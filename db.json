{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"source/pic/java2-1.png","path":"pic/java2-1.png","modified":0,"renderable":0},{"_id":"source/pic/java2-2.png","path":"pic/java2-2.png","modified":0,"renderable":0},{"_id":"source/pic/java2-3.jpg","path":"pic/java2-3.jpg","modified":0,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","path":"lib/canvas-ribbon/canvas-ribbon.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","path":"lib/needsharebutton/font-embedded.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","path":"lib/needsharebutton/needsharebutton.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","path":"lib/needsharebutton/needsharebutton.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","path":"lib/pace/pace-theme-barber-shop.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","path":"lib/pace/pace-theme-big-counter.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","path":"lib/pace/pace-theme-center-atom.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","path":"lib/pace/pace-theme-bounce.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","path":"lib/pace/pace-theme-center-circle.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","path":"lib/pace/pace-theme-center-radar.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","path":"lib/pace/pace-theme-center-simple.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","path":"lib/pace/pace-theme-fill-left.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","path":"lib/pace/pace-theme-flash.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","path":"lib/pace/pace-theme-loading-bar.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","path":"lib/pace/pace-theme-mac-osx.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace.min.js","path":"lib/pace/pace.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","path":"lib/pace/pace-theme-corner-indicator.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","path":"lib/pace/pace-theme-minimal.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.css","path":"lib/Han/dist/han.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.js","path":"lib/Han/dist/han.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.css","path":"lib/Han/dist/han.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.js","path":"lib/Han/dist/han.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","path":"lib/Han/dist/font/han-space.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","path":"lib/Han/dist/font/han-space.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","path":"lib/Han/dist/font/han.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","path":"lib/Han/dist/font/han.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","path":"lib/Han/dist/font/han.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":0,"renderable":1},{"_id":"source/pic/iis-1.png","path":"pic/iis-1.png","modified":0,"renderable":0},{"_id":"source/pic/iis-2.png","path":"pic/iis-2.png","modified":0,"renderable":0},{"_id":"source/pic/iis-3.png","path":"pic/iis-3.png","modified":0,"renderable":0},{"_id":"source/pic/win2012-net.png","path":"pic/win2012-net.png","modified":0,"renderable":0},{"_id":"source/pic/win2012-1.png","path":"pic/win2012-1.png","modified":0,"renderable":0},{"_id":"source/pic/iis8-file-2.png","path":"pic/iis8-file-2.png","modified":0,"renderable":0},{"_id":"source/pic/iis8-file-3.png","path":"pic/iis8-file-3.png","modified":0,"renderable":0},{"_id":"source/pic/iis8-file-1.png","path":"pic/iis8-file-1.png","modified":0,"renderable":0},{"_id":"source/pic/dialogbox.png","path":"pic/dialogbox.png","modified":0,"renderable":0},{"_id":"source/pic/javaee-running-1.png","path":"pic/javaee-running-1.png","modified":0,"renderable":0},{"_id":"source/pic/javaee-running-3.png","path":"pic/javaee-running-3.png","modified":0,"renderable":0},{"_id":"source/pic/javaee-running-2.png","path":"pic/javaee-running-2.png","modified":0,"renderable":0},{"_id":"source/pic/javaee-running-4.png","path":"pic/javaee-running-4.png","modified":0,"renderable":0},{"_id":"source/pic/java-remote-debug-3.png","path":"pic/java-remote-debug-3.png","modified":0,"renderable":0},{"_id":"source/pic/java-remote-debug-2.png","path":"pic/java-remote-debug-2.png","modified":0,"renderable":0},{"_id":"source/pic/java-remote-debug-1.png","path":"pic/java-remote-debug-1.png","modified":0,"renderable":0},{"_id":"source/pic/java-remote-debug-4.png","path":"pic/java-remote-debug-4.png","modified":0,"renderable":0},{"_id":"source/pic/wx-pay-1.png","path":"pic/wx-pay-1.png","modified":0,"renderable":0},{"_id":"source/pic/nps-1.png","path":"pic/nps-1.png","modified":1,"renderable":0},{"_id":"source/pic/nps-2.png","path":"pic/nps-2.png","modified":1,"renderable":0}],"Cache":[{"_id":"source/_posts/Linux-firewalld使用总结.md","hash":"d4d3ea874792d969472694c216ec16c455193bde","modified":1723119481173},{"_id":"source/_posts/2022初四.md","hash":"b2e278326e94d124b819a653bb5fa79d0ea777b7","modified":1707198634820},{"_id":"source/_posts/Hexo基础应用.md","hash":"7d2f97023e5bda7dae903c77e9e74c6546d6bc40","modified":1707198634810},{"_id":"source/_posts/Linux服务之crond.md","hash":"5559a59572b3687703595555a1a07947a6b1bb37","modified":1723434063726},{"_id":"source/_posts/Linux之LVM-逻辑卷管理.md","hash":"8954039c3dda21872cc5196a5b3b2ea5891dea1d","modified":1707198634811},{"_id":"source/_posts/docker学习3.md","hash":"8550e5f7e7a7f84ee8567cca3974861db325507e","modified":1707217488290},{"_id":"source/_posts/docker学习4-网络.md","hash":"bb666628ad10c5d37b34e7bcca1c5241620e6f7d","modified":1710741008123},{"_id":"source/_posts/ansible学习-playbook之nginx安装.md","hash":"6afe1aff4aee1beb27e180b2f6d3e2e2cb2a5a3e","modified":1707217463514},{"_id":"source/_posts/docker学习1.md","hash":"2d8b4d1edecc33c238f12d1a664d415b7949125a","modified":1710473431025},{"_id":"source/_posts/git-server.md","hash":"815b8a42b86055a98c5f26d7bda33992a0d6c90f","modified":1707198634827},{"_id":"source/_posts/fail2ban软件使用.md","hash":"1b99fa0c5745b837ebce0a7fe094a51d22d58afb","modified":1707217496723},{"_id":"source/_posts/docker学习2.md","hash":"e3d85821dad38c2981f48f52a3764d18718fe93f","modified":1707217484561},{"_id":"source/_posts/fastadmin使用总结.md","hash":"3f3e02b69b4f8ba744faa3e817f63220e108e569","modified":1707217117700},{"_id":"source/_posts/git总结.md","hash":"aa01f9a61765033ed5b4079085bc6aa1f6154c75","modified":1707198634834},{"_id":"source/_posts/hj212环保协议-2007.md","hash":"1fc065e717ae521730290dde2be2a403f0f4fb44","modified":1707217178819},{"_id":"source/_posts/ansible学习-playbook之nginx配置.md","hash":"6e77582a8065b4b14d73f2e89f67586fbe177eb4","modified":1707217476948},{"_id":"source/_posts/java学习1.md","hash":"c8a2611a5e939204c7c9f6737bc53e369656cf35","modified":1707198634830},{"_id":"source/_posts/k8s安装配置.md","hash":"d7fba8c6bb8c460f91bc004e1e4bea12346e7582","modified":1733296605373},{"_id":"source/_posts/js模块化.md","hash":"1b68249872842148b051bd9c8878aff6363146dc","modified":1707217364222},{"_id":"source/_posts/ansible学习.md","hash":"6f8ae3a7cffe9b77ce6d36fca66de3d8e950e9d3","modified":1707217471996},{"_id":"source/_posts/java学习2-运行javaee程序.md","hash":"06e3fd13fc9ddc51197564430cb893e776d3c1f2","modified":1712732729734},{"_id":"source/_posts/linux系统后台运行任务.md","hash":"38b0bc3220019f99e6aae30d4d4ed38bb5b6a04f","modified":1707198634844},{"_id":"source/_posts/linux-iptables使用总结.md","hash":"02a0c3fe73e454d990988fb74c7696f6533d5fa6","modified":1732533501336},{"_id":"source/_posts/java学习3-Servlet及HttpSeverlet.md","hash":"b7123fee2e4e85788d7ff5a63439db100da731d6","modified":1712735791982},{"_id":"source/_posts/jenkins-发布php项目.md","hash":"20a3583467efb91920433cc11016b7a8cc5cd540","modified":1707217353140},{"_id":"source/_posts/java学习4-层级类.md","hash":"e40a66813b8d80e30d2f7ec24fd005f051e27670","modified":1717405988919},{"_id":"source/_posts/linux配置代理.md","hash":"806cca43cccd202841bb0b6ba06b950b51d33145","modified":1709712245067},{"_id":"source/_posts/linux-防火墙相关.md","hash":"f46cf55365260d9592c19f2d53587597c0b6cff5","modified":1737338047893},{"_id":"source/_posts/linux环境编译安装总结.md","hash":"81e6fa130bf13a15808574a6f2426e9a3ae3e15f","modified":1709712245064},{"_id":"source/_posts/make-lnmp.md","hash":"47e513756d80b4ea4eea9989539fe7363b0319bd","modified":1707198634842},{"_id":"source/_posts/linux硬盘分区.md","hash":"d159426bd692fee10c2b59108169ccb41828b3f2","modified":1707198634843},{"_id":"source/_posts/mysql的常用应用.md","hash":"1e17a80acd12ab4085ca06bbef2590b574cc8465","modified":1723430587102},{"_id":"source/_posts/mysql-server.md","hash":"7c5c1e58e963a2d34b0d9e9c4157753e47f74363","modified":1707198634845},{"_id":"source/_posts/nginx-vhost-安全配置模版.md","hash":"2fd89e45619392c75b365f45dfa86e35d48a349b","modified":1707217383389},{"_id":"source/_posts/nginx之location.md","hash":"9f544018803b9597d49689da8423aeb0f06a15ed","modified":1707217387620},{"_id":"source/_posts/nginx-server.md","hash":"098f37828250093adcd48ffbc55399318161db61","modified":1707217195509},{"_id":"source/_posts/php.md","hash":"a485dd66ddb08e0c4cefd1b1eddb9b69c9c9d710","modified":1707217400175},{"_id":"source/_posts/nginx之logrotate.md","hash":"3a2ff3c3706d1c18c13c60282500db5a8fde574a","modified":1707217391983},{"_id":"source/_posts/openEuler搭建lnmp.md","hash":"7c59bdb121b3374417c1a4a9bd8be9b4e59dd660","modified":1732533855777},{"_id":"source/_posts/php开发-laravel学习2.md","hash":"5e31ad286e1a8e27271a936f3d7e18d69f1fcc42","modified":1719624846859},{"_id":"source/_posts/php开发-mysql锁.md","hash":"e186fc1f6c5c882e3722d225c9be2b67d1e1a3bd","modified":1719624846859},{"_id":"source/_posts/nginx配置.md","hash":"0686f01bf6801bd60a356bed095913d0b228d680","modified":1707217210809},{"_id":"source/_posts/php开发-ftp下载上传.md","hash":"3fbf24ac2ed3251db0e60d42afb68bf8ba95c72b","modified":1707364238129},{"_id":"source/_posts/openEuler系统安装遇到问题.md","hash":"c82238119b6a79902eb9aba5c54d3cb401c63216","modified":1707217218612},{"_id":"source/_posts/php开发-laravel学习1.md","hash":"3c35aed76bed364b290e7c6624f47e780061b981","modified":1719624846858},{"_id":"source/_posts/php开发-常见加密使用.md","hash":"10bc7350046ff3a35b9c53f5bf4e6b0b1e2b0cf2","modified":1732068985230},{"_id":"source/_posts/php开发-微信授权登录.md","hash":"4f86673015acadfdc1e1770728e902572a086654","modified":1745292833293},{"_id":"source/_posts/php开发-thinkphp钩子与行为.md","hash":"9be4b03d062411084b2aab5c98605f92606c4ec9","modified":1732534499355},{"_id":"source/_posts/php开发-常用函数总结.md","hash":"298e0d4496f0a84843fe355cd70bceb3511cc3a6","modified":1707217098937},{"_id":"source/_posts/php扩展安装.md","hash":"fe55523a68d8f45ca779329a52e74451df78b953","modified":1707198634956},{"_id":"source/_posts/php开发-注册登录登录.md","hash":"459256a715e526e5cea3f7ca1e7fa77e743fea94","modified":1732534466165},{"_id":"source/_posts/redis基本数据结构.md","hash":"bb6d376ba8664f7066d15194875f18c735360743","modified":1732534426697},{"_id":"source/_posts/session和cookie.md","hash":"98749e1e0d7c1e7b921e8db21e7fa86cfd64998b","modified":1707198634961},{"_id":"source/_posts/redis基础.md","hash":"819f3b4af2ba3e8c8aae91adf177e10ec2cdd08f","modified":1732534420486},{"_id":"source/_posts/shell脚本学习2.md","hash":"34f18bc2b2241abf8b80dc1183e055ddd7865ef7","modified":1707198634963},{"_id":"source/_posts/ubuntn搭建lnmp环境.md","hash":"6497ff84b0b677b7382a1e864f0eef40f40b8053","modified":1733302453299},{"_id":"source/_posts/shell脚本学习1.md","hash":"0c74452894f1d41ed917534bb96713eab12cf45c","modified":1707198634964},{"_id":"source/_posts/rsyslog日志服务.md","hash":"a0181d32121d2bfe3cc7e99983c1c9adf976b286","modified":1707217410168},{"_id":"source/_posts/springboot学习.md","hash":"0cc4280640b463d487d8abe7fd084f7ee25b73f5","modified":1707217267672},{"_id":"source/_posts/webpack学习笔记1.md","hash":"4b613038bd44a63a0373644c9b1480cdaa4fe69c","modified":1732534296361},{"_id":"source/_posts/web安全.md","hash":"76e67a33e8e5bb929042d705404e11c1eb6cc743","modified":1707198634974},{"_id":"source/_posts/vue学习1.md","hash":"8bfe2d22fa1d226dbed0dce6927645751ad7023a","modified":1732534281686},{"_id":"source/_posts/web开发中实时通信技术.md","hash":"e2179720e37f37b0b7e3390fbb5fc6639ed83c15","modified":1709712245068},{"_id":"source/_posts/wordpress相关.md","hash":"6cd8f83d112ed2dbeeea0c1a06a4977b2af4f087","modified":1707217142131},{"_id":"source/_posts/web备份方案.md","hash":"6a582c0aba4202907158f58a487273e1674208b6","modified":1707198634969},{"_id":"source/_posts/vsftpd-server.md","hash":"54956a913399ea718fe10d570e103386ae5e3360","modified":1710928025963},{"_id":"source/_posts/windows搭建apache-php-mysql5-6.md","hash":"7cf94f25942990298e049221c25b64ec57e99349","modified":1740400003050},{"_id":"source/_posts/奇怪问题总结.md","hash":"12aa3ef5720ed815f5a40cdac6d2e1deff182d99","modified":1723708327205},{"_id":"source/_posts/升级openssh.md","hash":"085ae481fe2f882f2ad3d44c0a009dae756e5e38","modified":1707198634996},{"_id":"source/_posts/搭建k8s.md","hash":"cbb671dfad2f589b8cf1d585b78c0039f8fb947a","modified":1707217457270},{"_id":"source/_posts/云主机硬盘扩容.md","hash":"3d1e2610c03ce6da90ffeb2414eaff9fc93f8318","modified":1754033153648},{"_id":"source/_posts/守护进程-supervisor.md","hash":"2726a4f351cca438942dd55cbbab31c84dd212e6","modified":1713257875678},{"_id":"source/_posts/搭建nps内网穿透.md","hash":"6467d807e9a8d151b1be6396b46cf823ca52348e","modified":1707198635000},{"_id":"source/_posts/普通心理学笔记1.md","hash":"d0ebe03bdcbbe22bc50cc38a51b103ac9a8bc784","modified":1707198635003},{"_id":"source/_posts/搭建openvpn.md","hash":"e2d9d939d2415c6f137b0e02201eb259b993e024","modified":1716624208066},{"_id":"source/about/index.md","hash":"780735e5368f60ba35d959352b50e3bea434e4e9","modified":1707191221582},{"_id":"source/_posts/普通心理学笔记2.md","hash":"f552004500b597ba9d3fc7a23474f3cf8308daa9","modified":1707198635020},{"_id":"source/_posts/记ubuntu-dns问题.md","hash":"8304c5bb00870e74b7e0977e826898bdb2f0bf70","modified":1732534375497},{"_id":"source/categories/index.md","hash":"4ebc85c57a8ad0ed7ee2d0f9f77738429279e2c0","modified":1707199169380},{"_id":"source/_posts/特殊的SQL语句.md","hash":"8a8a6b352925087c12ba594dce99244958c2aed2","modified":1732534182641},{"_id":"source/_posts/跨域问题总结.md","hash":"fc85817b7e0c3faa188c4e036145ce0b362e169b","modified":1707198635021},{"_id":"source/_posts/虚拟机扩容.md","hash":"4ad5c8cc7f35a7472ab6f9f89282f96064be6a7d","modified":1712450638442},{"_id":"source/tags/index.md","hash":"32f9cfcc437ca3d79540fa0a4c7f146e0b6bb8b1","modified":1645843561763},{"_id":"source/pic/java2-1.png","hash":"1324881cab769333bed47daa7b75ec7b3868fbfe","modified":1712715180873},{"_id":"source/_posts/高德地图-点位展示开发.md","hash":"bbe8ac96d3b896dbd9ad954045b6a87a2aae65d4","modified":1707217345300},{"_id":"source/pic/java2-2.png","hash":"a8c2b41e773eb1a689141720f1b56d24d22e9734","modified":1712715173963},{"_id":"source/pic/java2-3.jpg","hash":"f13e26dcaaa86f35508df3be327f67b7ffca6c6d","modified":1712718890012},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1645843561818},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1645843561810},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1645843561810},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1645843561810},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1645843561817},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1645843561817},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1645843561780},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1645843561780},{"_id":"themes/next/.gitignore","hash":"ee0b13c268cc8695d3883a5da84930af02d4ed08","modified":1645843561765},{"_id":"themes/next/.editorconfig","hash":"211d2c92bfdddb3e81ea946f4ca7a539f150f4da","modified":1645843561764},{"_id":"themes/next/.bowerrc","hash":"334da94ca6f024d60d012cc26ea655681e724ad8","modified":1645843561764},{"_id":"themes/next/.jshintrc","hash":"b7d23f2ce8d99fa073f22f9960605f318acd7710","modified":1645843561766},{"_id":"themes/next/.gitattributes","hash":"8454b9313cb1a97b63fb87e2d29daee497ce6249","modified":1645843561764},{"_id":"themes/next/.hound.yml","hash":"289dcf5bfe92dbd680d54d6e0668f41c9c9c0c78","modified":1645843561766},{"_id":"themes/next/.travis.yml","hash":"6674fbdfe0d0c03b8a04527ffb8ab66a94253acd","modified":1645843561766},{"_id":"themes/next/README.cn.md","hash":"b878b73f3fcdef47849453c94420871903d487b3","modified":1645843561767},{"_id":"themes/next/LICENSE","hash":"ec44503d7e617144909e54533754f0147845f0c5","modified":1645843561766},{"_id":"themes/next/bower.json","hash":"486ebd72068848c97def75f36b71cbec9bb359c5","modified":1645843561768},{"_id":"themes/next/package.json","hash":"3963ad558a24c78a3fd4ef23cf5f73f421854627","modified":1645843561790},{"_id":"themes/next/.stylintrc","hash":"3b7f9785e9ad0dab764e1c535b40df02f4ff5fd6","modified":1645843561766},{"_id":"themes/next/_config.yml","hash":"a72c363835d3273a0d3bbd7b4b57b498e156a8c0","modified":1707208255328},{"_id":"themes/next/.javascript_ignore","hash":"cd250ad74ca22bd2c054476456a73d9687f05f87","modified":1645843561766},{"_id":"themes/next/gulpfile.coffee","hash":"412defab3d93d404b7c26aaa0279e2e586e97454","modified":1645843561768},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"5adfad3ef1b870063e621bc0838268eb2c7c697a","modified":1645843561764},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"a0a82dbfabdef9a9d7c17a08ceebfb4052d98d81","modified":1645843561765},{"_id":"themes/next/languages/default.yml","hash":"b3bcd8934327448a43d9bfada5dd11b1b8c1402e","modified":1645843561768},{"_id":"themes/next/README.md","hash":"efcdc4b0ca791c3fc64afa28c8721e137f2d11ea","modified":1645843561767},{"_id":"themes/next/languages/de.yml","hash":"fd02d9c2035798d5dc7c1a96b4c3e24b05b31a47","modified":1645843561768},{"_id":"themes/next/languages/en.yml","hash":"2f4b4776ca1a08cc266a19afb0d1350a3926f42c","modified":1645843561769},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"1228506a940114288d61812bfe60c045a0abeac1","modified":1645843561765},{"_id":"themes/next/languages/id.yml","hash":"dccae33e2a5b3c9f11c0e05ec4a7201af1b25745","modified":1645843561769},{"_id":"themes/next/languages/fr-FR.yml","hash":"efeeb55d5c4add54ad59a612fc0630ee1300388c","modified":1645843561769},{"_id":"themes/next/languages/ko.yml","hash":"dc8f3e8c64eb7c4bb2385025b3006b8efec8b31d","modified":1645843561770},{"_id":"themes/next/languages/ja.yml","hash":"37f954e47a3bc669620ca559e3edb3b0072a4be5","modified":1645843561769},{"_id":"themes/next/.github/browserstack_logo.png","hash":"a6c43887f64a7f48a2814e3714eaa1215e542037","modified":1645843561765},{"_id":"themes/next/languages/pt-BR.yml","hash":"568d494a1f37726a5375b11452a45c71c3e2852d","modified":1645843561770},{"_id":"themes/next/languages/nl-NL.yml","hash":"213e7a002b82fb265f69dabafbbc382cfd460030","modified":1645843561770},{"_id":"themes/next/languages/pt.yml","hash":"2efcd240c66ab1a122f061505ca0fb1e8819877b","modified":1645843561771},{"_id":"themes/next/languages/vi.yml","hash":"a9b89ebd3e5933033d1386c7c56b66c44aca299a","modified":1645843561771},{"_id":"themes/next/languages/it.yml","hash":"a215d016146b1bd92cef046042081cbe0c7f976f","modified":1645843561769},{"_id":"themes/next/languages/ru.yml","hash":"e33ee44e80f82e329900fc41eb0bb6823397a4d6","modified":1645843561771},{"_id":"themes/next/scripts/merge-configs.js","hash":"38d86aab4fc12fb741ae52099be475196b9db972","modified":1645843561790},{"_id":"themes/next/languages/zh-Hans.yml","hash":"66b9b42f143c3cb2f782a94abd4c4cbd5fd7f55f","modified":1645843561772},{"_id":"themes/next/test/.jshintrc","hash":"c9fca43ae0d99718e45a6f5ce736a18ba5fc8fb6","modified":1645843561866},{"_id":"themes/next/languages/zh-hk.yml","hash":"fe0d45807d015082049f05b54714988c244888da","modified":1645843561772},{"_id":"themes/next/languages/zh-tw.yml","hash":"432463b481e105073accda16c3e590e54c8e7b74","modified":1645843561772},{"_id":"themes/next/scripts/merge.js","hash":"39b84b937b2a9608b94e5872349a47200e1800ff","modified":1645843561790},{"_id":"themes/next/test/intern.js","hash":"db90b1063356727d72be0d77054fdc32fa882a66","modified":1645843561866},{"_id":"themes/next/test/helpers.js","hash":"f25e7f3265eb5a6e1ccbb5e5012fa9bebf134105","modified":1645843561866},{"_id":"themes/next/layout/_layout.swig","hash":"2164570bb05db11ee4bcfbbb5d183a759afe9d07","modified":1645843561773},{"_id":"themes/next/layout/index.swig","hash":"555a357ecf17128db4e29346c92bb6298e66547a","modified":1645843561789},{"_id":"themes/next/layout/archive.swig","hash":"9a2c14874a75c7085d2bada5e39201d3fc4fd2b4","modified":1645843561788},{"_id":"themes/next/layout/schedule.swig","hash":"87ad6055df01fa2e63e51887d34a2d8f0fbd2f5a","modified":1645843561790},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"99b66949f18398689b904907af23c013be1b978f","modified":1645843561791},{"_id":"themes/next/layout/category.swig","hash":"3cbb3f72429647411f9e85f2544bdf0e3ad2e6b2","modified":1645843561789},{"_id":"themes/next/scripts/tags/button.js","hash":"eddbb612c15ac27faf11c59c019ce188f33dec2c","modified":1645843561791},{"_id":"themes/next/layout/post.swig","hash":"7a6ce102ca82c3a80f776e555dddae1a9981e1ed","modified":1645843561790},{"_id":"themes/next/scripts/tags/exturl.js","hash":"5022c0ba9f1d13192677cf1fd66005c57c3d0f53","modified":1645843561791},{"_id":"themes/next/scripts/tags/full-image.js","hash":"c9f833158c66bd72f627a0559cf96550e867aa72","modified":1645843561791},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"ac681b0d0d8d39ba3817336c0270c6787c2b6b70","modified":1645843561792},{"_id":"themes/next/scripts/tags/lazy-image.js","hash":"bcba2ff25cd7850ce6da322d8bd85a8dd00b5ceb","modified":1645843561792},{"_id":"themes/next/layout/page.swig","hash":"e8fcaa641d46930237675d2ad4b56964d9e262e9","modified":1645843561789},{"_id":"themes/next/scripts/tags/note.js","hash":"f7eae135f35cdab23728e9d0d88b76e00715faa0","modified":1645843561792},{"_id":"themes/next/layout/tag.swig","hash":"34e1c016cbdf94a31f9c5d494854ff46b2a182e9","modified":1645843561790},{"_id":"themes/next/scripts/tags/tabs.js","hash":"aa7fc94a5ec27737458d9fe1a75c0db7593352fd","modified":1645843561792},{"_id":"themes/next/scripts/tags/label.js","hash":"6f00952d70aadece844ce7fd27adc52816cc7374","modified":1645843561792},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"45eeea0b5fba833e21e38ea10ed5ab385ceb4f01","modified":1645843561818},{"_id":"themes/next/source/css/main.styl","hash":"a91dbb7ef799f0a171b5e726c801139efe545176","modified":1645843561818},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1645843561819},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"bc3588c9b2d7c68830524783120ff6cf957cf668","modified":1645843561819},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1645843561818},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"6f55543d1fb9cbc436c101d24f802dec7b41efc3","modified":1645843561819},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"6f076713fb9bf934aa2c1046bdf2cf2e37bc1eab","modified":1645843561819},{"_id":"themes/next/source/images/cc-by.svg","hash":"e92a33c32d1dac8ed94849b2b4e6456e887efe70","modified":1645843561821},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1645843561821},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"42cd73da328077ccc92f859bb8f3cf621b3484f8","modified":1645843561820},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1645843561821},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1645843561821},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"70c1535f43e54e5ff35ca81419e77e4c0c301398","modified":1645843561820},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1645843561821},{"_id":"themes/next/source/images/logo.svg","hash":"169f56fd82941591dad3abd734a50ec7259be950","modified":1645843561821},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"8c56dd26157cbc580ae41d97ac34b90ab48ced3f","modified":1645843561773},{"_id":"themes/next/layout/_macro/post-copyright.swig","hash":"f83befdc740beb8dc88805efd7fbb0fef9ed19be","modified":1645843561774},{"_id":"themes/next/source/images/quote-l.svg","hash":"cd108d6f44351cadf8e6742565217f88818a0458","modified":1645843561822},{"_id":"themes/next/source/images/quote-r.svg","hash":"2a2a250b32a87c69dcc1b1976c74b747bedbfb41","modified":1645843561822},{"_id":"themes/next/source/images/cc-zero.svg","hash":"9bfb52b2f63527a7049247bf00d44e6dc1170e7d","modified":1645843561821},{"_id":"themes/next/layout/_macro/post.swig","hash":"4ba938822d56c597490f0731893eaa2443942e0f","modified":1645843561774},{"_id":"themes/next/layout/_partials/comments.swig","hash":"4adc65a602d1276615da3b887dcbf2ac68e7382b","modified":1645843561775},{"_id":"themes/next/layout/_partials/footer.swig","hash":"cf2a4cf640273026cdf64f0e214b113aef69142e","modified":1707208197973},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"9c7343fd470e0943ebd75f227a083a980816290b","modified":1645843561774},{"_id":"themes/next/layout/_partials/search.swig","hash":"b4ebe4a52a3b51efe549dd1cdee846103664f5eb","modified":1645843561777},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"77c61e0baea3544df361b7338c3cd13dc84dde22","modified":1645843561776},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"e2e4eae391476da994045ed4c7faf5e05aca2cd7","modified":1645843561775},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"931808ad9b8d8390c0dcf9bdeb0954eeb9185d68","modified":1645843561779},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"0cba467c1351a4968fffd948feaabc9c5270bdda","modified":1650957278427},{"_id":"themes/next/layout/_third-party/duoshuo-hot-articles.swig","hash":"ba75672183d94f1de7c8bd0eeee497a58c70e889","modified":1645843561785},{"_id":"themes/next/layout/_partials/head.swig","hash":"f14a39dad1ddd98e6d3ceb25dda092ba80d391b5","modified":1645843561775},{"_id":"themes/next/layout/_macro/reward.swig","hash":"357d86ec9586705bfbb2c40a8c7d247a407db21a","modified":1645843561774},{"_id":"themes/next/layout/_third-party/exturl.swig","hash":"8301c9600bb3e47f7fb98b0e0332ef3c51bb1688","modified":1645843561786},{"_id":"themes/next/layout/_partials/header.swig","hash":"c54b32263bc8d75918688fb21f795103b3f57f03","modified":1645843561776},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"554ec568e9d2c71e4a624a8de3cb5929050811d6","modified":1645843561787},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1645843561822},{"_id":"themes/next/layout/_third-party/scroll-cookie.swig","hash":"9a188938d46931d5f3882a140aa1c48b3a893f0c","modified":1645843561787},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"9be624634703be496a5d2535228bc568a8373af9","modified":1645843561780},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"ba8ab5a0280b953aa97435ff8946cbcbb2755a27","modified":1645843561773},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"c0f5a0955f69ca4ed9ee64a2d5f8aa75064935ad","modified":1645843561779},{"_id":"themes/next/layout/_custom/header.swig","hash":"ba8ab5a0280b953aa97435ff8946cbcbb2755a27","modified":1645843561773},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"07f7da320689f828f6e36a6123807964a45157a0","modified":1645843561810},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"db15d7e1552aa2d2386a6b8a33b3b3a40bf9e43d","modified":1645843561787},{"_id":"themes/next/layout/_third-party/needsharebutton.swig","hash":"fa882641da3bd83d9a58a8a97f9d4c62a9ee7b5c","modified":1645843561787},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"7896c3ee107e1a8b9108b6019f1c070600a1e8cc","modified":1645843561810},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"a25408534f8fe6e321db4bbf9dd03335d648fe17","modified":1645843561816},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"58e7dd5947817d9fc30770712fc39b2f52230d1e","modified":1645843561816},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"0e55cbd93852dc3f8ccb44df74d35d9918f847e0","modified":1645843561810},{"_id":"themes/next/layout/_third-party/mathjax.swig","hash":"a0bd3388587fd943baae0d84ca779a707fbcad89","modified":1645843561787},{"_id":"themes/next/source/css/_variables/base.styl","hash":"b1f6ea881a4938a54603d68282b0f8efb4d7915d","modified":1645843561817},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"3403fdd8efde1a0afd11ae8a5a97673f5903087f","modified":1645843561809},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","hash":"b02737510e9b89aeed6b54f89f602a9c24b06ff2","modified":1645843561833},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"4069f918ccc312da86db6c51205fc6c6eaabb116","modified":1645843561817},{"_id":"themes/next/source/lib/fastclick/README.md","hash":"68a9b9d53126405b0fa5f3324f1fb96dbcc547aa","modified":1645843561838},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1645843561832},{"_id":"themes/next/source/lib/fastclick/.bower.json","hash":"bf3eef9d647cd7c9b62feda3bc708c6cdd7c0877","modified":1645843561838},{"_id":"themes/next/source/lib/fastclick/LICENSE","hash":"6f474ea75c42442da7bbcf2e9143ce98258efd8d","modified":1645843561838},{"_id":"themes/next/source/lib/jquery_lazyload/.bower.json","hash":"90fa628f156d8045357ff11eaf32e61abacf10e8","modified":1645843561851},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1645843561829},{"_id":"themes/next/source/lib/jquery/.bower.json","hash":"865d6c1328ab209a4376b9d2b7a7824369565f28","modified":1645843561849},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4ded6fee668544778e97e38c2b211fc56c848e77","modified":1645843561851},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","hash":"e0acf1db27b0cc16128a59c46db1db406b5c4c58","modified":1645843561851},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","hash":"b930297cb98b8e1dbd5abe9bc1ed9d5935d18ce8","modified":1645843561851},{"_id":"themes/next/source/lib/fastclick/bower.json","hash":"a9b3ee1e4db71a0e4ea6d5bed292d176dd68b261","modified":1645843561839},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"f4a570908f6c89c6edfb1c74959e733eaadea4f2","modified":1645843561851},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"03ddbf76c1dd1afb93eed0b670d2eee747472ef1","modified":1645843561840},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","hash":"e33aa8fa48b6639d8d8b937d13261597dd473b3a","modified":1645843561853},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"c31ff06a740955e44edd4403902e653ccabfd4db","modified":1645843561840},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"71e7183634dc1b9449f590f15ebd7201add22ca7","modified":1645843561840},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","hash":"14264a210bf94232d58d7599ea2ba93bfa4fb458","modified":1645843561852},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"bf773ad48a0b9aa77681a89d7569eefc0f7b7b18","modified":1645843561852},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1645843561853},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","hash":"2ce5f3bf15c523b9bfc97720d8884bb22602a454","modified":1645843561853},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1645843561854},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"b4aefc910578d76b267e86dfffdd5121c8db9aec","modified":1645843561840},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1645843561853},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1645843561856},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1645843561854},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1645843561854},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1645843561854},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1645843561854},{"_id":"themes/next/source/js/src/affix.js","hash":"1b509c3b5b290a6f4607f0f06461a0c33acb69b1","modified":1645843561822},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"ee33b2798b1e714b904d663436c6b3521011d1fa","modified":1645843561840},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1645843561856},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1645843561856},{"_id":"themes/next/source/lib/pace/pace.min.js","hash":"8aaa675f577d5501f5f22d5ccb07c2b76310b690","modified":1645843561856},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1645843561856},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1645843561855},{"_id":"themes/next/source/js/src/exturl.js","hash":"a2a0f0de07e46211f74942a468f42ee270aa555c","modified":1645843561823},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"cb431b54ba9c692165a1f5a12e4c564a560f8058","modified":1645843561822},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1645843561856},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"0289031200c3d4c2bdd801ee10fff13bb2c353e4","modified":1645843561823},{"_id":"themes/next/source/js/src/post-details.js","hash":"93a18271b4123dd8f94f09d1439b47c3c19a8712","modified":1645843561824},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"02cf91514e41200bc9df5d8bdbeb58575ec06074","modified":1645843561825},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"b35a7dc47b634197b93487cea8671a40a9fdffce","modified":1645843561823},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"1512c751d219577d338ac0780fb2bbd9075d5298","modified":1645843561823},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"b7657be25fc52ec67c75ab5481bdcb483573338b","modified":1645843561825},{"_id":"themes/next/source/lib/velocity/bower.json","hash":"92d92860418c4216aa59eb4cb4a556290a7ad9c3","modified":1645843561862},{"_id":"themes/next/source/js/src/motion.js","hash":"885176ed51d468f662fbf0fc09611f45c7e5a3b1","modified":1645843561823},{"_id":"themes/next/source/js/src/utils.js","hash":"b3e9eca64aba59403334f3fa821f100d98d40337","modified":1645843561825},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"bf172816a9c57f9040e3d19c24e181a142daf92b","modified":1645843561865},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"dbbfb50f6502f6b81dcc9fee7b31f1e812da3464","modified":1645843561865},{"_id":"themes/next/layout/_partials/head/custom-head.swig","hash":"a223919d2e1bf17ca4d6abb2c86f2efca9883dc1","modified":1645843561776},{"_id":"themes/next/source/lib/velocity/.bower.json","hash":"63da5e80ebb61bb66a2794d5936315ca44231f0c","modified":1645843561862},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"dde584994ac13dc601836e86f4cf490e418d9723","modified":1645843561865},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"b2f0d247b213e4cf8de47af6a304d98070cc7256","modified":1645843561777},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"a8c7f9ca7c605d039a1f3bf4e4d3183700a3dd62","modified":1645843561777},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","hash":"2d9a9f38c493fdf7c0b833bb9184b6a1645c11b2","modified":1645843561857},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"f5e487b0d213ca0bd94aa30bc23b240d65081627","modified":1645843561776},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"b25002a83cbd2ca0c4a5df87ad5bff26477c0457","modified":1645843561777},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"a9a3995b9615adfb8d6b127c78c6771627bee19a","modified":1645843561780},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"9e3d133ac5bcc6cb51702c83b2611a49811abad1","modified":1645843561778},{"_id":"themes/next/source/lib/three/three-waves.min.js","hash":"8148492dd49aa876d32bb7d5b728d3f5bf6f5074","modified":1645843561857},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"9b84ab576982b2c3bb0291da49143bc77fba3cc6","modified":1645843561779},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","hash":"46a50b91c98b639c9a2b9265c5a1e66a5c656881","modified":1645843561857},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a9a3995b9615adfb8d6b127c78c6771627bee19a","modified":1645843561780},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"d9e2d9282f9be6e04eae105964abb81e512bffed","modified":1645843561778},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"d4fbffd7fa8f2090eb32a871872665d90a885fac","modified":1645843561778},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"4c501ea0b9c494181eb3c607c5526a5754e7fbd8","modified":1645843561783},{"_id":"themes/next/layout/_third-party/comments/duoshuo.swig","hash":"1600f340e0225361580c44890568dc07dbcf2c89","modified":1645843561784},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"0a9cdd6958395fcdffc80ab60f0c6301b63664a5","modified":1645843561778},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"493bd5999a1061b981922be92d8277a0f9152447","modified":1645843561784},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"b83a51bbe0f1e2ded9819070840b0ea145f003a6","modified":1645843561783},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"9246162d4bc7e949ce1d12d135cbbaf5dc3024ec","modified":1645843561785},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"ff947f3561b229bc528cb1837d4ca19612219411","modified":1645843561780},{"_id":"themes/next/layout/_third-party/comments/youyan.swig","hash":"7e65ff8fe586cd655b0e9d1ad2912663ff9bd36c","modified":1645843561785},{"_id":"themes/next/layout/_third-party/comments/hypercomments.swig","hash":"af7f3e43cbdc4f88c13f101f0f341af96ace3383","modified":1645843561784},{"_id":"themes/next/layout/_third-party/comments/gitment.swig","hash":"4dcc3213c033994d342d02b800b6229295433d30","modified":1645843561784},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"a10b7f19d7b5725527514622899df413a34a89db","modified":1645843561781},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"753d262911c27baf663fcaf199267133528656af","modified":1645843561781},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"71397a5823e8ec8aad3b68aace13150623b3e19d","modified":1645843561780},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"45f3f629c2aacc381095750e1c8649041a71a84b","modified":1645843561782},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"b1e13df83fb2b1d5d513b30b7aa6158b0837daab","modified":1645843561782},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"7b11eac3a0685fa1ab2ab6ecff60afc4f15f0d16","modified":1645843561781},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"4050553d44ba1396174161c9a6bb0f89fa779eca","modified":1645843561785},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"7d94845f96197d9d84a405fa5d4ede75fb81b225","modified":1645843561781},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"8a399df90dadba5ad4e781445b58f4765aeb701e","modified":1645843561783},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"ccc443b22bd4f8c7ac4145664686c756395b90e0","modified":1645843561782},{"_id":"themes/next/layout/_third-party/search/tinysou.swig","hash":"fe95dd3d166634c466e19aa756e65ad6e8254d3e","modified":1645843561788},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"34599633658f3b0ffb487728b7766e1c7b551f5a","modified":1645843561787},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"e6d10ee4fb70b3ae1cd37e9e36e000306734aa2e","modified":1645843561782},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"ff4489cd582f518bba6909a301ac1292a38b4e96","modified":1645843561794},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"f9a1647a8f1866deeb94052d1f87a5df99cb1e70","modified":1645843561783},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"93479642fd076a1257fecc25fcf5d20ccdefe509","modified":1645843561788},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"5a8027328f060f965b3014060bebec1d7cf149c1","modified":1645843561783},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"7ad4081466b397e2a6204141bb7768b7c01bd93c","modified":1645843561794},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"6eb4bcc3056bd279d000607e8b4dad50d368ca69","modified":1645843561803},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"8b32928686c327151e13d3ab100157f9a03cd59f","modified":1645843561794},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"237d185ac62ec9877e300947fa0109c44fb8db19","modified":1645843561793},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"4f2801fc4cf3f31bf2069f41db8c6ce0e3da9e39","modified":1645843561798},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"24ee4b356ff55fc6e58f26a929fa07750002cf29","modified":1645843561808},{"_id":"themes/next/layout/_third-party/seo/baidu-push.swig","hash":"d8c98938719284fa06492c114d99a1904652a555","modified":1645843561788},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"8f86f694c0749a18ab3ad6f6df75466ca137a4bc","modified":1645843561793},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a17e2b871a335f290afb392a08f94fd35f59c715","modified":1645843561809},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"3f40e8a9fe8e7bd5cfc4cf4cbbbcb9539462e973","modified":1645843561809},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"91ca75492cd51f2553f4d294ed2f48239fcd55eb","modified":1645843561808},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"60fa84aa7731760f05f52dd7d8f79b5f74ac478d","modified":1645843561811},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"b1025c421406d2c24cc92a02ae28c1915b01e240","modified":1645843561812},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"12662536c7a07fff548abe94171f34b768dd610f","modified":1645843561808},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"1da5c800d025345f212a3bf1be035060f4e5e6ed","modified":1645843561808},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"25d5e45a355ee2093f3b8b8eeac125ebf3905026","modified":1645843561811},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"26666c1f472bf5f3fb9bc62081cca22b4de15ccb","modified":1645843561812},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"ea9069645696f86c5df64208490876fe150c8cae","modified":1645843561809},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"31127dcbf4c7b4ada53ffbf1638b5fe325b7cbc0","modified":1645843561814},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"09c965022c13b84ed8a661fee8ac2a6d550495ae","modified":1645843561812},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"748dbfbf9c08e719ddc775958003c64b00d39dab","modified":1645843561814},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"9c99034f8e00d47e978b3959f51eb4a9ded0fcc8","modified":1645843561812},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"09c965022c13b84ed8a661fee8ac2a6d550495ae","modified":1645843561814},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"bce344d3a665b4c55230d2a91eac2ad16d6f32fd","modified":1645843561815},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9b913b73d31d21f057f97115ffab93cfa578b884","modified":1645843561812},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"86197902dfd3bededba10ba62b8f9f22e0420bde","modified":1645843561816},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"5dbc0d0c897e46760e5dbee416530d485c747bba","modified":1645843561814},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"4642e30010af8b2b037f5b43146b10a934941958","modified":1645843561815},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"416988dca389e6e2fdfa51fa7f4ee07eb53f82fb","modified":1645843561815},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"ad2dcedf393ed1f3f5afd2508d24969c916d02fc","modified":1645843561815},{"_id":"themes/next/source/lib/Han/dist/han.min.css","hash":"6d586bfcfb7ae48f1b12f76eec82d3ad31947501","modified":1645843561829},{"_id":"themes/next/source/lib/Han/dist/han.css","hash":"6c26cdb36687d4f0a11dabf5290a909c3506be5c","modified":1645843561827},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"1f6e2ce674735269599acc6d77b3ea18d31967fc","modified":1645843561815},{"_id":"themes/next/source/lib/Han/dist/han.min.js","hash":"16b03db23a52623348f37c04544f2792032c1fb6","modified":1645843561829},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1645843561833},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1645843561834},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1645843561834},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1645843561835},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"e695e58f714129ca292c2e54cd62c251aca7f7fe","modified":1645843561814},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"82f33ad0842aa9c154d029e0dada2497d4eb1d57","modified":1645843561836},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"d71602cbca33b9ecdb7ab291b7f86a49530f3601","modified":1645843561837},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"3655f1fdf1e584c4d8e8d39026093ca306a5a341","modified":1645843561841},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1645843561839},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"1573904b82807abbb32c97a3632c6c6808eaac50","modified":1645843561841},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1645843561834},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","hash":"1d6aeda0480d0e4cb6198edf7719d601d4ae2ccc","modified":1645843561839},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"88af80502c44cd52ca81ffe7dc7276b7eccb06cf","modified":1645843561842},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"ae6318aeb62ad4ce7a7e9a4cdacd93ffb004f0fb","modified":1645843561838},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"41ea797c68dbcff2f6fb3aba1d1043a22e7cc0f6","modified":1645843561861},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"9f73c4696f0907aa451a855444f88fc0698fa472","modified":1645843561795},{"_id":"themes/next/layout/_third-party/search/algolia-search/dom.swig","hash":"2530de0f3125a912756f6c0e9090cd012134a4c5","modified":1645843561787},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"53cde051e0337f4bf42fb8d6d7a79fa3fa6d4ef2","modified":1645843561795},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d63e0cacc53dd375fcc113465a4328c59ff5f2c1","modified":1645843561795},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"a817b6c158cbc5bab3582713de9fe18a18a80552","modified":1645843561862},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1645843561834},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"1a0d059799a298fe17c49a44298d32cebde93785","modified":1645843561795},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"1727702eac5d326b5c81a667944a245016668231","modified":1645843561796},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"d0bfd1bef988c76f7d7dd72d88af6f0908a8b0db","modified":1645843561811},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"39f04c4c7237a4e10acd3002331992b79945d241","modified":1645843561801},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"f1d0b5d7af32c423eaa8bb93ab6a0b45655645dc","modified":1645843561824},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"167986d0f649516671ddf7193eebba7b421cd115","modified":1645843561796},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"761eba9811b050b25d548cc0854de4824b41eb08","modified":1645843561802},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"11c22f0fb3f6beb13e5a425ec064a4ff974c13b7","modified":1645843561802},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"0656e753f182c9f47fef7304c847b7587a85ef0d","modified":1645843561796},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"8dd9a1c6f4f6baa00c2cf01837e7617120cf9660","modified":1645843561802},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"61f8cea3c01acd600e90e1bc2a07def405503748","modified":1645843561802},{"_id":"themes/next/layout/_third-party/search/algolia-search/assets.swig","hash":"218cc936ba3518a3591b2c9eda46bc701edf7710","modified":1645843561787},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"1153bb71edf253765145559674390e16dd67c633","modified":1645843561803},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"7fe4d4d656e86276c17cb4e48a560cb6a4def703","modified":1645843561797},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"50450d9fdc8a2b2be8cfca51e3e1a01ffd636c0b","modified":1645843561796},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"e71652d3216e289c8548b1ea2357822c1476a425","modified":1645843561803},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"b6f3a06a94a6ee5470c956663164d58eda818a64","modified":1645843561797},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"7fb593f90d74a99c21840679933b9ef6fdc16a61","modified":1645843561797},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"62fbbd32cf5a99ae550c45c763a2c4813a138d01","modified":1645843561798},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"4e3838d7ac81d9ad133960f0f7ed58a44a015285","modified":1645843561797},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"f9760ecf186954cee3ba4a149be334e9ba296b89","modified":1645843561797},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"5ef6343835f484a2c0770bd1eb9cc443609e4c39","modified":1645843561803},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"caf263d1928496688c0e1419801eafd7e6919ce5","modified":1645843561799},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"875cbe88d5c7f6248990e2beb97c9828920e7e24","modified":1645843561798},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"a200c0a1c5a895ac9dc41e0641a5dfcd766be99b","modified":1645843561799},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"cd9e214e502697f2f2db84eb721bac57a49b0fce","modified":1645843561799},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"c8fe49a4bc014c24dead05b782a7082411a4abc5","modified":1645843561803},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"8cf318644acc8b4978537c263290363e21c7f5af","modified":1645843561798},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"a1521d48bb06d8d703753f52a198baa197af7da2","modified":1645843561803},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"a6c6eb8adba0a090ad1f4b9124e866887f20d10d","modified":1645843561799},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"b2495ae5e04dcca610aacadc47881d9e716cd440","modified":1645843561800},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"ccb34c52be8adba5996c6b94f9e723bd07d34c16","modified":1645843561801},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"7968343e41f8b94b318c36289dff1196c3eb1791","modified":1645843561801},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"5a982d8ef3b3623ea5f59e63728990f5623c1b57","modified":1645843561800},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"d0d7a5c90d62b685520d2b47fea8ba6019ff5402","modified":1645843561799},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"01567edaea6978628aa5521a122a85434c418bfd","modified":1645843561801},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"ca88ea6999a61fb905eb6e72eba5f92d4ee31e6e","modified":1645843561800},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"5dbeed535d63a50265d96b396a5440f9bb31e4ba","modified":1645843561806},{"_id":"themes/next/source/css/_common/components/third-party/gitment.styl","hash":"874278147115601d2abf15987f5f7a84ada1ac6b","modified":1645843561806},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"27deb3d3a243d30022055dac7dad851024099a8b","modified":1645843561800},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"a6e7d698702c2e383dde3fde2abde27951679084","modified":1645843561806},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"10599e16414a8b7a76c4e79e6617b5fe3d4d1adf","modified":1645843561807},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"bba4f3bdb7517cd85376df3e1209b570c0548c69","modified":1645843561806},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"15975ba7456b96916b1dbac448a1a0d2c38b8f3d","modified":1645843561807},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"89d6c3b697efc63de42afd2e89194b1be14152af","modified":1645843561801},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"28825ae15fa20ae3942cdaa7bcc1f3523ce59acc","modified":1645843561807},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"717cc7f82be9cc151e23a7678601ff2fd3a7fa1d","modified":1645843561806},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"f825da191816eef69ea8efb498a7f756d5ebb498","modified":1645843561804},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"9c8196394a89dfa40b87bf0019e80144365a9c93","modified":1645843561808},{"_id":"themes/next/source/css/_common/components/tags/exturl.styl","hash":"a3bdd71237afc112b2aa255f278cab6baeb25351","modified":1645843561804},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"2ad1a2a9bbf6742d1b0762c4c623b68113d1e0fe","modified":1645843561804},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"16087276945fa038f199692e3eabb1c52b8ea633","modified":1645843561807},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"2fe76476432b31993338cb45cdb3b29a518b6379","modified":1645843561804},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"2ab1322fe52ab5aafd49e68f5bd890e8380ee927","modified":1645843561804},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"a07aa12cc36ac5c819670c2a3c17d07ed7a08986","modified":1645843561813},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"b80604868e4f5cf20fccafd7ee415c20c804f700","modified":1645843561805},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"154a87a32d2fead480d5e909c37f6c476671c5e6","modified":1645843561805},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"1f09be9bb38411f0629b58c3b23873589a6dbcaa","modified":1645843561814},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"1f09be9bb38411f0629b58c3b23873589a6dbcaa","modified":1645843561813},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"9a409b798decdefdaf7a23f0b11004a8c27e82f3","modified":1645843561805},{"_id":"themes/next/source/css/_common/components/tags/note-modern.styl","hash":"b7076e58d647265ee0ad2b461fe8ce72c9373bc5","modified":1645843561805},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1645843561826},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1645843561826},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1645843561825},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","hash":"623af3ed5423371ac136a4fe0e8cc7bb7396037a","modified":1645843561827},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1645843561826},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"6394c48092085788a8c0ef72670b0652006231a1","modified":1645843561835},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1645843561835},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"51139a4c79573d372a347ef01a493222a1eaf10a","modified":1645843561836},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"b88b589f5f1aa1b3d87cc7eef34c281ff749b1ae","modified":1645843561836},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"ee948b4489aedeb548a77c9e45d8c7c5732fd62d","modified":1645843561836},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"d22b1629cb23a6181bebb70d0cf653ffe4b835c8","modified":1645843561836},{"_id":"themes/next/source/lib/jquery/index.js","hash":"17a740d68a1c330876c198b6a4d9319f379f3af2","modified":1645843561850},{"_id":"themes/next/source/lib/Han/dist/han.js","hash":"4ac683b2bc8531c84d98f51b86957be0e6f830f3","modified":1645843561828},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1645843561849},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1645843561848},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1645843561845},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1645843561848},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1645843561843},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"4237c6e9d59da349639de20e559e87c2c0218cfd","modified":1645843561864},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"90a1b22129efc172e2dfcceeeb76bff58bc3192f","modified":1645843561832},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"b5483b11f8ba213e733b5b8af9927a04fec996f6","modified":1645843561846},{"_id":"themes/next/source/lib/three/three.min.js","hash":"26273b1cb4914850a89529b48091dc584f2c57b8","modified":1645843561860},{"_id":"public/search.xml","hash":"3987814e4332fbe49c6bad3ba71cb4e9d523abc5","modified":1744855460063},{"_id":"public/sitemap.xml","hash":"b18dd974b444d66bb4468e4082b94f75545733e8","modified":1744855460063},{"_id":"public/sitemap.txt","hash":"f95859ad0135060b024fab0742eeef4cbde443e4","modified":1744855460063},{"_id":"public/atom.xml","hash":"bf51ad1e129a2b5fb265f117e1db39573530dbc7","modified":1744855460063},{"_id":"public/about/index.html","hash":"8a37cdcb81843302f932971d99e3d61f5d9c3e6b","modified":1744855460063},{"_id":"public/categories/index.html","hash":"922d4cf93ba28336a4477ec492599499fa34c5cb","modified":1744855460063},{"_id":"public/tags/index.html","hash":"f47554abc0af242dec2a2888452614817cb9d1af","modified":1744855460063},{"_id":"public/posts/33571e0f.html","hash":"6429a61c685e55bea02141fe40d8c5420e2c8bbd","modified":1744855460063},{"_id":"public/posts/4a58ed40.html","hash":"73b5a64d036259ed3fbe5923e9a7656d9c15e974","modified":1744855460063},{"_id":"public/posts/7052941e.html","hash":"453970375e560bfac2e044aeed60772aa53b8418","modified":1744855460063},{"_id":"public/posts/5951e8f7.html","hash":"9e51d4a2833be619ab0b22968f0a4139014f36e7","modified":1744855460063},{"_id":"public/posts/e9f2e524.html","hash":"5dbca1cd2e62ae42dba400b3346cd356b8d8a790","modified":1744855460063},{"_id":"public/posts/2b88779d.html","hash":"f33f1639e59a1e8ddee36f66d14ee6542e4475e2","modified":1744855460063},{"_id":"public/posts/10974f2f.html","hash":"e42b2d6da0f56503f35eee7b4c441c52530706c3","modified":1744855460063},{"_id":"public/posts/dc9d89c5.html","hash":"86b19cf771d2d92e7c7057c81faeb2ec63baff83","modified":1744855460063},{"_id":"public/posts/9d1b4110.html","hash":"3a625151005902b84740ee7a33b7c0091f7a5345","modified":1744855460063},{"_id":"public/posts/1b78fbfa.html","hash":"70c96298ed8070f60157b08a9669d0c494b57ae8","modified":1744855460063},{"_id":"public/posts/a634ca62.html","hash":"6d6923dfbbab37c4285a521604989006995dce23","modified":1744855460063},{"_id":"public/posts/42347bce.html","hash":"2c9afc0189bfa8eb661912b6f67cdd4061c5ca4c","modified":1744855460063},{"_id":"public/posts/78f26761.html","hash":"bd4fcb1418d8b7a103b3cdb3037ae661429944e4","modified":1744855460063},{"_id":"public/posts/eae5a656.html","hash":"df1b45cbc42e86f7e15d0cf69775512f65eea6d5","modified":1744855460063},{"_id":"public/posts/fa30932c.html","hash":"2acf1d1f20ab87cf2d3d1111de61818d7f80fdb3","modified":1744855460063},{"_id":"public/posts/ae0c2972.html","hash":"f00b8cb2ca3cc1ab2f4b942fb6f4d19cf59ddbd9","modified":1744855460063},{"_id":"public/posts/aaedf8b3.html","hash":"968574c9099a8c3a9f76dbc80955bf2bdcbaa0ac","modified":1744855460063},{"_id":"public/posts/45805688.html","hash":"9a00f8fde1a7c6c0da30a214571a230094eede89","modified":1744855460063},{"_id":"public/posts/78909e13.html","hash":"26ffdc2e98f71c9f574582de2c5e53065e59c623","modified":1744855460063},{"_id":"public/posts/34fa5185.html","hash":"e78f59fb05e8f47ad8e5d5b08555c9df8b342330","modified":1744855460063},{"_id":"public/posts/18f37986.html","hash":"ede51413be10cddab7dab9101d13cb5199208f6e","modified":1744855460063},{"_id":"public/posts/901bc739.html","hash":"b3248f72aa8c0dd4874bdb232448224c33533023","modified":1744855460063},{"_id":"public/posts/c6f6fc00.html","hash":"93bc4a4a6ecc1dcb7e7cc26a56550fea93c6fc81","modified":1744855460063},{"_id":"public/posts/6f994fe6.html","hash":"a6835532b659840b0b2b0c41967cdb5f6ec2c17a","modified":1723118935352},{"_id":"public/posts/ee8708d7.html","hash":"37c55077b58dc431b410d9810289ff1b8b1354af","modified":1744855460063},{"_id":"public/posts/a9da9b42.html","hash":"4aa6d25dbbdab60a596451705e8e189108f5812d","modified":1744855460063},{"_id":"public/posts/4aea2b73.html","hash":"1f9caa34499a21f5a657eb326de43ad4ae14fda7","modified":1744855460063},{"_id":"public/posts/32b808f5.html","hash":"80b125b809b6cea11c4aaa0a127326597a736be4","modified":1744855460063},{"_id":"public/posts/427bdc6a.html","hash":"15a43c04302cd1b55067824e952db7fddbe01009","modified":1744855460063},{"_id":"public/posts/c8d81a10.html","hash":"4eb2cc535326a0767062d1ee590f0aba6d50e529","modified":1744855460063},{"_id":"public/posts/660a1c80.html","hash":"5c7d1e77aa129ae490c3b9a0f8afc7decb250a04","modified":1744855460063},{"_id":"public/posts/78b568c7.html","hash":"36abbeaacfcd49540efd9d0e731acf5b32582856","modified":1744855460063},{"_id":"public/posts/a04b492d.html","hash":"586620599ce77d950f9f41b9c5f641dc56d0063b","modified":1744855460063},{"_id":"public/posts/224c29d4.html","hash":"dafcf986a027c9ec98f691cbe16ade8477b0d9f9","modified":1744855460063},{"_id":"public/posts/a535b82c.html","hash":"6f7efd70506f86638f01f9af46f966da7c236b20","modified":1744855460063},{"_id":"public/posts/59b7aac2.html","hash":"be3f06d32264cc1c1360388858fe80ae58882cc7","modified":1744855460063},{"_id":"public/posts/8a82885c.html","hash":"7a858e32965033bdcabb58e8181aa3f52de247c2","modified":1744855460063},{"_id":"public/posts/e22c93eb.html","hash":"f092a7e24f4bb653048232fe3e79b3168c62276a","modified":1744855460063},{"_id":"public/posts/8a98ccfe.html","hash":"d613ba08994d829c255d2ed22a1a0ff0700da336","modified":1744855460063},{"_id":"public/posts/2bee8b90.html","hash":"0187edf19a1683079b101d9db3b4edc88337eeb0","modified":1744855460063},{"_id":"public/posts/709a4555.html","hash":"1f2b0705e71340a68d4fdeeeeaa16af0a2642554","modified":1744855460063},{"_id":"public/posts/24ccf49a.html","hash":"fc19a9fff5bca72b3e889e052978d20ae41c6e11","modified":1744855460063},{"_id":"public/posts/15179f17.html","hash":"2605ea277f3d98f9ae275a93e4a486233d9bd04c","modified":1744855460063},{"_id":"public/posts/54e89ac9.html","hash":"ec0f72f4af33989deb657d5f6bba293039c82661","modified":1744855460063},{"_id":"public/posts/2af5ddcd.html","hash":"3d02b201eea21d611eaddb2085424a10da9685cf","modified":1744855460063},{"_id":"public/posts/ceed82ea.html","hash":"d457b584e463fd7a6a2ce4d7af03baf4c287fab0","modified":1744855460063},{"_id":"public/posts/28b7458e.html","hash":"41f1633af95587091178e1f6830be43337280913","modified":1744855460063},{"_id":"public/posts/49b184d4.html","hash":"49baa93acca9750059602d55cc834938bbad259d","modified":1744855460063},{"_id":"public/posts/66259c3b.html","hash":"a949356fb5ea46b19087978852383dcb28bd329d","modified":1744855460063},{"_id":"public/posts/928212f0.html","hash":"efe5c5b7cd2a97990bece1606d385ff6c1241a44","modified":1744855460063},{"_id":"public/posts/a61dc71f.html","hash":"12e933ac69ca9b0f86a5d74965f7e99cb95d14d3","modified":1744855460063},{"_id":"public/posts/8e3b07ac.html","hash":"8ddf19883c00c345c6a9a7c93219300eb4f725d7","modified":1744855460063},{"_id":"public/posts/13919d44.html","hash":"a35d9f68e06ff7727c97eeff7a00b030ec9d3b89","modified":1744855460063},{"_id":"public/posts/8a9d1567.html","hash":"b12c69a75c8bc2906ed028fc520cfe08a033203c","modified":1744855460063},{"_id":"public/posts/f44631de.html","hash":"33afe0de81aa925b92275399faac4e5d9ae0feaf","modified":1744855460063},{"_id":"public/posts/def64e49.html","hash":"03dc8debf64928249a8c6aa0e7eec93cfd4901b5","modified":1744855460063},{"_id":"public/posts/a707732.html","hash":"aac94aeb5e32fc6553377a98f8f3528aac8b208f","modified":1744855460063},{"_id":"public/posts/b991678b.html","hash":"bda2f5befc3eae15e931e59720368d49a9e08e8e","modified":1744855460063},{"_id":"public/posts/a7094d11.html","hash":"59014a99ac2aa4258c15619f767cd72413e2d444","modified":1744855460063},{"_id":"public/posts/ad46b1ee.html","hash":"bf697ffd34d3879cd66f2af39cc9b3cffeded1d3","modified":1744855460063},{"_id":"public/posts/2cb0387a.html","hash":"f91b2bbe533dacc9a099af3feb1c5f5873f02aa9","modified":1744855460063},{"_id":"public/posts/2acbc304.html","hash":"e455a002b70d85a4098bc6e86b8a5d0bd6651f58","modified":1744855460063},{"_id":"public/posts/35967ec2.html","hash":"69f2bb8669d054898555660882eefd2a256180cf","modified":1744855460063},{"_id":"public/posts/f00cf8de.html","hash":"5e11693fe5357dcedc9212f0b9d651866df2273e","modified":1744855460063},{"_id":"public/posts/27e26578.html","hash":"e82fea146d05380ad5f33e4a8703d4728af1a0f5","modified":1744855460063},{"_id":"public/posts/5dd4fb79.html","hash":"6d1c07c7dce5aceba3e8b99199540ce5f0cce470","modified":1744855460063},{"_id":"public/posts/1f1744f1.html","hash":"219707006665e29dda720b708a8ec74dfbcb3e4f","modified":1744855460063},{"_id":"public/posts/3820734e.html","hash":"af93f8663758d3e668407bc86b91aa119608f2c7","modified":1744855460063},{"_id":"public/posts/ca8fa022.html","hash":"211c73f2693c9fda77065ebd28786a4e1da9e6a0","modified":1744855460063},{"_id":"public/posts/35d2b340.html","hash":"473090b73550b2e9d9e0689538c67588e71e6f7c","modified":1744855460063},{"_id":"public/posts/fa953e4f.html","hash":"79ed0230b26db0727cf8dc98b7e57fa8291750ab","modified":1744855460063},{"_id":"public/posts/40a34212.html","hash":"ab48fd20a8c0bd31dd83e3dea8f2195bb00c24c5","modified":1744855460063},{"_id":"public/posts/8dbab449.html","hash":"d2caf2350b65f076372e39df9bcd486a69e42848","modified":1724066665254},{"_id":"public/posts/b90b7557.html","hash":"92ae9f2b82808a8deb0cff2aece67488daf670ae","modified":1744855460063},{"_id":"public/posts/b2e052be.html","hash":"c15d4746f5839ad34429f1d000ddecc837e2f2a6","modified":1744855460063},{"_id":"public/posts/30bc514d.html","hash":"69197416163aaa79840fa1c94f5f611c9c47753f","modified":1744855460063},{"_id":"public/posts/13c1c2ab.html","hash":"af045e2642f52594c7a4596c62f7b40b5b677ef2","modified":1744855460063},{"_id":"public/posts/bc76f316.html","hash":"efd8ff9fec97efbc7487759585bce2d4449ea256","modified":1744855460063},{"_id":"public/posts/257fa2ac.html","hash":"03ac526ea727f0a60b8c3c4f3b9ca4574f177f07","modified":1744855460063},{"_id":"public/posts/cc20be5e.html","hash":"74a53bb5588786731709f4d675c0a1da3b470406","modified":1744855460063},{"_id":"public/archives/index.html","hash":"23aee4de3029633bcd51a5ef8715b25097eebae4","modified":1744855460063},{"_id":"public/archives/page/2/index.html","hash":"d1940063cc911cc742cd5c5edcaa02ae27ae3d75","modified":1744855460063},{"_id":"public/archives/page/3/index.html","hash":"dd0ba2727ef6d2f2615394619c35e854c29f544b","modified":1744855460063},{"_id":"public/archives/page/4/index.html","hash":"6b9d2d7775f307182d3c7c097fe92f4bae9dc22a","modified":1744855460063},{"_id":"public/archives/page/5/index.html","hash":"575b95cdb710955e2293914da797fe5be3bdfab7","modified":1744855460063},{"_id":"public/archives/page/6/index.html","hash":"eaf1805a46cfd1a3acca5be004e13681a5141d9e","modified":1744855460063},{"_id":"public/archives/page/7/index.html","hash":"255e22907dc83c8fae58b332d10c4a5bc1b757be","modified":1744855460063},{"_id":"public/archives/page/8/index.html","hash":"eca6b4a3099b310cdb373bf72eb0fdc7910da56c","modified":1744855460063},{"_id":"public/archives/2021/index.html","hash":"928d84412e43fef6b7ad973da252888f7d125f3d","modified":1744855460063},{"_id":"public/archives/2021/12/index.html","hash":"d1a59131ae4c7f1d81c8143ff471356a9d50ab80","modified":1744855460063},{"_id":"public/archives/2022/index.html","hash":"3525bead89f1b8c76990a8f84e4915dbd80bed7c","modified":1744855460063},{"_id":"public/archives/2022/01/index.html","hash":"2bc9c2718feb2471f29da8828ed6948e96cf3b1c","modified":1744855460063},{"_id":"public/archives/2022/02/index.html","hash":"11d1224adbbd3ff57572d233dd7b334358e30c33","modified":1744855460063},{"_id":"public/archives/2022/03/index.html","hash":"93cc57c3f56b1e21105c8e8d76cff2866610b236","modified":1744855460063},{"_id":"public/archives/2022/04/index.html","hash":"e33744d2d77b3630af78c506813cd8d44908d0ea","modified":1744855460063},{"_id":"public/archives/2023/index.html","hash":"d53c65295716398b3536315f2b56084962697a05","modified":1744855460063},{"_id":"public/archives/2023/page/2/index.html","hash":"3ff096e69fead5c718ca2aaf858accc575e42582","modified":1744855460063},{"_id":"public/archives/2023/page/3/index.html","hash":"bbc453ddd6c683f338756af977deeaa0b3efb5ce","modified":1744855460063},{"_id":"public/archives/2023/page/4/index.html","hash":"7e2489d7a03b7fa237b9457e9a95e91382be3ca0","modified":1744855460063},{"_id":"public/archives/2023/page/5/index.html","hash":"ca3ad5c1b0248a69b2a0de25ec461221046fa560","modified":1744855460063},{"_id":"public/archives/2023/02/index.html","hash":"8b2fe85387139411c7528bae4cfcea10f2d9561c","modified":1744855460063},{"_id":"public/archives/2023/03/index.html","hash":"937d61713e0f35b47dc292e5c92124c9cca84ea5","modified":1744855460063},{"_id":"public/archives/2023/07/index.html","hash":"12625590c4811216e8bd5fabdbffaadd28bc3404","modified":1744855460063},{"_id":"public/archives/2023/07/page/2/index.html","hash":"5cd1ffb5317a9cb467172862d89838d893baa6a4","modified":1744855460063},{"_id":"public/archives/2023/07/page/3/index.html","hash":"4589b128a31bf7f12d4c20dcfd9488d31e3420a9","modified":1744855460063},{"_id":"public/archives/2023/08/index.html","hash":"00feb21427401c76b8f62f03cd2b28e486edda17","modified":1744855460063},{"_id":"public/archives/2023/09/index.html","hash":"847a813b3107e76e9cba1512972bb349753ac81f","modified":1744855460063},{"_id":"public/archives/2023/10/index.html","hash":"44b4f30966bfa4d716d5560ab8151492eb7820d2","modified":1744855460063},{"_id":"public/archives/2023/11/index.html","hash":"b6e11661fd18d3bde86b548301c20e5f2f53f1ae","modified":1744855460063},{"_id":"public/archives/2023/12/index.html","hash":"dc326a556bb06d947e69eadb5bbcdecaa4339588","modified":1744855460063},{"_id":"public/archives/2024/index.html","hash":"7c6e31053562b94e8fb44ea20b8fd4b0377be9e2","modified":1744855460063},{"_id":"public/archives/2024/page/2/index.html","hash":"22af3d94a42036e44585c7a362ec0cd8f215e126","modified":1744855460063},{"_id":"public/archives/2024/page/3/index.html","hash":"7d51fc887750a685ae4558401a030f54004dcd58","modified":1744855460063},{"_id":"public/archives/2024/01/index.html","hash":"a7e1a6822d0bd0333fe15db6181667c224156b7d","modified":1744855460063},{"_id":"public/archives/2024/02/index.html","hash":"0d8a2837a83ecd9861f58a1aa81e6b8b7dc6d23e","modified":1744855460063},{"_id":"public/archives/2024/03/index.html","hash":"3cbb8912b5d8b815c2f22b600c5e50448b18f882","modified":1744855460063},{"_id":"public/archives/2024/04/index.html","hash":"731eaf7cdd709250262240401d3be9a2a4b52b72","modified":1744855460063},{"_id":"public/archives/2024/05/index.html","hash":"b51751ddde125aab1fbcfd6c51cf08cec38a35ef","modified":1744855460063},{"_id":"public/categories/服务器相关/index.html","hash":"855172c15936e1bb4f1aa708b9d27cb12c6f70ad","modified":1744855460063},{"_id":"public/archives/2024/06/index.html","hash":"5971eb2adbca6651443b2a99406f40c09446c515","modified":1744855460063},{"_id":"public/categories/服务器相关/page/2/index.html","hash":"28e45162abfb7db70e735291ee8dec628c0a0fb0","modified":1744855460063},{"_id":"public/categories/服务器相关/page/3/index.html","hash":"b9d7a8c0488bba0bf6ddb40d06ad6e531ea316a6","modified":1744855460063},{"_id":"public/categories/PHP开发/index.html","hash":"a7e905a5042575c3b622a8cf8249bb9a25f37db0","modified":1744855460063},{"_id":"public/categories/前端/index.html","hash":"7f6fff7845787ee18058e629f811c2c6a3be8fda","modified":1744855460063},{"_id":"public/categories/server/index.html","hash":"1b0a25f9bfae0732d04d60fd99cd15ee1fbb918f","modified":1732533439119},{"_id":"public/categories/JAVA开发/index.html","hash":"50d63b1aa6b83a76cda72c94a25916f38cb0ac89","modified":1744855460063},{"_id":"public/categories/心理学/index.html","hash":"2b5db8cb6500dcb91135f975ebb772935f0cd8e6","modified":1744855460063},{"_id":"public/categories/MYSQL/index.html","hash":"7375869aa40b8a1e88766651c81daf483e65766c","modified":1732533439119},{"_id":"public/index.html","hash":"bf508c907876c365c503d035b80cac9af156c7c1","modified":1744855460063},{"_id":"public/page/2/index.html","hash":"6650659c2bfb520a80c78fedb1ba8e250f166391","modified":1744855460063},{"_id":"public/page/3/index.html","hash":"f39a3d477aaa9a9708b2d8dc7b8fac8f8ed33fe5","modified":1744855460063},{"_id":"public/page/4/index.html","hash":"7182e93c4d7efd679e1a72ad38f872a78c691e5d","modified":1744855460063},{"_id":"public/page/5/index.html","hash":"98a0d485dbcd02bf480874254d6ace612d806094","modified":1744855460063},{"_id":"public/page/6/index.html","hash":"a4ebd258963922e8889873e98881baaf670c1070","modified":1744855460063},{"_id":"public/page/7/index.html","hash":"34badfd48685085e55499fde8f4ad43d6b988b8d","modified":1744855460063},{"_id":"public/page/8/index.html","hash":"1032a68ac2ec1562f54e85bf31e8e9817e990963","modified":1744855460063},{"_id":"public/tags/PHP开发/index.html","hash":"91431f0b82aaa4af6d0b98e354fb70f2282e8080","modified":1744855460063},{"_id":"public/pic/java2-1.png","hash":"1324881cab769333bed47daa7b75ec7b3868fbfe","modified":1718153895228},{"_id":"public/pic/java2-2.png","hash":"a8c2b41e773eb1a689141720f1b56d24d22e9734","modified":1718153895228},{"_id":"public/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1718153895228},{"_id":"public/images/algolia_logo.svg","hash":"45eeea0b5fba833e21e38ea10ed5ab385ceb4f01","modified":1719640414750},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1718153895228},{"_id":"public/images/cc-by-nc.svg","hash":"6f076713fb9bf934aa2c1046bdf2cf2e37bc1eab","modified":1719640414750},{"_id":"public/images/cc-by-nc-nd.svg","hash":"bc3588c9b2d7c68830524783120ff6cf957cf668","modified":1719640414750},{"_id":"public/images/cc-by.svg","hash":"e92a33c32d1dac8ed94849b2b4e6456e887efe70","modified":1719640414750},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1718153895228},{"_id":"public/images/cc-zero.svg","hash":"9bfb52b2f63527a7049247bf00d44e6dc1170e7d","modified":1719640414750},{"_id":"public/images/cc-by-nd.svg","hash":"42cd73da328077ccc92f859bb8f3cf621b3484f8","modified":1719640414750},{"_id":"public/images/cc-by-sa.svg","hash":"70c1535f43e54e5ff35ca81419e77e4c0c301398","modified":1719640414750},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1718153895228},{"_id":"public/images/logo.svg","hash":"169f56fd82941591dad3abd734a50ec7259be950","modified":1719640414750},{"_id":"public/images/cc-by-nc-sa.svg","hash":"6f55543d1fb9cbc436c101d24f802dec7b41efc3","modified":1719640414750},{"_id":"public/images/quote-l.svg","hash":"cd108d6f44351cadf8e6742565217f88818a0458","modified":1719640414750},{"_id":"public/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1718153895228},{"_id":"public/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1718153895228},{"_id":"public/images/quote-r.svg","hash":"2a2a250b32a87c69dcc1b1976c74b747bedbfb41","modified":1719640414750},{"_id":"public/lib/fastclick/LICENSE","hash":"6f474ea75c42442da7bbcf2e9143ce98258efd8d","modified":1719640414750},{"_id":"public/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1718153895228},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"ee33b2798b1e714b904d663436c6b3521011d1fa","modified":1719640414750},{"_id":"public/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1718153895228},{"_id":"public/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1718153895228},{"_id":"public/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1718153895228},{"_id":"public/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1718153895228},{"_id":"public/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1718153895228},{"_id":"public/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1718153895228},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"1573904b82807abbb32c97a3632c6c6808eaac50","modified":1719640414750},{"_id":"public/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1718153895228},{"_id":"public/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1718153895228},{"_id":"public/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1718153895228},{"_id":"public/lib/Han/dist/font/han.woff2","hash":"623af3ed5423371ac136a4fe0e8cc7bb7396037a","modified":1718153895228},{"_id":"public/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1718153895228},{"_id":"public/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1718153895228},{"_id":"public/pic/java2-3.jpg","hash":"f13e26dcaaa86f35508df3be327f67b7ffca6c6d","modified":1718153895228},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1718153895228},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1718153895228},{"_id":"public/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1718153895228},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1718153895228},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1718153895228},{"_id":"public/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1718153895228},{"_id":"public/lib/canvas-ribbon/canvas-ribbon.js","hash":"ff5915eb2596e890a2fc6697c864f861a1995ec0","modified":1718153895228},{"_id":"public/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1718153895228},{"_id":"public/lib/fastclick/README.html","hash":"c88ed76304392b9e77b266fcbbc05f443c5df133","modified":1718153895228},{"_id":"public/lib/jquery_lazyload/CONTRIBUTING.html","hash":"bc6cf8951a99074bdc6ec9172f03fb7c0e412729","modified":1718153895228},{"_id":"public/lib/jquery_lazyload/README.html","hash":"96a5c2cc00de5b338ae972c1e8de879d2d919608","modified":1718153895228},{"_id":"public/lib/fastclick/bower.json","hash":"4dcecf83afddba148464d5339c93f6d0aa9f42e9","modified":1718153895228},{"_id":"public/lib/jquery_lazyload/bower.json","hash":"ae3c3b61e6e7f9e1d7e3585ad854380ecc04cf53","modified":1718153895228},{"_id":"public/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1718153895228},{"_id":"public/lib/needsharebutton/needsharebutton.css","hash":"3ef0020a1815ca6151ea4886cd0d37421ae3695c","modified":1718153895228},{"_id":"public/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1718153895228},{"_id":"public/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1718153895228},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1718153895228},{"_id":"public/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1718153895228},{"_id":"public/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1718153895228},{"_id":"public/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1718153895228},{"_id":"public/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1718153895228},{"_id":"public/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1718153895228},{"_id":"public/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1718153895228},{"_id":"public/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1718153895228},{"_id":"public/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1718153895228},{"_id":"public/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1718153895228},{"_id":"public/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1718153895228},{"_id":"public/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1718153895228},{"_id":"public/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1718153895228},{"_id":"public/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1718153895228},{"_id":"public/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1718153895228},{"_id":"public/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1718153895228},{"_id":"public/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1718153895228},{"_id":"public/js/src/bootstrap.js","hash":"034bc8113e0966fe2096ba5b56061bbf10ef0512","modified":1718153895228},{"_id":"public/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1718153895228},{"_id":"public/js/src/motion.js","hash":"754b294394f102c8fd9423a1789ddb1201677898","modified":1718153895228},{"_id":"public/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1718153895228},{"_id":"public/js/src/post-details.js","hash":"a13f45f7aa8291cf7244ec5ba93907d119c5dbdd","modified":1718153895228},{"_id":"public/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1718153895228},{"_id":"public/lib/velocity/bower.json","hash":"0ef14e7ccdfba5db6eb3f8fc6aa3b47282c36409","modified":1718153895228},{"_id":"public/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1718153895228},{"_id":"public/js/src/utils.js","hash":"9b1325801d27213083d1487a12b1a62b539ab6f8","modified":1718153895228},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1718153895228},{"_id":"public/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1718153895228},{"_id":"public/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1718153895228},{"_id":"public/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1718153895228},{"_id":"public/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1718153895228},{"_id":"public/js/src/schemes/pisces.js","hash":"8050a5b2683d1d77238c5762b6bd89c543daed6e","modified":1718153895228},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1718153895228},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1718153895228},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1718153895228},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1718153895228},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1718153895228},{"_id":"public/css/main.css","hash":"f38c10be21c85eecb121c070375e9aa05a3178ec","modified":1719640414750},{"_id":"public/lib/needsharebutton/needsharebutton.js","hash":"9885fd9bea5e7ebafc5b1de9d17be5e106248d96","modified":1718153895228},{"_id":"public/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1718153895228},{"_id":"public/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1718153895228},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1718153895228},{"_id":"public/lib/needsharebutton/font-embedded.css","hash":"c39d37278c1e178838732af21bd26cd0baeddfe0","modified":1718153895228},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1718153895228},{"_id":"public/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1718153895228},{"_id":"public/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1718153895228},{"_id":"public/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1718153895228},{"_id":"public/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1718153895228},{"_id":"public/lib/Han/dist/han.min.css","hash":"a0c9e32549a8b8cf327ab9227b037f323cdb60ee","modified":1718153895228},{"_id":"public/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1718153895228},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1718153895228},{"_id":"public/lib/Han/dist/han.css","hash":"bd40da3fba8735df5850956814e312bd7b3193d7","modified":1718153895228},{"_id":"public/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1718153895228},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"b5483b11f8ba213e733b5b8af9927a04fec996f6","modified":1719640414750},{"_id":"public/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1718153895228},{"_id":"public/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1718153895228},{"_id":"public/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1718153895228},{"_id":"public/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1718153895228},{"_id":"public/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1718153895228},{"_id":"source/_posts/php开发-Tcp连接.md","hash":"35568f2ca8db0a93765c70cdf2640a6a68ee6dc2","modified":1724120262679},{"_id":"source/_posts/php开发-php-fpm进程被占满.md","hash":"4e695ef5d77fe8da83d3b6c8a1520c2959ac5fc8","modified":1719211721647},{"_id":"source/_posts/php开发-websocket.md","hash":"52ae1c481d5604074e364a6f925f97fe6a67a009","modified":1732534454503},{"_id":"source/_posts/php开发-swoole框架.md","hash":"00c2474479c9308f731bbf68bbbc12e2b4f74add","modified":1719211721649},{"_id":"source/_posts/PHP开发-fastadmin使用总结.md","hash":"bbd41e840f708c24c6c8e8984df611934bf630e4","modified":1723115332680},{"_id":"source/pic/iis-1.png","hash":"3b4d6105cb53803350578cae820171107545941c","modified":1719512764000},{"_id":"source/pic/iis-2.png","hash":"374e056c2d1fd8bc0db5cac8b9578de0433adc56","modified":1719512764000},{"_id":"source/pic/iis-3.png","hash":"6f2048c73a61056cd45ff46689e745acbac70312","modified":1719542153941},{"_id":"source/pic/win2012-net.png","hash":"73d4a1ae54e346e7044cd6f79e5be36265cac46f","modified":1719512764000},{"_id":"source/_posts/windows2012-R2发布asp网站.md","hash":"544677301e1f1d1533bca0b1c4e459e28e4c4c58","modified":1732534340430},{"_id":"source/pic/win2012-1.png","hash":"db1df28c99a47fc4c62f46b598c9cabd8e530236","modified":1719542679174},{"_id":"public/posts/dd0146de.html","hash":"870bd8d0f1a6201c563a9e031a4e156626f59f17","modified":1744855460063},{"_id":"public/posts/9b3ce30d.html","hash":"9a73c22da785cac89338e3b0b456b30d7ae68171","modified":1744855460063},{"_id":"public/posts/ab7af144.html","hash":"e2d7e199358704f154fcd330002ab31a3dfde631","modified":1744855460063},{"_id":"public/posts/cab3e457.html","hash":"e13b34543f9569bbf3828ee79308783629c37871","modified":1744855460063},{"_id":"public/posts/680ac944.html","hash":"a9bfe34c7dd7fd25f0b02bb047e453bd13c61eb0","modified":1744855460063},{"_id":"public/archives/page/9/index.html","hash":"ddbff69679b5a192de2aad882472fe8691554521","modified":1744855460063},{"_id":"public/page/9/index.html","hash":"5d08f9a0a062cab4f26fd8024db7b4e1e826c1d0","modified":1744855460063},{"_id":"public/categories/PHP开发/page/2/index.html","hash":"3d8f53cf43f6184e54148af733a8791a15dc491c","modified":1744855460063},{"_id":"public/tags/PHP开发/page/2/index.html","hash":"b42023bb4ca46dc7f1ab9e41bb202b79fc420d2f","modified":1719543241298},{"_id":"public/pic/iis-3.png","hash":"6f2048c73a61056cd45ff46689e745acbac70312","modified":1719543241298},{"_id":"public/pic/win2012-net.png","hash":"73d4a1ae54e346e7044cd6f79e5be36265cac46f","modified":1719543241298},{"_id":"public/pic/iis-2.png","hash":"374e056c2d1fd8bc0db5cac8b9578de0433adc56","modified":1719543241298},{"_id":"public/pic/iis-1.png","hash":"3b4d6105cb53803350578cae820171107545941c","modified":1719543241298},{"_id":"public/pic/win2012-1.png","hash":"db1df28c99a47fc4c62f46b598c9cabd8e530236","modified":1719543241298},{"_id":"source/_posts/gitlab备份恢复.md","hash":"69b0a8dc2e10f4d8fd5610251422b981f3f11a71","modified":1732534654429},{"_id":"source/_posts/php开发-fastadmin按钮弹框传数据到列表.md","hash":"7d2d32161df66d7829b5ab899c74bf22d0c7ddb7","modified":1729231435066},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"cc40a9b11e52348e554c84e4a5c058056f6b7aeb","modified":1639120955580},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"2db21acfbd457452462f71cc4048a943ee61b8e0","modified":1639120955580},{"_id":"public/posts/6df754b5.html","hash":"9b36ad58147010eb273e3a3a06d1207d86a8c55c","modified":1744855460063},{"_id":"public/tags/fastadmin/index.html","hash":"efcadc467a6cf7a8424659207767d73fa40d4e58","modified":1744855460063},{"_id":"public/tags/laravel/index.html","hash":"78dffeb1707e1efa3eb99f1772335c2476f0fa69","modified":1744855460063},{"_id":"public/tags/mysql/index.html","hash":"1469b3a98873d5e4a03c2bc632e60a9a51a6ce33","modified":1744855460063},{"_id":"public/posts/6551734d.html","hash":"2cba77b32656d5d6ff2d5be314383b74b576357d","modified":1744855460063},{"_id":"source/_posts/nginx配置-rewrite.md","hash":"8d8b5e308b329a630474255f778af1bea38af49b","modified":1719640415969},{"_id":"public/posts/a0181459.html","hash":"4df9f2cc1f4d5531cc0a60e3705996d8baa1670d","modified":1744855460063},{"_id":"source/pic/iis8-file-2.png","hash":"60eed8ea5fe8de23d5dc41ea019c598a12f54112","modified":1719641054443},{"_id":"source/pic/iis8-file-1.png","hash":"7979b7b0074a4ea3ff8903433fe7a8dbf983f7a6","modified":1719611958000},{"_id":"source/pic/iis8-file-3.png","hash":"20278e613a813e0a15782fea099b564dd64a40cd","modified":1719611958000},{"_id":"public/pic/iis8-file-2.png","hash":"60eed8ea5fe8de23d5dc41ea019c598a12f54112","modified":1719641170997},{"_id":"public/pic/iis8-file-3.png","hash":"20278e613a813e0a15782fea099b564dd64a40cd","modified":1719641170997},{"_id":"public/pic/iis8-file-1.png","hash":"7979b7b0074a4ea3ff8903433fe7a8dbf983f7a6","modified":1719641170997},{"_id":"source/_posts/php开发-微信登录.md","hash":"186b0f5e51e6e192239db1f9768ef711262b78a0","modified":1732534470005},{"_id":"public/posts/77054df3.html","hash":"5ebab7bd48cdfabb16ccda8ff01d4990d188ce67","modified":1744855460063},{"_id":"public/archives/2024/07/index.html","hash":"abfda046703e84944b07ec1b0d897117c2368d96","modified":1744855460063},{"_id":"source/_posts/mysql-主从数据库.md","hash":"1c0fc705fc1ab585fba7e9d372c8e8242b6e86b5","modified":1732533662790},{"_id":"public/posts/585d050b.html","hash":"b7184c89952df1aa78f4cc0efb9ed8523407e2df","modified":1744855460063},{"_id":"public/archives/2024/page/4/index.html","hash":"2dcc0e3404bc3b98b7aff45fea1445ad70322f76","modified":1744855460063},{"_id":"source/_posts/sftp配置.md","hash":"93f03cd68bb26e368ff79aafc27fb9a3e48599e0","modified":1723708145507},{"_id":"public/posts/8e2962f3.html","hash":"5ea2bdc00e21a2cdb617a6f36eb87b9f2bb6af4f","modified":1744855460063},{"_id":"public/archives/page/10/index.html","hash":"9c8366f93e52daf52084aa9b1a5ea044012ecec6","modified":1744855460063},{"_id":"public/archives/2024/08/index.html","hash":"d821a07ea1c07c6f4108a9cb55f631f7a040ae22","modified":1744855460063},{"_id":"public/page/10/index.html","hash":"dd064ea9120473cb05712df8c132eab02e5d22a6","modified":1744855460063},{"_id":"source/_posts/搭建php环境.md","hash":"a485dd66ddb08e0c4cefd1b1eddb9b69c9c9d710","modified":1707217400175},{"_id":"source/pic/dialogbox.png","hash":"a5011531872077d6165290bc951ad19eb5f86d46","modified":1723115476061},{"_id":"source/_posts/php开发-fastadmin键值组件-Fieldlist.md","hash":"5ddd3c300dfefe2972cc52449bb7d6bef5cf6d5a","modified":1729231442835},{"_id":"public/posts/c70fd524.html","hash":"1a3f4e4809af1b4f5d20c8254914032a39030a4c","modified":1744855460063},{"_id":"public/pic/dialogbox.png","hash":"a5011531872077d6165290bc951ad19eb5f86d46","modified":1723118935352},{"_id":"source/_posts/php开发-fastadmin中input自定义验证方法.md","hash":"9e7dd927470eb39b225b39a9b7893a031b9a1c2a","modified":1729231420634},{"_id":"source/_posts/php开发-fastadmin表格操作列自定义按钮.md","hash":"ca0f1baab06bc52ec578118ac950954c4a139625","modified":1729231439671},{"_id":"public/posts/5f9fc809.html","hash":"0df33bbd8768b4d6fce0f778a90efe5c5890ab07","modified":1744855460063},{"_id":"source/_posts/php开发-fastadmin高德地图点位展示效果.md","hash":"3e050aefe2b7b3fdb535776288520e7683691cb3","modified":1729231446532},{"_id":"source/_posts/搭建 nginx_server.md","hash":"098f37828250093adcd48ffbc55399318161db61","modified":1707217195509},{"_id":"source/_posts/SPU和SKU数据结构设计.md","hash":"7710eeaa4a30ceaf7ec1074bc3f0734e1df67237","modified":1723445276470},{"_id":"source/_posts/商城开发-拼团功能开发设计.md","hash":"517c06d30cc64c3304ee56ec9c7125e814c4a1e4","modified":1723448576263},{"_id":"source/_posts/商城开发-SPU和SKU数据结构设计.md","hash":"46068093d357daac3866362aa4c16a8a20e2a44e","modified":1723447541240},{"_id":"public/posts/701fec33.html","hash":"701fcae603f80fc1cf999a902b8dc7aeac480908","modified":1744855460063},{"_id":"public/posts/ce3caa74.html","hash":"a362efed862a6a566759b6e42c04b721460328c0","modified":1744855460063},{"_id":"source/_posts/php开发-fastAdmin中搜索日期时间的处理.md","hash":"0fbbe6f004b6b4c5cc0b887726769759b34b1204","modified":1723550072308},{"_id":"source/_posts/php开发-根据设置的概率抽奖.md","hash":"29c6f518c6a51b38482247a651b5adcee35a98e5","modified":1732534475911},{"_id":"source/_posts/php开发-海康视频接口对接.md","hash":"3ad7a34b3f7d5f631652a8fe429100212fb2b7a2","modified":1732534463084},{"_id":"source/_posts/php开发-工行支付接口对接.md","hash":"049c501e5ddd15cdc19f5fee872d0398e1d757bb","modified":1732534488619},{"_id":"source/_posts/php开发-设计模式之容器-container.md","hash":"163705bfd13779b67040c2e4c0f617b7df718fa1","modified":1723794044544},{"_id":"source/_posts/php开发-多进程应用.md","hash":"61ca22217368253ee83b59c3512f0550ca962944","modified":1732534482175},{"_id":"source/_posts/php开发-Laravel中的服务容器.md","hash":"5eeb5862033ed0796859826a7ed40b7dace23e0a","modified":1723792689690},{"_id":"public/posts/b61a700f.html","hash":"dde8bc77415e87c1aaa3068d6e90f517f3752801","modified":1744855460063},{"_id":"public/posts/fef50030.html","hash":"451f230e200b631a9384f0252861d9c53ce82c11","modified":1744855460063},{"_id":"public/posts/aa1b125a.html","hash":"f7ec2a061e7a725eb7fc14c94e5f4aacbbd85ae9","modified":1744855460063},{"_id":"public/posts/11955b14.html","hash":"aa782057ab7edc186efcccd06b91cf3ad7c89d7c","modified":1744855460063},{"_id":"public/posts/cc90e6c9.html","hash":"53dc6fa6f3f11438de77da7f2efeb823da6097df","modified":1744855460063},{"_id":"public/posts/84d7639f.html","hash":"4667dbfbfba5c2510ea57210e2ab436acfdc3d5d","modified":1744855460063},{"_id":"public/posts/cb6a68f0.html","hash":"7e88781ebed790f27d2a5d7e66cd1144e40d2731","modified":1744855460063},{"_id":"public/archives/page/11/index.html","hash":"4a83cdd4bc547f8acf458fa6b8a6d9bfb7abc7f1","modified":1744855460063},{"_id":"public/archives/2024/page/5/index.html","hash":"41e98eb1bd60c1bdd3776a93ae76f33d0c8986c2","modified":1744855460063},{"_id":"public/archives/2024/08/page/2/index.html","hash":"f823357703e79c43328739e9b9279d07e85409fe","modified":1744855460063},{"_id":"public/page/11/index.html","hash":"56fb7694251d71a70194b06dc3ff290c1e1c4b7d","modified":1744855460063},{"_id":"source/_posts/java开发-Servlet及HttpSeverlet.md","hash":"9936109f96caab179f16672dff98e25efe79828b","modified":1724119080710},{"_id":"source/_posts/linux-LVM逻辑卷管理.md","hash":"2184ba7d625d3f3956e815a115aa485c5356cd0a","modified":1732533510482},{"_id":"source/_posts/java开发-层级类.md","hash":"285f426610c40697a72890680e000df4e9bee067","modified":1724119071732},{"_id":"source/_posts/java开发-相关概念.md","hash":"ae83445d2152cfb82d3e6d89f0367521d31c7ddd","modified":1724119062192},{"_id":"source/_posts/linux-firewalld使用总结.md","hash":"1123ec96b126dd0e90233c783dea612a1cb59b6c","modified":1732533491945},{"_id":"source/_posts/java开发-springboot学习.md","hash":"24a42f20770db4e4cd70bbd049f0b78a03968371","modified":1724119170778},{"_id":"source/_posts/linux-crond服务.md","hash":"e5923bea3277f4dfa7a3e76eaad592aa82ce4254","modified":1732533481135},{"_id":"source/_posts/linux-fail2ban软件使用.md","hash":"58c0c6148de30136bd229591ce2ecfe500b02e3f","modified":1732533320538},{"_id":"source/_posts/linux-nginx服务搭建.md","hash":"88b648af0c360d3f8ed74413c4020589ec5382e7","modified":1732533352211},{"_id":"source/_posts/linux-logrotate日志切割.md","hash":"b28ea368b98ac75b6aa7dd2c98ee8e101499127d","modified":1732533344649},{"_id":"source/_posts/linux-php扩展安装.md","hash":"5b216cbcdc1a43c658c535184f3e227145b6b69e","modified":1732533929026},{"_id":"source/_posts/linux-后台运行任务.md","hash":"a383d9c8d83dc50380a390d87d50f2604847f849","modified":1732533573547},{"_id":"source/_posts/linux-rsyslog日志服务.md","hash":"aa9782cf0de7646db71476a3ebb95f586b28ee23","modified":1732533529370},{"_id":"source/_posts/linux-守护进程supervisor服务.md","hash":"7064df077b30118d9d5ac9437630d106d340b3c8","modified":1732533578023},{"_id":"source/_posts/java开发-运行javaee程序.md","hash":"06e3fd13fc9ddc51197564430cb893e776d3c1f2","modified":1712732729734},{"_id":"source/_posts/linux-sftp服务配置.md","hash":"a278d29f7873c0cc2eaa6548674f011d72c3a68c","modified":1738723485139},{"_id":"source/_posts/linux-升级openssh.md","hash":"d72d2cd79b5772b64d0a5a1dd50c059adab6191c","modified":1732533561598},{"_id":"source/_posts/linux-安装配置php环境.md","hash":"c70bed7deb6c4433634025623bf00b2b88250c84","modified":1732533385697},{"_id":"source/_posts/linux-搭建nps内网穿透.md","hash":"b9cb72d9180992835aa66983a1ae94b84b3c0a37","modified":1751510078690},{"_id":"source/_posts/linux-编译安装软件总结.md","hash":"405df7633da957d44927f8ab63565442d0928bb0","modified":1732533610932},{"_id":"source/_posts/linux-搭建mysql服务.md","hash":"3e7f0dbd32ef41d8a2ddda937bf186e670b11eb5","modified":1732534068412},{"_id":"source/_posts/linux-搭建openvpn.md","hash":"58d3e8e400713304d826388d8818cbf7734f564f","modified":1732534686126},{"_id":"source/_posts/linux-硬盘分区.md","hash":"52dd4e1f3371c0361c971370801d5969eb0e5d34","modified":1732533603785},{"_id":"source/_posts/nginx-配置rewrite.md","hash":"d597b3b51f537d6656398485c6f0e7530d6b0996","modified":1732533773829},{"_id":"source/_posts/linux-配置代理.md","hash":"e8a397adbc488f0a1b9bcd0da044b8e75b4d68e0","modified":1732533615492},{"_id":"source/_posts/nginx-配置location.md","hash":"b5763531c3a13a05bed624efb48717aef4bf2fdb","modified":1732533762876},{"_id":"source/_posts/nginx-vhost安全配置模版.md","hash":"91a3e2988eb2d08b89a2a56b4a06005abef32ed2","modified":1732533753904},{"_id":"source/_posts/nginx-配置文件.md","hash":"3a3b075d303566746bec1935aa2890d3417db3a4","modified":1732533799386},{"_id":"source/_posts/php开发-laravel中的服务容器.md","hash":"73277e93cf66eee8234f9dafcf50cbf81d0ef15b","modified":1729231450398},{"_id":"source/_posts/php开发-laravel源码学习2.md","hash":"5e31ad286e1a8e27271a936f3d7e18d69f1fcc42","modified":1719624846859},{"_id":"source/_posts/mysql-常用命令应用.md","hash":"adaebd2ddde0f93c7adbe1b6c165468ce9ce8ec4","modified":1732533654052},{"_id":"source/_posts/php开发-wordpress相关.md","hash":"6cd8f83d112ed2dbeeea0c1a06a4977b2af4f087","modified":1707217142131},{"_id":"source/_posts/php开发-hj212环保协议2007.md","hash":"77ac68c8a75cf273769394beeb69a7ba66754a16","modified":1724119112822},{"_id":"source/_posts/php开发-session和cookie.md","hash":"7127e4ec6697dcdb4223adb2662feabf427a8c5a","modified":1732534516471},{"_id":"source/_posts/php开发-laravel源码学习1.md","hash":"3c35aed76bed364b290e7c6624f47e780061b981","modified":1719624846858},{"_id":"source/_posts/shell脚本-学习2.md","hash":"d52bfd9a75778bd5c95837b930dde0416cb04525","modified":1732534401000},{"_id":"source/_posts/php开发-设计模式之容器(container).md","hash":"9bc473ac70f08baa0657cc7a9f64021d357f217b","modified":1732534460218},{"_id":"source/_posts/shell脚本-学习1.md","hash":"e7cbc736a61a0f8fdd71ba36ea47ca7dee41512f","modified":1732534392227},{"_id":"source/_posts/php开发-ASN编码.md","hash":"1686c564e54a6205bbe597ea091dd64c75d3c420","modified":1729231426445},{"_id":"source/_posts/php开发-国秘加密-sm2-sm3-sm4.md","hash":"a73e45056ec945ef3a47116cf3700f400dd5a0df","modified":1732534485198},{"_id":"public/posts/b6482428.html","hash":"04832d8fa78621310c02e9ba8552439f045618f7","modified":1744855460063},{"_id":"public/posts/6aa2955a.html","hash":"ae46d2df159f02971f6113355ab7dd4cbc5c5219","modified":1744855460063},{"_id":"public/archives/2024/09/index.html","hash":"7d98c31dbc6e63ae0956edb1a125d03593737124","modified":1744855460063},{"_id":"source/_posts/openEuler系统安装问题总结.md","hash":"b3d9cd73a5a10d47f528f64ca18d0c7bfd1073fd","modified":1725530536910},{"_id":"source/_posts/微信开发-授权登录（小程序登录-网页授权登录）.md","hash":"dcb37fef323092dc520d87d57ca4f5fe536ca29d","modified":1729499951625},{"_id":"source/_posts/laravel开发-中间件开发应用.md","hash":"6bb38fa8e4458fe08aa10ebfaaf6346686f5178a","modified":1729230763956},{"_id":"source/_posts/php开发-laravel中间件开发应用.md","hash":"2bf659d852424f5f49be69a041754bf95fefffed","modified":1729231030602},{"_id":"source/_posts/php开发-fastadmin中搜索日期时间的处理.md","hash":"897fca0012d745c56e506ff4f673ba6cb8bc7f43","modified":1729231508772},{"_id":"public/posts/99fb5d5d.html","hash":"7f74cfc740e42080e1f9ecffead1b3366f45e520","modified":1744855460063},{"_id":"public/posts/71fe1155.html","hash":"4b3a66a3718cdf94b65465d727fb3b28c1cddd01","modified":1744855460063},{"_id":"public/posts/6c1c44d1.html","hash":"0c9ed81bd574d939c225c60c5f4d904c6b66de44","modified":1744855460063},{"_id":"public/categories/微信开发/index.html","hash":"14bdd855d5e13fd2774faa9158fbdcfee530e033","modified":1744855460063},{"_id":"public/archives/2024/10/index.html","hash":"cec7595f7396dd1971f4f4fe3f1cb4d68279640f","modified":1744855460063},{"_id":"public/tags/thinkphp/index.html","hash":"6e541e823f71ab8f65da2e96617d941380ecc9b0","modified":1744855460063},{"_id":"public/tags/加密技术/index.html","hash":"8a79940f172753f448910f3be1a01236c77092ff","modified":1744855460063},{"_id":"source/_posts/php开发-使用OpenSSL进程DES加密.md","hash":"d02ee01cfddc4474bd5c09b366223743ccdbe1e9","modified":1731928331497},{"_id":"public/posts/28dcf7b8.html","hash":"9d1b1ed46c009dfad019c0e41878d3695b96f28b","modified":1744855460063},{"_id":"public/archives/2024/11/index.html","hash":"a414f021cbd6248b17a67eadfd2d36d4a11e4919","modified":1744855460063},{"_id":"source/_posts/linux-screen软件应用.md","hash":"7aaa43f71ef31405314d43ff139350e764f70043","modified":1753509964328},{"_id":"public/posts/87fcad5d.html","hash":"7b7138d5c24b96d680d6df68399f8e4183e46f99","modified":1744855460063},{"_id":"public/tags/linux/index.html","hash":"31569e8d77d0d96ac8a4fb4836e40ea12e0bce36","modified":1744855460063},{"_id":"public/tags/linux/page/2/index.html","hash":"027d84b4dbc0f6ce7a376b1f632896012767f01b","modified":1744855460063},{"_id":"public/tags/linux/page/3/index.html","hash":"adcb3bf09f096f6519e6fcbb95b64a217f4d3051","modified":1744855460063},{"_id":"public/categories/服务器相关/page/5/index.html","hash":"b72dd38eabd6a63bb210390acb6726ad3467805a","modified":1744855460063},{"_id":"public/categories/PHP开发/page/3/index.html","hash":"8967d11142cab873224214a87b67ca2e443cf84c","modified":1744855460063},{"_id":"public/categories/服务器相关/page/4/index.html","hash":"de96da8f4bcf65ee9455d2a7c5feab7835353df1","modified":1744855460063},{"_id":"public/categories/mysql/index.html","hash":"68589d0bad4d7ca3eba5cf1a47ac523673d8f5c9","modified":1744855460063},{"_id":"public/categories/服务器相关/nginx/index.html","hash":"0a19d1a10859b4a61a39209bdc447e80aa0056ff","modified":1744855460063},{"_id":"public/categories/前端/vue/index.html","hash":"f13a427c5a73783495198eb1c82ec0c1584928b1","modified":1744855460063},{"_id":"public/categories/服务器相关/防火墙/index.html","hash":"868d7e4e7814edb1f878cda33401fa51f473398e","modified":1744855460063},{"_id":"public/categories/前端/webpack/index.html","hash":"bc67aa3c80f416b1c39b4b06491daab5b43de1bb","modified":1744855460063},{"_id":"public/categories/服务器相关/openEnler/index.html","hash":"df7901bfb31690ae269d4c53055872337c8b5bfe","modified":1744855460063},{"_id":"public/categories/服务器相关/mysql/index.html","hash":"c6eae5a4b8fb8ae10fcea3a2793a9b93aadef3e9","modified":1744855460063},{"_id":"public/categories/服务器相关/shell/index.html","hash":"acceaa8909668f3f152f20ce693b9207b307d310","modified":1744855460063},{"_id":"public/categories/服务器相关/windows/index.html","hash":"89316b1b162a12ce329a67c997791d26483411ce","modified":1744855460063},{"_id":"public/tags/sftp/index.html","hash":"f9ca0e555ee59f495769515f3c9503c3acb428a8","modified":1744855460063},{"_id":"public/tags/vue/index.html","hash":"172a27900c9ff676d6d1fe8dfa9e2d775331f5fb","modified":1744855460063},{"_id":"public/tags/ubuntu/index.html","hash":"800ab133d70f86186e7adfea3a9c1d87e09ac3a8","modified":1744855460063},{"_id":"public/tags/redis/index.html","hash":"2124e6fbbfd90db7ab6658ac308241cf7fd5c942","modified":1744855460063},{"_id":"public/tags/php/index.html","hash":"a62d123b83c8b47244e32f6bf38409b560b85c13","modified":1744855460063},{"_id":"public/tags/gitlab/index.html","hash":"010c7721f066769d1952799ed5e7c818c7acf112","modified":1744855460063},{"_id":"source/_posts/php开发-源码加密.md","hash":"bd352e65ca3bac7772d53c2f33597e7a10d2e78a","modified":1733302762829},{"_id":"source/_posts/php开发-开源beast库源码加密.md","hash":"a3837d207c16f8bd1019e2c0b3c0f1154f45ae1e","modified":1746667786831},{"_id":"public/posts/71e4e85e.html","hash":"463005544688ccd1a1a5235568bb17cff73b6f1c","modified":1744855460063},{"_id":"public/posts/8409d51e.html","hash":"392d9f925c1a4e68dffb46222903060ff453dc96","modified":1744855460063},{"_id":"public/archives/2024/page/6/index.html","hash":"59ddf3a14b147f538d7a6ca342aa8fac88dcbe93","modified":1744855460063},{"_id":"public/archives/2024/12/index.html","hash":"8d73830230957747a4f52d09a838364dd2c7205a","modified":1744855460063},{"_id":"public/tags/k8s/index.html","hash":"de78c5c60de849ad5de0995b527d185a3358be2d","modified":1744855460063},{"_id":"source/_posts/java开发-idea配置运行银行包.md","hash":"c996a7a11d0c98a84f28dc52f1204ca8357f3491","modified":1740621350863},{"_id":"source/_posts/php开发-对接南京银行接口.md","hash":"d12f4fc7417d77d1640c1d179b9b07ff031d8104","modified":1745293707752},{"_id":"source/pic/javaee-running-1.png","hash":"b6f7ea0e5c915ae8fe3f7418d4ada693deea40d8","modified":1740619631034},{"_id":"source/pic/javaee-running-4.png","hash":"4eaeacb84f3475eb5f64720ed6e077dcf6ab360b","modified":1740620691704},{"_id":"source/pic/javaee-running-3.png","hash":"ae1adeed3eea70701788ab7461ee946de15d352d","modified":1740620687077},{"_id":"source/pic/javaee-running-2.png","hash":"d9e090379141d2b04f1267e2919265fe53cc5da9","modified":1740620689766},{"_id":"source/_posts/java开发-配置idea调试线上的程序.md","hash":"8270895b1a5d30a71f59d37f9c53eee52332ed4c","modified":1740622852532},{"_id":"source/pic/java-remote-debug-2.png","hash":"19a982702b8f4c014fc710e28483228701d40410","modified":1740622399013},{"_id":"source/pic/java-remote-debug-4.png","hash":"6c408cd01b57369134b41d2817f0b0bcb9c2a9d5","modified":1740622639600},{"_id":"source/pic/java-remote-debug-3.png","hash":"e9fb1f45e37c580d9da0fa313c3a522b872f684b","modified":1740622400499},{"_id":"source/pic/java-remote-debug-1.png","hash":"2c2c4182da11428d070a9c528dc43e7e49666ca7","modified":1740622397070},{"_id":"source/_posts/php开发-docker环境.md","hash":"5b2d58dd4b09af646529242c159cc5c13d82983d","modified":1744855345478},{"_id":"public/posts/f4cbc520.html","hash":"44bf39346328d8e105fe378faf824f81e1457b55","modified":1744855460063},{"_id":"public/posts/38689ecd.html","hash":"42fe91ff2068fce0c56d8777d507efbe93849930","modified":1744855460063},{"_id":"public/posts/4e8d42b6.html","hash":"4f92797738a6889ff452edb87db4ab3b15d7b338","modified":1744855460063},{"_id":"public/posts/9a132a59.html","hash":"98b0cc140599e3e9e64396a67acdf2ae24d0f269","modified":1744855460063},{"_id":"public/archives/page/12/index.html","hash":"e9e0ea127d47785db009419f76735bd28d22df7f","modified":1744855460063},{"_id":"public/archives/2025/index.html","hash":"f0f770a302472cc3364c2995397540585c10b554","modified":1744855460063},{"_id":"public/archives/2025/02/index.html","hash":"05564fad485fd01ed32434b64a56c7fb45be8b98","modified":1744855460063},{"_id":"public/archives/2025/04/index.html","hash":"033999965403e3c58b0026a0d1f77bb8562eb49b","modified":1744855460063},{"_id":"public/page/12/index.html","hash":"d432c416a1f344dd895c3d8cfb868d3a5a0f9fc0","modified":1744855460063},{"_id":"public/pic/javaee-running-3.png","hash":"ae1adeed3eea70701788ab7461ee946de15d352d","modified":1744855460063},{"_id":"public/pic/javaee-running-4.png","hash":"4eaeacb84f3475eb5f64720ed6e077dcf6ab360b","modified":1744855460063},{"_id":"public/pic/javaee-running-1.png","hash":"b6f7ea0e5c915ae8fe3f7418d4ada693deea40d8","modified":1744855460063},{"_id":"public/pic/java-remote-debug-2.png","hash":"19a982702b8f4c014fc710e28483228701d40410","modified":1744855460063},{"_id":"public/pic/java-remote-debug-3.png","hash":"e9fb1f45e37c580d9da0fa313c3a522b872f684b","modified":1744855460063},{"_id":"public/pic/javaee-running-2.png","hash":"d9e090379141d2b04f1267e2919265fe53cc5da9","modified":1744855460063},{"_id":"public/pic/java-remote-debug-4.png","hash":"6c408cd01b57369134b41d2817f0b0bcb9c2a9d5","modified":1744855460063},{"_id":"public/pic/java-remote-debug-1.png","hash":"2c2c4182da11428d070a9c528dc43e7e49666ca7","modified":1744855460063},{"_id":"source/_posts/php开发-微信支付配置.md","hash":"74a404d840ec11d243d3dde667c8c656a7d4c1d4","modified":1745301130134},{"_id":"source/pic/wx-pay-1.png","hash":"85e66e8a4d88475619ceb824a7f61e99f5d8dda9","modified":1745293565050},{"_id":"source/_posts/linux-ntp时间服务.md","hash":"7490a8951d1565257a2aaa5c883fce16ae1b62de","modified":1749643265616},{"_id":"source/_posts/php开发-单点登录sso.md","hash":"bd73d873be1e718ed51bf996155a98e576b12456","modified":1751936899680},{"_id":"source/_posts/内网部署-政务网.md","hash":"cab1808e10f406527463a03f5b7aeb59aff0d5ad","modified":1754967336360},{"_id":"source/pic/nps-1.png","hash":"bdf4e0bb05a0467b5e0475d4f810b60a9e9336c6","modified":1751509768795},{"_id":"source/pic/nps-2.png","hash":"e065bc29d3210b64c3eab60c4b58da8340236506","modified":1751509770965}],"Category":[{"name":"服务器相关","_id":"clxb4gv3z000apcocgi5a3x1i"},{"name":"PHP开发","_id":"clxb4gv49000npcoc2ms19ohq"},{"name":"前端","_id":"clxb4gv4d0014pcoc61746nsw"},{"name":"server","_id":"clxb4gv4j001hpcoc8d7j8muz"},{"name":"JAVA开发","_id":"clxb4gv55002ypcoc8cwd78j0"},{"name":"心理学","_id":"clxb4gv5f003lpcocdvs5co5p"},{"name":"MYSQL","_id":"clxb4gv5j003spcoch6x22am7"},{"name":"微信开发","_id":"cm2ebk5cj0003dkocbmus9fpa"},{"name":"mysql","_id":"cm3wxt649000lq4oc4dwr1ah1"},{"name":"php","parent":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxthd0000nq4oc209m3h63"},{"name":"nginx","parent":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxv4ey000pq4oc25944hem"},{"name":"openEnler","parent":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxxb0x000wq4oc09u0db3q"},{"name":"php","parent":"clxb4gv49000npcoc2ms19ohq","_id":"cm3wxyre8000yq4ocbz3m41zc"},{"name":"mysql","parent":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxzq070013q4oc4cc8f3av"},{"name":"防火墙","parent":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wy0qk60016q4oce4dobbvx"},{"name":"vue","parent":"clxb4gv4d0014pcoc61746nsw","_id":"cm3wy4vbr001aq4ocbyqz3qjv"},{"name":"webpack","parent":"clxb4gv4d0014pcoc61746nsw","_id":"cm3wy6qz3001fq4ocgc0pblrd"},{"name":"window","parent":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wy7gkp001iq4oc8q6l7drh"},{"name":"windows","parent":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wy7mfg001lq4oc4w0gaa4w"},{"name":"shell","parent":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wy8sy3001sq4oc02qad1cr"}],"Data":[],"Page":[{"title":"about","date":"2021-12-11T03:32:31.000Z","_content":"\n# 个人介绍\n\n\n# 工作经历\n","source":"about/index.md","raw":"---\ntitle: about\ndate: 2021-12-11 11:32:31\n---\n\n# 个人介绍\n\n\n# 工作经历\n","updated":"2024-02-06T03:47:01.582Z","path":"about/index.html","_id":"clxb4gv3i0000pcoceyoxh3jz","comments":1,"layout":"page","content":"<h1 id=\"个人介绍\"><a href=\"#个人介绍\" class=\"headerlink\" title=\"个人介绍\"></a>个人介绍</h1><h1 id=\"工作经历\"><a href=\"#工作经历\" class=\"headerlink\" title=\"工作经历\"></a>工作经历</h1>","site":{"data":{}},"length":8,"excerpt":"","more":"<h1 id=\"个人介绍\"><a href=\"#个人介绍\" class=\"headerlink\" title=\"个人介绍\"></a>个人介绍</h1><h1 id=\"工作经历\"><a href=\"#工作经历\" class=\"headerlink\" title=\"工作经历\"></a>工作经历</h1>"},{"title":"分类","date":"2022-04-26T12:00:30.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: 分类 \ndate: 2022-04-26 20:00:30 \ntype: categories \n---\n","updated":"2024-02-06T05:59:29.380Z","path":"categories/index.html","comments":1,"layout":"page","_id":"clxb4gv3s0002pcoccxi36dwc","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"tags","date":"2021-12-11T03:33:08.000Z","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2021-12-11 11:33:08\n---\n","updated":"2022-02-26T02:46:01.763Z","path":"tags/index.html","_id":"clxb4gv3v0004pcoc412262sw","comments":1,"layout":"page","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""}],"Post":[{"title":"Hexo基础应用","abbrlink":"cc20be5e","date":"2021-12-10T06:20:38.000Z","_content":"\n1.首先安装node,具体参考https://hexo.io/zh-cn/docs/\n\n2.初始化 项目\n``` bash\nhexo init blog\n```\n将会在当前目录下产生blog文件夹\n\n3.新建文章\n``` bash\nhexo n 文章标题  //完整命令 hexo new 文章标题\n```\n相应会在source/_posts 目录下产生   文章标题.md\n\n4.生成html\n``` bash\nhexo g        //完整命令  hexo generate\n```\n将会在public目录生成相应的html文件\n\n5.开启本地测试环境\n``` bash\nhexo s        //完整命令  hexo server\n```\n    http://loaclhost:4000就可以访问了\n\n\n6.发布代码到github.io\n    \n    配置修改_config.yml文件\n```\ndeploy:\n  type: 'git'\n  repo: https://github.com/github账号名称/github账号名称.github.io\n  branch: master\n```\n``` bash\nhexo d       //发布到线上  hexo generate\n```\n\n\n\n\n\n\n\n","source":"_posts/Hexo基础应用.md","raw":"---\ntitle: Hexo基础应用\nabbrlink: cc20be5e\ndate: 2021-12-10 14:20:38\ntags:\n---\n\n1.首先安装node,具体参考https://hexo.io/zh-cn/docs/\n\n2.初始化 项目\n``` bash\nhexo init blog\n```\n将会在当前目录下产生blog文件夹\n\n3.新建文章\n``` bash\nhexo n 文章标题  //完整命令 hexo new 文章标题\n```\n相应会在source/_posts 目录下产生   文章标题.md\n\n4.生成html\n``` bash\nhexo g        //完整命令  hexo generate\n```\n将会在public目录生成相应的html文件\n\n5.开启本地测试环境\n``` bash\nhexo s        //完整命令  hexo server\n```\n    http://loaclhost:4000就可以访问了\n\n\n6.发布代码到github.io\n    \n    配置修改_config.yml文件\n```\ndeploy:\n  type: 'git'\n  repo: https://github.com/github账号名称/github账号名称.github.io\n  branch: master\n```\n``` bash\nhexo d       //发布到线上  hexo generate\n```\n\n\n\n\n\n\n\n","slug":"Hexo基础应用","published":1,"updated":"2024-02-06T05:50:34.810Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv3t0003pcocf4nb63zv","content":"<p>1.首先安装node,具体参考<a href=\"https://hexo.io/zh-cn/docs/\">https://hexo.io/zh-cn/docs/</a></p>\n<p>2.初始化 项目</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo init blog</span><br></pre></td></tr></table></figure>\n<p>将会在当前目录下产生blog文件夹</p>\n<p>3.新建文章</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo n 文章标题  //完整命令 hexo new 文章标题</span><br></pre></td></tr></table></figure>\n<p>相应会在source/_posts 目录下产生   文章标题.md</p>\n<p>4.生成html</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo g        //完整命令  hexo generate</span><br></pre></td></tr></table></figure>\n<p>将会在public目录生成相应的html文件</p>\n<p>5.开启本地测试环境</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo s        //完整命令  hexo server</span><br></pre></td></tr></table></figure>\n<pre><code>http://loaclhost:4000就可以访问了\n</code></pre>\n<p>6.发布代码到github.io</p>\n<pre><code>配置修改_config.yml文件\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">  type: &#x27;git&#x27;</span><br><span class=\"line\">  repo: https://github.com/github账号名称/github账号名称.github.io</span><br><span class=\"line\">  branch: master</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo d       //发布到线上  hexo generate</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n","site":{"data":{}},"length":411,"excerpt":"","more":"<p>1.首先安装node,具体参考<a href=\"https://hexo.io/zh-cn/docs/\">https://hexo.io/zh-cn/docs/</a></p>\n<p>2.初始化 项目</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo init blog</span><br></pre></td></tr></table></figure>\n<p>将会在当前目录下产生blog文件夹</p>\n<p>3.新建文章</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo n 文章标题  //完整命令 hexo new 文章标题</span><br></pre></td></tr></table></figure>\n<p>相应会在source/_posts 目录下产生   文章标题.md</p>\n<p>4.生成html</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo g        //完整命令  hexo generate</span><br></pre></td></tr></table></figure>\n<p>将会在public目录生成相应的html文件</p>\n<p>5.开启本地测试环境</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo s        //完整命令  hexo server</span><br></pre></td></tr></table></figure>\n<pre><code>http://loaclhost:4000就可以访问了\n</code></pre>\n<p>6.发布代码到github.io</p>\n<pre><code>配置修改_config.yml文件\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">  type: &#x27;git&#x27;</span><br><span class=\"line\">  repo: https://github.com/github账号名称/github账号名称.github.io</span><br><span class=\"line\">  branch: master</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo d       //发布到线上  hexo generate</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n"},{"title":"2022初四","published":0,"hidden":true,"abbrlink":"8bdd5997","date":"2022-02-04T12:35:47.000Z","_content":"\n    转眼间3天年已经过去了，马上就要上班了。此时此刻心情五味杂陈，对于工作，感情，能力，未来\n我有些烦，看见爷爷奶奶逐渐老去，走路已有些步履蹒跚，看着父母为了我的婚姻，无可奈何的叹息，拼命工作。\n我的内心总有些许的难受。婚姻问题逐渐成为了我一道难以逾越的坎了，逐渐的让我怀疑自己的对于婚姻的认知，\n怀疑自己的选择是不是错的，但是内心还是不甘心。就想找到那个能和我一起玩，一起相伴，自己看了对眼的人。\n不想潦草了事以后后悔。可奈何时间不等人。鱼与熊掌不可兼得，在时间的洪流与世俗的冲击下，我又能吼的住多久呢？\n无解。。。","source":"_posts/2022初四.md","raw":"---\ntitle: 2022初四\npublished: false\nhidden: true\nabbrlink: 8bdd5997\ndate: 2022-02-04 20:35:47\ntags:\n---\n\n    转眼间3天年已经过去了，马上就要上班了。此时此刻心情五味杂陈，对于工作，感情，能力，未来\n我有些烦，看见爷爷奶奶逐渐老去，走路已有些步履蹒跚，看着父母为了我的婚姻，无可奈何的叹息，拼命工作。\n我的内心总有些许的难受。婚姻问题逐渐成为了我一道难以逾越的坎了，逐渐的让我怀疑自己的对于婚姻的认知，\n怀疑自己的选择是不是错的，但是内心还是不甘心。就想找到那个能和我一起玩，一起相伴，自己看了对眼的人。\n不想潦草了事以后后悔。可奈何时间不等人。鱼与熊掌不可兼得，在时间的洪流与世俗的冲击下，我又能吼的住多久呢？\n无解。。。","slug":"2022初四","updated":"2024-02-06T05:50:34.820Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv3v0005pcoc7lbdale7","content":"<pre><code>转眼间3天年已经过去了，马上就要上班了。此时此刻心情五味杂陈，对于工作，感情，能力，未来\n</code></pre>\n<p>我有些烦，看见爷爷奶奶逐渐老去，走路已有些步履蹒跚，看着父母为了我的婚姻，无可奈何的叹息，拼命工作。<br>我的内心总有些许的难受。婚姻问题逐渐成为了我一道难以逾越的坎了，逐渐的让我怀疑自己的对于婚姻的认知，<br>怀疑自己的选择是不是错的，但是内心还是不甘心。就想找到那个能和我一起玩，一起相伴，自己看了对眼的人。<br>不想潦草了事以后后悔。可奈何时间不等人。鱼与熊掌不可兼得，在时间的洪流与世俗的冲击下，我又能吼的住多久呢？<br>无解。。。</p>\n","site":{"data":{}},"length":252,"excerpt":"","more":"<pre><code>转眼间3天年已经过去了，马上就要上班了。此时此刻心情五味杂陈，对于工作，感情，能力，未来\n</code></pre>\n<p>我有些烦，看见爷爷奶奶逐渐老去，走路已有些步履蹒跚，看着父母为了我的婚姻，无可奈何的叹息，拼命工作。<br>我的内心总有些许的难受。婚姻问题逐渐成为了我一道难以逾越的坎了，逐渐的让我怀疑自己的对于婚姻的认知，<br>怀疑自己的选择是不是错的，但是内心还是不甘心。就想找到那个能和我一起玩，一起相伴，自己看了对眼的人。<br>不想潦草了事以后后悔。可奈何时间不等人。鱼与熊掌不可兼得，在时间的洪流与世俗的冲击下，我又能吼的住多久呢？<br>无解。。。</p>\n"},{"title":"docker学习1-Docker基础命令","abbrlink":"2cb0387a","date":"2023-07-08T13:47:55.000Z","_content":"\n# Docker基础命令\n    \n### 查看镜像\n    Docker image ls \n\n### 查看运行中的容器container\n\n    docker ps      展示 正在运行的\n\n\tdocker ps -a   所有  启动与未启动的 \n\n    docker ps -q\n\n\n### 运行容器\n\ndocker run 容器名称\n\ndocker run -d\n\n    用来在 Docker 中以后台模式运行容器的命令\n    \n    \ndocker run -p 8080:80   \n    \n    -p 宿主机IP:宿主机端口:容器端口\n    \n    宿主机IP不写表示\"0.0.0.0\",宿主机PORT不写表示随机端口，\n    容器PORT必须指定，可以同时对多个端口进行映射绑定\n    指定端口映射，在标准化场景下使用频率高\n    \ndocker run -v\n\n      -v宿主机路径:容器中路径\n     \n    示例：\n        docker run -d -p 8080:80  -v /root/nginx/:/etc/nginx --name nginx-test nginx:1.22\n\n### 查看运行中的容器container\n\n\tdocker inspect  容器名称    查看容器信息\n\t\n\t示例：\n\t    docker inspect nginx\n\n### 根据dockerfile 文件生成image\n\n\tDocker build -t tag/镜像名称   dockerfile所在目录\n\t\t示例：\n\t\tdocker build -t test/hello-word .\n\n### 删除容器\n\n    docker rm 容器ID       \n\n\tdocker rm $(docker container ls -aq)    删除所有容器\n\t\n\tdocker rmi image名称   删除镜像\n\n\n### 进入容器内\n\n    docker exec -it 容器名 /bin/bash\n    \n    示例：docker exec it php71 /bin/bash\n\n\n\n### docker 镜像 导出导入【必须成对使用】\n\n    docker export：导出容器\n    docker import：导入容器为镜像\n\n    \n    docker save：导出镜像\n    \n        -o:输出到的文件。\n\n        导出示例：\n            docker save -o my_ubuntu_v3.tar runoob/ubuntu:v3\n            docker save ubuntu:load>/root/ubuntu.tar\n\n    docker load：导入镜像\n        -i：指定导出的文件\n        -q：精简输出信息\n        \n        导入示例：\n            docker load -i ubuntu.tar\n            docker load < ubuntu.tar\n","source":"_posts/docker学习1.md","raw":"---\ntitle: docker学习1-Docker基础命令\nabbrlink: 2cb0387a\ncategories:\n  - 服务器相关\ndate: 2023-07-08 21:47:55\ntags:\n---\n\n# Docker基础命令\n    \n### 查看镜像\n    Docker image ls \n\n### 查看运行中的容器container\n\n    docker ps      展示 正在运行的\n\n\tdocker ps -a   所有  启动与未启动的 \n\n    docker ps -q\n\n\n### 运行容器\n\ndocker run 容器名称\n\ndocker run -d\n\n    用来在 Docker 中以后台模式运行容器的命令\n    \n    \ndocker run -p 8080:80   \n    \n    -p 宿主机IP:宿主机端口:容器端口\n    \n    宿主机IP不写表示\"0.0.0.0\",宿主机PORT不写表示随机端口，\n    容器PORT必须指定，可以同时对多个端口进行映射绑定\n    指定端口映射，在标准化场景下使用频率高\n    \ndocker run -v\n\n      -v宿主机路径:容器中路径\n     \n    示例：\n        docker run -d -p 8080:80  -v /root/nginx/:/etc/nginx --name nginx-test nginx:1.22\n\n### 查看运行中的容器container\n\n\tdocker inspect  容器名称    查看容器信息\n\t\n\t示例：\n\t    docker inspect nginx\n\n### 根据dockerfile 文件生成image\n\n\tDocker build -t tag/镜像名称   dockerfile所在目录\n\t\t示例：\n\t\tdocker build -t test/hello-word .\n\n### 删除容器\n\n    docker rm 容器ID       \n\n\tdocker rm $(docker container ls -aq)    删除所有容器\n\t\n\tdocker rmi image名称   删除镜像\n\n\n### 进入容器内\n\n    docker exec -it 容器名 /bin/bash\n    \n    示例：docker exec it php71 /bin/bash\n\n\n\n### docker 镜像 导出导入【必须成对使用】\n\n    docker export：导出容器\n    docker import：导入容器为镜像\n\n    \n    docker save：导出镜像\n    \n        -o:输出到的文件。\n\n        导出示例：\n            docker save -o my_ubuntu_v3.tar runoob/ubuntu:v3\n            docker save ubuntu:load>/root/ubuntu.tar\n\n    docker load：导入镜像\n        -i：指定导出的文件\n        -q：精简输出信息\n        \n        导入示例：\n            docker load -i ubuntu.tar\n            docker load < ubuntu.tar\n","slug":"docker学习1","published":1,"updated":"2024-03-15T03:30:31.025Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv3y0008pcoc73so0mtm","content":"<h1 id=\"Docker基础命令\"><a href=\"#Docker基础命令\" class=\"headerlink\" title=\"Docker基础命令\"></a>Docker基础命令</h1><h3 id=\"查看镜像\"><a href=\"#查看镜像\" class=\"headerlink\" title=\"查看镜像\"></a>查看镜像</h3><pre><code>Docker image ls \n</code></pre>\n<h3 id=\"查看运行中的容器container\"><a href=\"#查看运行中的容器container\" class=\"headerlink\" title=\"查看运行中的容器container\"></a>查看运行中的容器container</h3><pre><code>docker ps      展示 正在运行的\n\ndocker ps -a   所有  启动与未启动的 \n\ndocker ps -q\n</code></pre>\n<h3 id=\"运行容器\"><a href=\"#运行容器\" class=\"headerlink\" title=\"运行容器\"></a>运行容器</h3><p>docker run 容器名称</p>\n<p>docker run -d</p>\n<pre><code>用来在 Docker 中以后台模式运行容器的命令\n</code></pre>\n<p>docker run -p 8080:80   </p>\n<pre><code>-p 宿主机IP:宿主机端口:容器端口\n\n宿主机IP不写表示&quot;0.0.0.0&quot;,宿主机PORT不写表示随机端口，\n容器PORT必须指定，可以同时对多个端口进行映射绑定\n指定端口映射，在标准化场景下使用频率高\n</code></pre>\n<p>docker run -v</p>\n<pre><code>  -v宿主机路径:容器中路径\n \n示例：\n    docker run -d -p 8080:80  -v /root/nginx/:/etc/nginx --name nginx-test nginx:1.22\n</code></pre>\n<h3 id=\"查看运行中的容器container-1\"><a href=\"#查看运行中的容器container-1\" class=\"headerlink\" title=\"查看运行中的容器container\"></a>查看运行中的容器container</h3><pre><code>docker inspect  容器名称    查看容器信息\n\n示例：\n    docker inspect nginx\n</code></pre>\n<h3 id=\"根据dockerfile-文件生成image\"><a href=\"#根据dockerfile-文件生成image\" class=\"headerlink\" title=\"根据dockerfile 文件生成image\"></a>根据dockerfile 文件生成image</h3><pre><code>Docker build -t tag/镜像名称   dockerfile所在目录\n    示例：\n    docker build -t test/hello-word .\n</code></pre>\n<h3 id=\"删除容器\"><a href=\"#删除容器\" class=\"headerlink\" title=\"删除容器\"></a>删除容器</h3><pre><code>docker rm 容器ID       \n\ndocker rm $(docker container ls -aq)    删除所有容器\n\ndocker rmi image名称   删除镜像\n</code></pre>\n<h3 id=\"进入容器内\"><a href=\"#进入容器内\" class=\"headerlink\" title=\"进入容器内\"></a>进入容器内</h3><pre><code>docker exec -it 容器名 /bin/bash\n\n示例：docker exec it php71 /bin/bash\n</code></pre>\n<h3 id=\"docker-镜像-导出导入【必须成对使用】\"><a href=\"#docker-镜像-导出导入【必须成对使用】\" class=\"headerlink\" title=\"docker 镜像 导出导入【必须成对使用】\"></a>docker 镜像 导出导入【必须成对使用】</h3><pre><code>docker export：导出容器\ndocker import：导入容器为镜像\n\n\ndocker save：导出镜像\n\n    -o:输出到的文件。\n\n    导出示例：\n        docker save -o my_ubuntu_v3.tar runoob/ubuntu:v3\n        docker save ubuntu:load&gt;/root/ubuntu.tar\n\ndocker load：导入镜像\n    -i：指定导出的文件\n    -q：精简输出信息\n    \n    导入示例：\n        docker load -i ubuntu.tar\n        docker load &lt; ubuntu.tar\n</code></pre>\n","site":{"data":{}},"length":900,"excerpt":"","more":"<h1 id=\"Docker基础命令\"><a href=\"#Docker基础命令\" class=\"headerlink\" title=\"Docker基础命令\"></a>Docker基础命令</h1><h3 id=\"查看镜像\"><a href=\"#查看镜像\" class=\"headerlink\" title=\"查看镜像\"></a>查看镜像</h3><pre><code>Docker image ls \n</code></pre>\n<h3 id=\"查看运行中的容器container\"><a href=\"#查看运行中的容器container\" class=\"headerlink\" title=\"查看运行中的容器container\"></a>查看运行中的容器container</h3><pre><code>docker ps      展示 正在运行的\n\ndocker ps -a   所有  启动与未启动的 \n\ndocker ps -q\n</code></pre>\n<h3 id=\"运行容器\"><a href=\"#运行容器\" class=\"headerlink\" title=\"运行容器\"></a>运行容器</h3><p>docker run 容器名称</p>\n<p>docker run -d</p>\n<pre><code>用来在 Docker 中以后台模式运行容器的命令\n</code></pre>\n<p>docker run -p 8080:80   </p>\n<pre><code>-p 宿主机IP:宿主机端口:容器端口\n\n宿主机IP不写表示&quot;0.0.0.0&quot;,宿主机PORT不写表示随机端口，\n容器PORT必须指定，可以同时对多个端口进行映射绑定\n指定端口映射，在标准化场景下使用频率高\n</code></pre>\n<p>docker run -v</p>\n<pre><code>  -v宿主机路径:容器中路径\n \n示例：\n    docker run -d -p 8080:80  -v /root/nginx/:/etc/nginx --name nginx-test nginx:1.22\n</code></pre>\n<h3 id=\"查看运行中的容器container-1\"><a href=\"#查看运行中的容器container-1\" class=\"headerlink\" title=\"查看运行中的容器container\"></a>查看运行中的容器container</h3><pre><code>docker inspect  容器名称    查看容器信息\n\n示例：\n    docker inspect nginx\n</code></pre>\n<h3 id=\"根据dockerfile-文件生成image\"><a href=\"#根据dockerfile-文件生成image\" class=\"headerlink\" title=\"根据dockerfile 文件生成image\"></a>根据dockerfile 文件生成image</h3><pre><code>Docker build -t tag/镜像名称   dockerfile所在目录\n    示例：\n    docker build -t test/hello-word .\n</code></pre>\n<h3 id=\"删除容器\"><a href=\"#删除容器\" class=\"headerlink\" title=\"删除容器\"></a>删除容器</h3><pre><code>docker rm 容器ID       \n\ndocker rm $(docker container ls -aq)    删除所有容器\n\ndocker rmi image名称   删除镜像\n</code></pre>\n<h3 id=\"进入容器内\"><a href=\"#进入容器内\" class=\"headerlink\" title=\"进入容器内\"></a>进入容器内</h3><pre><code>docker exec -it 容器名 /bin/bash\n\n示例：docker exec it php71 /bin/bash\n</code></pre>\n<h3 id=\"docker-镜像-导出导入【必须成对使用】\"><a href=\"#docker-镜像-导出导入【必须成对使用】\" class=\"headerlink\" title=\"docker 镜像 导出导入【必须成对使用】\"></a>docker 镜像 导出导入【必须成对使用】</h3><pre><code>docker export：导出容器\ndocker import：导入容器为镜像\n\n\ndocker save：导出镜像\n\n    -o:输出到的文件。\n\n    导出示例：\n        docker save -o my_ubuntu_v3.tar runoob/ubuntu:v3\n        docker save ubuntu:load&gt;/root/ubuntu.tar\n\ndocker load：导入镜像\n    -i：指定导出的文件\n    -q：精简输出信息\n    \n    导入示例：\n        docker load -i ubuntu.tar\n        docker load &lt; ubuntu.tar\n</code></pre>\n"},{"title":"docker学习2-DockerFile","abbrlink":"ad46b1ee","date":"2023-07-08T13:54:55.000Z","_content":"\n# Dockerfile 学习\n\n\n## 相关语法\n\n\tFROM  scratch\n\tADD hello /\n\tCMD [\"/hello\"]\n\n\n## FROM语法\n\n\tFROM scratch   //制作  base image\n\n\tFROM centos    //使用  base image\n\n\tFROM ubuntu:14.4\n\n## LABEL语法（类似注释作用）\n\n\tLABEL maintainer=\"xiaoquwl@gmail.com\"\n\tLABEL version=\"1.0\"\n\tLABEL description=\"This is description\"\n\t注：Metadata(元数据)不可少\n\n    示例：\n    LABEL org.opencontainers.image.authors=\"yeasy\"\n    LABEL org.opencontainers.image.documentation=\"https://yeasy.gitbooks.io\"\n\n\n## RUN 语法\n\n\tRUN yum update && yum install -y vim \\\n\tpython-dev \n\t注：反斜杠换行\n\n\tRUN\n\n\n## WORKDIR 语法\n    设置工作目录，目录不存在，会自动创建\n\n    示列：\n    WORKDIR /test\n    WORKDIR abc\n    这样就工作在/test/abc目录下\n    注：\n        1、RUN cd 能实现类似效果 但不推荐\n        2、目录尽量示绝对目录\n\n## ADD&&COPY 语法\n\n    功能类似添加文件到容器\n    ADD 有解压缩功能\n\n    示列：\n     ADD test.tar.gz /app/web\n    \n## ENV 语法\n    \n    定义变量\n    示列：\n        ENV  MYSQL_VERSION 5.6\n        RUM yum install mysql_server=\"${MYSQL_VERSION}\"\n\n\n## VOLUME&&EXPOSE\n    存储和网络\n\n\n\n","source":"_posts/docker学习2.md","raw":"---\ntitle: docker学习2-DockerFile\nabbrlink: ad46b1ee\ncategories:\n  - 服务器相关\ndate: 2023-07-08 21:54:55\ntags:\n---\n\n# Dockerfile 学习\n\n\n## 相关语法\n\n\tFROM  scratch\n\tADD hello /\n\tCMD [\"/hello\"]\n\n\n## FROM语法\n\n\tFROM scratch   //制作  base image\n\n\tFROM centos    //使用  base image\n\n\tFROM ubuntu:14.4\n\n## LABEL语法（类似注释作用）\n\n\tLABEL maintainer=\"xiaoquwl@gmail.com\"\n\tLABEL version=\"1.0\"\n\tLABEL description=\"This is description\"\n\t注：Metadata(元数据)不可少\n\n    示例：\n    LABEL org.opencontainers.image.authors=\"yeasy\"\n    LABEL org.opencontainers.image.documentation=\"https://yeasy.gitbooks.io\"\n\n\n## RUN 语法\n\n\tRUN yum update && yum install -y vim \\\n\tpython-dev \n\t注：反斜杠换行\n\n\tRUN\n\n\n## WORKDIR 语法\n    设置工作目录，目录不存在，会自动创建\n\n    示列：\n    WORKDIR /test\n    WORKDIR abc\n    这样就工作在/test/abc目录下\n    注：\n        1、RUN cd 能实现类似效果 但不推荐\n        2、目录尽量示绝对目录\n\n## ADD&&COPY 语法\n\n    功能类似添加文件到容器\n    ADD 有解压缩功能\n\n    示列：\n     ADD test.tar.gz /app/web\n    \n## ENV 语法\n    \n    定义变量\n    示列：\n        ENV  MYSQL_VERSION 5.6\n        RUM yum install mysql_server=\"${MYSQL_VERSION}\"\n\n\n## VOLUME&&EXPOSE\n    存储和网络\n\n\n\n","slug":"docker学习2","published":1,"updated":"2024-02-06T11:04:44.561Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv3y0009pcoc56xqaxqv","content":"<h1 id=\"Dockerfile-学习\"><a href=\"#Dockerfile-学习\" class=\"headerlink\" title=\"Dockerfile 学习\"></a>Dockerfile 学习</h1><h2 id=\"相关语法\"><a href=\"#相关语法\" class=\"headerlink\" title=\"相关语法\"></a>相关语法</h2><pre><code>FROM  scratch\nADD hello /\nCMD [&quot;/hello&quot;]\n</code></pre>\n<h2 id=\"FROM语法\"><a href=\"#FROM语法\" class=\"headerlink\" title=\"FROM语法\"></a>FROM语法</h2><pre><code>FROM scratch   //制作  base image\n\nFROM centos    //使用  base image\n\nFROM ubuntu:14.4\n</code></pre>\n<h2 id=\"LABEL语法（类似注释作用）\"><a href=\"#LABEL语法（类似注释作用）\" class=\"headerlink\" title=\"LABEL语法（类似注释作用）\"></a>LABEL语法（类似注释作用）</h2><pre><code>LABEL maintainer=&quot;xiaoquwl@gmail.com&quot;\nLABEL version=&quot;1.0&quot;\nLABEL description=&quot;This is description&quot;\n注：Metadata(元数据)不可少\n\n示例：\nLABEL org.opencontainers.image.authors=&quot;yeasy&quot;\nLABEL org.opencontainers.image.documentation=&quot;https://yeasy.gitbooks.io&quot;\n</code></pre>\n<h2 id=\"RUN-语法\"><a href=\"#RUN-语法\" class=\"headerlink\" title=\"RUN 语法\"></a>RUN 语法</h2><pre><code>RUN yum update &amp;&amp; yum install -y vim \\\npython-dev \n注：反斜杠换行\n\nRUN\n</code></pre>\n<h2 id=\"WORKDIR-语法\"><a href=\"#WORKDIR-语法\" class=\"headerlink\" title=\"WORKDIR 语法\"></a>WORKDIR 语法</h2><pre><code>设置工作目录，目录不存在，会自动创建\n\n示列：\nWORKDIR /test\nWORKDIR abc\n这样就工作在/test/abc目录下\n注：\n    1、RUN cd 能实现类似效果 但不推荐\n    2、目录尽量示绝对目录\n</code></pre>\n<h2 id=\"ADD-amp-amp-COPY-语法\"><a href=\"#ADD-amp-amp-COPY-语法\" class=\"headerlink\" title=\"ADD&amp;&amp;COPY 语法\"></a>ADD&amp;&amp;COPY 语法</h2><pre><code>功能类似添加文件到容器\nADD 有解压缩功能\n\n示列：\n ADD test.tar.gz /app/web\n</code></pre>\n<h2 id=\"ENV-语法\"><a href=\"#ENV-语法\" class=\"headerlink\" title=\"ENV 语法\"></a>ENV 语法</h2><pre><code>定义变量\n示列：\n    ENV  MYSQL_VERSION 5.6\n    RUM yum install mysql_server=&quot;$&#123;MYSQL_VERSION&#125;&quot;\n</code></pre>\n<h2 id=\"VOLUME-amp-amp-EXPOSE\"><a href=\"#VOLUME-amp-amp-EXPOSE\" class=\"headerlink\" title=\"VOLUME&amp;&amp;EXPOSE\"></a>VOLUME&amp;&amp;EXPOSE</h2><pre><code>存储和网络\n</code></pre>\n","site":{"data":{}},"length":769,"excerpt":"","more":"<h1 id=\"Dockerfile-学习\"><a href=\"#Dockerfile-学习\" class=\"headerlink\" title=\"Dockerfile 学习\"></a>Dockerfile 学习</h1><h2 id=\"相关语法\"><a href=\"#相关语法\" class=\"headerlink\" title=\"相关语法\"></a>相关语法</h2><pre><code>FROM  scratch\nADD hello /\nCMD [&quot;/hello&quot;]\n</code></pre>\n<h2 id=\"FROM语法\"><a href=\"#FROM语法\" class=\"headerlink\" title=\"FROM语法\"></a>FROM语法</h2><pre><code>FROM scratch   //制作  base image\n\nFROM centos    //使用  base image\n\nFROM ubuntu:14.4\n</code></pre>\n<h2 id=\"LABEL语法（类似注释作用）\"><a href=\"#LABEL语法（类似注释作用）\" class=\"headerlink\" title=\"LABEL语法（类似注释作用）\"></a>LABEL语法（类似注释作用）</h2><pre><code>LABEL maintainer=&quot;xiaoquwl@gmail.com&quot;\nLABEL version=&quot;1.0&quot;\nLABEL description=&quot;This is description&quot;\n注：Metadata(元数据)不可少\n\n示例：\nLABEL org.opencontainers.image.authors=&quot;yeasy&quot;\nLABEL org.opencontainers.image.documentation=&quot;https://yeasy.gitbooks.io&quot;\n</code></pre>\n<h2 id=\"RUN-语法\"><a href=\"#RUN-语法\" class=\"headerlink\" title=\"RUN 语法\"></a>RUN 语法</h2><pre><code>RUN yum update &amp;&amp; yum install -y vim \\\npython-dev \n注：反斜杠换行\n\nRUN\n</code></pre>\n<h2 id=\"WORKDIR-语法\"><a href=\"#WORKDIR-语法\" class=\"headerlink\" title=\"WORKDIR 语法\"></a>WORKDIR 语法</h2><pre><code>设置工作目录，目录不存在，会自动创建\n\n示列：\nWORKDIR /test\nWORKDIR abc\n这样就工作在/test/abc目录下\n注：\n    1、RUN cd 能实现类似效果 但不推荐\n    2、目录尽量示绝对目录\n</code></pre>\n<h2 id=\"ADD-amp-amp-COPY-语法\"><a href=\"#ADD-amp-amp-COPY-语法\" class=\"headerlink\" title=\"ADD&amp;&amp;COPY 语法\"></a>ADD&amp;&amp;COPY 语法</h2><pre><code>功能类似添加文件到容器\nADD 有解压缩功能\n\n示列：\n ADD test.tar.gz /app/web\n</code></pre>\n<h2 id=\"ENV-语法\"><a href=\"#ENV-语法\" class=\"headerlink\" title=\"ENV 语法\"></a>ENV 语法</h2><pre><code>定义变量\n示列：\n    ENV  MYSQL_VERSION 5.6\n    RUM yum install mysql_server=&quot;$&#123;MYSQL_VERSION&#125;&quot;\n</code></pre>\n<h2 id=\"VOLUME-amp-amp-EXPOSE\"><a href=\"#VOLUME-amp-amp-EXPOSE\" class=\"headerlink\" title=\"VOLUME&amp;&amp;EXPOSE\"></a>VOLUME&amp;&amp;EXPOSE</h2><pre><code>存储和网络\n</code></pre>\n"},{"title":"ansible学习-playbook之nginx安装","abbrlink":"78909e13","date":"2024-01-17T07:41:33.000Z","_content":"\n```\n---\n - name: install nginx\n   hosts: test\n   tasks:\n    - name: Print ansible_os_family\n      debug:\n       var: ansible_os_family    \n    #关闭selinux     \n    - name: disable selinux\n      shell: \"setenforce 0\"\n      ignore_errors: true\n    - name: Update apt package cache\n      apt:\n        update_cache: yes\n      ignore_errors: true\n      when: ansible_os_family in [\"Debian\",\"ubuntu\"]     \n    - name: ubuntu install nginx\n      apt:\n        name: nginx\n        state: present   \n      when: ansible_os_family in [\"Debian\",\"ubuntu\"]\n    - name: Add repo \n      yum_repository:\n       name: nginx\n       description: nginx repo\n       baseurl: http://nginx.org/packages/centos/7/$basearch/\n       gpgcheck: no\n       enabled: 1\n      when: ansible_os_family in  [\"RedHat\",\"openEuler\"]\n    - name: redhat install nginx\n      yum:\n       name: nginx\n       state: latest\n      when: ansible_os_family in [\"RedHat\",\"openEuler\"]\n    - name: start nginx server\n      service: name=nginx state=started\n```\n","source":"_posts/ansible学习-playbook之nginx安装.md","raw":"---\ntitle: ansible学习-playbook之nginx安装\nabbrlink: '78909e13'\ncategories:\n  - 服务器相关\ndate: 2024-01-17 15:41:33\ntags:\n---\n\n```\n---\n - name: install nginx\n   hosts: test\n   tasks:\n    - name: Print ansible_os_family\n      debug:\n       var: ansible_os_family    \n    #关闭selinux     \n    - name: disable selinux\n      shell: \"setenforce 0\"\n      ignore_errors: true\n    - name: Update apt package cache\n      apt:\n        update_cache: yes\n      ignore_errors: true\n      when: ansible_os_family in [\"Debian\",\"ubuntu\"]     \n    - name: ubuntu install nginx\n      apt:\n        name: nginx\n        state: present   \n      when: ansible_os_family in [\"Debian\",\"ubuntu\"]\n    - name: Add repo \n      yum_repository:\n       name: nginx\n       description: nginx repo\n       baseurl: http://nginx.org/packages/centos/7/$basearch/\n       gpgcheck: no\n       enabled: 1\n      when: ansible_os_family in  [\"RedHat\",\"openEuler\"]\n    - name: redhat install nginx\n      yum:\n       name: nginx\n       state: latest\n      when: ansible_os_family in [\"RedHat\",\"openEuler\"]\n    - name: start nginx server\n      service: name=nginx state=started\n```\n","slug":"ansible学习-playbook之nginx安装","published":1,"updated":"2024-02-06T11:04:23.514Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv40000bpcocdm0mgs9x","content":"<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\"> - name: install nginx</span><br><span class=\"line\">   hosts: test</span><br><span class=\"line\">   tasks:</span><br><span class=\"line\">    - name: Print ansible_os_family</span><br><span class=\"line\">      debug:</span><br><span class=\"line\">       var: ansible_os_family    </span><br><span class=\"line\">    #关闭selinux     </span><br><span class=\"line\">    - name: disable selinux</span><br><span class=\"line\">      shell: &quot;setenforce 0&quot;</span><br><span class=\"line\">      ignore_errors: true</span><br><span class=\"line\">    - name: Update apt package cache</span><br><span class=\"line\">      apt:</span><br><span class=\"line\">        update_cache: yes</span><br><span class=\"line\">      ignore_errors: true</span><br><span class=\"line\">      when: ansible_os_family in [&quot;Debian&quot;,&quot;ubuntu&quot;]     </span><br><span class=\"line\">    - name: ubuntu install nginx</span><br><span class=\"line\">      apt:</span><br><span class=\"line\">        name: nginx</span><br><span class=\"line\">        state: present   </span><br><span class=\"line\">      when: ansible_os_family in [&quot;Debian&quot;,&quot;ubuntu&quot;]</span><br><span class=\"line\">    - name: Add repo </span><br><span class=\"line\">      yum_repository:</span><br><span class=\"line\">       name: nginx</span><br><span class=\"line\">       description: nginx repo</span><br><span class=\"line\">       baseurl: http://nginx.org/packages/centos/7/$basearch/</span><br><span class=\"line\">       gpgcheck: no</span><br><span class=\"line\">       enabled: 1</span><br><span class=\"line\">      when: ansible_os_family in  [&quot;RedHat&quot;,&quot;openEuler&quot;]</span><br><span class=\"line\">    - name: redhat install nginx</span><br><span class=\"line\">      yum:</span><br><span class=\"line\">       name: nginx</span><br><span class=\"line\">       state: latest</span><br><span class=\"line\">      when: ansible_os_family in [&quot;RedHat&quot;,&quot;openEuler&quot;]</span><br><span class=\"line\">    - name: start nginx server</span><br><span class=\"line\">      service: name=nginx state=started</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"length":841,"excerpt":"","more":"<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\"> - name: install nginx</span><br><span class=\"line\">   hosts: test</span><br><span class=\"line\">   tasks:</span><br><span class=\"line\">    - name: Print ansible_os_family</span><br><span class=\"line\">      debug:</span><br><span class=\"line\">       var: ansible_os_family    </span><br><span class=\"line\">    #关闭selinux     </span><br><span class=\"line\">    - name: disable selinux</span><br><span class=\"line\">      shell: &quot;setenforce 0&quot;</span><br><span class=\"line\">      ignore_errors: true</span><br><span class=\"line\">    - name: Update apt package cache</span><br><span class=\"line\">      apt:</span><br><span class=\"line\">        update_cache: yes</span><br><span class=\"line\">      ignore_errors: true</span><br><span class=\"line\">      when: ansible_os_family in [&quot;Debian&quot;,&quot;ubuntu&quot;]     </span><br><span class=\"line\">    - name: ubuntu install nginx</span><br><span class=\"line\">      apt:</span><br><span class=\"line\">        name: nginx</span><br><span class=\"line\">        state: present   </span><br><span class=\"line\">      when: ansible_os_family in [&quot;Debian&quot;,&quot;ubuntu&quot;]</span><br><span class=\"line\">    - name: Add repo </span><br><span class=\"line\">      yum_repository:</span><br><span class=\"line\">       name: nginx</span><br><span class=\"line\">       description: nginx repo</span><br><span class=\"line\">       baseurl: http://nginx.org/packages/centos/7/$basearch/</span><br><span class=\"line\">       gpgcheck: no</span><br><span class=\"line\">       enabled: 1</span><br><span class=\"line\">      when: ansible_os_family in  [&quot;RedHat&quot;,&quot;openEuler&quot;]</span><br><span class=\"line\">    - name: redhat install nginx</span><br><span class=\"line\">      yum:</span><br><span class=\"line\">       name: nginx</span><br><span class=\"line\">       state: latest</span><br><span class=\"line\">      when: ansible_os_family in [&quot;RedHat&quot;,&quot;openEuler&quot;]</span><br><span class=\"line\">    - name: start nginx server</span><br><span class=\"line\">      service: name=nginx state=started</span><br></pre></td></tr></table></figure>\n"},{"title":"docker学习4-网络","abbrlink":"32b808f5","date":"2023-10-26T13:56:52.000Z","_content":"# 原理linux network namespace\n\n# docker  bridge 网络\n\n默认就是 bridge\n\n宿主主机通过 nat 访问\n\n## link\n``\n## 自定义 docker 网络\n\n\n#  docker端口映射\n\n\n# docker host 网络\n\n没有ip  ip就是宿主主机 端口也就对应宿主主机的","source":"_posts/docker学习4-网络.md","raw":"---\ntitle: docker学习4-网络\nabbrlink: 32b808f5\ncategories:\n  - 服务器相关\ndate: 2023-10-26 21:56:52\ntags:\n---\n# 原理linux network namespace\n\n# docker  bridge 网络\n\n默认就是 bridge\n\n宿主主机通过 nat 访问\n\n## link\n``\n## 自定义 docker 网络\n\n\n#  docker端口映射\n\n\n# docker host 网络\n\n没有ip  ip就是宿主主机 端口也就对应宿主主机的","slug":"docker学习4-网络","published":1,"updated":"2024-03-18T05:50:08.123Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv42000cpcocc1rs1kk1","content":"<h1 id=\"原理linux-network-namespace\"><a href=\"#原理linux-network-namespace\" class=\"headerlink\" title=\"原理linux network namespace\"></a>原理linux network namespace</h1><h1 id=\"docker-bridge-网络\"><a href=\"#docker-bridge-网络\" class=\"headerlink\" title=\"docker  bridge 网络\"></a>docker  bridge 网络</h1><p>默认就是 bridge</p>\n<p>宿主主机通过 nat 访问</p>\n<h2 id=\"link\"><a href=\"#link\" class=\"headerlink\" title=\"link\"></a>link</h2><p>``</p>\n<h2 id=\"自定义-docker-网络\"><a href=\"#自定义-docker-网络\" class=\"headerlink\" title=\"自定义 docker 网络\"></a>自定义 docker 网络</h2><h1 id=\"docker端口映射\"><a href=\"#docker端口映射\" class=\"headerlink\" title=\"docker端口映射\"></a>docker端口映射</h1><h1 id=\"docker-host-网络\"><a href=\"#docker-host-网络\" class=\"headerlink\" title=\"docker host 网络\"></a>docker host 网络</h1><p>没有ip  ip就是宿主主机 端口也就对应宿主主机的</p>\n","site":{"data":{}},"length":120,"excerpt":"","more":"<h1 id=\"原理linux-network-namespace\"><a href=\"#原理linux-network-namespace\" class=\"headerlink\" title=\"原理linux network namespace\"></a>原理linux network namespace</h1><h1 id=\"docker-bridge-网络\"><a href=\"#docker-bridge-网络\" class=\"headerlink\" title=\"docker  bridge 网络\"></a>docker  bridge 网络</h1><p>默认就是 bridge</p>\n<p>宿主主机通过 nat 访问</p>\n<h2 id=\"link\"><a href=\"#link\" class=\"headerlink\" title=\"link\"></a>link</h2><p>``</p>\n<h2 id=\"自定义-docker-网络\"><a href=\"#自定义-docker-网络\" class=\"headerlink\" title=\"自定义 docker 网络\"></a>自定义 docker 网络</h2><h1 id=\"docker端口映射\"><a href=\"#docker端口映射\" class=\"headerlink\" title=\"docker端口映射\"></a>docker端口映射</h1><h1 id=\"docker-host-网络\"><a href=\"#docker-host-网络\" class=\"headerlink\" title=\"docker host 网络\"></a>docker host 网络</h1><p>没有ip  ip就是宿主主机 端口也就对应宿主主机的</p>\n"},{"title":"docker学习3","abbrlink":"a707732","date":"2023-07-09T06:00:02.000Z","_content":"# docker-compose使用\n\n\n## docker-compose安装","source":"_posts/docker学习3.md","raw":"---\ntitle: docker学习3\nabbrlink: a707732\ncategories:\n  - 服务器相关\ndate: 2023-07-09 14:00:02\ntags:\n---\n# docker-compose使用\n\n\n## docker-compose安装","slug":"docker学习3","published":1,"updated":"2024-02-06T11:04:48.290Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv43000dpcoc5gvta9vl","content":"<h1 id=\"docker-compose使用\"><a href=\"#docker-compose使用\" class=\"headerlink\" title=\"docker-compose使用\"></a>docker-compose使用</h1><h2 id=\"docker-compose安装\"><a href=\"#docker-compose安装\" class=\"headerlink\" title=\"docker-compose安装\"></a>docker-compose安装</h2>","site":{"data":{}},"length":32,"excerpt":"","more":"<h1 id=\"docker-compose使用\"><a href=\"#docker-compose使用\" class=\"headerlink\" title=\"docker-compose使用\"></a>docker-compose使用</h1><h2 id=\"docker-compose安装\"><a href=\"#docker-compose安装\" class=\"headerlink\" title=\"docker-compose安装\"></a>docker-compose安装</h2>"},{"title":"ansible学习-playbook之nginx配置","abbrlink":"45805688","date":"2024-01-17T07:41:48.000Z","_content":"\n\n```\n---\n- name: install nginx\n  hosts: test\n  gather_facts: yes      \n#  vars:\n#       createuser:\n#        - tomcat\n#        - www\n#        - mysql\n  vars:\n   username: www      \n  tasks:\n   - name: Print ansible_os_family\n     debug:\n   #利用循环创建多个用户\n   # - name: create user\n   #  user: name={{item}} state=present\n   #  with_items: \"{{createuser}}\"     \n   - name: Create Nginx User\n     user: name={{username}} state=present createhome=no shell=/sbin/nologin\n   - name: template config to remote hosts\n     template: src=template/nginx.conf.j2 dest=/etc/nginx/nginx.conf\n#   - name: add virtualhost config\n#      copy: src=my.conf dest=/etc/nginx/conf.d/\n#      tags: updateconfig\n   #检查nginx是否运行\n   - name: check nginx running\n     stat: path=/var/run/nginx.pid\n     register: nginxrunning\n     tags: updateconfig\n   #检查nginx配置文件是否有问题          \n   - name: check nginx syntax\n     command: /usr/sbin/nginx -t\n     register: nginxsyntax   \n     check_mode: False   \n#     changed_when: true\n#     ignore_errors: true   \n     tags: updateconfig\n#删除上一步产生的pid\n#   - name: delete pid\n#     shell: rm -rf /var/run/nginx.pid\n   #debug  nginx状态\n   - name: print nginx syntax\n     debug:\n      var: \"nginxrunning, nginxsyntax\"\n   - name: reload nginx server\n     service: name=nginx state=reloaded\n     when: nginxsyntax.rc == 0  and nginxrunning.stat.exists == true\n     tags: updateconfig     \n   - name: start nginx server\n     service: name=nginx state=started\n     when: \n      - nginxsyntax.rc == 0\n      - nginxrunning.stat.exists == false\n     tags: updateconfig\n     \n\n```","source":"_posts/ansible学习-playbook之nginx配置.md","raw":"---\ntitle: ansible学习-playbook之nginx配置\nabbrlink: '45805688'\ncategories:\n  - 服务器相关\ndate: 2024-01-17 15:41:48\ntags:\n---\n\n\n```\n---\n- name: install nginx\n  hosts: test\n  gather_facts: yes      \n#  vars:\n#       createuser:\n#        - tomcat\n#        - www\n#        - mysql\n  vars:\n   username: www      \n  tasks:\n   - name: Print ansible_os_family\n     debug:\n   #利用循环创建多个用户\n   # - name: create user\n   #  user: name={{item}} state=present\n   #  with_items: \"{{createuser}}\"     \n   - name: Create Nginx User\n     user: name={{username}} state=present createhome=no shell=/sbin/nologin\n   - name: template config to remote hosts\n     template: src=template/nginx.conf.j2 dest=/etc/nginx/nginx.conf\n#   - name: add virtualhost config\n#      copy: src=my.conf dest=/etc/nginx/conf.d/\n#      tags: updateconfig\n   #检查nginx是否运行\n   - name: check nginx running\n     stat: path=/var/run/nginx.pid\n     register: nginxrunning\n     tags: updateconfig\n   #检查nginx配置文件是否有问题          \n   - name: check nginx syntax\n     command: /usr/sbin/nginx -t\n     register: nginxsyntax   \n     check_mode: False   \n#     changed_when: true\n#     ignore_errors: true   \n     tags: updateconfig\n#删除上一步产生的pid\n#   - name: delete pid\n#     shell: rm -rf /var/run/nginx.pid\n   #debug  nginx状态\n   - name: print nginx syntax\n     debug:\n      var: \"nginxrunning, nginxsyntax\"\n   - name: reload nginx server\n     service: name=nginx state=reloaded\n     when: nginxsyntax.rc == 0  and nginxrunning.stat.exists == true\n     tags: updateconfig     \n   - name: start nginx server\n     service: name=nginx state=started\n     when: \n      - nginxsyntax.rc == 0\n      - nginxrunning.stat.exists == false\n     tags: updateconfig\n     \n\n```","slug":"ansible学习-playbook之nginx配置","published":1,"updated":"2024-02-06T11:04:36.948Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv48000jpcochqgketk1","content":"<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">- name: install nginx</span><br><span class=\"line\">  hosts: test</span><br><span class=\"line\">  gather_facts: yes      </span><br><span class=\"line\">#  vars:</span><br><span class=\"line\">#       createuser:</span><br><span class=\"line\">#        - tomcat</span><br><span class=\"line\">#        - www</span><br><span class=\"line\">#        - mysql</span><br><span class=\"line\">  vars:</span><br><span class=\"line\">   username: www      </span><br><span class=\"line\">  tasks:</span><br><span class=\"line\">   - name: Print ansible_os_family</span><br><span class=\"line\">     debug:</span><br><span class=\"line\">   #利用循环创建多个用户</span><br><span class=\"line\">   # - name: create user</span><br><span class=\"line\">   #  user: name=&#123;&#123;item&#125;&#125; state=present</span><br><span class=\"line\">   #  with_items: &quot;&#123;&#123;createuser&#125;&#125;&quot;     </span><br><span class=\"line\">   - name: Create Nginx User</span><br><span class=\"line\">     user: name=&#123;&#123;username&#125;&#125; state=present createhome=no shell=/sbin/nologin</span><br><span class=\"line\">   - name: template config to remote hosts</span><br><span class=\"line\">     template: src=template/nginx.conf.j2 dest=/etc/nginx/nginx.conf</span><br><span class=\"line\">#   - name: add virtualhost config</span><br><span class=\"line\">#      copy: src=my.conf dest=/etc/nginx/conf.d/</span><br><span class=\"line\">#      tags: updateconfig</span><br><span class=\"line\">   #检查nginx是否运行</span><br><span class=\"line\">   - name: check nginx running</span><br><span class=\"line\">     stat: path=/var/run/nginx.pid</span><br><span class=\"line\">     register: nginxrunning</span><br><span class=\"line\">     tags: updateconfig</span><br><span class=\"line\">   #检查nginx配置文件是否有问题          </span><br><span class=\"line\">   - name: check nginx syntax</span><br><span class=\"line\">     command: /usr/sbin/nginx -t</span><br><span class=\"line\">     register: nginxsyntax   </span><br><span class=\"line\">     check_mode: False   </span><br><span class=\"line\">#     changed_when: true</span><br><span class=\"line\">#     ignore_errors: true   </span><br><span class=\"line\">     tags: updateconfig</span><br><span class=\"line\">#删除上一步产生的pid</span><br><span class=\"line\">#   - name: delete pid</span><br><span class=\"line\">#     shell: rm -rf /var/run/nginx.pid</span><br><span class=\"line\">   #debug  nginx状态</span><br><span class=\"line\">   - name: print nginx syntax</span><br><span class=\"line\">     debug:</span><br><span class=\"line\">      var: &quot;nginxrunning, nginxsyntax&quot;</span><br><span class=\"line\">   - name: reload nginx server</span><br><span class=\"line\">     service: name=nginx state=reloaded</span><br><span class=\"line\">     when: nginxsyntax.rc == 0  and nginxrunning.stat.exists == true</span><br><span class=\"line\">     tags: updateconfig     </span><br><span class=\"line\">   - name: start nginx server</span><br><span class=\"line\">     service: name=nginx state=started</span><br><span class=\"line\">     when: </span><br><span class=\"line\">      - nginxsyntax.rc == 0</span><br><span class=\"line\">      - nginxrunning.stat.exists == false</span><br><span class=\"line\">     tags: updateconfig</span><br><span class=\"line\">     </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>","site":{"data":{}},"length":1318,"excerpt":"","more":"<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">- name: install nginx</span><br><span class=\"line\">  hosts: test</span><br><span class=\"line\">  gather_facts: yes      </span><br><span class=\"line\">#  vars:</span><br><span class=\"line\">#       createuser:</span><br><span class=\"line\">#        - tomcat</span><br><span class=\"line\">#        - www</span><br><span class=\"line\">#        - mysql</span><br><span class=\"line\">  vars:</span><br><span class=\"line\">   username: www      </span><br><span class=\"line\">  tasks:</span><br><span class=\"line\">   - name: Print ansible_os_family</span><br><span class=\"line\">     debug:</span><br><span class=\"line\">   #利用循环创建多个用户</span><br><span class=\"line\">   # - name: create user</span><br><span class=\"line\">   #  user: name=&#123;&#123;item&#125;&#125; state=present</span><br><span class=\"line\">   #  with_items: &quot;&#123;&#123;createuser&#125;&#125;&quot;     </span><br><span class=\"line\">   - name: Create Nginx User</span><br><span class=\"line\">     user: name=&#123;&#123;username&#125;&#125; state=present createhome=no shell=/sbin/nologin</span><br><span class=\"line\">   - name: template config to remote hosts</span><br><span class=\"line\">     template: src=template/nginx.conf.j2 dest=/etc/nginx/nginx.conf</span><br><span class=\"line\">#   - name: add virtualhost config</span><br><span class=\"line\">#      copy: src=my.conf dest=/etc/nginx/conf.d/</span><br><span class=\"line\">#      tags: updateconfig</span><br><span class=\"line\">   #检查nginx是否运行</span><br><span class=\"line\">   - name: check nginx running</span><br><span class=\"line\">     stat: path=/var/run/nginx.pid</span><br><span class=\"line\">     register: nginxrunning</span><br><span class=\"line\">     tags: updateconfig</span><br><span class=\"line\">   #检查nginx配置文件是否有问题          </span><br><span class=\"line\">   - name: check nginx syntax</span><br><span class=\"line\">     command: /usr/sbin/nginx -t</span><br><span class=\"line\">     register: nginxsyntax   </span><br><span class=\"line\">     check_mode: False   </span><br><span class=\"line\">#     changed_when: true</span><br><span class=\"line\">#     ignore_errors: true   </span><br><span class=\"line\">     tags: updateconfig</span><br><span class=\"line\">#删除上一步产生的pid</span><br><span class=\"line\">#   - name: delete pid</span><br><span class=\"line\">#     shell: rm -rf /var/run/nginx.pid</span><br><span class=\"line\">   #debug  nginx状态</span><br><span class=\"line\">   - name: print nginx syntax</span><br><span class=\"line\">     debug:</span><br><span class=\"line\">      var: &quot;nginxrunning, nginxsyntax&quot;</span><br><span class=\"line\">   - name: reload nginx server</span><br><span class=\"line\">     service: name=nginx state=reloaded</span><br><span class=\"line\">     when: nginxsyntax.rc == 0  and nginxrunning.stat.exists == true</span><br><span class=\"line\">     tags: updateconfig     </span><br><span class=\"line\">   - name: start nginx server</span><br><span class=\"line\">     service: name=nginx state=started</span><br><span class=\"line\">     when: </span><br><span class=\"line\">      - nginxsyntax.rc == 0</span><br><span class=\"line\">      - nginxrunning.stat.exists == false</span><br><span class=\"line\">     tags: updateconfig</span><br><span class=\"line\">     </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>"},{"abbrlink":"709a4555","_content":"---\ntitle: git总结\ndate: 2022-01-08 22:19:16\ntags:\n--- \n# 一、基础知识\n\n    工作区(workspace)      就是你平时存放项目代码的地方\n    暂存区(stage)          git add\n    仓库区/版本库(Repository)     git commit\n    远程仓库\n\n# 二、回退问题\n## 1.git add 后回退\n\ngit status 先看一下add 中的文件\ngit reset HEAD 如果后面什么都不跟的话 就是上一次add 里面的全部撤销了\ngit reset HEAD XXX/XXX/XXX.java 就是对某个文件进行撤销了\n\n\n## 2.git commit后回退\n\n    git log    命令显示从最近到最远的提交日志\n\n        [root@localhost test-jenkins]# git log\n        commit e2c7f2d567cbdc36e4503479e15ea51d19816d33\n        Author: root <root@localhost.localdomain>\n        Date:   Fri Jan 7 11:17:27 2022 +0800\n\n        dev branch change\n\n        commit 8943166480734ac5a760e482a887ee8da0140ec8\n        Author: root <root@localhost.localdomain>\n        Date:   Fri Jan 7 10:56:22 2022 +0800\n\n        dev branch add index.php\n        。。。。\n\n    git reest --hard  commit_id\n                      上一个版本就是HEAD^，\n                      上上一个版本就是HEAD^^，\n                      当然往上100个版本写100个^比较容易数不过来，\n                      所以写成HEAD~100。\n    例：\n        git reset --hard 139dcfaa558e3276b30b6b2e5cbbb9c00bbdca96\n        git reset --hard HEAD^\n\n    将会删除此版本之前添加\n\n    强制push到对应的远程分支（如提交到develop分支）\n    git push -f -u origin develop\n\n\n## 3.回退后悔药\n\ngit reflog用来记录你的每一次命令\n\n    [root@localhost test-jenkins]# git reflog\n    8943166 HEAD@{0}: reset: moving to 8943166480734ac5a760e482a887ee8da0140ec8\n    e2c7f2d HEAD@{1}: commit: dev branch change\n    8943166 HEAD@{2}: commit: dev branch add index.php\n    1ca6f06 HEAD@{3}: checkout: moving from release to dev\n    1ca6f06 HEAD@{4}: pull origin release: Fast-forward\n    14fbb47 HEAD@{5}: checkout: moving from master to release\n    14fbb47 HEAD@{6}: clone: from ssh://git@117.89.131.220:44222/zhaoyoushui/test-jenkins.git\n\n    git reset --hard e2c7f2d\n\n## 4.已经提交远程分支\n\ngit reset 方法回退\n拉过的错误版本的本地分支  多需要回退\n回退  强制推送  远程\n\ngit revert 版本号\ngit revert HEAD 上个版本\ngit revert HEAD~n 上n个版本\ngit push 远程\n其他客户端正常拉取就可以\n\n\n# 三、Git Reset 三种模式\n\n--hard: 会清空工作目录和暂存区的改动\n        \n        git reset --hard  c3b320427ad2560140e20af23225d803b2fed6e0\n        \n<font color=\"red\">--soft：保留工作目录，并把重置 HEAD 所带来的新的差异放进暂存区  **变得只是仓库区**</font>\n    \n        git reset --soft  c3b320427ad2560140e20af23225d803b2fed6e0\n        \n--mixed reset 不加参数(mixed)：保留工作目录，并清空暂存区\n        \n        git reset c3b320427ad2560140e20af23225d803b2fed6e0\n\n# 四、修改远程url\n\n    1.方法一\n        git remote set-url origin [url]\n        git remote -v 查看\n    \n    2.方法二\n        git remote rm origin\n        git remote add origin [url]\n        git remote -v 查看\n    \n    3.方法三\n        直接修改config 文件\n\n# 五、常用命令\n\ngit branch  :查看本地所有分钟\n    \n    示例 ：git branch\n\ngit branch -a ：查看所有分支 包括远程\n\n    示例：git branch -a \n\ngit branch 【分支名]：新建分支\n\n    示例：git branch  dev\n    \ngit branch  -d 【分支名】    删除分支\n    \n    示例 : git branch  -d  test\n\ngit branch -D 【分支名】     强制删除 分支\n\n    示例 : git branch  -D  test\n\ngit merge 【分支名】 ：合并分支，到当前分支\n    \n    示例：git merge dev\n\ngit checkout 【分支名】：切换到那个分支\n\n    示例：git checkout dev\n\n<font color=\"red\">git checkout -b 【分支名】 【远程分支名】：新建一个分支，来自远程分支</font>\n    \n    示例：git checkout -b  dev origin/dev\n    \n    \n    ","source":"_posts/git总结.md","raw":"---\nabbrlink: 709a4555\n---\n---\ntitle: git总结\ndate: 2022-01-08 22:19:16\ntags:\n--- \n# 一、基础知识\n\n    工作区(workspace)      就是你平时存放项目代码的地方\n    暂存区(stage)          git add\n    仓库区/版本库(Repository)     git commit\n    远程仓库\n\n# 二、回退问题\n## 1.git add 后回退\n\ngit status 先看一下add 中的文件\ngit reset HEAD 如果后面什么都不跟的话 就是上一次add 里面的全部撤销了\ngit reset HEAD XXX/XXX/XXX.java 就是对某个文件进行撤销了\n\n\n## 2.git commit后回退\n\n    git log    命令显示从最近到最远的提交日志\n\n        [root@localhost test-jenkins]# git log\n        commit e2c7f2d567cbdc36e4503479e15ea51d19816d33\n        Author: root <root@localhost.localdomain>\n        Date:   Fri Jan 7 11:17:27 2022 +0800\n\n        dev branch change\n\n        commit 8943166480734ac5a760e482a887ee8da0140ec8\n        Author: root <root@localhost.localdomain>\n        Date:   Fri Jan 7 10:56:22 2022 +0800\n\n        dev branch add index.php\n        。。。。\n\n    git reest --hard  commit_id\n                      上一个版本就是HEAD^，\n                      上上一个版本就是HEAD^^，\n                      当然往上100个版本写100个^比较容易数不过来，\n                      所以写成HEAD~100。\n    例：\n        git reset --hard 139dcfaa558e3276b30b6b2e5cbbb9c00bbdca96\n        git reset --hard HEAD^\n\n    将会删除此版本之前添加\n\n    强制push到对应的远程分支（如提交到develop分支）\n    git push -f -u origin develop\n\n\n## 3.回退后悔药\n\ngit reflog用来记录你的每一次命令\n\n    [root@localhost test-jenkins]# git reflog\n    8943166 HEAD@{0}: reset: moving to 8943166480734ac5a760e482a887ee8da0140ec8\n    e2c7f2d HEAD@{1}: commit: dev branch change\n    8943166 HEAD@{2}: commit: dev branch add index.php\n    1ca6f06 HEAD@{3}: checkout: moving from release to dev\n    1ca6f06 HEAD@{4}: pull origin release: Fast-forward\n    14fbb47 HEAD@{5}: checkout: moving from master to release\n    14fbb47 HEAD@{6}: clone: from ssh://git@117.89.131.220:44222/zhaoyoushui/test-jenkins.git\n\n    git reset --hard e2c7f2d\n\n## 4.已经提交远程分支\n\ngit reset 方法回退\n拉过的错误版本的本地分支  多需要回退\n回退  强制推送  远程\n\ngit revert 版本号\ngit revert HEAD 上个版本\ngit revert HEAD~n 上n个版本\ngit push 远程\n其他客户端正常拉取就可以\n\n\n# 三、Git Reset 三种模式\n\n--hard: 会清空工作目录和暂存区的改动\n        \n        git reset --hard  c3b320427ad2560140e20af23225d803b2fed6e0\n        \n<font color=\"red\">--soft：保留工作目录，并把重置 HEAD 所带来的新的差异放进暂存区  **变得只是仓库区**</font>\n    \n        git reset --soft  c3b320427ad2560140e20af23225d803b2fed6e0\n        \n--mixed reset 不加参数(mixed)：保留工作目录，并清空暂存区\n        \n        git reset c3b320427ad2560140e20af23225d803b2fed6e0\n\n# 四、修改远程url\n\n    1.方法一\n        git remote set-url origin [url]\n        git remote -v 查看\n    \n    2.方法二\n        git remote rm origin\n        git remote add origin [url]\n        git remote -v 查看\n    \n    3.方法三\n        直接修改config 文件\n\n# 五、常用命令\n\ngit branch  :查看本地所有分钟\n    \n    示例 ：git branch\n\ngit branch -a ：查看所有分支 包括远程\n\n    示例：git branch -a \n\ngit branch 【分支名]：新建分支\n\n    示例：git branch  dev\n    \ngit branch  -d 【分支名】    删除分支\n    \n    示例 : git branch  -d  test\n\ngit branch -D 【分支名】     强制删除 分支\n\n    示例 : git branch  -D  test\n\ngit merge 【分支名】 ：合并分支，到当前分支\n    \n    示例：git merge dev\n\ngit checkout 【分支名】：切换到那个分支\n\n    示例：git checkout dev\n\n<font color=\"red\">git checkout -b 【分支名】 【远程分支名】：新建一个分支，来自远程分支</font>\n    \n    示例：git checkout -b  dev origin/dev\n    \n    \n    ","slug":"git总结","published":1,"date":"2023-07-26T07:56:35.814Z","updated":"2024-02-06T05:50:34.834Z","title":"","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv48000lpcoc59fe0xnj","content":"<hr>\n<p>title: git总结<br>date: 2022-01-08 22:19:16<br>tags:</p>\n<hr>\n<h1 id=\"一、基础知识\"><a href=\"#一、基础知识\" class=\"headerlink\" title=\"一、基础知识\"></a>一、基础知识</h1><pre><code>工作区(workspace)      就是你平时存放项目代码的地方\n暂存区(stage)          git add\n仓库区/版本库(Repository)     git commit\n远程仓库\n</code></pre>\n<h1 id=\"二、回退问题\"><a href=\"#二、回退问题\" class=\"headerlink\" title=\"二、回退问题\"></a>二、回退问题</h1><h2 id=\"1-git-add-后回退\"><a href=\"#1-git-add-后回退\" class=\"headerlink\" title=\"1.git add 后回退\"></a>1.git add 后回退</h2><p>git status 先看一下add 中的文件<br>git reset HEAD 如果后面什么都不跟的话 就是上一次add 里面的全部撤销了<br>git reset HEAD XXX/XXX/XXX.java 就是对某个文件进行撤销了</p>\n<h2 id=\"2-git-commit后回退\"><a href=\"#2-git-commit后回退\" class=\"headerlink\" title=\"2.git commit后回退\"></a>2.git commit后回退</h2><pre><code>git log    命令显示从最近到最远的提交日志\n\n    [root@localhost test-jenkins]# git log\n    commit e2c7f2d567cbdc36e4503479e15ea51d19816d33\n    Author: root &lt;root@localhost.localdomain&gt;\n    Date:   Fri Jan 7 11:17:27 2022 +0800\n\n    dev branch change\n\n    commit 8943166480734ac5a760e482a887ee8da0140ec8\n    Author: root &lt;root@localhost.localdomain&gt;\n    Date:   Fri Jan 7 10:56:22 2022 +0800\n\n    dev branch add index.php\n    。。。。\n\ngit reest --hard  commit_id\n                  上一个版本就是HEAD^，\n                  上上一个版本就是HEAD^^，\n                  当然往上100个版本写100个^比较容易数不过来，\n                  所以写成HEAD~100。\n例：\n    git reset --hard 139dcfaa558e3276b30b6b2e5cbbb9c00bbdca96\n    git reset --hard HEAD^\n\n将会删除此版本之前添加\n\n强制push到对应的远程分支（如提交到develop分支）\ngit push -f -u origin develop\n</code></pre>\n<h2 id=\"3-回退后悔药\"><a href=\"#3-回退后悔药\" class=\"headerlink\" title=\"3.回退后悔药\"></a>3.回退后悔药</h2><p>git reflog用来记录你的每一次命令</p>\n<pre><code>[root@localhost test-jenkins]# git reflog\n8943166 HEAD@&#123;0&#125;: reset: moving to 8943166480734ac5a760e482a887ee8da0140ec8\ne2c7f2d HEAD@&#123;1&#125;: commit: dev branch change\n8943166 HEAD@&#123;2&#125;: commit: dev branch add index.php\n1ca6f06 HEAD@&#123;3&#125;: checkout: moving from release to dev\n1ca6f06 HEAD@&#123;4&#125;: pull origin release: Fast-forward\n14fbb47 HEAD@&#123;5&#125;: checkout: moving from master to release\n14fbb47 HEAD@&#123;6&#125;: clone: from ssh://git@117.89.131.220:44222/zhaoyoushui/test-jenkins.git\n\ngit reset --hard e2c7f2d\n</code></pre>\n<h2 id=\"4-已经提交远程分支\"><a href=\"#4-已经提交远程分支\" class=\"headerlink\" title=\"4.已经提交远程分支\"></a>4.已经提交远程分支</h2><p>git reset 方法回退<br>拉过的错误版本的本地分支  多需要回退<br>回退  强制推送  远程</p>\n<p>git revert 版本号<br>git revert HEAD 上个版本<br>git revert HEAD~n 上n个版本<br>git push 远程<br>其他客户端正常拉取就可以</p>\n<h1 id=\"三、Git-Reset-三种模式\"><a href=\"#三、Git-Reset-三种模式\" class=\"headerlink\" title=\"三、Git Reset 三种模式\"></a>三、Git Reset 三种模式</h1><p>–hard: 会清空工作目录和暂存区的改动</p>\n<pre><code>    git reset --hard  c3b320427ad2560140e20af23225d803b2fed6e0\n    \n</code></pre>\n<p><font color=\"red\">–soft：保留工作目录，并把重置 HEAD 所带来的新的差异放进暂存区  <strong>变得只是仓库区</strong></font></p>\n<pre><code>    git reset --soft  c3b320427ad2560140e20af23225d803b2fed6e0\n    \n</code></pre>\n<p>–mixed reset 不加参数(mixed)：保留工作目录，并清空暂存区</p>\n<pre><code>    git reset c3b320427ad2560140e20af23225d803b2fed6e0\n</code></pre>\n<h1 id=\"四、修改远程url\"><a href=\"#四、修改远程url\" class=\"headerlink\" title=\"四、修改远程url\"></a>四、修改远程url</h1><pre><code>1.方法一\n    git remote set-url origin [url]\n    git remote -v 查看\n\n2.方法二\n    git remote rm origin\n    git remote add origin [url]\n    git remote -v 查看\n\n3.方法三\n    直接修改config 文件\n</code></pre>\n<h1 id=\"五、常用命令\"><a href=\"#五、常用命令\" class=\"headerlink\" title=\"五、常用命令\"></a>五、常用命令</h1><p>git branch  :查看本地所有分钟</p>\n<pre><code>示例 ：git branch\n</code></pre>\n<p>git branch -a ：查看所有分支 包括远程</p>\n<pre><code>示例：git branch -a \n</code></pre>\n<p>git branch 【分支名]：新建分支</p>\n<pre><code>示例：git branch  dev\n</code></pre>\n<p>git branch  -d 【分支名】    删除分支</p>\n<pre><code>示例 : git branch  -d  test\n</code></pre>\n<p>git branch -D 【分支名】     强制删除 分支</p>\n<pre><code>示例 : git branch  -D  test\n</code></pre>\n<p>git merge 【分支名】 ：合并分支，到当前分支</p>\n<pre><code>示例：git merge dev\n</code></pre>\n<p>git checkout 【分支名】：切换到那个分支</p>\n<pre><code>示例：git checkout dev\n</code></pre>\n<p><font color=\"red\">git checkout -b 【分支名】 【远程分支名】：新建一个分支，来自远程分支</font></p>\n<pre><code>示例：git checkout -b  dev origin/dev\n</code></pre>\n","site":{"data":{}},"length":2195,"excerpt":"","more":"<hr>\n<p>title: git总结<br>date: 2022-01-08 22:19:16<br>tags:</p>\n<hr>\n<h1 id=\"一、基础知识\"><a href=\"#一、基础知识\" class=\"headerlink\" title=\"一、基础知识\"></a>一、基础知识</h1><pre><code>工作区(workspace)      就是你平时存放项目代码的地方\n暂存区(stage)          git add\n仓库区/版本库(Repository)     git commit\n远程仓库\n</code></pre>\n<h1 id=\"二、回退问题\"><a href=\"#二、回退问题\" class=\"headerlink\" title=\"二、回退问题\"></a>二、回退问题</h1><h2 id=\"1-git-add-后回退\"><a href=\"#1-git-add-后回退\" class=\"headerlink\" title=\"1.git add 后回退\"></a>1.git add 后回退</h2><p>git status 先看一下add 中的文件<br>git reset HEAD 如果后面什么都不跟的话 就是上一次add 里面的全部撤销了<br>git reset HEAD XXX/XXX/XXX.java 就是对某个文件进行撤销了</p>\n<h2 id=\"2-git-commit后回退\"><a href=\"#2-git-commit后回退\" class=\"headerlink\" title=\"2.git commit后回退\"></a>2.git commit后回退</h2><pre><code>git log    命令显示从最近到最远的提交日志\n\n    [root@localhost test-jenkins]# git log\n    commit e2c7f2d567cbdc36e4503479e15ea51d19816d33\n    Author: root &lt;root@localhost.localdomain&gt;\n    Date:   Fri Jan 7 11:17:27 2022 +0800\n\n    dev branch change\n\n    commit 8943166480734ac5a760e482a887ee8da0140ec8\n    Author: root &lt;root@localhost.localdomain&gt;\n    Date:   Fri Jan 7 10:56:22 2022 +0800\n\n    dev branch add index.php\n    。。。。\n\ngit reest --hard  commit_id\n                  上一个版本就是HEAD^，\n                  上上一个版本就是HEAD^^，\n                  当然往上100个版本写100个^比较容易数不过来，\n                  所以写成HEAD~100。\n例：\n    git reset --hard 139dcfaa558e3276b30b6b2e5cbbb9c00bbdca96\n    git reset --hard HEAD^\n\n将会删除此版本之前添加\n\n强制push到对应的远程分支（如提交到develop分支）\ngit push -f -u origin develop\n</code></pre>\n<h2 id=\"3-回退后悔药\"><a href=\"#3-回退后悔药\" class=\"headerlink\" title=\"3.回退后悔药\"></a>3.回退后悔药</h2><p>git reflog用来记录你的每一次命令</p>\n<pre><code>[root@localhost test-jenkins]# git reflog\n8943166 HEAD@&#123;0&#125;: reset: moving to 8943166480734ac5a760e482a887ee8da0140ec8\ne2c7f2d HEAD@&#123;1&#125;: commit: dev branch change\n8943166 HEAD@&#123;2&#125;: commit: dev branch add index.php\n1ca6f06 HEAD@&#123;3&#125;: checkout: moving from release to dev\n1ca6f06 HEAD@&#123;4&#125;: pull origin release: Fast-forward\n14fbb47 HEAD@&#123;5&#125;: checkout: moving from master to release\n14fbb47 HEAD@&#123;6&#125;: clone: from ssh://git@117.89.131.220:44222/zhaoyoushui/test-jenkins.git\n\ngit reset --hard e2c7f2d\n</code></pre>\n<h2 id=\"4-已经提交远程分支\"><a href=\"#4-已经提交远程分支\" class=\"headerlink\" title=\"4.已经提交远程分支\"></a>4.已经提交远程分支</h2><p>git reset 方法回退<br>拉过的错误版本的本地分支  多需要回退<br>回退  强制推送  远程</p>\n<p>git revert 版本号<br>git revert HEAD 上个版本<br>git revert HEAD~n 上n个版本<br>git push 远程<br>其他客户端正常拉取就可以</p>\n<h1 id=\"三、Git-Reset-三种模式\"><a href=\"#三、Git-Reset-三种模式\" class=\"headerlink\" title=\"三、Git Reset 三种模式\"></a>三、Git Reset 三种模式</h1><p>–hard: 会清空工作目录和暂存区的改动</p>\n<pre><code>    git reset --hard  c3b320427ad2560140e20af23225d803b2fed6e0\n    \n</code></pre>\n<p><font color=\"red\">–soft：保留工作目录，并把重置 HEAD 所带来的新的差异放进暂存区  <strong>变得只是仓库区</strong></font></p>\n<pre><code>    git reset --soft  c3b320427ad2560140e20af23225d803b2fed6e0\n    \n</code></pre>\n<p>–mixed reset 不加参数(mixed)：保留工作目录，并清空暂存区</p>\n<pre><code>    git reset c3b320427ad2560140e20af23225d803b2fed6e0\n</code></pre>\n<h1 id=\"四、修改远程url\"><a href=\"#四、修改远程url\" class=\"headerlink\" title=\"四、修改远程url\"></a>四、修改远程url</h1><pre><code>1.方法一\n    git remote set-url origin [url]\n    git remote -v 查看\n\n2.方法二\n    git remote rm origin\n    git remote add origin [url]\n    git remote -v 查看\n\n3.方法三\n    直接修改config 文件\n</code></pre>\n<h1 id=\"五、常用命令\"><a href=\"#五、常用命令\" class=\"headerlink\" title=\"五、常用命令\"></a>五、常用命令</h1><p>git branch  :查看本地所有分钟</p>\n<pre><code>示例 ：git branch\n</code></pre>\n<p>git branch -a ：查看所有分支 包括远程</p>\n<pre><code>示例：git branch -a \n</code></pre>\n<p>git branch 【分支名]：新建分支</p>\n<pre><code>示例：git branch  dev\n</code></pre>\n<p>git branch  -d 【分支名】    删除分支</p>\n<pre><code>示例 : git branch  -d  test\n</code></pre>\n<p>git branch -D 【分支名】     强制删除 分支</p>\n<pre><code>示例 : git branch  -D  test\n</code></pre>\n<p>git merge 【分支名】 ：合并分支，到当前分支</p>\n<pre><code>示例：git merge dev\n</code></pre>\n<p>git checkout 【分支名】：切换到那个分支</p>\n<pre><code>示例：git checkout dev\n</code></pre>\n<p><font color=\"red\">git checkout -b 【分支名】 【远程分支名】：新建一个分支，来自远程分支</font></p>\n<pre><code>示例：git checkout -b  dev origin/dev\n</code></pre>\n"},{"abbrlink":"3820734e","_content":"---\ntitle: 搭建git服务（适用小团队开发）\ndate: 2022-04-13 22:14:23\ncategories: # 分类\n- server\ntags:\n--- #标签\n- git\n#添加账号\n    useradd git \n\n    useradd -g git test \n    passwd test\n\n    cd /home/git/\n#创建项目\n    git init --bare 项目名称.git\n\n#配置权限\n    cd /home/git/项目名称.git\n\n    git config core.sharedRepository 0770\n\n\n第二种方法 公钥 方法\n","source":"_posts/git-server.md","raw":"---\nabbrlink: 3820734e\n---\n---\ntitle: 搭建git服务（适用小团队开发）\ndate: 2022-04-13 22:14:23\ncategories: # 分类\n- server\ntags:\n--- #标签\n- git\n#添加账号\n    useradd git \n\n    useradd -g git test \n    passwd test\n\n    cd /home/git/\n#创建项目\n    git init --bare 项目名称.git\n\n#配置权限\n    cd /home/git/项目名称.git\n\n    git config core.sharedRepository 0770\n\n\n第二种方法 公钥 方法\n","slug":"git-server","published":1,"date":"2022-04-26T06:59:26.687Z","updated":"2024-02-06T05:50:34.827Z","title":"","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv49000opcoc9vrs48bz","content":"<hr>\n<p>title: 搭建git服务（适用小团队开发）<br>date: 2022-04-13 22:14:23<br>categories: # 分类</p>\n<ul>\n<li><p>server<br>tags:</p>\n</li>\n<li><p>– #标签</p>\n</li>\n<li><p>git<br>#添加账号<br>  useradd git </p>\n<p>  useradd -g git test<br>  passwd test</p>\n<p>  cd /home/git/<br>#创建项目<br>  git init –bare 项目名称.git</p>\n</li>\n</ul>\n<p>#配置权限<br>    cd /home/git/项目名称.git</p>\n<pre><code>git config core.sharedRepository 0770\n</code></pre>\n<p>第二种方法 公钥 方法</p>\n","site":{"data":{}},"length":223,"excerpt":"","more":"<hr>\n<p>title: 搭建git服务（适用小团队开发）<br>date: 2022-04-13 22:14:23<br>categories: # 分类</p>\n<ul>\n<li><p>server<br>tags:</p>\n</li>\n<li><p>– #标签</p>\n</li>\n<li><p>git<br>#添加账号<br>  useradd git </p>\n<p>  useradd -g git test<br>  passwd test</p>\n<p>  cd /home/git/<br>#创建项目<br>  git init –bare 项目名称.git</p>\n</li>\n</ul>\n<p>#配置权限<br>    cd /home/git/项目名称.git</p>\n<pre><code>git config core.sharedRepository 0770\n</code></pre>\n<p>第二种方法 公钥 方法</p>\n"},{"title":"ansible学习","abbrlink":"901bc739","date":"2023-12-01T11:48:14.000Z","_content":"\n## 一、安装\n\n yum install -y epel-release\n \n yum install -y ansible\n \n ansible配置文件：\n \n    /etc/ansible/ansible.cfg\n    /etc/ansible/hosts\n    \n 生成秘钥：\n \n    ssh-keygen -t rsa  #在/root/.ssh/目录下生成秘钥\n    #被控端：(复制主机端公钥到被控端)\n    ssh-copy-id -i /root/.ssh/id_rsa.pub root@192.168.7.99 \n    ssh-copy-id  被控端ip\n   \n## 二、管理服务器：Inventory文件 \n \n用于管理主机与主机组的文件 也叫主机清单\n默认文件  /etc/ansible/hosts 最好不要用这  不然一不小心  没指定hosts 就执行这个了\n\n文件示例\n```\n[gs]\ngs157 ansible_ssh_host=1.11.1.11 ansible_ssh_port=65022\n[remote]\nkh251 ansible_ssh_host=2.22.222.2\n```\n    \n    \n## 三、基础命令\n\n###  常用命令\n\n查看具体主机配置\n\n    grep -v ^# /etc/ansible/hosts |grep -v ^$\n    \n    ansible all --list-host     \n\n### 基础参数\n    \n-m 指定模块【command copy shell】\n<font color=\"red\">   忽略时，就默认是 -m command </font>\n   \n    示例：  ansible -i ./hosts -a ifconfig  test\n   \n-a 模块中使用的参数\n\n    示例：  ansible -i ./hosts -m shell -a \"free -mh\"  test\n    \n-i 指定hosts文件\n\n    示例  ansible -i ./hosts -m ping test\n\n###  检查能否在受管主机上运行python模块\n    ansible host-pattern -m module [-a 'module arguments'] [-i inventory]\n    示例\n        ansible gsweb -m ping\n        \n        ansible -i /etc/ansible/hosts gsweb -m ping\n\n       \n### command模块 \n    执行shell命令\n    -m 不使用 默认使用command模块\n    \n    ansible -m command -a \"frem -mh\" test   \n    \n    ansible -m command -a \"frem -mh\" test     \n    \n    ansible  -a \"frem -mh\" test \n### shell模块    \n\n 与command模块有些相似,但是command 有些命令无法执行\n    \n  命令行示例\n    \n     ansible -m shell -a \"cat /etc/*release\" test\n    \n### copy模块\n\n   参数\n    \n    src：    待copy的文件或目录\n    \n    dest：   目标copy到远程主机的具体目录（必要参数）\n    \n    owner：  目标copy到远程主机后的属主（远程主机上必须有对应的用户，否则报错）\n    \n    group：  目标copy到远程主机后的属组（远程主机上必须有对应的组，否则报错）\n    \n    mode：   目标copy到远程主机后的权限\n\n    content： 若不用src指定拷贝的文件，必须用content直接指定文件内容，2选一。 \n    \n    force：   当远程主机的目标路径中已经存在同名文件，并且与ansible主机中的文件内容不同时，\n              是否强制覆盖，可选值有yes和no。默认值为yes，表示覆盖，\n              如果设置为no，则不会执行覆盖拷贝操作，远程主机中的文件保持不变。\n              \n    backup：  当远程主机的目标路径中已经存在同名文件，并且与ansible主机中的文件内容不同时，\n              是否对远程主机的文件进行备份，\n              可选值有yes和no，当设置为yes时，会先备份远程主机中的文件，\n              然后再将ansible主机中的文件拷贝到远程主机。\n    \n\n   命令行 示例\n   \n       ansible khweb  -m copy -a \"src=/home/soft/node_exporter-1.6.1.linux-amd64.tar.gz  dest=/home/soft/  backup=yes mode=644\"\n\n   playbook 示例\n   \n       - name: Copy a file from local to remote\n         copy:\n          src: /path/to/local/file.txt\n          dest: /path/to/remote/file.txt\n          \n          \n       - name: \"copy files\"\n             copy:\n             src: \"{{ item.src }}\"\n             dest: \"{{ item.dest }}\"\n             owner: root\n             group: root\n             mode: 755\n             with_items:\n                - {src: \"/root/aaa.txt\", dest: \"/tmp\" }\n                - {src: \"/root/bbb.txt\", dest: \"/tmp\" }\n \n   \n### setup模块\n\n### file模块\n\n### debug模块\n\n### yum模块\n\n### user模块\n\n### register模块\n    \n register 捕获 task 的输出，并将它保存到一个变量中，方便在以后的任务中调用\n     \n change： 表示执行命令的状态，如果命令执行了，则为 true；\n \n cmd： 表示的则是你当前执行的命令；\n \n delta： 表示命令执行所花费的时间\n \n start： 表示命令开始执行的时间\n \n end： 表示命令结束的时间\n \n failed： 表示命令执行的结果，如果为 false 则表示命令执行成功，true 则表示命令执行失败\n \n rc： 表示命令执行的返回码（return code），0 表示执行成功；\n \n stderr：命令输出的标准错误信息\n \n stderr_lines： 按换行符分割输出的内容，在多行输出时，显示的效果比 stderr 更加直观\n \n stdout： 命令的标准输出信息\n \n stdout_lines： 按换行符分割输出的内容，在多行输出时，结果更加直观    \n     \n    示例：\n    - name: View the logged in user name\n      shell: whoami\n      register: user\n    - debug:\n        var: user  \n         \n    - name: check nginx running\n       stat: path=/var/run/nginx.pid\n       register: nginxrunning   \n    - name: check nginx syntax\n      shell: /usr/sbin/nginx -t\n      register: nginxsyntax\n    # check_mode  true  -C测试 会跳过\n      check_mode: false\n      debug:\n        var: \"nginxsyntax,nginxrunning\"\n    - name: reload nginx server\n      service: name=nginx state=reloaded\n      when: nginxsyntax.rc == 0  and nginxrunning.stat.exists == true   \n        \n        \n    \n## when模块\n## debug与when连用\n##  剧本（Playbooks）\n    \n    Playbook可以运行多个任务，并提供一些更高级的功能。\n    让我们将上述任务移到一本剧本中。在ansible中剧本（playbooks）和角色（roles）都使用Yaml文件定义\n\n### 常用标签\n\n    gather_facts: no\n    只要是使用了ansible-playbook，默认情况，第 1 个步骤总是执行 Gathering Facts 这个TASK \n    这个主要收集目标主机的常用信息，如：主机名、内核版本、网卡接口、IP 地址、操作系统版本、CPU、内存、磁盘 等等\n\n    tag标签可以单独使用\n    #启动nginx\n        - name: start nginx server\n          service: name=nginx state=started\n          when: \n            - nginxsyntax.rc == 0\n            - nginxrunning.stat.exists == false\n          tags: updateconfig\n          \n     ansible-playbook -i hosts site.yml -t updateconfig     \n          \n    通过debug模块去确认返回结果的数据结构   \n    - name: print nginx syntax result\n      debug: var=nginxsyntax   \n### 定义变量 循环示例\n\n     vars:\n        createuser:\n          - tomcat\n          - www\n          - mysql\n          \n      tasks:\n       #利用循环创建多个用户\n        - name: create user\n          user: name={{item}} state=present\n          with_items: \"{{createuser}}\"\n\n","source":"_posts/ansible学习.md","raw":"---\ntitle: ansible学习\nabbrlink: 901bc739\ncategories:\n  - 服务器相关\ndate: 2023-12-01 19:48:14\ntags:\n---\n\n## 一、安装\n\n yum install -y epel-release\n \n yum install -y ansible\n \n ansible配置文件：\n \n    /etc/ansible/ansible.cfg\n    /etc/ansible/hosts\n    \n 生成秘钥：\n \n    ssh-keygen -t rsa  #在/root/.ssh/目录下生成秘钥\n    #被控端：(复制主机端公钥到被控端)\n    ssh-copy-id -i /root/.ssh/id_rsa.pub root@192.168.7.99 \n    ssh-copy-id  被控端ip\n   \n## 二、管理服务器：Inventory文件 \n \n用于管理主机与主机组的文件 也叫主机清单\n默认文件  /etc/ansible/hosts 最好不要用这  不然一不小心  没指定hosts 就执行这个了\n\n文件示例\n```\n[gs]\ngs157 ansible_ssh_host=1.11.1.11 ansible_ssh_port=65022\n[remote]\nkh251 ansible_ssh_host=2.22.222.2\n```\n    \n    \n## 三、基础命令\n\n###  常用命令\n\n查看具体主机配置\n\n    grep -v ^# /etc/ansible/hosts |grep -v ^$\n    \n    ansible all --list-host     \n\n### 基础参数\n    \n-m 指定模块【command copy shell】\n<font color=\"red\">   忽略时，就默认是 -m command </font>\n   \n    示例：  ansible -i ./hosts -a ifconfig  test\n   \n-a 模块中使用的参数\n\n    示例：  ansible -i ./hosts -m shell -a \"free -mh\"  test\n    \n-i 指定hosts文件\n\n    示例  ansible -i ./hosts -m ping test\n\n###  检查能否在受管主机上运行python模块\n    ansible host-pattern -m module [-a 'module arguments'] [-i inventory]\n    示例\n        ansible gsweb -m ping\n        \n        ansible -i /etc/ansible/hosts gsweb -m ping\n\n       \n### command模块 \n    执行shell命令\n    -m 不使用 默认使用command模块\n    \n    ansible -m command -a \"frem -mh\" test   \n    \n    ansible -m command -a \"frem -mh\" test     \n    \n    ansible  -a \"frem -mh\" test \n### shell模块    \n\n 与command模块有些相似,但是command 有些命令无法执行\n    \n  命令行示例\n    \n     ansible -m shell -a \"cat /etc/*release\" test\n    \n### copy模块\n\n   参数\n    \n    src：    待copy的文件或目录\n    \n    dest：   目标copy到远程主机的具体目录（必要参数）\n    \n    owner：  目标copy到远程主机后的属主（远程主机上必须有对应的用户，否则报错）\n    \n    group：  目标copy到远程主机后的属组（远程主机上必须有对应的组，否则报错）\n    \n    mode：   目标copy到远程主机后的权限\n\n    content： 若不用src指定拷贝的文件，必须用content直接指定文件内容，2选一。 \n    \n    force：   当远程主机的目标路径中已经存在同名文件，并且与ansible主机中的文件内容不同时，\n              是否强制覆盖，可选值有yes和no。默认值为yes，表示覆盖，\n              如果设置为no，则不会执行覆盖拷贝操作，远程主机中的文件保持不变。\n              \n    backup：  当远程主机的目标路径中已经存在同名文件，并且与ansible主机中的文件内容不同时，\n              是否对远程主机的文件进行备份，\n              可选值有yes和no，当设置为yes时，会先备份远程主机中的文件，\n              然后再将ansible主机中的文件拷贝到远程主机。\n    \n\n   命令行 示例\n   \n       ansible khweb  -m copy -a \"src=/home/soft/node_exporter-1.6.1.linux-amd64.tar.gz  dest=/home/soft/  backup=yes mode=644\"\n\n   playbook 示例\n   \n       - name: Copy a file from local to remote\n         copy:\n          src: /path/to/local/file.txt\n          dest: /path/to/remote/file.txt\n          \n          \n       - name: \"copy files\"\n             copy:\n             src: \"{{ item.src }}\"\n             dest: \"{{ item.dest }}\"\n             owner: root\n             group: root\n             mode: 755\n             with_items:\n                - {src: \"/root/aaa.txt\", dest: \"/tmp\" }\n                - {src: \"/root/bbb.txt\", dest: \"/tmp\" }\n \n   \n### setup模块\n\n### file模块\n\n### debug模块\n\n### yum模块\n\n### user模块\n\n### register模块\n    \n register 捕获 task 的输出，并将它保存到一个变量中，方便在以后的任务中调用\n     \n change： 表示执行命令的状态，如果命令执行了，则为 true；\n \n cmd： 表示的则是你当前执行的命令；\n \n delta： 表示命令执行所花费的时间\n \n start： 表示命令开始执行的时间\n \n end： 表示命令结束的时间\n \n failed： 表示命令执行的结果，如果为 false 则表示命令执行成功，true 则表示命令执行失败\n \n rc： 表示命令执行的返回码（return code），0 表示执行成功；\n \n stderr：命令输出的标准错误信息\n \n stderr_lines： 按换行符分割输出的内容，在多行输出时，显示的效果比 stderr 更加直观\n \n stdout： 命令的标准输出信息\n \n stdout_lines： 按换行符分割输出的内容，在多行输出时，结果更加直观    \n     \n    示例：\n    - name: View the logged in user name\n      shell: whoami\n      register: user\n    - debug:\n        var: user  \n         \n    - name: check nginx running\n       stat: path=/var/run/nginx.pid\n       register: nginxrunning   \n    - name: check nginx syntax\n      shell: /usr/sbin/nginx -t\n      register: nginxsyntax\n    # check_mode  true  -C测试 会跳过\n      check_mode: false\n      debug:\n        var: \"nginxsyntax,nginxrunning\"\n    - name: reload nginx server\n      service: name=nginx state=reloaded\n      when: nginxsyntax.rc == 0  and nginxrunning.stat.exists == true   \n        \n        \n    \n## when模块\n## debug与when连用\n##  剧本（Playbooks）\n    \n    Playbook可以运行多个任务，并提供一些更高级的功能。\n    让我们将上述任务移到一本剧本中。在ansible中剧本（playbooks）和角色（roles）都使用Yaml文件定义\n\n### 常用标签\n\n    gather_facts: no\n    只要是使用了ansible-playbook，默认情况，第 1 个步骤总是执行 Gathering Facts 这个TASK \n    这个主要收集目标主机的常用信息，如：主机名、内核版本、网卡接口、IP 地址、操作系统版本、CPU、内存、磁盘 等等\n\n    tag标签可以单独使用\n    #启动nginx\n        - name: start nginx server\n          service: name=nginx state=started\n          when: \n            - nginxsyntax.rc == 0\n            - nginxrunning.stat.exists == false\n          tags: updateconfig\n          \n     ansible-playbook -i hosts site.yml -t updateconfig     \n          \n    通过debug模块去确认返回结果的数据结构   \n    - name: print nginx syntax result\n      debug: var=nginxsyntax   \n### 定义变量 循环示例\n\n     vars:\n        createuser:\n          - tomcat\n          - www\n          - mysql\n          \n      tasks:\n       #利用循环创建多个用户\n        - name: create user\n          user: name={{item}} state=present\n          with_items: \"{{createuser}}\"\n\n","slug":"ansible学习","published":1,"updated":"2024-02-06T11:04:31.996Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv4a000spcoc6myrbkg4","content":"<h2 id=\"一、安装\"><a href=\"#一、安装\" class=\"headerlink\" title=\"一、安装\"></a>一、安装</h2><p> yum install -y epel-release</p>\n<p> yum install -y ansible</p>\n<p> ansible配置文件：</p>\n<pre><code>/etc/ansible/ansible.cfg\n/etc/ansible/hosts\n</code></pre>\n<p> 生成秘钥：</p>\n<pre><code>ssh-keygen -t rsa  #在/root/.ssh/目录下生成秘钥\n#被控端：(复制主机端公钥到被控端)\nssh-copy-id -i /root/.ssh/id_rsa.pub root@192.168.7.99 \nssh-copy-id  被控端ip\n</code></pre>\n<h2 id=\"二、管理服务器：Inventory文件\"><a href=\"#二、管理服务器：Inventory文件\" class=\"headerlink\" title=\"二、管理服务器：Inventory文件\"></a>二、管理服务器：Inventory文件</h2><p>用于管理主机与主机组的文件 也叫主机清单<br>默认文件  /etc/ansible/hosts 最好不要用这  不然一不小心  没指定hosts 就执行这个了</p>\n<p>文件示例</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[gs]</span><br><span class=\"line\">gs157 ansible_ssh_host=1.11.1.11 ansible_ssh_port=65022</span><br><span class=\"line\">[remote]</span><br><span class=\"line\">kh251 ansible_ssh_host=2.22.222.2</span><br></pre></td></tr></table></figure>\n<h2 id=\"三、基础命令\"><a href=\"#三、基础命令\" class=\"headerlink\" title=\"三、基础命令\"></a>三、基础命令</h2><h3 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h3><p>查看具体主机配置</p>\n<pre><code>grep -v ^# /etc/ansible/hosts |grep -v ^$\n\nansible all --list-host     \n</code></pre>\n<h3 id=\"基础参数\"><a href=\"#基础参数\" class=\"headerlink\" title=\"基础参数\"></a>基础参数</h3><p>-m 指定模块【command copy shell】<br><font color=\"red\">   忽略时，就默认是 -m command </font></p>\n<pre><code>示例：  ansible -i ./hosts -a ifconfig  test\n</code></pre>\n<p>-a 模块中使用的参数</p>\n<pre><code>示例：  ansible -i ./hosts -m shell -a &quot;free -mh&quot;  test\n</code></pre>\n<p>-i 指定hosts文件</p>\n<pre><code>示例  ansible -i ./hosts -m ping test\n</code></pre>\n<h3 id=\"检查能否在受管主机上运行python模块\"><a href=\"#检查能否在受管主机上运行python模块\" class=\"headerlink\" title=\"检查能否在受管主机上运行python模块\"></a>检查能否在受管主机上运行python模块</h3><pre><code>ansible host-pattern -m module [-a &#39;module arguments&#39;] [-i inventory]\n示例\n    ansible gsweb -m ping\n    \n    ansible -i /etc/ansible/hosts gsweb -m ping\n\n   \n</code></pre>\n<h3 id=\"command模块\"><a href=\"#command模块\" class=\"headerlink\" title=\"command模块\"></a>command模块</h3><pre><code>执行shell命令\n-m 不使用 默认使用command模块\n\nansible -m command -a &quot;frem -mh&quot; test   \n\nansible -m command -a &quot;frem -mh&quot; test     \n\nansible  -a &quot;frem -mh&quot; test \n</code></pre>\n<h3 id=\"shell模块\"><a href=\"#shell模块\" class=\"headerlink\" title=\"shell模块\"></a>shell模块</h3><p> 与command模块有些相似,但是command 有些命令无法执行</p>\n<p>  命令行示例</p>\n<pre><code> ansible -m shell -a &quot;cat /etc/*release&quot; test\n</code></pre>\n<h3 id=\"copy模块\"><a href=\"#copy模块\" class=\"headerlink\" title=\"copy模块\"></a>copy模块</h3><p>   参数</p>\n<pre><code>src：    待copy的文件或目录\n\ndest：   目标copy到远程主机的具体目录（必要参数）\n\nowner：  目标copy到远程主机后的属主（远程主机上必须有对应的用户，否则报错）\n\ngroup：  目标copy到远程主机后的属组（远程主机上必须有对应的组，否则报错）\n\nmode：   目标copy到远程主机后的权限\n\ncontent： 若不用src指定拷贝的文件，必须用content直接指定文件内容，2选一。 \n\nforce：   当远程主机的目标路径中已经存在同名文件，并且与ansible主机中的文件内容不同时，\n          是否强制覆盖，可选值有yes和no。默认值为yes，表示覆盖，\n          如果设置为no，则不会执行覆盖拷贝操作，远程主机中的文件保持不变。\n          \nbackup：  当远程主机的目标路径中已经存在同名文件，并且与ansible主机中的文件内容不同时，\n          是否对远程主机的文件进行备份，\n          可选值有yes和no，当设置为yes时，会先备份远程主机中的文件，\n          然后再将ansible主机中的文件拷贝到远程主机。\n</code></pre>\n<p>   命令行 示例</p>\n<pre><code>   ansible khweb  -m copy -a &quot;src=/home/soft/node_exporter-1.6.1.linux-amd64.tar.gz  dest=/home/soft/  backup=yes mode=644&quot;\n</code></pre>\n<p>   playbook 示例</p>\n<pre><code>   - name: Copy a file from local to remote\n     copy:\n      src: /path/to/local/file.txt\n      dest: /path/to/remote/file.txt\n      \n      \n   - name: &quot;copy files&quot;\n         copy:\n         src: &quot;&#123;&#123; item.src &#125;&#125;&quot;\n         dest: &quot;&#123;&#123; item.dest &#125;&#125;&quot;\n         owner: root\n         group: root\n         mode: 755\n         with_items:\n            - &#123;src: &quot;/root/aaa.txt&quot;, dest: &quot;/tmp&quot; &#125;\n            - &#123;src: &quot;/root/bbb.txt&quot;, dest: &quot;/tmp&quot; &#125;\n</code></pre>\n<h3 id=\"setup模块\"><a href=\"#setup模块\" class=\"headerlink\" title=\"setup模块\"></a>setup模块</h3><h3 id=\"file模块\"><a href=\"#file模块\" class=\"headerlink\" title=\"file模块\"></a>file模块</h3><h3 id=\"debug模块\"><a href=\"#debug模块\" class=\"headerlink\" title=\"debug模块\"></a>debug模块</h3><h3 id=\"yum模块\"><a href=\"#yum模块\" class=\"headerlink\" title=\"yum模块\"></a>yum模块</h3><h3 id=\"user模块\"><a href=\"#user模块\" class=\"headerlink\" title=\"user模块\"></a>user模块</h3><h3 id=\"register模块\"><a href=\"#register模块\" class=\"headerlink\" title=\"register模块\"></a>register模块</h3><p> register 捕获 task 的输出，并将它保存到一个变量中，方便在以后的任务中调用</p>\n<p> change： 表示执行命令的状态，如果命令执行了，则为 true；</p>\n<p> cmd： 表示的则是你当前执行的命令；</p>\n<p> delta： 表示命令执行所花费的时间</p>\n<p> start： 表示命令开始执行的时间</p>\n<p> end： 表示命令结束的时间</p>\n<p> failed： 表示命令执行的结果，如果为 false 则表示命令执行成功，true 则表示命令执行失败</p>\n<p> rc： 表示命令执行的返回码（return code），0 表示执行成功；</p>\n<p> stderr：命令输出的标准错误信息</p>\n<p> stderr_lines： 按换行符分割输出的内容，在多行输出时，显示的效果比 stderr 更加直观</p>\n<p> stdout： 命令的标准输出信息</p>\n<p> stdout_lines： 按换行符分割输出的内容，在多行输出时，结果更加直观    </p>\n<pre><code>示例：\n- name: View the logged in user name\n  shell: whoami\n  register: user\n- debug:\n    var: user  \n     \n- name: check nginx running\n   stat: path=/var/run/nginx.pid\n   register: nginxrunning   \n- name: check nginx syntax\n  shell: /usr/sbin/nginx -t\n  register: nginxsyntax\n# check_mode  true  -C测试 会跳过\n  check_mode: false\n  debug:\n    var: &quot;nginxsyntax,nginxrunning&quot;\n- name: reload nginx server\n  service: name=nginx state=reloaded\n  when: nginxsyntax.rc == 0  and nginxrunning.stat.exists == true   \n    \n    \n</code></pre>\n<h2 id=\"when模块\"><a href=\"#when模块\" class=\"headerlink\" title=\"when模块\"></a>when模块</h2><h2 id=\"debug与when连用\"><a href=\"#debug与when连用\" class=\"headerlink\" title=\"debug与when连用\"></a>debug与when连用</h2><h2 id=\"剧本（Playbooks）\"><a href=\"#剧本（Playbooks）\" class=\"headerlink\" title=\"剧本（Playbooks）\"></a>剧本（Playbooks）</h2><pre><code>Playbook可以运行多个任务，并提供一些更高级的功能。\n让我们将上述任务移到一本剧本中。在ansible中剧本（playbooks）和角色（roles）都使用Yaml文件定义\n</code></pre>\n<h3 id=\"常用标签\"><a href=\"#常用标签\" class=\"headerlink\" title=\"常用标签\"></a>常用标签</h3><pre><code>gather_facts: no\n只要是使用了ansible-playbook，默认情况，第 1 个步骤总是执行 Gathering Facts 这个TASK \n这个主要收集目标主机的常用信息，如：主机名、内核版本、网卡接口、IP 地址、操作系统版本、CPU、内存、磁盘 等等\n\ntag标签可以单独使用\n#启动nginx\n    - name: start nginx server\n      service: name=nginx state=started\n      when: \n        - nginxsyntax.rc == 0\n        - nginxrunning.stat.exists == false\n      tags: updateconfig\n      \n ansible-playbook -i hosts site.yml -t updateconfig     \n      \n通过debug模块去确认返回结果的数据结构   \n- name: print nginx syntax result\n  debug: var=nginxsyntax   \n</code></pre>\n<h3 id=\"定义变量-循环示例\"><a href=\"#定义变量-循环示例\" class=\"headerlink\" title=\"定义变量 循环示例\"></a>定义变量 循环示例</h3><pre><code> vars:\n    createuser:\n      - tomcat\n      - www\n      - mysql\n      \n  tasks:\n   #利用循环创建多个用户\n    - name: create user\n      user: name=&#123;&#123;item&#125;&#125; state=present\n      with_items: &quot;&#123;&#123;createuser&#125;&#125;&quot;\n</code></pre>\n","site":{"data":{}},"length":3488,"excerpt":"","more":"<h2 id=\"一、安装\"><a href=\"#一、安装\" class=\"headerlink\" title=\"一、安装\"></a>一、安装</h2><p> yum install -y epel-release</p>\n<p> yum install -y ansible</p>\n<p> ansible配置文件：</p>\n<pre><code>/etc/ansible/ansible.cfg\n/etc/ansible/hosts\n</code></pre>\n<p> 生成秘钥：</p>\n<pre><code>ssh-keygen -t rsa  #在/root/.ssh/目录下生成秘钥\n#被控端：(复制主机端公钥到被控端)\nssh-copy-id -i /root/.ssh/id_rsa.pub root@192.168.7.99 \nssh-copy-id  被控端ip\n</code></pre>\n<h2 id=\"二、管理服务器：Inventory文件\"><a href=\"#二、管理服务器：Inventory文件\" class=\"headerlink\" title=\"二、管理服务器：Inventory文件\"></a>二、管理服务器：Inventory文件</h2><p>用于管理主机与主机组的文件 也叫主机清单<br>默认文件  /etc/ansible/hosts 最好不要用这  不然一不小心  没指定hosts 就执行这个了</p>\n<p>文件示例</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[gs]</span><br><span class=\"line\">gs157 ansible_ssh_host=1.11.1.11 ansible_ssh_port=65022</span><br><span class=\"line\">[remote]</span><br><span class=\"line\">kh251 ansible_ssh_host=2.22.222.2</span><br></pre></td></tr></table></figure>\n<h2 id=\"三、基础命令\"><a href=\"#三、基础命令\" class=\"headerlink\" title=\"三、基础命令\"></a>三、基础命令</h2><h3 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h3><p>查看具体主机配置</p>\n<pre><code>grep -v ^# /etc/ansible/hosts |grep -v ^$\n\nansible all --list-host     \n</code></pre>\n<h3 id=\"基础参数\"><a href=\"#基础参数\" class=\"headerlink\" title=\"基础参数\"></a>基础参数</h3><p>-m 指定模块【command copy shell】<br><font color=\"red\">   忽略时，就默认是 -m command </font></p>\n<pre><code>示例：  ansible -i ./hosts -a ifconfig  test\n</code></pre>\n<p>-a 模块中使用的参数</p>\n<pre><code>示例：  ansible -i ./hosts -m shell -a &quot;free -mh&quot;  test\n</code></pre>\n<p>-i 指定hosts文件</p>\n<pre><code>示例  ansible -i ./hosts -m ping test\n</code></pre>\n<h3 id=\"检查能否在受管主机上运行python模块\"><a href=\"#检查能否在受管主机上运行python模块\" class=\"headerlink\" title=\"检查能否在受管主机上运行python模块\"></a>检查能否在受管主机上运行python模块</h3><pre><code>ansible host-pattern -m module [-a &#39;module arguments&#39;] [-i inventory]\n示例\n    ansible gsweb -m ping\n    \n    ansible -i /etc/ansible/hosts gsweb -m ping\n\n   \n</code></pre>\n<h3 id=\"command模块\"><a href=\"#command模块\" class=\"headerlink\" title=\"command模块\"></a>command模块</h3><pre><code>执行shell命令\n-m 不使用 默认使用command模块\n\nansible -m command -a &quot;frem -mh&quot; test   \n\nansible -m command -a &quot;frem -mh&quot; test     \n\nansible  -a &quot;frem -mh&quot; test \n</code></pre>\n<h3 id=\"shell模块\"><a href=\"#shell模块\" class=\"headerlink\" title=\"shell模块\"></a>shell模块</h3><p> 与command模块有些相似,但是command 有些命令无法执行</p>\n<p>  命令行示例</p>\n<pre><code> ansible -m shell -a &quot;cat /etc/*release&quot; test\n</code></pre>\n<h3 id=\"copy模块\"><a href=\"#copy模块\" class=\"headerlink\" title=\"copy模块\"></a>copy模块</h3><p>   参数</p>\n<pre><code>src：    待copy的文件或目录\n\ndest：   目标copy到远程主机的具体目录（必要参数）\n\nowner：  目标copy到远程主机后的属主（远程主机上必须有对应的用户，否则报错）\n\ngroup：  目标copy到远程主机后的属组（远程主机上必须有对应的组，否则报错）\n\nmode：   目标copy到远程主机后的权限\n\ncontent： 若不用src指定拷贝的文件，必须用content直接指定文件内容，2选一。 \n\nforce：   当远程主机的目标路径中已经存在同名文件，并且与ansible主机中的文件内容不同时，\n          是否强制覆盖，可选值有yes和no。默认值为yes，表示覆盖，\n          如果设置为no，则不会执行覆盖拷贝操作，远程主机中的文件保持不变。\n          \nbackup：  当远程主机的目标路径中已经存在同名文件，并且与ansible主机中的文件内容不同时，\n          是否对远程主机的文件进行备份，\n          可选值有yes和no，当设置为yes时，会先备份远程主机中的文件，\n          然后再将ansible主机中的文件拷贝到远程主机。\n</code></pre>\n<p>   命令行 示例</p>\n<pre><code>   ansible khweb  -m copy -a &quot;src=/home/soft/node_exporter-1.6.1.linux-amd64.tar.gz  dest=/home/soft/  backup=yes mode=644&quot;\n</code></pre>\n<p>   playbook 示例</p>\n<pre><code>   - name: Copy a file from local to remote\n     copy:\n      src: /path/to/local/file.txt\n      dest: /path/to/remote/file.txt\n      \n      \n   - name: &quot;copy files&quot;\n         copy:\n         src: &quot;&#123;&#123; item.src &#125;&#125;&quot;\n         dest: &quot;&#123;&#123; item.dest &#125;&#125;&quot;\n         owner: root\n         group: root\n         mode: 755\n         with_items:\n            - &#123;src: &quot;/root/aaa.txt&quot;, dest: &quot;/tmp&quot; &#125;\n            - &#123;src: &quot;/root/bbb.txt&quot;, dest: &quot;/tmp&quot; &#125;\n</code></pre>\n<h3 id=\"setup模块\"><a href=\"#setup模块\" class=\"headerlink\" title=\"setup模块\"></a>setup模块</h3><h3 id=\"file模块\"><a href=\"#file模块\" class=\"headerlink\" title=\"file模块\"></a>file模块</h3><h3 id=\"debug模块\"><a href=\"#debug模块\" class=\"headerlink\" title=\"debug模块\"></a>debug模块</h3><h3 id=\"yum模块\"><a href=\"#yum模块\" class=\"headerlink\" title=\"yum模块\"></a>yum模块</h3><h3 id=\"user模块\"><a href=\"#user模块\" class=\"headerlink\" title=\"user模块\"></a>user模块</h3><h3 id=\"register模块\"><a href=\"#register模块\" class=\"headerlink\" title=\"register模块\"></a>register模块</h3><p> register 捕获 task 的输出，并将它保存到一个变量中，方便在以后的任务中调用</p>\n<p> change： 表示执行命令的状态，如果命令执行了，则为 true；</p>\n<p> cmd： 表示的则是你当前执行的命令；</p>\n<p> delta： 表示命令执行所花费的时间</p>\n<p> start： 表示命令开始执行的时间</p>\n<p> end： 表示命令结束的时间</p>\n<p> failed： 表示命令执行的结果，如果为 false 则表示命令执行成功，true 则表示命令执行失败</p>\n<p> rc： 表示命令执行的返回码（return code），0 表示执行成功；</p>\n<p> stderr：命令输出的标准错误信息</p>\n<p> stderr_lines： 按换行符分割输出的内容，在多行输出时，显示的效果比 stderr 更加直观</p>\n<p> stdout： 命令的标准输出信息</p>\n<p> stdout_lines： 按换行符分割输出的内容，在多行输出时，结果更加直观    </p>\n<pre><code>示例：\n- name: View the logged in user name\n  shell: whoami\n  register: user\n- debug:\n    var: user  \n     \n- name: check nginx running\n   stat: path=/var/run/nginx.pid\n   register: nginxrunning   \n- name: check nginx syntax\n  shell: /usr/sbin/nginx -t\n  register: nginxsyntax\n# check_mode  true  -C测试 会跳过\n  check_mode: false\n  debug:\n    var: &quot;nginxsyntax,nginxrunning&quot;\n- name: reload nginx server\n  service: name=nginx state=reloaded\n  when: nginxsyntax.rc == 0  and nginxrunning.stat.exists == true   \n    \n    \n</code></pre>\n<h2 id=\"when模块\"><a href=\"#when模块\" class=\"headerlink\" title=\"when模块\"></a>when模块</h2><h2 id=\"debug与when连用\"><a href=\"#debug与when连用\" class=\"headerlink\" title=\"debug与when连用\"></a>debug与when连用</h2><h2 id=\"剧本（Playbooks）\"><a href=\"#剧本（Playbooks）\" class=\"headerlink\" title=\"剧本（Playbooks）\"></a>剧本（Playbooks）</h2><pre><code>Playbook可以运行多个任务，并提供一些更高级的功能。\n让我们将上述任务移到一本剧本中。在ansible中剧本（playbooks）和角色（roles）都使用Yaml文件定义\n</code></pre>\n<h3 id=\"常用标签\"><a href=\"#常用标签\" class=\"headerlink\" title=\"常用标签\"></a>常用标签</h3><pre><code>gather_facts: no\n只要是使用了ansible-playbook，默认情况，第 1 个步骤总是执行 Gathering Facts 这个TASK \n这个主要收集目标主机的常用信息，如：主机名、内核版本、网卡接口、IP 地址、操作系统版本、CPU、内存、磁盘 等等\n\ntag标签可以单独使用\n#启动nginx\n    - name: start nginx server\n      service: name=nginx state=started\n      when: \n        - nginxsyntax.rc == 0\n        - nginxrunning.stat.exists == false\n      tags: updateconfig\n      \n ansible-playbook -i hosts site.yml -t updateconfig     \n      \n通过debug模块去确认返回结果的数据结构   \n- name: print nginx syntax result\n  debug: var=nginxsyntax   \n</code></pre>\n<h3 id=\"定义变量-循环示例\"><a href=\"#定义变量-循环示例\" class=\"headerlink\" title=\"定义变量 循环示例\"></a>定义变量 循环示例</h3><pre><code> vars:\n    createuser:\n      - tomcat\n      - www\n      - mysql\n      \n  tasks:\n   #利用循环创建多个用户\n    - name: create user\n      user: name=&#123;&#123;item&#125;&#125; state=present\n      with_items: &quot;&#123;&#123;createuser&#125;&#125;&quot;\n</code></pre>\n"},{"title":"JS模块化","abbrlink":"b2e052be","date":"2022-02-26T02:48:58.000Z","_content":"\n## CommonJs规范简  \n    前端模块化\n    \n    最初是服务于服务端的 但它的载体是前端语言 JavaScript\n    commonjs 随着 nodejs 的诞生而面世，主要是用来解决服务端模块化的问题\n    Node.js 应用由模块组成，每个文件就是一个模块，有自己的作用域。\n    在一个文件里面定义的变量、函数、类，都是私有的，对其他文件不可见\n    \n     CommonJS 规范的模块时，无外乎就是使用了 require 、 exports 、 module 三个东西，\n     然后一个 js 文件就是一个模块\n     \n     弊端require 多个文件  网络加载问题\n\n### require\n\n    用来加载某个模块\n\n\n### module\n\n    module 代表当前模块，是一个对象，保存了当前模块的信息\n    exports 是 module 上的一个属性，保存了当前模块要导出的接口或者变量，\n    使用 require 加载的某个模块获取到的值就是那个模块使用 exports 导出的值\n    \n```\n    // a.js\n    var name = 'morrain'\n    var age = 18\n    module.exports.name = name\n    module.exports.getAge = function(){\n        return age\n    }\n    \n    //b.js\n    var a = require('a.js')\n    console.log(a.name) // 'morrain'\n    console.log(a.getAge())// 18\n```\n\n### exports\n\n    为了方便，Node.js 在实现 CommonJS 规范时，为每个模块提供一个 exports的私有变量\n    为每个模块提供一个 exports的私有变量，指向 module.exports\n    你可以理解为 Node.js 在每个模块开始的地方，添加了如下这行代码。\n    \n    exports 是模块内的私有局部变量，它只是指向了 module.exports\n    所以直接对 exports 赋值是无效的\n    \n```\n    //a.js\n    var name = 'test'\n    var age = 18\n    exports.name = name\n    exports.getAge = function(){\n        return age\n    }\n    \n    \n    //b.js\n    \n    a = require('a.js')\n    console.log(a.name)\n    a.name\n```\n     \n    \n## AMD(Asynchronous Module Definition 异步模块定义)   require.js\n\n    　　（1）实现js文件的异步加载，避免网页失去响应；\n    \n    　　（2）管理模块之间的依赖性，便于代码的编写和维护。\n\n```\ndefine(id?, dependencies?, factory)\n\nid：可选参数，用来定义模块的标识，如果没有提供该参数，就使用 js 文件名（去掉拓展名）对于一个 js 文件只定义了一个模块时，这个参数是可以省略的\n\ndependencies：可选参数，是一个数组，表示当前模块的依赖，如果没有依赖可以不传\n\nfactory：工厂方法，模块初始化要执行的函数或对象。如果为函数，它应该只被执行一次，返回值便是模块要导出的值。\n如果是对象，此对象应该为模块的输出值\n\n```\n\n\n```\n// a.js\ndefine(function(){\n    var name = 'morrain'\n    var age = 18\n    return {\n        name,\n        getAge: () => age\n    }\n})\n// b.js\ndefine(['a.js'], function(a){\n    var name = 'lilei'\n    var age = 15\n    console.log(a.name) // 'morrain'\n    console.log(a.getAge()) // 18\n    return {\n        name,\n        getAge: () => age\n    }\n})\n```\n\n\n## CMD (Common Module Definition)  Sea.js\n     \n     Sea.js\n     \n```\n<script src=\"sea.js\"></script>\n<script src=\"b.js\"></script>\n// a.js\ndefine(function(require, exports, module){\n    var name = 'morrain'\n    var age = 18\n\n    exports.name = name\n    exports.getAge = () => age\n})\n// b.js\ndefine(function(require, exports, module){\n    var name = 'lilei'\n    var age = 15\n    var a = require('a.js')\n\n    console.log(a.name) // 'morrain'\n    console.log(a.getAge()) //18\n\n    exports.name = name\n    exports.getAge = () => age\n})\n```\n\n## ES6 Moudule","source":"_posts/js模块化.md","raw":"---\ntitle: JS模块化\nabbrlink: b2e052be\ncategories:\n  - 前端\ndate: 2022-02-26 10:48:58\ntags:\n---\n\n## CommonJs规范简  \n    前端模块化\n    \n    最初是服务于服务端的 但它的载体是前端语言 JavaScript\n    commonjs 随着 nodejs 的诞生而面世，主要是用来解决服务端模块化的问题\n    Node.js 应用由模块组成，每个文件就是一个模块，有自己的作用域。\n    在一个文件里面定义的变量、函数、类，都是私有的，对其他文件不可见\n    \n     CommonJS 规范的模块时，无外乎就是使用了 require 、 exports 、 module 三个东西，\n     然后一个 js 文件就是一个模块\n     \n     弊端require 多个文件  网络加载问题\n\n### require\n\n    用来加载某个模块\n\n\n### module\n\n    module 代表当前模块，是一个对象，保存了当前模块的信息\n    exports 是 module 上的一个属性，保存了当前模块要导出的接口或者变量，\n    使用 require 加载的某个模块获取到的值就是那个模块使用 exports 导出的值\n    \n```\n    // a.js\n    var name = 'morrain'\n    var age = 18\n    module.exports.name = name\n    module.exports.getAge = function(){\n        return age\n    }\n    \n    //b.js\n    var a = require('a.js')\n    console.log(a.name) // 'morrain'\n    console.log(a.getAge())// 18\n```\n\n### exports\n\n    为了方便，Node.js 在实现 CommonJS 规范时，为每个模块提供一个 exports的私有变量\n    为每个模块提供一个 exports的私有变量，指向 module.exports\n    你可以理解为 Node.js 在每个模块开始的地方，添加了如下这行代码。\n    \n    exports 是模块内的私有局部变量，它只是指向了 module.exports\n    所以直接对 exports 赋值是无效的\n    \n```\n    //a.js\n    var name = 'test'\n    var age = 18\n    exports.name = name\n    exports.getAge = function(){\n        return age\n    }\n    \n    \n    //b.js\n    \n    a = require('a.js')\n    console.log(a.name)\n    a.name\n```\n     \n    \n## AMD(Asynchronous Module Definition 异步模块定义)   require.js\n\n    　　（1）实现js文件的异步加载，避免网页失去响应；\n    \n    　　（2）管理模块之间的依赖性，便于代码的编写和维护。\n\n```\ndefine(id?, dependencies?, factory)\n\nid：可选参数，用来定义模块的标识，如果没有提供该参数，就使用 js 文件名（去掉拓展名）对于一个 js 文件只定义了一个模块时，这个参数是可以省略的\n\ndependencies：可选参数，是一个数组，表示当前模块的依赖，如果没有依赖可以不传\n\nfactory：工厂方法，模块初始化要执行的函数或对象。如果为函数，它应该只被执行一次，返回值便是模块要导出的值。\n如果是对象，此对象应该为模块的输出值\n\n```\n\n\n```\n// a.js\ndefine(function(){\n    var name = 'morrain'\n    var age = 18\n    return {\n        name,\n        getAge: () => age\n    }\n})\n// b.js\ndefine(['a.js'], function(a){\n    var name = 'lilei'\n    var age = 15\n    console.log(a.name) // 'morrain'\n    console.log(a.getAge()) // 18\n    return {\n        name,\n        getAge: () => age\n    }\n})\n```\n\n\n## CMD (Common Module Definition)  Sea.js\n     \n     Sea.js\n     \n```\n<script src=\"sea.js\"></script>\n<script src=\"b.js\"></script>\n// a.js\ndefine(function(require, exports, module){\n    var name = 'morrain'\n    var age = 18\n\n    exports.name = name\n    exports.getAge = () => age\n})\n// b.js\ndefine(function(require, exports, module){\n    var name = 'lilei'\n    var age = 15\n    var a = require('a.js')\n\n    console.log(a.name) // 'morrain'\n    console.log(a.getAge()) //18\n\n    exports.name = name\n    exports.getAge = () => age\n})\n```\n\n## ES6 Moudule","slug":"js模块化","published":1,"updated":"2024-02-06T11:02:44.222Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv4c000zpcoc85zk0742","content":"<h2 id=\"CommonJs规范简\"><a href=\"#CommonJs规范简\" class=\"headerlink\" title=\"CommonJs规范简\"></a>CommonJs规范简</h2><pre><code>前端模块化\n\n最初是服务于服务端的 但它的载体是前端语言 JavaScript\ncommonjs 随着 nodejs 的诞生而面世，主要是用来解决服务端模块化的问题\nNode.js 应用由模块组成，每个文件就是一个模块，有自己的作用域。\n在一个文件里面定义的变量、函数、类，都是私有的，对其他文件不可见\n\n CommonJS 规范的模块时，无外乎就是使用了 require 、 exports 、 module 三个东西，\n 然后一个 js 文件就是一个模块\n \n 弊端require 多个文件  网络加载问题\n</code></pre>\n<h3 id=\"require\"><a href=\"#require\" class=\"headerlink\" title=\"require\"></a>require</h3><pre><code>用来加载某个模块\n</code></pre>\n<h3 id=\"module\"><a href=\"#module\" class=\"headerlink\" title=\"module\"></a>module</h3><pre><code>module 代表当前模块，是一个对象，保存了当前模块的信息\nexports 是 module 上的一个属性，保存了当前模块要导出的接口或者变量，\n使用 require 加载的某个模块获取到的值就是那个模块使用 exports 导出的值\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// a.js</span><br><span class=\"line\">var name = &#x27;morrain&#x27;</span><br><span class=\"line\">var age = 18</span><br><span class=\"line\">module.exports.name = name</span><br><span class=\"line\">module.exports.getAge = function()&#123;</span><br><span class=\"line\">    return age</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">//b.js</span><br><span class=\"line\">var a = require(&#x27;a.js&#x27;)</span><br><span class=\"line\">console.log(a.name) // &#x27;morrain&#x27;</span><br><span class=\"line\">console.log(a.getAge())// 18</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"exports\"><a href=\"#exports\" class=\"headerlink\" title=\"exports\"></a>exports</h3><pre><code>为了方便，Node.js 在实现 CommonJS 规范时，为每个模块提供一个 exports的私有变量\n为每个模块提供一个 exports的私有变量，指向 module.exports\n你可以理解为 Node.js 在每个模块开始的地方，添加了如下这行代码。\n\nexports 是模块内的私有局部变量，它只是指向了 module.exports\n所以直接对 exports 赋值是无效的\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//a.js</span><br><span class=\"line\">var name = &#x27;test&#x27;</span><br><span class=\"line\">var age = 18</span><br><span class=\"line\">exports.name = name</span><br><span class=\"line\">exports.getAge = function()&#123;</span><br><span class=\"line\">    return age</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">//b.js</span><br><span class=\"line\"></span><br><span class=\"line\">a = require(&#x27;a.js&#x27;)</span><br><span class=\"line\">console.log(a.name)</span><br><span class=\"line\">a.name</span><br></pre></td></tr></table></figure>\n<h2 id=\"AMD-Asynchronous-Module-Definition-异步模块定义-require-js\"><a href=\"#AMD-Asynchronous-Module-Definition-异步模块定义-require-js\" class=\"headerlink\" title=\"AMD(Asynchronous Module Definition 异步模块定义)   require.js\"></a>AMD(Asynchronous Module Definition 异步模块定义)   require.js</h2><pre><code>　　（1）实现js文件的异步加载，避免网页失去响应；\n\n　　（2）管理模块之间的依赖性，便于代码的编写和维护。\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">define(id?, dependencies?, factory)</span><br><span class=\"line\"></span><br><span class=\"line\">id：可选参数，用来定义模块的标识，如果没有提供该参数，就使用 js 文件名（去掉拓展名）对于一个 js 文件只定义了一个模块时，这个参数是可以省略的</span><br><span class=\"line\"></span><br><span class=\"line\">dependencies：可选参数，是一个数组，表示当前模块的依赖，如果没有依赖可以不传</span><br><span class=\"line\"></span><br><span class=\"line\">factory：工厂方法，模块初始化要执行的函数或对象。如果为函数，它应该只被执行一次，返回值便是模块要导出的值。</span><br><span class=\"line\">如果是对象，此对象应该为模块的输出值</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// a.js</span><br><span class=\"line\">define(function()&#123;</span><br><span class=\"line\">    var name = &#x27;morrain&#x27;</span><br><span class=\"line\">    var age = 18</span><br><span class=\"line\">    return &#123;</span><br><span class=\"line\">        name,</span><br><span class=\"line\">        getAge: () =&gt; age</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">// b.js</span><br><span class=\"line\">define([&#x27;a.js&#x27;], function(a)&#123;</span><br><span class=\"line\">    var name = &#x27;lilei&#x27;</span><br><span class=\"line\">    var age = 15</span><br><span class=\"line\">    console.log(a.name) // &#x27;morrain&#x27;</span><br><span class=\"line\">    console.log(a.getAge()) // 18</span><br><span class=\"line\">    return &#123;</span><br><span class=\"line\">        name,</span><br><span class=\"line\">        getAge: () =&gt; age</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"CMD-Common-Module-Definition-Sea-js\"><a href=\"#CMD-Common-Module-Definition-Sea-js\" class=\"headerlink\" title=\"CMD (Common Module Definition)  Sea.js\"></a>CMD (Common Module Definition)  Sea.js</h2><pre><code> Sea.js\n \n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script src=&quot;sea.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;script src=&quot;b.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">// a.js</span><br><span class=\"line\">define(function(require, exports, module)&#123;</span><br><span class=\"line\">    var name = &#x27;morrain&#x27;</span><br><span class=\"line\">    var age = 18</span><br><span class=\"line\"></span><br><span class=\"line\">    exports.name = name</span><br><span class=\"line\">    exports.getAge = () =&gt; age</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">// b.js</span><br><span class=\"line\">define(function(require, exports, module)&#123;</span><br><span class=\"line\">    var name = &#x27;lilei&#x27;</span><br><span class=\"line\">    var age = 15</span><br><span class=\"line\">    var a = require(&#x27;a.js&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">    console.log(a.name) // &#x27;morrain&#x27;</span><br><span class=\"line\">    console.log(a.getAge()) //18</span><br><span class=\"line\"></span><br><span class=\"line\">    exports.name = name</span><br><span class=\"line\">    exports.getAge = () =&gt; age</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ES6-Moudule\"><a href=\"#ES6-Moudule\" class=\"headerlink\" title=\"ES6 Moudule\"></a>ES6 Moudule</h2>","site":{"data":{}},"length":2184,"excerpt":"","more":"<h2 id=\"CommonJs规范简\"><a href=\"#CommonJs规范简\" class=\"headerlink\" title=\"CommonJs规范简\"></a>CommonJs规范简</h2><pre><code>前端模块化\n\n最初是服务于服务端的 但它的载体是前端语言 JavaScript\ncommonjs 随着 nodejs 的诞生而面世，主要是用来解决服务端模块化的问题\nNode.js 应用由模块组成，每个文件就是一个模块，有自己的作用域。\n在一个文件里面定义的变量、函数、类，都是私有的，对其他文件不可见\n\n CommonJS 规范的模块时，无外乎就是使用了 require 、 exports 、 module 三个东西，\n 然后一个 js 文件就是一个模块\n \n 弊端require 多个文件  网络加载问题\n</code></pre>\n<h3 id=\"require\"><a href=\"#require\" class=\"headerlink\" title=\"require\"></a>require</h3><pre><code>用来加载某个模块\n</code></pre>\n<h3 id=\"module\"><a href=\"#module\" class=\"headerlink\" title=\"module\"></a>module</h3><pre><code>module 代表当前模块，是一个对象，保存了当前模块的信息\nexports 是 module 上的一个属性，保存了当前模块要导出的接口或者变量，\n使用 require 加载的某个模块获取到的值就是那个模块使用 exports 导出的值\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// a.js</span><br><span class=\"line\">var name = &#x27;morrain&#x27;</span><br><span class=\"line\">var age = 18</span><br><span class=\"line\">module.exports.name = name</span><br><span class=\"line\">module.exports.getAge = function()&#123;</span><br><span class=\"line\">    return age</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">//b.js</span><br><span class=\"line\">var a = require(&#x27;a.js&#x27;)</span><br><span class=\"line\">console.log(a.name) // &#x27;morrain&#x27;</span><br><span class=\"line\">console.log(a.getAge())// 18</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"exports\"><a href=\"#exports\" class=\"headerlink\" title=\"exports\"></a>exports</h3><pre><code>为了方便，Node.js 在实现 CommonJS 规范时，为每个模块提供一个 exports的私有变量\n为每个模块提供一个 exports的私有变量，指向 module.exports\n你可以理解为 Node.js 在每个模块开始的地方，添加了如下这行代码。\n\nexports 是模块内的私有局部变量，它只是指向了 module.exports\n所以直接对 exports 赋值是无效的\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//a.js</span><br><span class=\"line\">var name = &#x27;test&#x27;</span><br><span class=\"line\">var age = 18</span><br><span class=\"line\">exports.name = name</span><br><span class=\"line\">exports.getAge = function()&#123;</span><br><span class=\"line\">    return age</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">//b.js</span><br><span class=\"line\"></span><br><span class=\"line\">a = require(&#x27;a.js&#x27;)</span><br><span class=\"line\">console.log(a.name)</span><br><span class=\"line\">a.name</span><br></pre></td></tr></table></figure>\n<h2 id=\"AMD-Asynchronous-Module-Definition-异步模块定义-require-js\"><a href=\"#AMD-Asynchronous-Module-Definition-异步模块定义-require-js\" class=\"headerlink\" title=\"AMD(Asynchronous Module Definition 异步模块定义)   require.js\"></a>AMD(Asynchronous Module Definition 异步模块定义)   require.js</h2><pre><code>　　（1）实现js文件的异步加载，避免网页失去响应；\n\n　　（2）管理模块之间的依赖性，便于代码的编写和维护。\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">define(id?, dependencies?, factory)</span><br><span class=\"line\"></span><br><span class=\"line\">id：可选参数，用来定义模块的标识，如果没有提供该参数，就使用 js 文件名（去掉拓展名）对于一个 js 文件只定义了一个模块时，这个参数是可以省略的</span><br><span class=\"line\"></span><br><span class=\"line\">dependencies：可选参数，是一个数组，表示当前模块的依赖，如果没有依赖可以不传</span><br><span class=\"line\"></span><br><span class=\"line\">factory：工厂方法，模块初始化要执行的函数或对象。如果为函数，它应该只被执行一次，返回值便是模块要导出的值。</span><br><span class=\"line\">如果是对象，此对象应该为模块的输出值</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// a.js</span><br><span class=\"line\">define(function()&#123;</span><br><span class=\"line\">    var name = &#x27;morrain&#x27;</span><br><span class=\"line\">    var age = 18</span><br><span class=\"line\">    return &#123;</span><br><span class=\"line\">        name,</span><br><span class=\"line\">        getAge: () =&gt; age</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">// b.js</span><br><span class=\"line\">define([&#x27;a.js&#x27;], function(a)&#123;</span><br><span class=\"line\">    var name = &#x27;lilei&#x27;</span><br><span class=\"line\">    var age = 15</span><br><span class=\"line\">    console.log(a.name) // &#x27;morrain&#x27;</span><br><span class=\"line\">    console.log(a.getAge()) // 18</span><br><span class=\"line\">    return &#123;</span><br><span class=\"line\">        name,</span><br><span class=\"line\">        getAge: () =&gt; age</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"CMD-Common-Module-Definition-Sea-js\"><a href=\"#CMD-Common-Module-Definition-Sea-js\" class=\"headerlink\" title=\"CMD (Common Module Definition)  Sea.js\"></a>CMD (Common Module Definition)  Sea.js</h2><pre><code> Sea.js\n \n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script src=&quot;sea.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;script src=&quot;b.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">// a.js</span><br><span class=\"line\">define(function(require, exports, module)&#123;</span><br><span class=\"line\">    var name = &#x27;morrain&#x27;</span><br><span class=\"line\">    var age = 18</span><br><span class=\"line\"></span><br><span class=\"line\">    exports.name = name</span><br><span class=\"line\">    exports.getAge = () =&gt; age</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">// b.js</span><br><span class=\"line\">define(function(require, exports, module)&#123;</span><br><span class=\"line\">    var name = &#x27;lilei&#x27;</span><br><span class=\"line\">    var age = 15</span><br><span class=\"line\">    var a = require(&#x27;a.js&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">    console.log(a.name) // &#x27;morrain&#x27;</span><br><span class=\"line\">    console.log(a.getAge()) //18</span><br><span class=\"line\"></span><br><span class=\"line\">    exports.name = name</span><br><span class=\"line\">    exports.getAge = () =&gt; age</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ES6-Moudule\"><a href=\"#ES6-Moudule\" class=\"headerlink\" title=\"ES6 Moudule\"></a>ES6 Moudule</h2>"},{"title":"linux-iptables使用总结","abbrlink":"24ccf49a","date":"2023-07-26T07:31:32.000Z","_content":"一、iptables\n    iptables防火墙没有启用,iptables命令仍然会显示默认的规则.\n\n\n二、常用命令\n\n常用参数\n\n    -n 参数表示将 IP 地址和端口号显示为数字形式，而不是解析为主机名和服务名。\n    \n    -L 选项用于列出防火墙规则。\n    \n    -t nat 参数指定了要操作的表为 NAT 表，NAT 表用于处理网络地址转换相关的规则。\n\niptables -n -L           显示当前防火墙规则列表。\niptables --list\n\niptables -t nat -n -L    看 iptables 中 NAT（Network Address Translation）表的规则。\n\n    \n结果怎么看\n\n    Chain INPUT (policy ACCEPT)\n    target     prot opt source               destination         \n    ACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0            state NEW udp dpt:2333\n    ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            state NEW tcp dpt:2333\n    \n    Chain FORWARD (policy DROP)\n    target     prot opt source               destination         \n    DOCKER-USER  all  --  0.0.0.0/0            0.0.0.0/0           \n    DOCKER-ISOLATION-STAGE-1  all  --  0.0.0.0/0            0.0.0.0/0           \n    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED\n    DOCKER     all  --  0.0.0.0/0            0.0.0.0/0           \n    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           \n    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           \n    \n    Chain OUTPUT (policy ACCEPT)\n    target     prot opt source               destination         \n    \n    Chain DOCKER (1 references)\n    target     prot opt source               destination         \n    ACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60050\n    ACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60049\n    ACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60048\n    ACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60047\n    \n    Chain DOCKER-ISOLATION-STAGE-1 (1 references)\n    target     prot opt source               destination         \n    DOCKER-ISOLATION-STAGE-2  all  --  0.0.0.0/0            0.0.0.0/0           \n    RETURN     all  --  0.0.0.0/0            0.0.0.0/0           \n    \n    Chain DOCKER-ISOLATION-STAGE-2 (1 references)\n    target     prot opt source               destination         \n    DROP       all  --  0.0.0.0/0            0.0.0.0/0           \n    RETURN     all  --  0.0.0.0/0            0.0.0.0/0           \n    \n    Chain DOCKER-USER (1 references)\n    target     prot opt source               destination         \n    RETURN     all  --  0.0.0.0/0            0.0.0.0/0 \n     \n    \"LIBVIRT_FWI\"是一个iptables防火墙的链，并且该链已经被引用了一次\n    \n    允许所有协议（all）的流量从任意源IP地址（0.0.0.0/0）进入到目标IP地址为172.17.0.2  60047端口\n    \n    \n    REJECT 拒绝\n    \n    ACCEPT 允许\n    \n    DROP   丢弃\n    \n禁止主机去访问某个ip\n    \n    iptables -A OUTPUT -d 185.196.8.123 -j DROP  #试了下不知为啥不行\n    \n    iptables -I OUTPUT -d aheatcorner.world -j REJECT\n    \n    -A: 在规则链的末尾加入新规则\n    \n    -I: 在规则链的头部加入新规则\n    \n删除某个链中某规则    \n    \n    iptables -D 链名 序号\n    \n    示例：\n    iptables -D OUTPUT  1\n    \n    \n-A INPUT: 将此规则添加到INPUT链中，即用于处理传入的数据包。\n-p tcp: 指定匹配的协议为TCP。\n-m tcp: 使用TCP模块，以便使用更多的TCP相关选项。\n--tcp-flags FIN,SYN,RST,ACK SYN: 匹配TCP标志位中的SYN标志，表示仅匹配连接请求。\n-m set: 使用set模块，允许对集合进行匹配操作。\n--match-set YJ-GLOBAL-INBLOCK src: 匹配指定的IP地址集合，这里的YJ-GLOBAL-INBLOCK是集合的名称，src表示匹配源IP地址。\n-j DROP: 如果上述条件匹配成功，则丢弃该数据包，即阻止TCP连接请求。\n\n\n    \n    \n    \n\"-m state\"是iptables中的一个模块，它用于根据连接的状态来匹配和处理数据包。这个模块允许你在规则中设置条件来匹配特定的连接状态。\n\n一些常见的连接状态包括：\n\nNEW：表示新的连接请求。\nESTABLISHED：表示已经建立的连接。\nRELATED：表示和已经建立的连接相关的新连接。\nINVALID：表示无效的连接状态。\nUNTRACKED：表示未被iptables跟踪的连接。\n你可以在规则中使用\"-m state\"来根据特定的连接状态来匹配数据包，例如：\n\n\"-m state --state NEW\"：匹配新建的连接请求。\n\"-m state --state ESTABLISHED,RELATED\"：匹配已建立和相关的连接。\n需要注意的是，\"-m state\"只能在iptables的filter表中使用，并且在使用之前需要确保安装了iptables state模块。    ","source":"_posts/linux-iptables使用总结.md","raw":"---\ntitle: linux-iptables使用总结\nabbrlink: 24ccf49a\ndate: 2023-07-26 15:31:32\ntags:\n  - linux\ncategories:\n  - 服务器相关  \n---\n一、iptables\n    iptables防火墙没有启用,iptables命令仍然会显示默认的规则.\n\n\n二、常用命令\n\n常用参数\n\n    -n 参数表示将 IP 地址和端口号显示为数字形式，而不是解析为主机名和服务名。\n    \n    -L 选项用于列出防火墙规则。\n    \n    -t nat 参数指定了要操作的表为 NAT 表，NAT 表用于处理网络地址转换相关的规则。\n\niptables -n -L           显示当前防火墙规则列表。\niptables --list\n\niptables -t nat -n -L    看 iptables 中 NAT（Network Address Translation）表的规则。\n\n    \n结果怎么看\n\n    Chain INPUT (policy ACCEPT)\n    target     prot opt source               destination         \n    ACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0            state NEW udp dpt:2333\n    ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            state NEW tcp dpt:2333\n    \n    Chain FORWARD (policy DROP)\n    target     prot opt source               destination         \n    DOCKER-USER  all  --  0.0.0.0/0            0.0.0.0/0           \n    DOCKER-ISOLATION-STAGE-1  all  --  0.0.0.0/0            0.0.0.0/0           \n    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED\n    DOCKER     all  --  0.0.0.0/0            0.0.0.0/0           \n    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           \n    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           \n    \n    Chain OUTPUT (policy ACCEPT)\n    target     prot opt source               destination         \n    \n    Chain DOCKER (1 references)\n    target     prot opt source               destination         \n    ACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60050\n    ACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60049\n    ACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60048\n    ACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60047\n    \n    Chain DOCKER-ISOLATION-STAGE-1 (1 references)\n    target     prot opt source               destination         \n    DOCKER-ISOLATION-STAGE-2  all  --  0.0.0.0/0            0.0.0.0/0           \n    RETURN     all  --  0.0.0.0/0            0.0.0.0/0           \n    \n    Chain DOCKER-ISOLATION-STAGE-2 (1 references)\n    target     prot opt source               destination         \n    DROP       all  --  0.0.0.0/0            0.0.0.0/0           \n    RETURN     all  --  0.0.0.0/0            0.0.0.0/0           \n    \n    Chain DOCKER-USER (1 references)\n    target     prot opt source               destination         \n    RETURN     all  --  0.0.0.0/0            0.0.0.0/0 \n     \n    \"LIBVIRT_FWI\"是一个iptables防火墙的链，并且该链已经被引用了一次\n    \n    允许所有协议（all）的流量从任意源IP地址（0.0.0.0/0）进入到目标IP地址为172.17.0.2  60047端口\n    \n    \n    REJECT 拒绝\n    \n    ACCEPT 允许\n    \n    DROP   丢弃\n    \n禁止主机去访问某个ip\n    \n    iptables -A OUTPUT -d 185.196.8.123 -j DROP  #试了下不知为啥不行\n    \n    iptables -I OUTPUT -d aheatcorner.world -j REJECT\n    \n    -A: 在规则链的末尾加入新规则\n    \n    -I: 在规则链的头部加入新规则\n    \n删除某个链中某规则    \n    \n    iptables -D 链名 序号\n    \n    示例：\n    iptables -D OUTPUT  1\n    \n    \n-A INPUT: 将此规则添加到INPUT链中，即用于处理传入的数据包。\n-p tcp: 指定匹配的协议为TCP。\n-m tcp: 使用TCP模块，以便使用更多的TCP相关选项。\n--tcp-flags FIN,SYN,RST,ACK SYN: 匹配TCP标志位中的SYN标志，表示仅匹配连接请求。\n-m set: 使用set模块，允许对集合进行匹配操作。\n--match-set YJ-GLOBAL-INBLOCK src: 匹配指定的IP地址集合，这里的YJ-GLOBAL-INBLOCK是集合的名称，src表示匹配源IP地址。\n-j DROP: 如果上述条件匹配成功，则丢弃该数据包，即阻止TCP连接请求。\n\n\n    \n    \n    \n\"-m state\"是iptables中的一个模块，它用于根据连接的状态来匹配和处理数据包。这个模块允许你在规则中设置条件来匹配特定的连接状态。\n\n一些常见的连接状态包括：\n\nNEW：表示新的连接请求。\nESTABLISHED：表示已经建立的连接。\nRELATED：表示和已经建立的连接相关的新连接。\nINVALID：表示无效的连接状态。\nUNTRACKED：表示未被iptables跟踪的连接。\n你可以在规则中使用\"-m state\"来根据特定的连接状态来匹配数据包，例如：\n\n\"-m state --state NEW\"：匹配新建的连接请求。\n\"-m state --state ESTABLISHED,RELATED\"：匹配已建立和相关的连接。\n需要注意的是，\"-m state\"只能在iptables的filter表中使用，并且在使用之前需要确保安装了iptables state模块。    ","slug":"linux-iptables使用总结","published":1,"updated":"2024-11-25T11:18:21.336Z","_id":"clxb4gv4d0012pcocbmuo9icl","comments":1,"layout":"post","photos":[],"link":"","content":"<p>一、iptables<br>    iptables防火墙没有启用,iptables命令仍然会显示默认的规则.</p>\n<p>二、常用命令</p>\n<p>常用参数</p>\n<pre><code>-n 参数表示将 IP 地址和端口号显示为数字形式，而不是解析为主机名和服务名。\n\n-L 选项用于列出防火墙规则。\n\n-t nat 参数指定了要操作的表为 NAT 表，NAT 表用于处理网络地址转换相关的规则。\n</code></pre>\n<p>iptables -n -L           显示当前防火墙规则列表。<br>iptables –list</p>\n<p>iptables -t nat -n -L    看 iptables 中 NAT（Network Address Translation）表的规则。</p>\n<p>结果怎么看</p>\n<pre><code>Chain INPUT (policy ACCEPT)\ntarget     prot opt source               destination         \nACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0            state NEW udp dpt:2333\nACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            state NEW tcp dpt:2333\n\nChain FORWARD (policy DROP)\ntarget     prot opt source               destination         \nDOCKER-USER  all  --  0.0.0.0/0            0.0.0.0/0           \nDOCKER-ISOLATION-STAGE-1  all  --  0.0.0.0/0            0.0.0.0/0           \nACCEPT     all  --  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED\nDOCKER     all  --  0.0.0.0/0            0.0.0.0/0           \nACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           \nACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           \n\nChain OUTPUT (policy ACCEPT)\ntarget     prot opt source               destination         \n\nChain DOCKER (1 references)\ntarget     prot opt source               destination         \nACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60050\nACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60049\nACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60048\nACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60047\n\nChain DOCKER-ISOLATION-STAGE-1 (1 references)\ntarget     prot opt source               destination         \nDOCKER-ISOLATION-STAGE-2  all  --  0.0.0.0/0            0.0.0.0/0           \nRETURN     all  --  0.0.0.0/0            0.0.0.0/0           \n\nChain DOCKER-ISOLATION-STAGE-2 (1 references)\ntarget     prot opt source               destination         \nDROP       all  --  0.0.0.0/0            0.0.0.0/0           \nRETURN     all  --  0.0.0.0/0            0.0.0.0/0           \n\nChain DOCKER-USER (1 references)\ntarget     prot opt source               destination         \nRETURN     all  --  0.0.0.0/0            0.0.0.0/0 \n \n&quot;LIBVIRT_FWI&quot;是一个iptables防火墙的链，并且该链已经被引用了一次\n\n允许所有协议（all）的流量从任意源IP地址（0.0.0.0/0）进入到目标IP地址为172.17.0.2  60047端口\n\n\nREJECT 拒绝\n\nACCEPT 允许\n\nDROP   丢弃\n</code></pre>\n<p>禁止主机去访问某个ip</p>\n<pre><code>iptables -A OUTPUT -d 185.196.8.123 -j DROP  #试了下不知为啥不行\n\niptables -I OUTPUT -d aheatcorner.world -j REJECT\n\n-A: 在规则链的末尾加入新规则\n\n-I: 在规则链的头部加入新规则\n</code></pre>\n<p>删除某个链中某规则    </p>\n<pre><code>iptables -D 链名 序号\n\n示例：\niptables -D OUTPUT  1\n</code></pre>\n<p>-A INPUT: 将此规则添加到INPUT链中，即用于处理传入的数据包。<br>-p tcp: 指定匹配的协议为TCP。<br>-m tcp: 使用TCP模块，以便使用更多的TCP相关选项。<br>–tcp-flags FIN,SYN,RST,ACK SYN: 匹配TCP标志位中的SYN标志，表示仅匹配连接请求。<br>-m set: 使用set模块，允许对集合进行匹配操作。<br>–match-set YJ-GLOBAL-INBLOCK src: 匹配指定的IP地址集合，这里的YJ-GLOBAL-INBLOCK是集合的名称，src表示匹配源IP地址。<br>-j DROP: 如果上述条件匹配成功，则丢弃该数据包，即阻止TCP连接请求。</p>\n<p>“-m state”是iptables中的一个模块，它用于根据连接的状态来匹配和处理数据包。这个模块允许你在规则中设置条件来匹配特定的连接状态。</p>\n<p>一些常见的连接状态包括：</p>\n<p>NEW：表示新的连接请求。<br>ESTABLISHED：表示已经建立的连接。<br>RELATED：表示和已经建立的连接相关的新连接。<br>INVALID：表示无效的连接状态。<br>UNTRACKED：表示未被iptables跟踪的连接。<br>你可以在规则中使用”-m state”来根据特定的连接状态来匹配数据包，例如：</p>\n<p>“-m state –state NEW”：匹配新建的连接请求。<br>“-m state –state ESTABLISHED,RELATED”：匹配已建立和相关的连接。<br>需要注意的是，”-m state”只能在iptables的filter表中使用，并且在使用之前需要确保安装了iptables state模块。    </p>\n","site":{"data":{}},"length":2284,"excerpt":"","more":"<p>一、iptables<br>    iptables防火墙没有启用,iptables命令仍然会显示默认的规则.</p>\n<p>二、常用命令</p>\n<p>常用参数</p>\n<pre><code>-n 参数表示将 IP 地址和端口号显示为数字形式，而不是解析为主机名和服务名。\n\n-L 选项用于列出防火墙规则。\n\n-t nat 参数指定了要操作的表为 NAT 表，NAT 表用于处理网络地址转换相关的规则。\n</code></pre>\n<p>iptables -n -L           显示当前防火墙规则列表。<br>iptables –list</p>\n<p>iptables -t nat -n -L    看 iptables 中 NAT（Network Address Translation）表的规则。</p>\n<p>结果怎么看</p>\n<pre><code>Chain INPUT (policy ACCEPT)\ntarget     prot opt source               destination         \nACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0            state NEW udp dpt:2333\nACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            state NEW tcp dpt:2333\n\nChain FORWARD (policy DROP)\ntarget     prot opt source               destination         \nDOCKER-USER  all  --  0.0.0.0/0            0.0.0.0/0           \nDOCKER-ISOLATION-STAGE-1  all  --  0.0.0.0/0            0.0.0.0/0           \nACCEPT     all  --  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED\nDOCKER     all  --  0.0.0.0/0            0.0.0.0/0           \nACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           \nACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           \n\nChain OUTPUT (policy ACCEPT)\ntarget     prot opt source               destination         \n\nChain DOCKER (1 references)\ntarget     prot opt source               destination         \nACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60050\nACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60049\nACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60048\nACCEPT     udp  --  0.0.0.0/0            172.17.0.2           udp dpt:60047\n\nChain DOCKER-ISOLATION-STAGE-1 (1 references)\ntarget     prot opt source               destination         \nDOCKER-ISOLATION-STAGE-2  all  --  0.0.0.0/0            0.0.0.0/0           \nRETURN     all  --  0.0.0.0/0            0.0.0.0/0           \n\nChain DOCKER-ISOLATION-STAGE-2 (1 references)\ntarget     prot opt source               destination         \nDROP       all  --  0.0.0.0/0            0.0.0.0/0           \nRETURN     all  --  0.0.0.0/0            0.0.0.0/0           \n\nChain DOCKER-USER (1 references)\ntarget     prot opt source               destination         \nRETURN     all  --  0.0.0.0/0            0.0.0.0/0 \n \n&quot;LIBVIRT_FWI&quot;是一个iptables防火墙的链，并且该链已经被引用了一次\n\n允许所有协议（all）的流量从任意源IP地址（0.0.0.0/0）进入到目标IP地址为172.17.0.2  60047端口\n\n\nREJECT 拒绝\n\nACCEPT 允许\n\nDROP   丢弃\n</code></pre>\n<p>禁止主机去访问某个ip</p>\n<pre><code>iptables -A OUTPUT -d 185.196.8.123 -j DROP  #试了下不知为啥不行\n\niptables -I OUTPUT -d aheatcorner.world -j REJECT\n\n-A: 在规则链的末尾加入新规则\n\n-I: 在规则链的头部加入新规则\n</code></pre>\n<p>删除某个链中某规则    </p>\n<pre><code>iptables -D 链名 序号\n\n示例：\niptables -D OUTPUT  1\n</code></pre>\n<p>-A INPUT: 将此规则添加到INPUT链中，即用于处理传入的数据包。<br>-p tcp: 指定匹配的协议为TCP。<br>-m tcp: 使用TCP模块，以便使用更多的TCP相关选项。<br>–tcp-flags FIN,SYN,RST,ACK SYN: 匹配TCP标志位中的SYN标志，表示仅匹配连接请求。<br>-m set: 使用set模块，允许对集合进行匹配操作。<br>–match-set YJ-GLOBAL-INBLOCK src: 匹配指定的IP地址集合，这里的YJ-GLOBAL-INBLOCK是集合的名称，src表示匹配源IP地址。<br>-j DROP: 如果上述条件匹配成功，则丢弃该数据包，即阻止TCP连接请求。</p>\n<p>“-m state”是iptables中的一个模块，它用于根据连接的状态来匹配和处理数据包。这个模块允许你在规则中设置条件来匹配特定的连接状态。</p>\n<p>一些常见的连接状态包括：</p>\n<p>NEW：表示新的连接请求。<br>ESTABLISHED：表示已经建立的连接。<br>RELATED：表示和已经建立的连接相关的新连接。<br>INVALID：表示无效的连接状态。<br>UNTRACKED：表示未被iptables跟踪的连接。<br>你可以在规则中使用”-m state”来根据特定的连接状态来匹配数据包，例如：</p>\n<p>“-m state –state NEW”：匹配新建的连接请求。<br>“-m state –state ESTABLISHED,RELATED”：匹配已建立和相关的连接。<br>需要注意的是，”-m state”只能在iptables的filter表中使用，并且在使用之前需要确保安装了iptables state模块。    </p>\n"},{"title":"k8s安装配置","abbrlink":"5951e8f7","date":"2024-05-16T11:58:36.000Z","_content":"\n# 一、redhat/openEluer 22/Centos 系统 安装k8s\n\n## 1.1 更新源\n\nwget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\n编辑替换  %s/$releasever/7/g\n\n设置仓库，需要安装所需的软件包。yum-utils 提供了 yum-config-manager ，\n并且 device mapper 存储驱动程序需要 device-mapper-persistent-data 和 lvm2\n\nyum install -y yum-utils device-mapper-persistent-data lvm2\n\nyum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n编辑替换  %s/$releasever/7/g\n\n\n## 1.2 安装 docker\n\nyum install docker-ce\n\n## 1.3 新增k8s源及安装\n新增k8s源\ncat <<EOF > /etc/yum.repos.d/kubernetes.repo\n[kubernetes]\nname=Kubernetes\nbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/\nenabled=1\ngpgcheck=0\nEOF\n\n\nyum install kubeadm kubelet kubectl \n\n\n# 二、ubuntu 系统安装 k8s\n\n sudo apt-get install -y apt-transport-https ca-certificates curl software-properties-common\n \n curl -s https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | sudo apt-key add -\n  \n sudo apt-add-repository \"deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main\"\n  \n sudo apt-get update\n  \n \n  vi /etc/apt/sources.list\n\n deb https://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial main\n\n apt-get update\n sudo apt update\n \n #sudo apt install -y kubelet=1.26.1-00 kubeadm=1.26.1-00 kubectl=1.26.1-00\n \n sudo apt install kubelet kubeadm kubectl\n sudo apt-mark hold kubelet kubeadm kubectl\n\n# 三、必要的系统设置\n\n## 3.1 关闭 selinux  关闭防火墙【暂时】（redhat系统）\n零时关闭\n   setenforce 0  \n   \n永久关闭\n       vi /etc/selinux/config\n       将参数修改为SELINUX=disabled\n   \n关闭防火墙\n\n   systemctl stop iptables\n   \n   systemctl stop firewalld\n   \n   systemct stop ufw\n\n## 3.2 禁用交换分区  \n    \n   swapoff -a \n   \n   /etc/fstab 文件下永久关闭 \n   打开/etc/fstab注释掉swap那一行\n   \n   sed -i 's/.*swap.*/#&/' /etc/fstab  \n\n## 3.3 开启端口转发   \n\n   vim  /proc/sys/net/ipv4/ip_forward\n   sysctl -w net.ipv4.ip_forward=1\n   \n## 3.4 修改内核参数 \n\ncat <<EOF >  /etc/sysctl.d/k8s.conf  \nnet.bridge.bridge-nf-call-ip6tables = 1  \nnet.bridge.bridge-nf-call-iptables = 1  \nEOF  \nsysctl --system \n\n## 3.5 设置时区更新时间\n\n     timedatectl  查看时区\n     \n     设置时区\n     timedatectl set-timezone Asia/Shanghai\n     \n## 配置host\n\n    vim /etc/hosts\n    \n     \n \n# 三、master 节点配置\n\n ## 3.1 配置项 解释 \n \n 自定义镜像进行初始化(推荐)\n 使用自定义kubernets镜像仓库进行初始化\n \n apiserver-advertise-address: 配置 apiserver ip  本机ip\n                             指明用 Master 的哪个 interface 与 Cluster 的其他节点通信。\n                             如果 Master 有多个 interface，建议明确指定，如果不指定，kubeadm 会自动选择有默认网关的 interface。\n                             这里的ip为master节点ip，记得更换\n                                 \n apiserver-bind-port       : 配置 apiserver 端口 默认 6443\n \n control-plane-endpoint    : 配置 控制端   ip  默认本机ip\n                             cluster-endpoint 是映射到该 IP 的自定义 DNS 名称，这里配置hosts映射：192.168.0.113   cluster-endpoint。\n                             这将允许你将 --control-plane-endpoint=cluster-endpoint 传递给 kubeadm init，并将相同的 DNS 名称传递给 kubeadm join。 \n                             稍后你可以修改 cluster-endpoint 以指向高可用性方案中的负载均衡器的地址。\n \n service-cidr               这个参数指定了 Kubernetes 集群中服务（Service）的 IP 地址范围。在该示例中，服务 IP 地址将从 10.119.0.0 开始分配。\n                                  \n service-dns-domain         这个参数指定了 Kubernetes 集群中服务的 DNS 域名。在该示例中，服务的 DNS 域名将使用 \"cluster.local\"。\n                            \n pod-network-cidr  :    这个参数指定了 Kubernetes 集群中 Pod 的 IP 地址范围。在该示例中，Pod 的 IP 地址将从 10.120.0.0 开始分配。 \n                        指定 Pod 网络的范围。Kubernetes 支持多种网络方案，而且不同网络方案对  \n                        –pod-network-cidr有自己的要求，这里设置为10.244.0.0/16 是因为我们将使用 flannel 网络方案\n                        必须设置成这个 CIDR。\n\n image-repository           这个用于指定从什么位置来拉取镜像（1.13版本才有的），默认值是k8s.gcr.io，\n                            我们将其指定为国内镜像地址：registry.aliyuncs.com/google_containers\n                                                        \n kubernetes-version        指定kubenets版本号，默认值是stable-1，会导致从https://dl.k8s.io/release/stable-1.txt下载最新的版本号，\n                           我们可以将其指定为固定版本（v1.22.1）来跳过网络请求\n                           \n                           \n ## 3.2配置示例：\n \n kubeadm init \\\n --apiserver-advertise-address 192.168.240.11 \\\n --apiserver-bind-port 6443 \\\n --control-plane-endpoint 192.168.240.11 \\\n --service-cidr=10.119.0.0/16 \\\n --service-dns-domain=\"cluster.local\" \\\n --pod-network-cidr=10.120.0.0/16 \\\n --image-repository registry.aliyuncs.com/google_containers \n    \n kubeadm init \\\n  --apiserver-advertise-address=192.168.100.203 \\\n  --image-repository registry.aliyuncs.com/google_containers \\\n  --service-cidr=10.119.0.0/16 \\\n  --pod-network-cidr=10.120.0.0/16 \\\n  --kubernetes-version v1.28.2\n     \n kubeadm init \\\n   --apiserver-advertise-address=192.168.31.200 \\\n   --image-repository registry.aliyuncs.com/google_containers \\\n   --kubernetes-version v1.18.0 \\\n   --service-cidr=10.96.0.0/12 \\\n   --pod-network-cidr=10.244.0.0/16\n   \n## 3.3 配置 kubectl \n\n   mkdir -p $HOME/.kube\n   sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n   sudo chown $(id -u):$(id -g) $HOME/.kube/config\n   echo 'export KUBECONFIG=$HOME/.kube/config' >> $HOME/.bashrc\n   source ~/.bashrc\n\n## 3.3 配置网络\n\n   kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml\n\n   如果被墙，可以直接保存下列文件进行安装\n    \n   kubectl apply -f kube-flannel.yaml\n\n\n# 四、node 节点配置\n\n## 4.1 配置文件处理\n\n mkdir -p $HOME/.kube\n \n 复制master节点的 /etc/kubernetes/admin.conf 到 node节点 $HOME/.kube/config\n \n sudo  $(id -u):$(id -g) $HOME/.kube/config\n \n echo 'export KUBECONFIG=$HOME/.kube/config' >> $HOME/.bashrc\n \n source ~/.bashrc\n                      \n## 4.2 加入节点\n    \n   可以master 节点执行  kubeadm token create --print-join-command 获取加入节点命令\n   \n   kubeadm join 172.17.131.4:6443 --token decqn7.lwcygbjmzof0xny3  \\\n   --discovery-token-ca-cert-hash sha256:8f0e8d2c04e38c7aa291d8b47be2bd8a5127bf1071263e01bdd5602ab331a01d\n    \n\n\n# 五、相关命令\n\n 如何生成 Kubeadm Join 命令？\n 您可以使用 command 生成 join 命令。kubeadm token create --print-join-command\n \n \n 重置节点（清除kubeadm信息）\n kubeadm reset\n\n\n 查看 pod 节点\n kubectl get nodes\n\n\n 删除的节点\n kubectl delete node <node_name>\n\n于官网镜像在国内访问不稳定，会出现访问失败。\n使用国内镜像进行替换下载，在此pause使用3.9会导致集群无法初始化，还需要下载pause:3.6\n以下命令在每台服务器上执行\n使用自定义镜像仓库拉取镜像\nkubeadm config images pull  \\\n--image-repository registry.aliyuncs.com/google_containers \\\n--kubernetes-version v1.28.2\n\n\n# 六 报错\n\n\n 报错如下\n \"open /run/systemd/resolve/resolv.conf: no such file or directory\" pod=\"kubelet\n 解决：\n yum install systemd-resolved 解决\n\n\n报错如下：\ncombined from similar events): Failed to create pod sandbox: rpc error: code = Unknown desc = failed to setup network for sandbox \\&quot;4d992cde6a671b8fa3264a90f5f11aa01d1713376abf0cdf9a4e27ec82860185\\&quot;: plugin type=\\&quot;flannel\\&quot; failed (add): loadFlannelSubnetEnv \nfailed: open /run/flannel/subnet.env: no such file or directory\n\n\n解决：\n配置 /run/flannel/subnet.env\npod 网络信息 \n\nFLANNEL_NETWORK=10.120.0.0/16\nFLANNEL_SUBNET=10.120.0.1/24\nFLANNEL_MTU=1450\nFLANNEL_IPMASQ=true\n\n报错如下：\n[preflight] Running pre-flight checks\nerror execution phase preflight: [preflight] Some fatal errors occurred:\n\t[ERROR FileContent--proc-sys-net-ipv4-ip_forward]: /proc/sys/net/ipv4/ip_forward contents are not set to 1\n[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`\nTo see the stack trace of this error execute with --v=5 or higher\n\n\n 解决：\nsysctl -w net.ipv4.ip_forward=1\n\n\n\n报错如下：\n\n NotReady message:Network plugin returns error: cni plugin not initialized\n to get sandbox image \\\"registry.k8s.i\n \n evel=info msg=\"Stop CRI service\"\n 024-05-31T02:22:27.294384683Z\" level=info msg=\"stop pulling image registry.k8s.io/pause:3.8: active requests=1, bytes>\n 024-05-31T02:22:27.294515739Z\" level=info msg=\"trying next host\" error=\"failed to do request: Head \\\"https://us-west2> \n\n \n解决\n\ncontainerd config default > /etc/containerd/config.toml\n\n修改\nsandbox_image = \"registry.aliyuncs.com/google_containers/pause:3.9\"\n\nsystemctl restart containerd\n\n\nmkdir /etc/containerd\ncontainerd config default > /etc/containerd/config.toml\nsed -i '/sandbox_image/s#registry.k8s.io/pause:3.8#registry.aliyuncs.com/google_containers/pause:3.9#g' /etc/containerd/config.toml\nsed -i '/SystemdCgroup/s/false/true/' /etc/containerd/config.toml\nsystemctl restart containerd\n    \n \n\n发现不了节点报错\nhttps://blog.csdn.net/qq_32264301/article/details/125486521\n\n\n error=\"rpc error: code = Unavailable desc = error reading from server: EOF\" module=libcontainerd namespace=moby\n \n\n\n报错\nError registering network: failed to acquire lease: subnet \"10.244.0.0/16\" \nspecified in the flannel net config doesn't contain \"10.120.0.0/24\" PodCIDR of the \"ubuntuutoootest\" node \n\n\n修改 kube-flannel.yml\n\nnet-conf.json: |\n    {\n      \"Network\": \"10.120.0.0/16\",\n      \"EnableNFTables\": false,\n      \"Backend\": {\n        \"Type\": \"vxlan\"\n      }\n    }\n---\n\n\n\n\n# k8组件\nk8s的主要组件，以及它们主要是用来干什么的：\n\n3.1 「主节点（Master）」\n主节点负责管理集群的整体状态和控制工作节点的操作。它包括以下组件：\n\n「API Server：」 提供了K8s API的入口，用于与Kubernetes进行交互。\n「Controller Manager：」 负责监控系统状态，确保实际状态符合期望状态。\n「Scheduler：」 负责将Pod调度到工作节点上运行。\n\n3.2 「工作节点（Node）」\n工作节点是集群中的计算资源，用于运行容器。每个工作节点包括以下组件：\n\n「Kubelet：」 负责与主节点通信，确保在节点上运行所需的Pod。\n「Container Runtime：」 用于启动和管理容器的软件，如Docker。\n「Kube Proxy：」 负责在节点上实现Service的网络代理。\n\n\netcd：一款开源软件。提供可靠的分布式数据存储服务，用于持久化存储K8s集群的配置和状态\n\napiservice：用户程序（如kubectl）、K8s其它组件之间通信的接口。K8s其它组件之间不直接通信，而是通过API server通信的。这一点在上图的连接中可以体现，例如，只有API server连接了etcd，即其它组件更新K8s集群的状态时，只能通过API server读写etcd中的数据。\n\nScheduler：排程组件，为用户应用的每一可部署组件分配工作结点。\n\ncontroller-manager：执行集群级别的功能，如复制组件、追踪工作结点状态、处理结点失败等。Controller Manager组件是由多个控制器组成的，其中很多控制器是按K8s的资源类型划分的，如Replication Manager（管理ReplicationController 资源），ReplicaSet Controller，PersistentVolume controller。\n\nkube-proxy：在应用组件间负载均衡网络流量。\n\nkubelet：管理工作结点上的容器。\n\nContriner runtime Docker， rkt等实际运行容器的组件\n\n\n报错\n\n\n\n\n报错\n\n\n\n","source":"_posts/k8s安装配置.md","raw":"---\ntitle: k8s安装配置\nabbrlink: 5951e8f7\ndate: 2024-05-16 19:58:36\ntags:\n  - k8s\n---\n\n# 一、redhat/openEluer 22/Centos 系统 安装k8s\n\n## 1.1 更新源\n\nwget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\n编辑替换  %s/$releasever/7/g\n\n设置仓库，需要安装所需的软件包。yum-utils 提供了 yum-config-manager ，\n并且 device mapper 存储驱动程序需要 device-mapper-persistent-data 和 lvm2\n\nyum install -y yum-utils device-mapper-persistent-data lvm2\n\nyum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n编辑替换  %s/$releasever/7/g\n\n\n## 1.2 安装 docker\n\nyum install docker-ce\n\n## 1.3 新增k8s源及安装\n新增k8s源\ncat <<EOF > /etc/yum.repos.d/kubernetes.repo\n[kubernetes]\nname=Kubernetes\nbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/\nenabled=1\ngpgcheck=0\nEOF\n\n\nyum install kubeadm kubelet kubectl \n\n\n# 二、ubuntu 系统安装 k8s\n\n sudo apt-get install -y apt-transport-https ca-certificates curl software-properties-common\n \n curl -s https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | sudo apt-key add -\n  \n sudo apt-add-repository \"deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main\"\n  \n sudo apt-get update\n  \n \n  vi /etc/apt/sources.list\n\n deb https://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial main\n\n apt-get update\n sudo apt update\n \n #sudo apt install -y kubelet=1.26.1-00 kubeadm=1.26.1-00 kubectl=1.26.1-00\n \n sudo apt install kubelet kubeadm kubectl\n sudo apt-mark hold kubelet kubeadm kubectl\n\n# 三、必要的系统设置\n\n## 3.1 关闭 selinux  关闭防火墙【暂时】（redhat系统）\n零时关闭\n   setenforce 0  \n   \n永久关闭\n       vi /etc/selinux/config\n       将参数修改为SELINUX=disabled\n   \n关闭防火墙\n\n   systemctl stop iptables\n   \n   systemctl stop firewalld\n   \n   systemct stop ufw\n\n## 3.2 禁用交换分区  \n    \n   swapoff -a \n   \n   /etc/fstab 文件下永久关闭 \n   打开/etc/fstab注释掉swap那一行\n   \n   sed -i 's/.*swap.*/#&/' /etc/fstab  \n\n## 3.3 开启端口转发   \n\n   vim  /proc/sys/net/ipv4/ip_forward\n   sysctl -w net.ipv4.ip_forward=1\n   \n## 3.4 修改内核参数 \n\ncat <<EOF >  /etc/sysctl.d/k8s.conf  \nnet.bridge.bridge-nf-call-ip6tables = 1  \nnet.bridge.bridge-nf-call-iptables = 1  \nEOF  \nsysctl --system \n\n## 3.5 设置时区更新时间\n\n     timedatectl  查看时区\n     \n     设置时区\n     timedatectl set-timezone Asia/Shanghai\n     \n## 配置host\n\n    vim /etc/hosts\n    \n     \n \n# 三、master 节点配置\n\n ## 3.1 配置项 解释 \n \n 自定义镜像进行初始化(推荐)\n 使用自定义kubernets镜像仓库进行初始化\n \n apiserver-advertise-address: 配置 apiserver ip  本机ip\n                             指明用 Master 的哪个 interface 与 Cluster 的其他节点通信。\n                             如果 Master 有多个 interface，建议明确指定，如果不指定，kubeadm 会自动选择有默认网关的 interface。\n                             这里的ip为master节点ip，记得更换\n                                 \n apiserver-bind-port       : 配置 apiserver 端口 默认 6443\n \n control-plane-endpoint    : 配置 控制端   ip  默认本机ip\n                             cluster-endpoint 是映射到该 IP 的自定义 DNS 名称，这里配置hosts映射：192.168.0.113   cluster-endpoint。\n                             这将允许你将 --control-plane-endpoint=cluster-endpoint 传递给 kubeadm init，并将相同的 DNS 名称传递给 kubeadm join。 \n                             稍后你可以修改 cluster-endpoint 以指向高可用性方案中的负载均衡器的地址。\n \n service-cidr               这个参数指定了 Kubernetes 集群中服务（Service）的 IP 地址范围。在该示例中，服务 IP 地址将从 10.119.0.0 开始分配。\n                                  \n service-dns-domain         这个参数指定了 Kubernetes 集群中服务的 DNS 域名。在该示例中，服务的 DNS 域名将使用 \"cluster.local\"。\n                            \n pod-network-cidr  :    这个参数指定了 Kubernetes 集群中 Pod 的 IP 地址范围。在该示例中，Pod 的 IP 地址将从 10.120.0.0 开始分配。 \n                        指定 Pod 网络的范围。Kubernetes 支持多种网络方案，而且不同网络方案对  \n                        –pod-network-cidr有自己的要求，这里设置为10.244.0.0/16 是因为我们将使用 flannel 网络方案\n                        必须设置成这个 CIDR。\n\n image-repository           这个用于指定从什么位置来拉取镜像（1.13版本才有的），默认值是k8s.gcr.io，\n                            我们将其指定为国内镜像地址：registry.aliyuncs.com/google_containers\n                                                        \n kubernetes-version        指定kubenets版本号，默认值是stable-1，会导致从https://dl.k8s.io/release/stable-1.txt下载最新的版本号，\n                           我们可以将其指定为固定版本（v1.22.1）来跳过网络请求\n                           \n                           \n ## 3.2配置示例：\n \n kubeadm init \\\n --apiserver-advertise-address 192.168.240.11 \\\n --apiserver-bind-port 6443 \\\n --control-plane-endpoint 192.168.240.11 \\\n --service-cidr=10.119.0.0/16 \\\n --service-dns-domain=\"cluster.local\" \\\n --pod-network-cidr=10.120.0.0/16 \\\n --image-repository registry.aliyuncs.com/google_containers \n    \n kubeadm init \\\n  --apiserver-advertise-address=192.168.100.203 \\\n  --image-repository registry.aliyuncs.com/google_containers \\\n  --service-cidr=10.119.0.0/16 \\\n  --pod-network-cidr=10.120.0.0/16 \\\n  --kubernetes-version v1.28.2\n     \n kubeadm init \\\n   --apiserver-advertise-address=192.168.31.200 \\\n   --image-repository registry.aliyuncs.com/google_containers \\\n   --kubernetes-version v1.18.0 \\\n   --service-cidr=10.96.0.0/12 \\\n   --pod-network-cidr=10.244.0.0/16\n   \n## 3.3 配置 kubectl \n\n   mkdir -p $HOME/.kube\n   sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n   sudo chown $(id -u):$(id -g) $HOME/.kube/config\n   echo 'export KUBECONFIG=$HOME/.kube/config' >> $HOME/.bashrc\n   source ~/.bashrc\n\n## 3.3 配置网络\n\n   kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml\n\n   如果被墙，可以直接保存下列文件进行安装\n    \n   kubectl apply -f kube-flannel.yaml\n\n\n# 四、node 节点配置\n\n## 4.1 配置文件处理\n\n mkdir -p $HOME/.kube\n \n 复制master节点的 /etc/kubernetes/admin.conf 到 node节点 $HOME/.kube/config\n \n sudo  $(id -u):$(id -g) $HOME/.kube/config\n \n echo 'export KUBECONFIG=$HOME/.kube/config' >> $HOME/.bashrc\n \n source ~/.bashrc\n                      \n## 4.2 加入节点\n    \n   可以master 节点执行  kubeadm token create --print-join-command 获取加入节点命令\n   \n   kubeadm join 172.17.131.4:6443 --token decqn7.lwcygbjmzof0xny3  \\\n   --discovery-token-ca-cert-hash sha256:8f0e8d2c04e38c7aa291d8b47be2bd8a5127bf1071263e01bdd5602ab331a01d\n    \n\n\n# 五、相关命令\n\n 如何生成 Kubeadm Join 命令？\n 您可以使用 command 生成 join 命令。kubeadm token create --print-join-command\n \n \n 重置节点（清除kubeadm信息）\n kubeadm reset\n\n\n 查看 pod 节点\n kubectl get nodes\n\n\n 删除的节点\n kubectl delete node <node_name>\n\n于官网镜像在国内访问不稳定，会出现访问失败。\n使用国内镜像进行替换下载，在此pause使用3.9会导致集群无法初始化，还需要下载pause:3.6\n以下命令在每台服务器上执行\n使用自定义镜像仓库拉取镜像\nkubeadm config images pull  \\\n--image-repository registry.aliyuncs.com/google_containers \\\n--kubernetes-version v1.28.2\n\n\n# 六 报错\n\n\n 报错如下\n \"open /run/systemd/resolve/resolv.conf: no such file or directory\" pod=\"kubelet\n 解决：\n yum install systemd-resolved 解决\n\n\n报错如下：\ncombined from similar events): Failed to create pod sandbox: rpc error: code = Unknown desc = failed to setup network for sandbox \\&quot;4d992cde6a671b8fa3264a90f5f11aa01d1713376abf0cdf9a4e27ec82860185\\&quot;: plugin type=\\&quot;flannel\\&quot; failed (add): loadFlannelSubnetEnv \nfailed: open /run/flannel/subnet.env: no such file or directory\n\n\n解决：\n配置 /run/flannel/subnet.env\npod 网络信息 \n\nFLANNEL_NETWORK=10.120.0.0/16\nFLANNEL_SUBNET=10.120.0.1/24\nFLANNEL_MTU=1450\nFLANNEL_IPMASQ=true\n\n报错如下：\n[preflight] Running pre-flight checks\nerror execution phase preflight: [preflight] Some fatal errors occurred:\n\t[ERROR FileContent--proc-sys-net-ipv4-ip_forward]: /proc/sys/net/ipv4/ip_forward contents are not set to 1\n[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`\nTo see the stack trace of this error execute with --v=5 or higher\n\n\n 解决：\nsysctl -w net.ipv4.ip_forward=1\n\n\n\n报错如下：\n\n NotReady message:Network plugin returns error: cni plugin not initialized\n to get sandbox image \\\"registry.k8s.i\n \n evel=info msg=\"Stop CRI service\"\n 024-05-31T02:22:27.294384683Z\" level=info msg=\"stop pulling image registry.k8s.io/pause:3.8: active requests=1, bytes>\n 024-05-31T02:22:27.294515739Z\" level=info msg=\"trying next host\" error=\"failed to do request: Head \\\"https://us-west2> \n\n \n解决\n\ncontainerd config default > /etc/containerd/config.toml\n\n修改\nsandbox_image = \"registry.aliyuncs.com/google_containers/pause:3.9\"\n\nsystemctl restart containerd\n\n\nmkdir /etc/containerd\ncontainerd config default > /etc/containerd/config.toml\nsed -i '/sandbox_image/s#registry.k8s.io/pause:3.8#registry.aliyuncs.com/google_containers/pause:3.9#g' /etc/containerd/config.toml\nsed -i '/SystemdCgroup/s/false/true/' /etc/containerd/config.toml\nsystemctl restart containerd\n    \n \n\n发现不了节点报错\nhttps://blog.csdn.net/qq_32264301/article/details/125486521\n\n\n error=\"rpc error: code = Unavailable desc = error reading from server: EOF\" module=libcontainerd namespace=moby\n \n\n\n报错\nError registering network: failed to acquire lease: subnet \"10.244.0.0/16\" \nspecified in the flannel net config doesn't contain \"10.120.0.0/24\" PodCIDR of the \"ubuntuutoootest\" node \n\n\n修改 kube-flannel.yml\n\nnet-conf.json: |\n    {\n      \"Network\": \"10.120.0.0/16\",\n      \"EnableNFTables\": false,\n      \"Backend\": {\n        \"Type\": \"vxlan\"\n      }\n    }\n---\n\n\n\n\n# k8组件\nk8s的主要组件，以及它们主要是用来干什么的：\n\n3.1 「主节点（Master）」\n主节点负责管理集群的整体状态和控制工作节点的操作。它包括以下组件：\n\n「API Server：」 提供了K8s API的入口，用于与Kubernetes进行交互。\n「Controller Manager：」 负责监控系统状态，确保实际状态符合期望状态。\n「Scheduler：」 负责将Pod调度到工作节点上运行。\n\n3.2 「工作节点（Node）」\n工作节点是集群中的计算资源，用于运行容器。每个工作节点包括以下组件：\n\n「Kubelet：」 负责与主节点通信，确保在节点上运行所需的Pod。\n「Container Runtime：」 用于启动和管理容器的软件，如Docker。\n「Kube Proxy：」 负责在节点上实现Service的网络代理。\n\n\netcd：一款开源软件。提供可靠的分布式数据存储服务，用于持久化存储K8s集群的配置和状态\n\napiservice：用户程序（如kubectl）、K8s其它组件之间通信的接口。K8s其它组件之间不直接通信，而是通过API server通信的。这一点在上图的连接中可以体现，例如，只有API server连接了etcd，即其它组件更新K8s集群的状态时，只能通过API server读写etcd中的数据。\n\nScheduler：排程组件，为用户应用的每一可部署组件分配工作结点。\n\ncontroller-manager：执行集群级别的功能，如复制组件、追踪工作结点状态、处理结点失败等。Controller Manager组件是由多个控制器组成的，其中很多控制器是按K8s的资源类型划分的，如Replication Manager（管理ReplicationController 资源），ReplicaSet Controller，PersistentVolume controller。\n\nkube-proxy：在应用组件间负载均衡网络流量。\n\nkubelet：管理工作结点上的容器。\n\nContriner runtime Docker， rkt等实际运行容器的组件\n\n\n报错\n\n\n\n\n报错\n\n\n\n","slug":"k8s安装配置","published":1,"updated":"2024-12-04T07:16:45.373Z","_id":"clxb4gv4f0017pcocdu3x9s3l","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、redhat-openEluer-22-Centos-系统-安装k8s\"><a href=\"#一、redhat-openEluer-22-Centos-系统-安装k8s\" class=\"headerlink\" title=\"一、redhat/openEluer 22/Centos 系统 安装k8s\"></a>一、redhat/openEluer 22/Centos 系统 安装k8s</h1><h2 id=\"1-1-更新源\"><a href=\"#1-1-更新源\" class=\"headerlink\" title=\"1.1 更新源\"></a>1.1 更新源</h2><p>wget -O /etc/yum.repos.d/CentOS-Base.repo <a href=\"http://mirrors.aliyun.com/repo/Centos-7.repo\">http://mirrors.aliyun.com/repo/Centos-7.repo</a><br>编辑替换  %s/$releasever/7/g</p>\n<p>设置仓库，需要安装所需的软件包。yum-utils 提供了 yum-config-manager ，<br>并且 device mapper 存储驱动程序需要 device-mapper-persistent-data 和 lvm2</p>\n<p>yum install -y yum-utils device-mapper-persistent-data lvm2</p>\n<p>yum-config-manager –add-repo <a href=\"https://download.docker.com/linux/centos/docker-ce.repo\">https://download.docker.com/linux/centos/docker-ce.repo</a><br>编辑替换  %s/$releasever/7/g</p>\n<h2 id=\"1-2-安装-docker\"><a href=\"#1-2-安装-docker\" class=\"headerlink\" title=\"1.2 安装 docker\"></a>1.2 安装 docker</h2><p>yum install docker-ce</p>\n<h2 id=\"1-3-新增k8s源及安装\"><a href=\"#1-3-新增k8s源及安装\" class=\"headerlink\" title=\"1.3 新增k8s源及安装\"></a>1.3 新增k8s源及安装</h2><p>新增k8s源<br>cat &lt;<EOF > /etc/yum.repos.d/kubernetes.repo<br>[kubernetes]<br>name=Kubernetes<br>baseurl=<a href=\"https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/\">https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/</a><br>enabled=1<br>gpgcheck=0<br>EOF</p>\n<p>yum install kubeadm kubelet kubectl </p>\n<h1 id=\"二、ubuntu-系统安装-k8s\"><a href=\"#二、ubuntu-系统安装-k8s\" class=\"headerlink\" title=\"二、ubuntu 系统安装 k8s\"></a>二、ubuntu 系统安装 k8s</h1><p> sudo apt-get install -y apt-transport-https ca-certificates curl software-properties-common</p>\n<p> curl -s <a href=\"https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg\">https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg</a> | sudo apt-key add -</p>\n<p> sudo apt-add-repository “deb <a href=\"https://mirrors.aliyun.com/kubernetes/apt/\">https://mirrors.aliyun.com/kubernetes/apt/</a> kubernetes-xenial main”</p>\n<p> sudo apt-get update</p>\n<p>  vi /etc/apt/sources.list</p>\n<p> deb <a href=\"https://mirrors.aliyun.com/kubernetes/apt\">https://mirrors.aliyun.com/kubernetes/apt</a> kubernetes-xenial main</p>\n<p> apt-get update<br> sudo apt update</p>\n<p> #sudo apt install -y kubelet=1.26.1-00 kubeadm=1.26.1-00 kubectl=1.26.1-00</p>\n<p> sudo apt install kubelet kubeadm kubectl<br> sudo apt-mark hold kubelet kubeadm kubectl</p>\n<h1 id=\"三、必要的系统设置\"><a href=\"#三、必要的系统设置\" class=\"headerlink\" title=\"三、必要的系统设置\"></a>三、必要的系统设置</h1><h2 id=\"3-1-关闭-selinux-关闭防火墙【暂时】（redhat系统）\"><a href=\"#3-1-关闭-selinux-关闭防火墙【暂时】（redhat系统）\" class=\"headerlink\" title=\"3.1 关闭 selinux  关闭防火墙【暂时】（redhat系统）\"></a>3.1 关闭 selinux  关闭防火墙【暂时】（redhat系统）</h2><p>零时关闭<br>   setenforce 0  </p>\n<p>永久关闭<br>       vi /etc/selinux/config<br>       将参数修改为SELINUX=disabled</p>\n<p>关闭防火墙</p>\n<p>   systemctl stop iptables</p>\n<p>   systemctl stop firewalld</p>\n<p>   systemct stop ufw</p>\n<h2 id=\"3-2-禁用交换分区\"><a href=\"#3-2-禁用交换分区\" class=\"headerlink\" title=\"3.2 禁用交换分区\"></a>3.2 禁用交换分区</h2><p>   swapoff -a </p>\n<p>   /etc/fstab 文件下永久关闭<br>   打开/etc/fstab注释掉swap那一行</p>\n<p>   sed -i ‘s/.<em>swap.</em>/#&amp;/‘ /etc/fstab  </p>\n<h2 id=\"3-3-开启端口转发\"><a href=\"#3-3-开启端口转发\" class=\"headerlink\" title=\"3.3 开启端口转发\"></a>3.3 开启端口转发</h2><p>   vim  /proc/sys/net/ipv4/ip_forward<br>   sysctl -w net.ipv4.ip_forward=1</p>\n<h2 id=\"3-4-修改内核参数\"><a href=\"#3-4-修改内核参数\" class=\"headerlink\" title=\"3.4 修改内核参数\"></a>3.4 修改内核参数</h2><p>cat &lt;<EOF >  /etc/sysctl.d/k8s.conf<br>net.bridge.bridge-nf-call-ip6tables = 1<br>net.bridge.bridge-nf-call-iptables = 1<br>EOF<br>sysctl –system </p>\n<h2 id=\"3-5-设置时区更新时间\"><a href=\"#3-5-设置时区更新时间\" class=\"headerlink\" title=\"3.5 设置时区更新时间\"></a>3.5 设置时区更新时间</h2><pre><code> timedatectl  查看时区\n \n 设置时区\n timedatectl set-timezone Asia/Shanghai\n \n</code></pre>\n<h2 id=\"配置host\"><a href=\"#配置host\" class=\"headerlink\" title=\"配置host\"></a>配置host</h2><pre><code>vim /etc/hosts\n\n \n</code></pre>\n<h1 id=\"三、master-节点配置\"><a href=\"#三、master-节点配置\" class=\"headerlink\" title=\"三、master 节点配置\"></a>三、master 节点配置</h1><h2 id=\"3-1-配置项-解释\"><a href=\"#3-1-配置项-解释\" class=\"headerlink\" title=\"3.1 配置项 解释\"></a>3.1 配置项 解释</h2><p> 自定义镜像进行初始化(推荐)<br> 使用自定义kubernets镜像仓库进行初始化</p>\n<p> apiserver-advertise-address: 配置 apiserver ip  本机ip<br>                             指明用 Master 的哪个 interface 与 Cluster 的其他节点通信。<br>                             如果 Master 有多个 interface，建议明确指定，如果不指定，kubeadm 会自动选择有默认网关的 interface。<br>                             这里的ip为master节点ip，记得更换</p>\n<p> apiserver-bind-port       : 配置 apiserver 端口 默认 6443</p>\n<p> control-plane-endpoint    : 配置 控制端   ip  默认本机ip<br>                             cluster-endpoint 是映射到该 IP 的自定义 DNS 名称，这里配置hosts映射：192.168.0.113   cluster-endpoint。<br>                             这将允许你将 –control-plane-endpoint=cluster-endpoint 传递给 kubeadm init，并将相同的 DNS 名称传递给 kubeadm join。<br>                             稍后你可以修改 cluster-endpoint 以指向高可用性方案中的负载均衡器的地址。</p>\n<p> service-cidr               这个参数指定了 Kubernetes 集群中服务（Service）的 IP 地址范围。在该示例中，服务 IP 地址将从 10.119.0.0 开始分配。</p>\n<p> service-dns-domain         这个参数指定了 Kubernetes 集群中服务的 DNS 域名。在该示例中，服务的 DNS 域名将使用 “cluster.local”。</p>\n<p> pod-network-cidr  :    这个参数指定了 Kubernetes 集群中 Pod 的 IP 地址范围。在该示例中，Pod 的 IP 地址将从 10.120.0.0 开始分配。<br>                        指定 Pod 网络的范围。Kubernetes 支持多种网络方案，而且不同网络方案对<br>                        –pod-network-cidr有自己的要求，这里设置为10.244.0.0/16 是因为我们将使用 flannel 网络方案<br>                        必须设置成这个 CIDR。</p>\n<p> image-repository           这个用于指定从什么位置来拉取镜像（1.13版本才有的），默认值是k8s.gcr.io，<br>                            我们将其指定为国内镜像地址：registry.aliyuncs.com/google_containers</p>\n<p> kubernetes-version        指定kubenets版本号，默认值是stable-1，会导致从<a href=\"https://dl.k8s.io/release/stable-1.txt%E4%B8%8B%E8%BD%BD%E6%9C%80%E6%96%B0%E7%9A%84%E7%89%88%E6%9C%AC%E5%8F%B7%EF%BC%8C\">https://dl.k8s.io/release/stable-1.txt下载最新的版本号，</a><br>                           我们可以将其指定为固定版本（v1.22.1）来跳过网络请求</p>\n<h2 id=\"3-2配置示例：\"><a href=\"#3-2配置示例：\" class=\"headerlink\" title=\"3.2配置示例：\"></a>3.2配置示例：</h2><p> kubeadm init <br> –apiserver-advertise-address 192.168.240.11 <br> –apiserver-bind-port 6443 <br> –control-plane-endpoint 192.168.240.11 <br> –service-cidr=10.119.0.0/16 <br> –service-dns-domain=”cluster.local” <br> –pod-network-cidr=10.120.0.0/16 <br> –image-repository registry.aliyuncs.com/google_containers </p>\n<p> kubeadm init <br>  –apiserver-advertise-address=192.168.100.203 <br>  –image-repository registry.aliyuncs.com/google_containers <br>  –service-cidr=10.119.0.0/16 <br>  –pod-network-cidr=10.120.0.0/16 <br>  –kubernetes-version v1.28.2</p>\n<p> kubeadm init <br>   –apiserver-advertise-address=192.168.31.200 <br>   –image-repository registry.aliyuncs.com/google_containers <br>   –kubernetes-version v1.18.0 <br>   –service-cidr=10.96.0.0/12 <br>   –pod-network-cidr=10.244.0.0/16</p>\n<h2 id=\"3-3-配置-kubectl\"><a href=\"#3-3-配置-kubectl\" class=\"headerlink\" title=\"3.3 配置 kubectl\"></a>3.3 配置 kubectl</h2><p>   mkdir -p $HOME/.kube<br>   sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config<br>   sudo chown $(id -u):$(id -g) $HOME/.kube/config<br>   echo ‘export KUBECONFIG=$HOME/.kube/config’ &gt;&gt; $HOME/.bashrc<br>   source ~/.bashrc</p>\n<h2 id=\"3-3-配置网络\"><a href=\"#3-3-配置网络\" class=\"headerlink\" title=\"3.3 配置网络\"></a>3.3 配置网络</h2><p>   kubectl apply -f <a href=\"https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml\">https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</a></p>\n<p>   如果被墙，可以直接保存下列文件进行安装</p>\n<p>   kubectl apply -f kube-flannel.yaml</p>\n<h1 id=\"四、node-节点配置\"><a href=\"#四、node-节点配置\" class=\"headerlink\" title=\"四、node 节点配置\"></a>四、node 节点配置</h1><h2 id=\"4-1-配置文件处理\"><a href=\"#4-1-配置文件处理\" class=\"headerlink\" title=\"4.1 配置文件处理\"></a>4.1 配置文件处理</h2><p> mkdir -p $HOME/.kube</p>\n<p> 复制master节点的 /etc/kubernetes/admin.conf 到 node节点 $HOME/.kube/config</p>\n<p> sudo  $(id -u):$(id -g) $HOME/.kube/config</p>\n<p> echo ‘export KUBECONFIG=$HOME/.kube/config’ &gt;&gt; $HOME/.bashrc</p>\n<p> source ~/.bashrc</p>\n<h2 id=\"4-2-加入节点\"><a href=\"#4-2-加入节点\" class=\"headerlink\" title=\"4.2 加入节点\"></a>4.2 加入节点</h2><p>   可以master 节点执行  kubeadm token create –print-join-command 获取加入节点命令</p>\n<p>   kubeadm join 172.17.131.4:6443 –token decqn7.lwcygbjmzof0xny3  <br>   –discovery-token-ca-cert-hash sha256:8f0e8d2c04e38c7aa291d8b47be2bd8a5127bf1071263e01bdd5602ab331a01d</p>\n<h1 id=\"五、相关命令\"><a href=\"#五、相关命令\" class=\"headerlink\" title=\"五、相关命令\"></a>五、相关命令</h1><p> 如何生成 Kubeadm Join 命令？<br> 您可以使用 command 生成 join 命令。kubeadm token create –print-join-command</p>\n<p> 重置节点（清除kubeadm信息）<br> kubeadm reset</p>\n<p> 查看 pod 节点<br> kubectl get nodes</p>\n<p> 删除的节点<br> kubectl delete node <node_name></p>\n<p>于官网镜像在国内访问不稳定，会出现访问失败。<br>使用国内镜像进行替换下载，在此pause使用3.9会导致集群无法初始化，还需要下载pause:3.6<br>以下命令在每台服务器上执行<br>使用自定义镜像仓库拉取镜像<br>kubeadm config images pull  <br>–image-repository registry.aliyuncs.com/google_containers <br>–kubernetes-version v1.28.2</p>\n<h1 id=\"六-报错\"><a href=\"#六-报错\" class=\"headerlink\" title=\"六 报错\"></a>六 报错</h1><p> 报错如下<br> “open /run/systemd/resolve/resolv.conf: no such file or directory” pod=”kubelet<br> 解决：<br> yum install systemd-resolved 解决</p>\n<p>报错如下：<br>combined from similar events): Failed to create pod sandbox: rpc error: code = Unknown desc = failed to setup network for sandbox &amp;quot;4d992cde6a671b8fa3264a90f5f11aa01d1713376abf0cdf9a4e27ec82860185&amp;quot;: plugin type=&amp;quot;flannel&amp;quot; failed (add): loadFlannelSubnetEnv<br>failed: open /run/flannel/subnet.env: no such file or directory</p>\n<p>解决：<br>配置 /run/flannel/subnet.env<br>pod 网络信息 </p>\n<p>FLANNEL_NETWORK=10.120.0.0/16<br>FLANNEL_SUBNET=10.120.0.1/24<br>FLANNEL_MTU=1450<br>FLANNEL_IPMASQ=true</p>\n<p>报错如下：<br>[preflight] Running pre-flight checks<br>error execution phase preflight: [preflight] Some fatal errors occurred:<br>    [ERROR FileContent–proc-sys-net-ipv4-ip_forward]: /proc/sys/net/ipv4/ip_forward contents are not set to 1<br>[preflight] If you know what you are doing, you can make a check non-fatal with <code>--ignore-preflight-errors=...</code><br>To see the stack trace of this error execute with –v=5 or higher</p>\n<p> 解决：<br>sysctl -w net.ipv4.ip_forward=1</p>\n<p>报错如下：</p>\n<p> NotReady message:Network plugin returns error: cni plugin not initialized<br> to get sandbox image &quot;registry.k8s.i</p>\n<p> evel=info msg=”Stop CRI service”<br> 024-05-31T02:22:27.294384683Z” level=info msg=”stop pulling image registry.k8s.io/pause:3.8: active requests=1, bytes&gt;<br> 024-05-31T02:22:27.294515739Z” level=info msg=”trying next host” error=”failed to do request: Head &quot;<a href=\"https://us-west2&gt;/\">https://us-west2&gt;</a> </p>\n<p>解决</p>\n<p>containerd config default &gt; /etc/containerd/config.toml</p>\n<p>修改<br>sandbox_image = “registry.aliyuncs.com/google_containers/pause:3.9”</p>\n<p>systemctl restart containerd</p>\n<p>mkdir /etc/containerd<br>containerd config default &gt; /etc/containerd/config.toml<br>sed -i ‘/sandbox_image/s#registry.k8s.io/pause:3.8#registry.aliyuncs.com/google_containers/pause:3.9#g’ /etc/containerd/config.toml<br>sed -i ‘/SystemdCgroup/s/false/true/‘ /etc/containerd/config.toml<br>systemctl restart containerd</p>\n<p>发现不了节点报错<br><a href=\"https://blog.csdn.net/qq_32264301/article/details/125486521\">https://blog.csdn.net/qq_32264301/article/details/125486521</a></p>\n<p> error=”rpc error: code = Unavailable desc = error reading from server: EOF” module=libcontainerd namespace=moby</p>\n<p>报错<br>Error registering network: failed to acquire lease: subnet “10.244.0.0/16”<br>specified in the flannel net config doesn’t contain “10.120.0.0/24” PodCIDR of the “ubuntuutoootest” node </p>\n<p>修改 kube-flannel.yml</p>\n<p>net-conf.json: |<br>    {<br>      “Network”: “10.120.0.0/16”,<br>      “EnableNFTables”: false,<br>      “Backend”: {<br>        “Type”: “vxlan”<br>      }<br>    }</p>\n<hr>\n<h1 id=\"k8组件\"><a href=\"#k8组件\" class=\"headerlink\" title=\"k8组件\"></a>k8组件</h1><p>k8s的主要组件，以及它们主要是用来干什么的：</p>\n<p>3.1 「主节点（Master）」<br>主节点负责管理集群的整体状态和控制工作节点的操作。它包括以下组件：</p>\n<p>「API Server：」 提供了K8s API的入口，用于与Kubernetes进行交互。<br>「Controller Manager：」 负责监控系统状态，确保实际状态符合期望状态。<br>「Scheduler：」 负责将Pod调度到工作节点上运行。</p>\n<p>3.2 「工作节点（Node）」<br>工作节点是集群中的计算资源，用于运行容器。每个工作节点包括以下组件：</p>\n<p>「Kubelet：」 负责与主节点通信，确保在节点上运行所需的Pod。<br>「Container Runtime：」 用于启动和管理容器的软件，如Docker。<br>「Kube Proxy：」 负责在节点上实现Service的网络代理。</p>\n<p>etcd：一款开源软件。提供可靠的分布式数据存储服务，用于持久化存储K8s集群的配置和状态</p>\n<p>apiservice：用户程序（如kubectl）、K8s其它组件之间通信的接口。K8s其它组件之间不直接通信，而是通过API server通信的。这一点在上图的连接中可以体现，例如，只有API server连接了etcd，即其它组件更新K8s集群的状态时，只能通过API server读写etcd中的数据。</p>\n<p>Scheduler：排程组件，为用户应用的每一可部署组件分配工作结点。</p>\n<p>controller-manager：执行集群级别的功能，如复制组件、追踪工作结点状态、处理结点失败等。Controller Manager组件是由多个控制器组成的，其中很多控制器是按K8s的资源类型划分的，如Replication Manager（管理ReplicationController 资源），ReplicaSet Controller，PersistentVolume controller。</p>\n<p>kube-proxy：在应用组件间负载均衡网络流量。</p>\n<p>kubelet：管理工作结点上的容器。</p>\n<p>Contriner runtime Docker， rkt等实际运行容器的组件</p>\n<p>报错</p>\n<p>报错</p>\n","site":{"data":{}},"length":7662,"excerpt":"","more":"<h1 id=\"一、redhat-openEluer-22-Centos-系统-安装k8s\"><a href=\"#一、redhat-openEluer-22-Centos-系统-安装k8s\" class=\"headerlink\" title=\"一、redhat/openEluer 22/Centos 系统 安装k8s\"></a>一、redhat/openEluer 22/Centos 系统 安装k8s</h1><h2 id=\"1-1-更新源\"><a href=\"#1-1-更新源\" class=\"headerlink\" title=\"1.1 更新源\"></a>1.1 更新源</h2><p>wget -O /etc/yum.repos.d/CentOS-Base.repo <a href=\"http://mirrors.aliyun.com/repo/Centos-7.repo\">http://mirrors.aliyun.com/repo/Centos-7.repo</a><br>编辑替换  %s/$releasever/7/g</p>\n<p>设置仓库，需要安装所需的软件包。yum-utils 提供了 yum-config-manager ，<br>并且 device mapper 存储驱动程序需要 device-mapper-persistent-data 和 lvm2</p>\n<p>yum install -y yum-utils device-mapper-persistent-data lvm2</p>\n<p>yum-config-manager –add-repo <a href=\"https://download.docker.com/linux/centos/docker-ce.repo\">https://download.docker.com/linux/centos/docker-ce.repo</a><br>编辑替换  %s/$releasever/7/g</p>\n<h2 id=\"1-2-安装-docker\"><a href=\"#1-2-安装-docker\" class=\"headerlink\" title=\"1.2 安装 docker\"></a>1.2 安装 docker</h2><p>yum install docker-ce</p>\n<h2 id=\"1-3-新增k8s源及安装\"><a href=\"#1-3-新增k8s源及安装\" class=\"headerlink\" title=\"1.3 新增k8s源及安装\"></a>1.3 新增k8s源及安装</h2><p>新增k8s源<br>cat &lt;<EOF > /etc/yum.repos.d/kubernetes.repo<br>[kubernetes]<br>name=Kubernetes<br>baseurl=<a href=\"https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/\">https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/</a><br>enabled=1<br>gpgcheck=0<br>EOF</p>\n<p>yum install kubeadm kubelet kubectl </p>\n<h1 id=\"二、ubuntu-系统安装-k8s\"><a href=\"#二、ubuntu-系统安装-k8s\" class=\"headerlink\" title=\"二、ubuntu 系统安装 k8s\"></a>二、ubuntu 系统安装 k8s</h1><p> sudo apt-get install -y apt-transport-https ca-certificates curl software-properties-common</p>\n<p> curl -s <a href=\"https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg\">https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg</a> | sudo apt-key add -</p>\n<p> sudo apt-add-repository “deb <a href=\"https://mirrors.aliyun.com/kubernetes/apt/\">https://mirrors.aliyun.com/kubernetes/apt/</a> kubernetes-xenial main”</p>\n<p> sudo apt-get update</p>\n<p>  vi /etc/apt/sources.list</p>\n<p> deb <a href=\"https://mirrors.aliyun.com/kubernetes/apt\">https://mirrors.aliyun.com/kubernetes/apt</a> kubernetes-xenial main</p>\n<p> apt-get update<br> sudo apt update</p>\n<p> #sudo apt install -y kubelet=1.26.1-00 kubeadm=1.26.1-00 kubectl=1.26.1-00</p>\n<p> sudo apt install kubelet kubeadm kubectl<br> sudo apt-mark hold kubelet kubeadm kubectl</p>\n<h1 id=\"三、必要的系统设置\"><a href=\"#三、必要的系统设置\" class=\"headerlink\" title=\"三、必要的系统设置\"></a>三、必要的系统设置</h1><h2 id=\"3-1-关闭-selinux-关闭防火墙【暂时】（redhat系统）\"><a href=\"#3-1-关闭-selinux-关闭防火墙【暂时】（redhat系统）\" class=\"headerlink\" title=\"3.1 关闭 selinux  关闭防火墙【暂时】（redhat系统）\"></a>3.1 关闭 selinux  关闭防火墙【暂时】（redhat系统）</h2><p>零时关闭<br>   setenforce 0  </p>\n<p>永久关闭<br>       vi /etc/selinux/config<br>       将参数修改为SELINUX=disabled</p>\n<p>关闭防火墙</p>\n<p>   systemctl stop iptables</p>\n<p>   systemctl stop firewalld</p>\n<p>   systemct stop ufw</p>\n<h2 id=\"3-2-禁用交换分区\"><a href=\"#3-2-禁用交换分区\" class=\"headerlink\" title=\"3.2 禁用交换分区\"></a>3.2 禁用交换分区</h2><p>   swapoff -a </p>\n<p>   /etc/fstab 文件下永久关闭<br>   打开/etc/fstab注释掉swap那一行</p>\n<p>   sed -i ‘s/.<em>swap.</em>/#&amp;/‘ /etc/fstab  </p>\n<h2 id=\"3-3-开启端口转发\"><a href=\"#3-3-开启端口转发\" class=\"headerlink\" title=\"3.3 开启端口转发\"></a>3.3 开启端口转发</h2><p>   vim  /proc/sys/net/ipv4/ip_forward<br>   sysctl -w net.ipv4.ip_forward=1</p>\n<h2 id=\"3-4-修改内核参数\"><a href=\"#3-4-修改内核参数\" class=\"headerlink\" title=\"3.4 修改内核参数\"></a>3.4 修改内核参数</h2><p>cat &lt;<EOF >  /etc/sysctl.d/k8s.conf<br>net.bridge.bridge-nf-call-ip6tables = 1<br>net.bridge.bridge-nf-call-iptables = 1<br>EOF<br>sysctl –system </p>\n<h2 id=\"3-5-设置时区更新时间\"><a href=\"#3-5-设置时区更新时间\" class=\"headerlink\" title=\"3.5 设置时区更新时间\"></a>3.5 设置时区更新时间</h2><pre><code> timedatectl  查看时区\n \n 设置时区\n timedatectl set-timezone Asia/Shanghai\n \n</code></pre>\n<h2 id=\"配置host\"><a href=\"#配置host\" class=\"headerlink\" title=\"配置host\"></a>配置host</h2><pre><code>vim /etc/hosts\n\n \n</code></pre>\n<h1 id=\"三、master-节点配置\"><a href=\"#三、master-节点配置\" class=\"headerlink\" title=\"三、master 节点配置\"></a>三、master 节点配置</h1><h2 id=\"3-1-配置项-解释\"><a href=\"#3-1-配置项-解释\" class=\"headerlink\" title=\"3.1 配置项 解释\"></a>3.1 配置项 解释</h2><p> 自定义镜像进行初始化(推荐)<br> 使用自定义kubernets镜像仓库进行初始化</p>\n<p> apiserver-advertise-address: 配置 apiserver ip  本机ip<br>                             指明用 Master 的哪个 interface 与 Cluster 的其他节点通信。<br>                             如果 Master 有多个 interface，建议明确指定，如果不指定，kubeadm 会自动选择有默认网关的 interface。<br>                             这里的ip为master节点ip，记得更换</p>\n<p> apiserver-bind-port       : 配置 apiserver 端口 默认 6443</p>\n<p> control-plane-endpoint    : 配置 控制端   ip  默认本机ip<br>                             cluster-endpoint 是映射到该 IP 的自定义 DNS 名称，这里配置hosts映射：192.168.0.113   cluster-endpoint。<br>                             这将允许你将 –control-plane-endpoint=cluster-endpoint 传递给 kubeadm init，并将相同的 DNS 名称传递给 kubeadm join。<br>                             稍后你可以修改 cluster-endpoint 以指向高可用性方案中的负载均衡器的地址。</p>\n<p> service-cidr               这个参数指定了 Kubernetes 集群中服务（Service）的 IP 地址范围。在该示例中，服务 IP 地址将从 10.119.0.0 开始分配。</p>\n<p> service-dns-domain         这个参数指定了 Kubernetes 集群中服务的 DNS 域名。在该示例中，服务的 DNS 域名将使用 “cluster.local”。</p>\n<p> pod-network-cidr  :    这个参数指定了 Kubernetes 集群中 Pod 的 IP 地址范围。在该示例中，Pod 的 IP 地址将从 10.120.0.0 开始分配。<br>                        指定 Pod 网络的范围。Kubernetes 支持多种网络方案，而且不同网络方案对<br>                        –pod-network-cidr有自己的要求，这里设置为10.244.0.0/16 是因为我们将使用 flannel 网络方案<br>                        必须设置成这个 CIDR。</p>\n<p> image-repository           这个用于指定从什么位置来拉取镜像（1.13版本才有的），默认值是k8s.gcr.io，<br>                            我们将其指定为国内镜像地址：registry.aliyuncs.com/google_containers</p>\n<p> kubernetes-version        指定kubenets版本号，默认值是stable-1，会导致从<a href=\"https://dl.k8s.io/release/stable-1.txt%E4%B8%8B%E8%BD%BD%E6%9C%80%E6%96%B0%E7%9A%84%E7%89%88%E6%9C%AC%E5%8F%B7%EF%BC%8C\">https://dl.k8s.io/release/stable-1.txt下载最新的版本号，</a><br>                           我们可以将其指定为固定版本（v1.22.1）来跳过网络请求</p>\n<h2 id=\"3-2配置示例：\"><a href=\"#3-2配置示例：\" class=\"headerlink\" title=\"3.2配置示例：\"></a>3.2配置示例：</h2><p> kubeadm init <br> –apiserver-advertise-address 192.168.240.11 <br> –apiserver-bind-port 6443 <br> –control-plane-endpoint 192.168.240.11 <br> –service-cidr=10.119.0.0/16 <br> –service-dns-domain=”cluster.local” <br> –pod-network-cidr=10.120.0.0/16 <br> –image-repository registry.aliyuncs.com/google_containers </p>\n<p> kubeadm init <br>  –apiserver-advertise-address=192.168.100.203 <br>  –image-repository registry.aliyuncs.com/google_containers <br>  –service-cidr=10.119.0.0/16 <br>  –pod-network-cidr=10.120.0.0/16 <br>  –kubernetes-version v1.28.2</p>\n<p> kubeadm init <br>   –apiserver-advertise-address=192.168.31.200 <br>   –image-repository registry.aliyuncs.com/google_containers <br>   –kubernetes-version v1.18.0 <br>   –service-cidr=10.96.0.0/12 <br>   –pod-network-cidr=10.244.0.0/16</p>\n<h2 id=\"3-3-配置-kubectl\"><a href=\"#3-3-配置-kubectl\" class=\"headerlink\" title=\"3.3 配置 kubectl\"></a>3.3 配置 kubectl</h2><p>   mkdir -p $HOME/.kube<br>   sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config<br>   sudo chown $(id -u):$(id -g) $HOME/.kube/config<br>   echo ‘export KUBECONFIG=$HOME/.kube/config’ &gt;&gt; $HOME/.bashrc<br>   source ~/.bashrc</p>\n<h2 id=\"3-3-配置网络\"><a href=\"#3-3-配置网络\" class=\"headerlink\" title=\"3.3 配置网络\"></a>3.3 配置网络</h2><p>   kubectl apply -f <a href=\"https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml\">https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</a></p>\n<p>   如果被墙，可以直接保存下列文件进行安装</p>\n<p>   kubectl apply -f kube-flannel.yaml</p>\n<h1 id=\"四、node-节点配置\"><a href=\"#四、node-节点配置\" class=\"headerlink\" title=\"四、node 节点配置\"></a>四、node 节点配置</h1><h2 id=\"4-1-配置文件处理\"><a href=\"#4-1-配置文件处理\" class=\"headerlink\" title=\"4.1 配置文件处理\"></a>4.1 配置文件处理</h2><p> mkdir -p $HOME/.kube</p>\n<p> 复制master节点的 /etc/kubernetes/admin.conf 到 node节点 $HOME/.kube/config</p>\n<p> sudo  $(id -u):$(id -g) $HOME/.kube/config</p>\n<p> echo ‘export KUBECONFIG=$HOME/.kube/config’ &gt;&gt; $HOME/.bashrc</p>\n<p> source ~/.bashrc</p>\n<h2 id=\"4-2-加入节点\"><a href=\"#4-2-加入节点\" class=\"headerlink\" title=\"4.2 加入节点\"></a>4.2 加入节点</h2><p>   可以master 节点执行  kubeadm token create –print-join-command 获取加入节点命令</p>\n<p>   kubeadm join 172.17.131.4:6443 –token decqn7.lwcygbjmzof0xny3  <br>   –discovery-token-ca-cert-hash sha256:8f0e8d2c04e38c7aa291d8b47be2bd8a5127bf1071263e01bdd5602ab331a01d</p>\n<h1 id=\"五、相关命令\"><a href=\"#五、相关命令\" class=\"headerlink\" title=\"五、相关命令\"></a>五、相关命令</h1><p> 如何生成 Kubeadm Join 命令？<br> 您可以使用 command 生成 join 命令。kubeadm token create –print-join-command</p>\n<p> 重置节点（清除kubeadm信息）<br> kubeadm reset</p>\n<p> 查看 pod 节点<br> kubectl get nodes</p>\n<p> 删除的节点<br> kubectl delete node <node_name></p>\n<p>于官网镜像在国内访问不稳定，会出现访问失败。<br>使用国内镜像进行替换下载，在此pause使用3.9会导致集群无法初始化，还需要下载pause:3.6<br>以下命令在每台服务器上执行<br>使用自定义镜像仓库拉取镜像<br>kubeadm config images pull  <br>–image-repository registry.aliyuncs.com/google_containers <br>–kubernetes-version v1.28.2</p>\n<h1 id=\"六-报错\"><a href=\"#六-报错\" class=\"headerlink\" title=\"六 报错\"></a>六 报错</h1><p> 报错如下<br> “open /run/systemd/resolve/resolv.conf: no such file or directory” pod=”kubelet<br> 解决：<br> yum install systemd-resolved 解决</p>\n<p>报错如下：<br>combined from similar events): Failed to create pod sandbox: rpc error: code = Unknown desc = failed to setup network for sandbox &amp;quot;4d992cde6a671b8fa3264a90f5f11aa01d1713376abf0cdf9a4e27ec82860185&amp;quot;: plugin type=&amp;quot;flannel&amp;quot; failed (add): loadFlannelSubnetEnv<br>failed: open /run/flannel/subnet.env: no such file or directory</p>\n<p>解决：<br>配置 /run/flannel/subnet.env<br>pod 网络信息 </p>\n<p>FLANNEL_NETWORK=10.120.0.0/16<br>FLANNEL_SUBNET=10.120.0.1/24<br>FLANNEL_MTU=1450<br>FLANNEL_IPMASQ=true</p>\n<p>报错如下：<br>[preflight] Running pre-flight checks<br>error execution phase preflight: [preflight] Some fatal errors occurred:<br>    [ERROR FileContent–proc-sys-net-ipv4-ip_forward]: /proc/sys/net/ipv4/ip_forward contents are not set to 1<br>[preflight] If you know what you are doing, you can make a check non-fatal with <code>--ignore-preflight-errors=...</code><br>To see the stack trace of this error execute with –v=5 or higher</p>\n<p> 解决：<br>sysctl -w net.ipv4.ip_forward=1</p>\n<p>报错如下：</p>\n<p> NotReady message:Network plugin returns error: cni plugin not initialized<br> to get sandbox image &quot;registry.k8s.i</p>\n<p> evel=info msg=”Stop CRI service”<br> 024-05-31T02:22:27.294384683Z” level=info msg=”stop pulling image registry.k8s.io/pause:3.8: active requests=1, bytes&gt;<br> 024-05-31T02:22:27.294515739Z” level=info msg=”trying next host” error=”failed to do request: Head &quot;<a href=\"https://us-west2&gt;/\">https://us-west2&gt;</a> </p>\n<p>解决</p>\n<p>containerd config default &gt; /etc/containerd/config.toml</p>\n<p>修改<br>sandbox_image = “registry.aliyuncs.com/google_containers/pause:3.9”</p>\n<p>systemctl restart containerd</p>\n<p>mkdir /etc/containerd<br>containerd config default &gt; /etc/containerd/config.toml<br>sed -i ‘/sandbox_image/s#registry.k8s.io/pause:3.8#registry.aliyuncs.com/google_containers/pause:3.9#g’ /etc/containerd/config.toml<br>sed -i ‘/SystemdCgroup/s/false/true/‘ /etc/containerd/config.toml<br>systemctl restart containerd</p>\n<p>发现不了节点报错<br><a href=\"https://blog.csdn.net/qq_32264301/article/details/125486521\">https://blog.csdn.net/qq_32264301/article/details/125486521</a></p>\n<p> error=”rpc error: code = Unavailable desc = error reading from server: EOF” module=libcontainerd namespace=moby</p>\n<p>报错<br>Error registering network: failed to acquire lease: subnet “10.244.0.0/16”<br>specified in the flannel net config doesn’t contain “10.120.0.0/24” PodCIDR of the “ubuntuutoootest” node </p>\n<p>修改 kube-flannel.yml</p>\n<p>net-conf.json: |<br>    {<br>      “Network”: “10.120.0.0/16”,<br>      “EnableNFTables”: false,<br>      “Backend”: {<br>        “Type”: “vxlan”<br>      }<br>    }</p>\n<hr>\n<h1 id=\"k8组件\"><a href=\"#k8组件\" class=\"headerlink\" title=\"k8组件\"></a>k8组件</h1><p>k8s的主要组件，以及它们主要是用来干什么的：</p>\n<p>3.1 「主节点（Master）」<br>主节点负责管理集群的整体状态和控制工作节点的操作。它包括以下组件：</p>\n<p>「API Server：」 提供了K8s API的入口，用于与Kubernetes进行交互。<br>「Controller Manager：」 负责监控系统状态，确保实际状态符合期望状态。<br>「Scheduler：」 负责将Pod调度到工作节点上运行。</p>\n<p>3.2 「工作节点（Node）」<br>工作节点是集群中的计算资源，用于运行容器。每个工作节点包括以下组件：</p>\n<p>「Kubelet：」 负责与主节点通信，确保在节点上运行所需的Pod。<br>「Container Runtime：」 用于启动和管理容器的软件，如Docker。<br>「Kube Proxy：」 负责在节点上实现Service的网络代理。</p>\n<p>etcd：一款开源软件。提供可靠的分布式数据存储服务，用于持久化存储K8s集群的配置和状态</p>\n<p>apiservice：用户程序（如kubectl）、K8s其它组件之间通信的接口。K8s其它组件之间不直接通信，而是通过API server通信的。这一点在上图的连接中可以体现，例如，只有API server连接了etcd，即其它组件更新K8s集群的状态时，只能通过API server读写etcd中的数据。</p>\n<p>Scheduler：排程组件，为用户应用的每一可部署组件分配工作结点。</p>\n<p>controller-manager：执行集群级别的功能，如复制组件、追踪工作结点状态、处理结点失败等。Controller Manager组件是由多个控制器组成的，其中很多控制器是按K8s的资源类型划分的，如Replication Manager（管理ReplicationController 资源），ReplicaSet Controller，PersistentVolume controller。</p>\n<p>kube-proxy：在应用组件间负载均衡网络流量。</p>\n<p>kubelet：管理工作结点上的容器。</p>\n<p>Contriner runtime Docker， rkt等实际运行容器的组件</p>\n<p>报错</p>\n<p>报错</p>\n"},{"title":"jenkins-发布php项目","abbrlink":"49b184d4","date":"2023-07-19T01:16:30.000Z","_content":"","source":"_posts/jenkins-发布php项目.md","raw":"---\ntitle: jenkins-发布php项目\nabbrlink: 49b184d4\ncategories:\n  - 服务器相关\ndate: 2023-07-19 09:16:30\ntags:\n---\n","slug":"jenkins-发布php项目","published":1,"updated":"2024-02-06T11:02:33.140Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv4g0018pcoc70d6063s","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"openEuler搭建lnmp","abbrlink":"b991678b","date":"2023-07-09T06:04:46.000Z","_content":"\n#openEuler搭建lnmp\n\n##安装php\nwget https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n\nrpm -ivh --nodeps epel-release-latest-7.noarch.rp\n\nwget https://rpms.remirepo.net/enterprise/remi-release-7.rpm\n\nrpm -ivh --nodeps remi-release-7.rpm \n\nyum-config-manager --enable remi-php73\n\nyum install php73 php73-php-fpm php73-php-opcache php73-php-gd php73-php-mbstring php73-php-xml php73-php-pdo php73-php-mysqlnd php73-php-pecl-mysql php73-php-bcmath\n\n\n\n##rpm包安装mysql\n\n    Error: \n     Problem: cannot install the best candidate for the job\n      - nothing provides libcrypto.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libssl.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libcrypto.so.10(libcrypto.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libssl.so.10(libssl.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libcrypto.so.10(OPENSSL_1.0.1_EC)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libcrypto.so.10(OPENSSL_1.0.2)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      \n此报错处理办法      \n\n    yum install compat-openssl10\n    yum install http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-3.el8.x86_64.rpm","source":"_posts/openEuler搭建lnmp.md","raw":"---\ntitle: openEuler搭建lnmp\nabbrlink: b991678b\ncategories:\n  - 服务器相关\n  - openEnler\ndate: 2023-07-09 14:04:46\ntags:\n---\n\n#openEuler搭建lnmp\n\n##安装php\nwget https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n\nrpm -ivh --nodeps epel-release-latest-7.noarch.rp\n\nwget https://rpms.remirepo.net/enterprise/remi-release-7.rpm\n\nrpm -ivh --nodeps remi-release-7.rpm \n\nyum-config-manager --enable remi-php73\n\nyum install php73 php73-php-fpm php73-php-opcache php73-php-gd php73-php-mbstring php73-php-xml php73-php-pdo php73-php-mysqlnd php73-php-pecl-mysql php73-php-bcmath\n\n\n\n##rpm包安装mysql\n\n    Error: \n     Problem: cannot install the best candidate for the job\n      - nothing provides libcrypto.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libssl.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libcrypto.so.10(libcrypto.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libssl.so.10(libssl.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libcrypto.so.10(OPENSSL_1.0.1_EC)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libcrypto.so.10(OPENSSL_1.0.2)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      \n此报错处理办法      \n\n    yum install compat-openssl10\n    yum install http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-3.el8.x86_64.rpm","slug":"openEuler搭建lnmp","published":1,"updated":"2024-11-25T11:24:15.777Z","_id":"clxb4gv4o001mpcoc5wczb1wu","comments":1,"layout":"post","photos":[],"link":"","content":"<p>#openEuler搭建lnmp</p>\n<p>##安装php<br>wget <a href=\"https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\">https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</a></p>\n<p>rpm -ivh –nodeps epel-release-latest-7.noarch.rp</p>\n<p>wget <a href=\"https://rpms.remirepo.net/enterprise/remi-release-7.rpm\">https://rpms.remirepo.net/enterprise/remi-release-7.rpm</a></p>\n<p>rpm -ivh –nodeps remi-release-7.rpm </p>\n<p>yum-config-manager –enable remi-php73</p>\n<p>yum install php73 php73-php-fpm php73-php-opcache php73-php-gd php73-php-mbstring php73-php-xml php73-php-pdo php73-php-mysqlnd php73-php-pecl-mysql php73-php-bcmath</p>\n<p>##rpm包安装mysql</p>\n<pre><code>Error: \n Problem: cannot install the best candidate for the job\n  - nothing provides libcrypto.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libssl.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libcrypto.so.10(libcrypto.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libssl.so.10(libssl.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libcrypto.so.10(OPENSSL_1.0.1_EC)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libcrypto.so.10(OPENSSL_1.0.2)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  \n</code></pre>\n<p>此报错处理办法      </p>\n<pre><code>yum install compat-openssl10\nyum install http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-3.el8.x86_64.rpm\n</code></pre>\n","site":{"data":{}},"length":1212,"excerpt":"","more":"<p>#openEuler搭建lnmp</p>\n<p>##安装php<br>wget <a href=\"https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\">https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</a></p>\n<p>rpm -ivh –nodeps epel-release-latest-7.noarch.rp</p>\n<p>wget <a href=\"https://rpms.remirepo.net/enterprise/remi-release-7.rpm\">https://rpms.remirepo.net/enterprise/remi-release-7.rpm</a></p>\n<p>rpm -ivh –nodeps remi-release-7.rpm </p>\n<p>yum-config-manager –enable remi-php73</p>\n<p>yum install php73 php73-php-fpm php73-php-opcache php73-php-gd php73-php-mbstring php73-php-xml php73-php-pdo php73-php-mysqlnd php73-php-pecl-mysql php73-php-bcmath</p>\n<p>##rpm包安装mysql</p>\n<pre><code>Error: \n Problem: cannot install the best candidate for the job\n  - nothing provides libcrypto.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libssl.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libcrypto.so.10(libcrypto.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libssl.so.10(libssl.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libcrypto.so.10(OPENSSL_1.0.1_EC)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libcrypto.so.10(OPENSSL_1.0.2)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  \n</code></pre>\n<p>此报错处理办法      </p>\n<pre><code>yum install compat-openssl10\nyum install http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-3.el8.x86_64.rpm\n</code></pre>\n"},{"title":"openEuler系统安装遇到问题","abbrlink":"a9da9b42","date":"2023-11-10T03:59:43.000Z","_content":"\n\n#yum 安装报依赖库找不到问题\n\n    openEuler release 22.03版本\n    \n    替换centos 7的源就可以\n    \n    具体命令：wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\n    \n    然后 将文件中$releasever替换7\n    \n    具体命令：vim 后  %s/$releasever/7/g\n    \n    \n# 安装 yum install nginx 报错\n\n    Error: \n     Problem: 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libcrypto.so.10()(64bit)，但没有提供者可以被安装\n      - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libcrypto.so.10(libcrypto.so.10)(64bit)，但没有提供者可以被安装\n      - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libssl.so.10()(64bit)，但没有提供者可以被安装\n      - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libssl.so.10(libssl.so.10)(64bit)，但没有提供者可以被安装\n      - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libcrypto.so.10(OPENSSL_1.0.2)(64bit)，但没有提供者可以被安装\n      - 无法同时安装 openssl-libs-1:1.0.2k-19.el7.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n      - 无法同时安装 openssl-libs-1:1.0.2k-21.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n      - 无法同时安装 openssl-libs-1:1.0.2k-22.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n      - 无法同时安装 openssl-libs-1:1.0.2k-24.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n      - 无法同时安装 openssl-libs-1:1.0.2k-25.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n      - 无法同时安装 openssl-libs-1:1.0.2k-26.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n      - 软件包 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64 需要 libcrypto.so.1.1()(64bit)，但没有提供者可以被安装\n      - 软件包 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64 需要 libcrypto.so.1.1(OPENSSL_1_1_0)(64bit)，但没有提供者可以被安装\n      - 软件包 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64 需要 libcrypto.so.1.1(OPENSSL_1_1_1)(64bit)，但没有提供者可以被安装\n      - 无法为该任务安装最佳候选\n      - 安装的软件包的问题 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64\n    (try to add '--allowerasing' to command line to replace conflicting packages or '--skip-broken' to skip uninstallable packages or '--nobest' to use not only best candidate packages)\n    \n    \n    解决方案\n    yum install compat-openssl10\n    yum install http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-3.el8.x86_64.rpm","source":"_posts/openEuler系统安装遇到问题.md","raw":"---\ntitle: openEuler系统安装遇到问题\nabbrlink: a9da9b42\ncategories:\n  - 服务器相关\ndate: 2023-11-10 11:59:43\ntags:\n---\n\n\n#yum 安装报依赖库找不到问题\n\n    openEuler release 22.03版本\n    \n    替换centos 7的源就可以\n    \n    具体命令：wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\n    \n    然后 将文件中$releasever替换7\n    \n    具体命令：vim 后  %s/$releasever/7/g\n    \n    \n# 安装 yum install nginx 报错\n\n    Error: \n     Problem: 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libcrypto.so.10()(64bit)，但没有提供者可以被安装\n      - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libcrypto.so.10(libcrypto.so.10)(64bit)，但没有提供者可以被安装\n      - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libssl.so.10()(64bit)，但没有提供者可以被安装\n      - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libssl.so.10(libssl.so.10)(64bit)，但没有提供者可以被安装\n      - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libcrypto.so.10(OPENSSL_1.0.2)(64bit)，但没有提供者可以被安装\n      - 无法同时安装 openssl-libs-1:1.0.2k-19.el7.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n      - 无法同时安装 openssl-libs-1:1.0.2k-21.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n      - 无法同时安装 openssl-libs-1:1.0.2k-22.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n      - 无法同时安装 openssl-libs-1:1.0.2k-24.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n      - 无法同时安装 openssl-libs-1:1.0.2k-25.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n      - 无法同时安装 openssl-libs-1:1.0.2k-26.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n      - 软件包 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64 需要 libcrypto.so.1.1()(64bit)，但没有提供者可以被安装\n      - 软件包 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64 需要 libcrypto.so.1.1(OPENSSL_1_1_0)(64bit)，但没有提供者可以被安装\n      - 软件包 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64 需要 libcrypto.so.1.1(OPENSSL_1_1_1)(64bit)，但没有提供者可以被安装\n      - 无法为该任务安装最佳候选\n      - 安装的软件包的问题 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64\n    (try to add '--allowerasing' to command line to replace conflicting packages or '--skip-broken' to skip uninstallable packages or '--nobest' to use not only best candidate packages)\n    \n    \n    解决方案\n    yum install compat-openssl10\n    yum install http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-3.el8.x86_64.rpm","slug":"openEuler系统安装遇到问题","published":1,"updated":"2024-02-06T11:00:18.612Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv4r001wpcoc1dxvbp8f","content":"<p>#yum 安装报依赖库找不到问题</p>\n<pre><code>openEuler release 22.03版本\n\n替换centos 7的源就可以\n\n具体命令：wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\n\n然后 将文件中$releasever替换7\n\n具体命令：vim 后  %s/$releasever/7/g\n</code></pre>\n<h1 id=\"安装-yum-install-nginx-报错\"><a href=\"#安装-yum-install-nginx-报错\" class=\"headerlink\" title=\"安装 yum install nginx 报错\"></a>安装 yum install nginx 报错</h1><pre><code>Error: \n Problem: 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libcrypto.so.10()(64bit)，但没有提供者可以被安装\n  - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libcrypto.so.10(libcrypto.so.10)(64bit)，但没有提供者可以被安装\n  - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libssl.so.10()(64bit)，但没有提供者可以被安装\n  - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libssl.so.10(libssl.so.10)(64bit)，但没有提供者可以被安装\n  - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libcrypto.so.10(OPENSSL_1.0.2)(64bit)，但没有提供者可以被安装\n  - 无法同时安装 openssl-libs-1:1.0.2k-19.el7.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n  - 无法同时安装 openssl-libs-1:1.0.2k-21.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n  - 无法同时安装 openssl-libs-1:1.0.2k-22.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n  - 无法同时安装 openssl-libs-1:1.0.2k-24.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n  - 无法同时安装 openssl-libs-1:1.0.2k-25.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n  - 无法同时安装 openssl-libs-1:1.0.2k-26.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n  - 软件包 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64 需要 libcrypto.so.1.1()(64bit)，但没有提供者可以被安装\n  - 软件包 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64 需要 libcrypto.so.1.1(OPENSSL_1_1_0)(64bit)，但没有提供者可以被安装\n  - 软件包 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64 需要 libcrypto.so.1.1(OPENSSL_1_1_1)(64bit)，但没有提供者可以被安装\n  - 无法为该任务安装最佳候选\n  - 安装的软件包的问题 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64\n(try to add &#39;--allowerasing&#39; to command line to replace conflicting packages or &#39;--skip-broken&#39; to skip uninstallable packages or &#39;--nobest&#39; to use not only best candidate packages)\n\n\n解决方案\nyum install compat-openssl10\nyum install http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-3.el8.x86_64.rpm\n</code></pre>\n","site":{"data":{}},"length":1794,"excerpt":"","more":"<p>#yum 安装报依赖库找不到问题</p>\n<pre><code>openEuler release 22.03版本\n\n替换centos 7的源就可以\n\n具体命令：wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\n\n然后 将文件中$releasever替换7\n\n具体命令：vim 后  %s/$releasever/7/g\n</code></pre>\n<h1 id=\"安装-yum-install-nginx-报错\"><a href=\"#安装-yum-install-nginx-报错\" class=\"headerlink\" title=\"安装 yum install nginx 报错\"></a>安装 yum install nginx 报错</h1><pre><code>Error: \n Problem: 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libcrypto.so.10()(64bit)，但没有提供者可以被安装\n  - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libcrypto.so.10(libcrypto.so.10)(64bit)，但没有提供者可以被安装\n  - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libssl.so.10()(64bit)，但没有提供者可以被安装\n  - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libssl.so.10(libssl.so.10)(64bit)，但没有提供者可以被安装\n  - 软件包 nginx-1:1.24.0-1.el7.ngx.x86_64 需要 libcrypto.so.10(OPENSSL_1.0.2)(64bit)，但没有提供者可以被安装\n  - 无法同时安装 openssl-libs-1:1.0.2k-19.el7.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n  - 无法同时安装 openssl-libs-1:1.0.2k-21.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n  - 无法同时安装 openssl-libs-1:1.0.2k-22.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n  - 无法同时安装 openssl-libs-1:1.0.2k-24.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n  - 无法同时安装 openssl-libs-1:1.0.2k-25.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n  - 无法同时安装 openssl-libs-1:1.0.2k-26.el7_9.x86_64 和 openssl-libs-1:1.1.1m-22.oe2203.x86_64\n  - 软件包 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64 需要 libcrypto.so.1.1()(64bit)，但没有提供者可以被安装\n  - 软件包 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64 需要 libcrypto.so.1.1(OPENSSL_1_1_0)(64bit)，但没有提供者可以被安装\n  - 软件包 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64 需要 libcrypto.so.1.1(OPENSSL_1_1_1)(64bit)，但没有提供者可以被安装\n  - 无法为该任务安装最佳候选\n  - 安装的软件包的问题 ima-evm-utils-libs-1.3.2-8.oe2203sp1.x86_64\n(try to add &#39;--allowerasing&#39; to command line to replace conflicting packages or &#39;--skip-broken&#39; to skip uninstallable packages or &#39;--nobest&#39; to use not only best candidate packages)\n\n\n解决方案\nyum install compat-openssl10\nyum install http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-3.el8.x86_64.rpm\n</code></pre>\n"},{"title":"php开发-mysql锁","abbrlink":"33571e0f","date":"2024-06-11T14:23:14.000Z","_content":"\n\n\n# 一、数据库中的锁\n\n   数据库锁定机制简单来说，就是数据库为了保证数据的一致性，而使各种共享资源在被并发访问变得有序所设计的一种规则。\n\n## 1.1 表级锁\n\n   使用表级锁定的主要是 MyISAM，MEMORY，CSV 等一些非事务性存储引擎。\n\n\n## 1.2 行级锁\n\n   使用行级锁定的主要是 InnoDB 存储引擎。\n\n\n## 行级锁类型\n\n   对于InnoDB 在 RR（MySQL默认隔离级别）而言，对于 update、delete 和 insert 语句，\n会自动给涉及数据集加排它锁（X）；\n\n   对于普通 select 语句，innodb 不会加任何锁。\n如果想在 select 操作的时候加上 S 锁 或者 X 锁，需要我们手动加锁。\n\n    \n### 共享锁（简称 s 锁）\n    \n  不会阻塞其他事务对同一行的读请求，但会阻塞对同一行的写请求。\n  只有当读锁释放后，才会执行其它事物的写操作。\n\n### 排它锁（简称 x 锁）\n\n  会阻塞其他事务对同一行的读和写操作，只有当写锁释放后，才会执行其它事务的读写操作\n\n## Sql示列\n\n```sql\n-- 加共享锁（S） lock in share mode\nselect * from table_name where ... lock in share mode\n\n\n-- 加排它锁（X)  for update\nselect * from table_name where ... for update\n\n-- LOCK TABLES 语句用于锁定一个或多个表\nLOCK TABLES users READ;\n```\n\nInnoDB 中的 行锁 的实现依赖于 索引，一旦某个加锁操作没有使用到索引，那么该锁就会退化为表锁。","source":"_posts/php开发-mysql锁.md","raw":"---\ntitle: php开发-mysql锁\ntags: mysql\ncategories:\n  - PHP开发\nabbrlink: 33571e0f\ndate: 2024-06-11 22:23:14\n---\n\n\n\n# 一、数据库中的锁\n\n   数据库锁定机制简单来说，就是数据库为了保证数据的一致性，而使各种共享资源在被并发访问变得有序所设计的一种规则。\n\n## 1.1 表级锁\n\n   使用表级锁定的主要是 MyISAM，MEMORY，CSV 等一些非事务性存储引擎。\n\n\n## 1.2 行级锁\n\n   使用行级锁定的主要是 InnoDB 存储引擎。\n\n\n## 行级锁类型\n\n   对于InnoDB 在 RR（MySQL默认隔离级别）而言，对于 update、delete 和 insert 语句，\n会自动给涉及数据集加排它锁（X）；\n\n   对于普通 select 语句，innodb 不会加任何锁。\n如果想在 select 操作的时候加上 S 锁 或者 X 锁，需要我们手动加锁。\n\n    \n### 共享锁（简称 s 锁）\n    \n  不会阻塞其他事务对同一行的读请求，但会阻塞对同一行的写请求。\n  只有当读锁释放后，才会执行其它事物的写操作。\n\n### 排它锁（简称 x 锁）\n\n  会阻塞其他事务对同一行的读和写操作，只有当写锁释放后，才会执行其它事务的读写操作\n\n## Sql示列\n\n```sql\n-- 加共享锁（S） lock in share mode\nselect * from table_name where ... lock in share mode\n\n\n-- 加排它锁（X)  for update\nselect * from table_name where ... for update\n\n-- LOCK TABLES 语句用于锁定一个或多个表\nLOCK TABLES users READ;\n```\n\nInnoDB 中的 行锁 的实现依赖于 索引，一旦某个加锁操作没有使用到索引，那么该锁就会退化为表锁。","slug":"php开发-mysql锁","published":1,"updated":"2024-06-29T01:34:06.859Z","_id":"clxb4gv4s0020pcocca1600da","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、数据库中的锁\"><a href=\"#一、数据库中的锁\" class=\"headerlink\" title=\"一、数据库中的锁\"></a>一、数据库中的锁</h1><p>   数据库锁定机制简单来说，就是数据库为了保证数据的一致性，而使各种共享资源在被并发访问变得有序所设计的一种规则。</p>\n<h2 id=\"1-1-表级锁\"><a href=\"#1-1-表级锁\" class=\"headerlink\" title=\"1.1 表级锁\"></a>1.1 表级锁</h2><p>   使用表级锁定的主要是 MyISAM，MEMORY，CSV 等一些非事务性存储引擎。</p>\n<h2 id=\"1-2-行级锁\"><a href=\"#1-2-行级锁\" class=\"headerlink\" title=\"1.2 行级锁\"></a>1.2 行级锁</h2><p>   使用行级锁定的主要是 InnoDB 存储引擎。</p>\n<h2 id=\"行级锁类型\"><a href=\"#行级锁类型\" class=\"headerlink\" title=\"行级锁类型\"></a>行级锁类型</h2><p>   对于InnoDB 在 RR（MySQL默认隔离级别）而言，对于 update、delete 和 insert 语句，<br>会自动给涉及数据集加排它锁（X）；</p>\n<p>   对于普通 select 语句，innodb 不会加任何锁。<br>如果想在 select 操作的时候加上 S 锁 或者 X 锁，需要我们手动加锁。</p>\n<h3 id=\"共享锁（简称-s-锁）\"><a href=\"#共享锁（简称-s-锁）\" class=\"headerlink\" title=\"共享锁（简称 s 锁）\"></a>共享锁（简称 s 锁）</h3><p>  不会阻塞其他事务对同一行的读请求，但会阻塞对同一行的写请求。<br>  只有当读锁释放后，才会执行其它事物的写操作。</p>\n<h3 id=\"排它锁（简称-x-锁）\"><a href=\"#排它锁（简称-x-锁）\" class=\"headerlink\" title=\"排它锁（简称 x 锁）\"></a>排它锁（简称 x 锁）</h3><p>  会阻塞其他事务对同一行的读和写操作，只有当写锁释放后，才会执行其它事务的读写操作</p>\n<h2 id=\"Sql示列\"><a href=\"#Sql示列\" class=\"headerlink\" title=\"Sql示列\"></a>Sql示列</h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 加共享锁（S） lock in share mode</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> table_name <span class=\"keyword\">where</span> ... lock <span class=\"keyword\">in</span> share mode</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 加排它锁（X)  for update</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> table_name <span class=\"keyword\">where</span> ... <span class=\"keyword\">for</span> update</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- LOCK TABLES 语句用于锁定一个或多个表</span></span><br><span class=\"line\">LOCK TABLES users READ;</span><br></pre></td></tr></table></figure>\n\n<p>InnoDB 中的 行锁 的实现依赖于 索引，一旦某个加锁操作没有使用到索引，那么该锁就会退化为表锁。</p>\n","site":{"data":{}},"length":607,"excerpt":"","more":"<h1 id=\"一、数据库中的锁\"><a href=\"#一、数据库中的锁\" class=\"headerlink\" title=\"一、数据库中的锁\"></a>一、数据库中的锁</h1><p>   数据库锁定机制简单来说，就是数据库为了保证数据的一致性，而使各种共享资源在被并发访问变得有序所设计的一种规则。</p>\n<h2 id=\"1-1-表级锁\"><a href=\"#1-1-表级锁\" class=\"headerlink\" title=\"1.1 表级锁\"></a>1.1 表级锁</h2><p>   使用表级锁定的主要是 MyISAM，MEMORY，CSV 等一些非事务性存储引擎。</p>\n<h2 id=\"1-2-行级锁\"><a href=\"#1-2-行级锁\" class=\"headerlink\" title=\"1.2 行级锁\"></a>1.2 行级锁</h2><p>   使用行级锁定的主要是 InnoDB 存储引擎。</p>\n<h2 id=\"行级锁类型\"><a href=\"#行级锁类型\" class=\"headerlink\" title=\"行级锁类型\"></a>行级锁类型</h2><p>   对于InnoDB 在 RR（MySQL默认隔离级别）而言，对于 update、delete 和 insert 语句，<br>会自动给涉及数据集加排它锁（X）；</p>\n<p>   对于普通 select 语句，innodb 不会加任何锁。<br>如果想在 select 操作的时候加上 S 锁 或者 X 锁，需要我们手动加锁。</p>\n<h3 id=\"共享锁（简称-s-锁）\"><a href=\"#共享锁（简称-s-锁）\" class=\"headerlink\" title=\"共享锁（简称 s 锁）\"></a>共享锁（简称 s 锁）</h3><p>  不会阻塞其他事务对同一行的读请求，但会阻塞对同一行的写请求。<br>  只有当读锁释放后，才会执行其它事物的写操作。</p>\n<h3 id=\"排它锁（简称-x-锁）\"><a href=\"#排它锁（简称-x-锁）\" class=\"headerlink\" title=\"排它锁（简称 x 锁）\"></a>排它锁（简称 x 锁）</h3><p>  会阻塞其他事务对同一行的读和写操作，只有当写锁释放后，才会执行其它事务的读写操作</p>\n<h2 id=\"Sql示列\"><a href=\"#Sql示列\" class=\"headerlink\" title=\"Sql示列\"></a>Sql示列</h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 加共享锁（S） lock in share mode</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> table_name <span class=\"keyword\">where</span> ... lock <span class=\"keyword\">in</span> share mode</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 加排它锁（X)  for update</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> table_name <span class=\"keyword\">where</span> ... <span class=\"keyword\">for</span> update</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- LOCK TABLES 语句用于锁定一个或多个表</span></span><br><span class=\"line\">LOCK TABLES users READ;</span><br></pre></td></tr></table></figure>\n\n<p>InnoDB 中的 行锁 的实现依赖于 索引，一旦某个加锁操作没有使用到索引，那么该锁就会退化为表锁。</p>\n"},{"title":"php开发-ftp下载上传","abbrlink":"eae5a656","date":"2024-02-06T08:43:04.000Z","_content":"\n\n# 检查ftp\n\n1.使用ftp 客户端 连接ftp\n\nwindows系统      winscp\nredhat发行版本   yum install ftp\ndebian发行版本   apt install ftp\n\n\n    示例（一定要ls get 下，才能证明能传输数据）\n        ftp 192.14.23.23 22221\n        ls                     \n        \n# 基础方法\n        ftp_connect(ip,port)                            #连接服务器  默认21  返回值 连接资源\n        ftp_login($conn,$username,$passwd)              #登录  返回值是 bool\n        ftp_pasv($conn,true)                            #设置被动模式  默认ftp 主动模式   \n        ftp_nlist($conn,$path)                          #查看当前目录 文件列表 类ls功能\n        ftp_pwd($conn)                                  #查看当前目录\n        ftp_get($conn,$localpath,$filename,FTP_ASCII)   #下载远程 文件到 本地\n        ftp_put($conn,$filename,$localpath,FTP_ASCII)   #上传本地文件 到服务器\n\n# 注意事项\n    \n<font color=\"red\">ftp 默认是主动模式 传输数据端口是随机的</font>\n\n<font color=\"red\">ftp 被动模式  是端口需要配置定义 </font>\n\n<font color=\"red\">防火墙需要放开端口</font>\n\n排查方案 用步骤一\n\n# 代码摘录示例\n```php\n        $conn = ftp_connect($ip, $port);\n        if ($conn) {\n            // 登录FTP服务器\n            $login = ftp_login($conn, $username, $passwd);\n            if ($login&&$pasv) {\n//                ftp_set_option($conn, FTP_USEPASVADDRESS, false);\n                  // 切换到主动模式\n                  ftp_pasv($conn, true);\n            }\n        } else {\n            throw new Exception(\"登录失败\");\n        }\n        \n        //查看目录下 列表 类似ls功能\n        $dirList = ftp_nlist($conn, $dir);\n        \n        #下载文件\n        $ret = ftp_get($conn, $local_filepath.$filename, $filename, FTP_ASCII);\n        \n        #上传文件       \n        ftp_put($conn, $filename, $local_filepath . $filename, FTP_ASCII);\n\n```  ","source":"_posts/php开发-ftp下载上传.md","raw":"---\ntitle: php开发-ftp下载上传\nabbrlink: eae5a656\ndate: 2024-02-06 16:43:04\ntags: PHP开发\ncategories:\n  - PHP开发\n---\n\n\n# 检查ftp\n\n1.使用ftp 客户端 连接ftp\n\nwindows系统      winscp\nredhat发行版本   yum install ftp\ndebian发行版本   apt install ftp\n\n\n    示例（一定要ls get 下，才能证明能传输数据）\n        ftp 192.14.23.23 22221\n        ls                     \n        \n# 基础方法\n        ftp_connect(ip,port)                            #连接服务器  默认21  返回值 连接资源\n        ftp_login($conn,$username,$passwd)              #登录  返回值是 bool\n        ftp_pasv($conn,true)                            #设置被动模式  默认ftp 主动模式   \n        ftp_nlist($conn,$path)                          #查看当前目录 文件列表 类ls功能\n        ftp_pwd($conn)                                  #查看当前目录\n        ftp_get($conn,$localpath,$filename,FTP_ASCII)   #下载远程 文件到 本地\n        ftp_put($conn,$filename,$localpath,FTP_ASCII)   #上传本地文件 到服务器\n\n# 注意事项\n    \n<font color=\"red\">ftp 默认是主动模式 传输数据端口是随机的</font>\n\n<font color=\"red\">ftp 被动模式  是端口需要配置定义 </font>\n\n<font color=\"red\">防火墙需要放开端口</font>\n\n排查方案 用步骤一\n\n# 代码摘录示例\n```php\n        $conn = ftp_connect($ip, $port);\n        if ($conn) {\n            // 登录FTP服务器\n            $login = ftp_login($conn, $username, $passwd);\n            if ($login&&$pasv) {\n//                ftp_set_option($conn, FTP_USEPASVADDRESS, false);\n                  // 切换到主动模式\n                  ftp_pasv($conn, true);\n            }\n        } else {\n            throw new Exception(\"登录失败\");\n        }\n        \n        //查看目录下 列表 类似ls功能\n        $dirList = ftp_nlist($conn, $dir);\n        \n        #下载文件\n        $ret = ftp_get($conn, $local_filepath.$filename, $filename, FTP_ASCII);\n        \n        #上传文件       \n        ftp_put($conn, $filename, $local_filepath . $filename, FTP_ASCII);\n\n```  ","slug":"php开发-ftp下载上传","published":1,"updated":"2024-02-08T03:50:38.129Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv4t0023pcoc1m6rbqat","content":"<h1 id=\"检查ftp\"><a href=\"#检查ftp\" class=\"headerlink\" title=\"检查ftp\"></a>检查ftp</h1><p>1.使用ftp 客户端 连接ftp</p>\n<p>windows系统      winscp<br>redhat发行版本   yum install ftp<br>debian发行版本   apt install ftp</p>\n<pre><code>示例（一定要ls get 下，才能证明能传输数据）\n    ftp 192.14.23.23 22221\n    ls                     \n    \n</code></pre>\n<h1 id=\"基础方法\"><a href=\"#基础方法\" class=\"headerlink\" title=\"基础方法\"></a>基础方法</h1><pre><code>    ftp_connect(ip,port)                            #连接服务器  默认21  返回值 连接资源\n    ftp_login($conn,$username,$passwd)              #登录  返回值是 bool\n    ftp_pasv($conn,true)                            #设置被动模式  默认ftp 主动模式   \n    ftp_nlist($conn,$path)                          #查看当前目录 文件列表 类ls功能\n    ftp_pwd($conn)                                  #查看当前目录\n    ftp_get($conn,$localpath,$filename,FTP_ASCII)   #下载远程 文件到 本地\n    ftp_put($conn,$filename,$localpath,FTP_ASCII)   #上传本地文件 到服务器\n</code></pre>\n<h1 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h1><p><font color=\"red\">ftp 默认是主动模式 传输数据端口是随机的</font></p>\n<p><font color=\"red\">ftp 被动模式  是端口需要配置定义 </font></p>\n<p><font color=\"red\">防火墙需要放开端口</font></p>\n<p>排查方案 用步骤一</p>\n<h1 id=\"代码摘录示例\"><a href=\"#代码摘录示例\" class=\"headerlink\" title=\"代码摘录示例\"></a>代码摘录示例</h1><pre><code class=\"php\">        $conn = ftp_connect($ip, $port);\n        if ($conn) &#123;\n            // 登录FTP服务器\n            $login = ftp_login($conn, $username, $passwd);\n            if ($login&amp;&amp;$pasv) &#123;\n//                ftp_set_option($conn, FTP_USEPASVADDRESS, false);\n                  // 切换到主动模式\n                  ftp_pasv($conn, true);\n            &#125;\n        &#125; else &#123;\n            throw new Exception(&quot;登录失败&quot;);\n        &#125;\n        \n        //查看目录下 列表 类似ls功能\n        $dirList = ftp_nlist($conn, $dir);\n        \n        #下载文件\n        $ret = ftp_get($conn, $local_filepath.$filename, $filename, FTP_ASCII);\n        \n        #上传文件       \n        ftp_put($conn, $filename, $local_filepath . $filename, FTP_ASCII);\n</code></pre>\n","site":{"data":{}},"length":934,"excerpt":"","more":"<h1 id=\"检查ftp\"><a href=\"#检查ftp\" class=\"headerlink\" title=\"检查ftp\"></a>检查ftp</h1><p>1.使用ftp 客户端 连接ftp</p>\n<p>windows系统      winscp<br>redhat发行版本   yum install ftp<br>debian发行版本   apt install ftp</p>\n<pre><code>示例（一定要ls get 下，才能证明能传输数据）\n    ftp 192.14.23.23 22221\n    ls                     \n    \n</code></pre>\n<h1 id=\"基础方法\"><a href=\"#基础方法\" class=\"headerlink\" title=\"基础方法\"></a>基础方法</h1><pre><code>    ftp_connect(ip,port)                            #连接服务器  默认21  返回值 连接资源\n    ftp_login($conn,$username,$passwd)              #登录  返回值是 bool\n    ftp_pasv($conn,true)                            #设置被动模式  默认ftp 主动模式   \n    ftp_nlist($conn,$path)                          #查看当前目录 文件列表 类ls功能\n    ftp_pwd($conn)                                  #查看当前目录\n    ftp_get($conn,$localpath,$filename,FTP_ASCII)   #下载远程 文件到 本地\n    ftp_put($conn,$filename,$localpath,FTP_ASCII)   #上传本地文件 到服务器\n</code></pre>\n<h1 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h1><p><font color=\"red\">ftp 默认是主动模式 传输数据端口是随机的</font></p>\n<p><font color=\"red\">ftp 被动模式  是端口需要配置定义 </font></p>\n<p><font color=\"red\">防火墙需要放开端口</font></p>\n<p>排查方案 用步骤一</p>\n<h1 id=\"代码摘录示例\"><a href=\"#代码摘录示例\" class=\"headerlink\" title=\"代码摘录示例\"></a>代码摘录示例</h1><pre><code class=\"php\">        $conn = ftp_connect($ip, $port);\n        if ($conn) &#123;\n            // 登录FTP服务器\n            $login = ftp_login($conn, $username, $passwd);\n            if ($login&amp;&amp;$pasv) &#123;\n//                ftp_set_option($conn, FTP_USEPASVADDRESS, false);\n                  // 切换到主动模式\n                  ftp_pasv($conn, true);\n            &#125;\n        &#125; else &#123;\n            throw new Exception(&quot;登录失败&quot;);\n        &#125;\n        \n        //查看目录下 列表 类似ls功能\n        $dirList = ftp_nlist($conn, $dir);\n        \n        #下载文件\n        $ret = ftp_get($conn, $local_filepath.$filename, $filename, FTP_ASCII);\n        \n        #上传文件       \n        ftp_put($conn, $filename, $local_filepath . $filename, FTP_ASCII);\n</code></pre>\n"},{"title":"php开发-常见加密使用","abbrlink":"78f26761","date":"2024-02-19T09:49:50.000Z","_content":"\n# 基础知识\n\n    数字签名 就是明文+私钥密文  这样就能保证数据没有被篡改  \n    \n    非对称加密 RSA、DSA\n        \n        公钥、私钥\n    \n    对称加密 DES、AES\n    \n        只需要一个秘钥  加密解密 多用它就行了\n    \n    密码散列算法有 SHA-1、SHA-256 、MD5  \n        算出来就不可逆了，主要用来确定来源的\n    \n    \n    \n# 签名算法-SHA1withRSA\n    \n用SHA算法进行签名，用RSA算法进行加密\n\n```php\n        $str        = chunk_split($myPrivateKeyStr, 64, \"\\n\");\n        $privateKey = \"-----BEGIN RSA PRIVATE KEY-----\\n$str-----END RSA PRIVATE KEY-----\\n\";\n        openssl_sign($paramStr, $sign, $privateKey);\n        $resSign = base64_encode($sign);\n```\n\n# RSA加密\n```php\n    /**\n     * RSA分段加密\n     *\n     * @param $context string 待加密字符串\n     * @param $type string  'private' or 'public'\n     * @param $key string 公钥 or 私钥\n     */\n    public static function encrypt($context, $type, $key)\n    {\n        //http://www.php.net/manual/en/function.openssl-public-encrypt.php#95307\n        //Assumes 1024 bit key and encrypts in chunks.\n        $maxlength = 117;\n        $output = '';\n        while ($context) {\n            $input = substr($context, 0, $maxlength);\n            $context = substr($context, $maxlength);\n            if ($type == 'private') {\n                $ok = openssl_private_encrypt($input, $encrypted, $key);\n            } else {\n                $ok = openssl_public_encrypt($input, $encrypted, $key);\n            }\n            $output .= $encrypted;\n        }\n        return base64_encode($output);\n    }\n```\n\n# AES加密\nopenssl_encrypt($data,$method,$key,$options=0,$iv=\"\",&$tag=NULL,$aad=\"\",$tag_length=16)\n\n1.$data：加密明文\n\n2.$method：加密方法： 可以通过openssl_get_cipher_methods()获取有哪些加密方式\n\n3.$passwd：加密密钥[密码]\n\n4.$options：数据格式选项（可选）【选项有：】：0,OPENSSL_RAW_DATA=1,OPENSSL_ZERO_PADDING=2,OPENSSL_NO_PADDING=3\n\n5.$iv：密初始化向量（可选),需要注意：如果method为DES−ECB，则iv无需填写\n\n6.$tag：使用 AEAD 密码模式（GCM 或 CCM）时传引用的验证标签(可选)\n\n7.$aad：附加的验证数据。（可选）\n\n8.$tag_length：验证 tag 的长度。GCM 模式时，它的范围是 4 到 16(可选)\n\n```php\n        openssl_encrypt(json_encode($body), 'AES-128-CBC', $this->key, OPENSSL_RAW_DATA, $this->iv)\n        \n        bin2hex(openssl_encrypt($str, 'DES-ECB', $this->appSecret, OPENSSL_RAW_DATA));\n        \n        #一般多需要转换为base64传输\n        base64_encode(openssl_encrypt(json_encode($body), 'AES-128-CBC', $this->key, OPENSSL_RAW_DATA, $this->iv));\n```\n    \n    \n# DES加密\n\n 填充模式：pkcs5、pkcs7、iso10126、ansix923、zero。\n\n 加密模式：DES-ECB、DES-CBC、DES-CTR、DES-OFB、DES-CFB。\n\n ECB模式（电子密码本模式）： 将明文分成块并分别加密，每个块独立处理。\n                            相同的明文块将加密成相同的密文块，可能存在安全性问题。\n\n CBC模式（密码块链接模式）： 使用前一个块的密文与当前块的明文进行异或操作，增强了安全性。\n                            需要一个初始化向量（IV）来加密第一个块。\n                            \n CFB模式（密码反馈模式）：   将前一个密文块与密钥流进行异或，再与明文进行异或。\n                            这种模式使得每个密文块的加密都依赖于前一个密文块。   \n                          \n OFB模式（输出反馈模式）：   将前一个输出块与密钥流进行异或，再与明文进行异或。\n                            类似于CFB模式，但不同的是OFB不直接依赖前一个密文块      \n                                                                         \n CTR模式（计数器模式）：       使用一个计数器和密钥流进行异或，得到密文。\n                            计数器的值会逐块增加，确保相同的明文块不会产生相同的密文块。\n\n\n输出类型：无编码，base64编码，hex编码。\n\njava 下默认是DES-ECB\n\n    \n\n# HMAC 散列消息身份验证码\n\n它不是散列函数，而是采用了将MD5或SHA1散列函数与共享机密秘钥（与公钥/秘钥对不同）一起使用的消息身份验证机制。\n\n目前hmac主要应用在身份验证中，在用户登录传递密码的过程中可以利用，签名来防止密码明文传递。\n\n在php中hash_hmac函数就能将HMAC和一部分哈希加密算法相结合起来实现HMAC-SHA1  HMAC-SHA256 HMAC-MD5等等算法\n\nstring hash_hmac(string $algo, string $data, string $key, bool $raw_output = false)\n\nalgo：要使用的哈希算法名称，可以是上述提到的md5,sha1等\n\ndata：要进行哈希运算的消息，也就是需要加密的明文。\n\nkey：使用HMAC生成信息摘要是所使用的密钥。\n\nraw_output：该参数为可选参数，默认为false，如果设为true，则返回原始二进制数据表示的信息摘要，\n否则返回16进制小写字符串格式表示的信息摘要（注意是16进制数，而非简单的字母加数字）。\n\n\n```php\n    \n    方案一：hash_hmac(\"sha1\", $str, $secret)\n    方案二：bin2hex(hash_hmac(\"sha1\", $str, $secret, true));\n    \n    hash_hmac( 'md5',$data, $this->appSecret)\n    \n    hash_hmac('sha256', $data,$this->appSecret)\n```\n  \n","source":"_posts/php开发-常见加密使用.md","raw":"---\ntitle: php开发-常见加密使用\ncategories:\n  - PHP开发\nabbrlink: 78f26761\ndate: 2024-02-19 17:49:50\ntags:\n---\n\n# 基础知识\n\n    数字签名 就是明文+私钥密文  这样就能保证数据没有被篡改  \n    \n    非对称加密 RSA、DSA\n        \n        公钥、私钥\n    \n    对称加密 DES、AES\n    \n        只需要一个秘钥  加密解密 多用它就行了\n    \n    密码散列算法有 SHA-1、SHA-256 、MD5  \n        算出来就不可逆了，主要用来确定来源的\n    \n    \n    \n# 签名算法-SHA1withRSA\n    \n用SHA算法进行签名，用RSA算法进行加密\n\n```php\n        $str        = chunk_split($myPrivateKeyStr, 64, \"\\n\");\n        $privateKey = \"-----BEGIN RSA PRIVATE KEY-----\\n$str-----END RSA PRIVATE KEY-----\\n\";\n        openssl_sign($paramStr, $sign, $privateKey);\n        $resSign = base64_encode($sign);\n```\n\n# RSA加密\n```php\n    /**\n     * RSA分段加密\n     *\n     * @param $context string 待加密字符串\n     * @param $type string  'private' or 'public'\n     * @param $key string 公钥 or 私钥\n     */\n    public static function encrypt($context, $type, $key)\n    {\n        //http://www.php.net/manual/en/function.openssl-public-encrypt.php#95307\n        //Assumes 1024 bit key and encrypts in chunks.\n        $maxlength = 117;\n        $output = '';\n        while ($context) {\n            $input = substr($context, 0, $maxlength);\n            $context = substr($context, $maxlength);\n            if ($type == 'private') {\n                $ok = openssl_private_encrypt($input, $encrypted, $key);\n            } else {\n                $ok = openssl_public_encrypt($input, $encrypted, $key);\n            }\n            $output .= $encrypted;\n        }\n        return base64_encode($output);\n    }\n```\n\n# AES加密\nopenssl_encrypt($data,$method,$key,$options=0,$iv=\"\",&$tag=NULL,$aad=\"\",$tag_length=16)\n\n1.$data：加密明文\n\n2.$method：加密方法： 可以通过openssl_get_cipher_methods()获取有哪些加密方式\n\n3.$passwd：加密密钥[密码]\n\n4.$options：数据格式选项（可选）【选项有：】：0,OPENSSL_RAW_DATA=1,OPENSSL_ZERO_PADDING=2,OPENSSL_NO_PADDING=3\n\n5.$iv：密初始化向量（可选),需要注意：如果method为DES−ECB，则iv无需填写\n\n6.$tag：使用 AEAD 密码模式（GCM 或 CCM）时传引用的验证标签(可选)\n\n7.$aad：附加的验证数据。（可选）\n\n8.$tag_length：验证 tag 的长度。GCM 模式时，它的范围是 4 到 16(可选)\n\n```php\n        openssl_encrypt(json_encode($body), 'AES-128-CBC', $this->key, OPENSSL_RAW_DATA, $this->iv)\n        \n        bin2hex(openssl_encrypt($str, 'DES-ECB', $this->appSecret, OPENSSL_RAW_DATA));\n        \n        #一般多需要转换为base64传输\n        base64_encode(openssl_encrypt(json_encode($body), 'AES-128-CBC', $this->key, OPENSSL_RAW_DATA, $this->iv));\n```\n    \n    \n# DES加密\n\n 填充模式：pkcs5、pkcs7、iso10126、ansix923、zero。\n\n 加密模式：DES-ECB、DES-CBC、DES-CTR、DES-OFB、DES-CFB。\n\n ECB模式（电子密码本模式）： 将明文分成块并分别加密，每个块独立处理。\n                            相同的明文块将加密成相同的密文块，可能存在安全性问题。\n\n CBC模式（密码块链接模式）： 使用前一个块的密文与当前块的明文进行异或操作，增强了安全性。\n                            需要一个初始化向量（IV）来加密第一个块。\n                            \n CFB模式（密码反馈模式）：   将前一个密文块与密钥流进行异或，再与明文进行异或。\n                            这种模式使得每个密文块的加密都依赖于前一个密文块。   \n                          \n OFB模式（输出反馈模式）：   将前一个输出块与密钥流进行异或，再与明文进行异或。\n                            类似于CFB模式，但不同的是OFB不直接依赖前一个密文块      \n                                                                         \n CTR模式（计数器模式）：       使用一个计数器和密钥流进行异或，得到密文。\n                            计数器的值会逐块增加，确保相同的明文块不会产生相同的密文块。\n\n\n输出类型：无编码，base64编码，hex编码。\n\njava 下默认是DES-ECB\n\n    \n\n# HMAC 散列消息身份验证码\n\n它不是散列函数，而是采用了将MD5或SHA1散列函数与共享机密秘钥（与公钥/秘钥对不同）一起使用的消息身份验证机制。\n\n目前hmac主要应用在身份验证中，在用户登录传递密码的过程中可以利用，签名来防止密码明文传递。\n\n在php中hash_hmac函数就能将HMAC和一部分哈希加密算法相结合起来实现HMAC-SHA1  HMAC-SHA256 HMAC-MD5等等算法\n\nstring hash_hmac(string $algo, string $data, string $key, bool $raw_output = false)\n\nalgo：要使用的哈希算法名称，可以是上述提到的md5,sha1等\n\ndata：要进行哈希运算的消息，也就是需要加密的明文。\n\nkey：使用HMAC生成信息摘要是所使用的密钥。\n\nraw_output：该参数为可选参数，默认为false，如果设为true，则返回原始二进制数据表示的信息摘要，\n否则返回16进制小写字符串格式表示的信息摘要（注意是16进制数，而非简单的字母加数字）。\n\n\n```php\n    \n    方案一：hash_hmac(\"sha1\", $str, $secret)\n    方案二：bin2hex(hash_hmac(\"sha1\", $str, $secret, true));\n    \n    hash_hmac( 'md5',$data, $this->appSecret)\n    \n    hash_hmac('sha256', $data,$this->appSecret)\n```\n  \n","slug":"php开发-常见加密使用","published":1,"updated":"2024-11-20T02:16:25.230Z","_id":"clxb4gv4w002cpcoc24220y0c","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"基础知识\"><a href=\"#基础知识\" class=\"headerlink\" title=\"基础知识\"></a>基础知识</h1><pre><code>数字签名 就是明文+私钥密文  这样就能保证数据没有被篡改  \n\n非对称加密 RSA、DSA\n    \n    公钥、私钥\n\n对称加密 DES、AES\n\n    只需要一个秘钥  加密解密 多用它就行了\n\n密码散列算法有 SHA-1、SHA-256 、MD5  \n    算出来就不可逆了，主要用来确定来源的\n</code></pre>\n<h1 id=\"签名算法-SHA1withRSA\"><a href=\"#签名算法-SHA1withRSA\" class=\"headerlink\" title=\"签名算法-SHA1withRSA\"></a>签名算法-SHA1withRSA</h1><p>用SHA算法进行签名，用RSA算法进行加密</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$str</span>        = chunk_split(<span class=\"variable\">$myPrivateKeyStr</span>, <span class=\"number\">64</span>, <span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\"><span class=\"variable\">$privateKey</span> = <span class=\"string\">&quot;-----BEGIN RSA PRIVATE KEY-----\\n<span class=\"subst\">$str</span>-----END RSA PRIVATE KEY-----\\n&quot;</span>;</span><br><span class=\"line\">openssl_sign(<span class=\"variable\">$paramStr</span>, <span class=\"variable\">$sign</span>, <span class=\"variable\">$privateKey</span>);</span><br><span class=\"line\"><span class=\"variable\">$resSign</span> = base64_encode(<span class=\"variable\">$sign</span>);</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"RSA加密\"><a href=\"#RSA加密\" class=\"headerlink\" title=\"RSA加密\"></a>RSA加密</h1><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * RSA分段加密</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> $context string 待加密字符串</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> $type string  &#x27;private&#x27; or &#x27;public&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> $key string 公钥 or 私钥</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"built_in\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">encrypt</span>(<span class=\"params\"><span class=\"variable\">$context</span>, <span class=\"variable\">$type</span>, <span class=\"variable\">$key</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//http://www.php.net/manual/en/function.openssl-public-encrypt.php#95307</span></span><br><span class=\"line\">    <span class=\"comment\">//Assumes 1024 bit key and encrypts in chunks.</span></span><br><span class=\"line\">    <span class=\"variable\">$maxlength</span> = <span class=\"number\">117</span>;</span><br><span class=\"line\">    <span class=\"variable\">$output</span> = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"variable\">$context</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable\">$input</span> = substr(<span class=\"variable\">$context</span>, <span class=\"number\">0</span>, <span class=\"variable\">$maxlength</span>);</span><br><span class=\"line\">        <span class=\"variable\">$context</span> = substr(<span class=\"variable\">$context</span>, <span class=\"variable\">$maxlength</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable\">$type</span> == <span class=\"string\">&#x27;private&#x27;</span>) &#123;</span><br><span class=\"line\">            <span class=\"variable\">$ok</span> = openssl_private_encrypt(<span class=\"variable\">$input</span>, <span class=\"variable\">$encrypted</span>, <span class=\"variable\">$key</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"variable\">$ok</span> = openssl_public_encrypt(<span class=\"variable\">$input</span>, <span class=\"variable\">$encrypted</span>, <span class=\"variable\">$key</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"variable\">$output</span> .= <span class=\"variable\">$encrypted</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> base64_encode(<span class=\"variable\">$output</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"AES加密\"><a href=\"#AES加密\" class=\"headerlink\" title=\"AES加密\"></a>AES加密</h1><p>openssl_encrypt($data,$method,$key,$options=0,$iv=””,&amp;$tag=NULL,$aad=””,$tag_length=16)</p>\n<p>1.$data：加密明文</p>\n<p>2.$method：加密方法： 可以通过openssl_get_cipher_methods()获取有哪些加密方式</p>\n<p>3.$passwd：加密密钥[密码]</p>\n<p>4.$options：数据格式选项（可选）【选项有：】：0,OPENSSL_RAW_DATA=1,OPENSSL_ZERO_PADDING=2,OPENSSL_NO_PADDING=3</p>\n<p>5.$iv：密初始化向量（可选),需要注意：如果method为DES−ECB，则iv无需填写</p>\n<p>6.$tag：使用 AEAD 密码模式（GCM 或 CCM）时传引用的验证标签(可选)</p>\n<p>7.$aad：附加的验证数据。（可选）</p>\n<p>8.$tag_length：验证 tag 的长度。GCM 模式时，它的范围是 4 到 16(可选)</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openssl_encrypt(json_encode(<span class=\"variable\">$body</span>), <span class=\"string\">&#x27;AES-128-CBC&#x27;</span>, <span class=\"keyword\">$this</span>-&gt;key, OPENSSL_RAW_DATA, <span class=\"keyword\">$this</span>-&gt;iv)</span><br><span class=\"line\"></span><br><span class=\"line\">bin2hex(openssl_encrypt(<span class=\"variable\">$str</span>, <span class=\"string\">&#x27;DES-ECB&#x27;</span>, <span class=\"keyword\">$this</span>-&gt;appSecret, OPENSSL_RAW_DATA));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#一般多需要转换为base64传输</span></span><br><span class=\"line\">base64_encode(openssl_encrypt(json_encode(<span class=\"variable\">$body</span>), <span class=\"string\">&#x27;AES-128-CBC&#x27;</span>, <span class=\"keyword\">$this</span>-&gt;key, OPENSSL_RAW_DATA, <span class=\"keyword\">$this</span>-&gt;iv));</span><br></pre></td></tr></table></figure>\n<h1 id=\"DES加密\"><a href=\"#DES加密\" class=\"headerlink\" title=\"DES加密\"></a>DES加密</h1><p> 填充模式：pkcs5、pkcs7、iso10126、ansix923、zero。</p>\n<p> 加密模式：DES-ECB、DES-CBC、DES-CTR、DES-OFB、DES-CFB。</p>\n<p> ECB模式（电子密码本模式）： 将明文分成块并分别加密，每个块独立处理。<br>                            相同的明文块将加密成相同的密文块，可能存在安全性问题。</p>\n<p> CBC模式（密码块链接模式）： 使用前一个块的密文与当前块的明文进行异或操作，增强了安全性。<br>                            需要一个初始化向量（IV）来加密第一个块。</p>\n<p> CFB模式（密码反馈模式）：   将前一个密文块与密钥流进行异或，再与明文进行异或。<br>                            这种模式使得每个密文块的加密都依赖于前一个密文块。   </p>\n<p> OFB模式（输出反馈模式）：   将前一个输出块与密钥流进行异或，再与明文进行异或。<br>                            类似于CFB模式，但不同的是OFB不直接依赖前一个密文块      </p>\n<p> CTR模式（计数器模式）：       使用一个计数器和密钥流进行异或，得到密文。<br>                            计数器的值会逐块增加，确保相同的明文块不会产生相同的密文块。</p>\n<p>输出类型：无编码，base64编码，hex编码。</p>\n<p>java 下默认是DES-ECB</p>\n<h1 id=\"HMAC-散列消息身份验证码\"><a href=\"#HMAC-散列消息身份验证码\" class=\"headerlink\" title=\"HMAC 散列消息身份验证码\"></a>HMAC 散列消息身份验证码</h1><p>它不是散列函数，而是采用了将MD5或SHA1散列函数与共享机密秘钥（与公钥/秘钥对不同）一起使用的消息身份验证机制。</p>\n<p>目前hmac主要应用在身份验证中，在用户登录传递密码的过程中可以利用，签名来防止密码明文传递。</p>\n<p>在php中hash_hmac函数就能将HMAC和一部分哈希加密算法相结合起来实现HMAC-SHA1  HMAC-SHA256 HMAC-MD5等等算法</p>\n<p>string hash_hmac(string $algo, string $data, string $key, bool $raw_output = false)</p>\n<p>algo：要使用的哈希算法名称，可以是上述提到的md5,sha1等</p>\n<p>data：要进行哈希运算的消息，也就是需要加密的明文。</p>\n<p>key：使用HMAC生成信息摘要是所使用的密钥。</p>\n<p>raw_output：该参数为可选参数，默认为false，如果设为true，则返回原始二进制数据表示的信息摘要，<br>否则返回16进制小写字符串格式表示的信息摘要（注意是16进制数，而非简单的字母加数字）。</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">方案一：hash_hmac(<span class=\"string\">&quot;sha1&quot;</span>, <span class=\"variable\">$str</span>, <span class=\"variable\">$secret</span>)</span><br><span class=\"line\">方案二：bin2hex(hash_hmac(<span class=\"string\">&quot;sha1&quot;</span>, <span class=\"variable\">$str</span>, <span class=\"variable\">$secret</span>, <span class=\"literal\">true</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">hash_hmac( <span class=\"string\">&#x27;md5&#x27;</span>,<span class=\"variable\">$data</span>, <span class=\"keyword\">$this</span>-&gt;appSecret)</span><br><span class=\"line\"></span><br><span class=\"line\">hash_hmac(<span class=\"string\">&#x27;sha256&#x27;</span>, <span class=\"variable\">$data</span>,<span class=\"keyword\">$this</span>-&gt;appSecret)</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"length":2925,"excerpt":"","more":"<h1 id=\"基础知识\"><a href=\"#基础知识\" class=\"headerlink\" title=\"基础知识\"></a>基础知识</h1><pre><code>数字签名 就是明文+私钥密文  这样就能保证数据没有被篡改  \n\n非对称加密 RSA、DSA\n    \n    公钥、私钥\n\n对称加密 DES、AES\n\n    只需要一个秘钥  加密解密 多用它就行了\n\n密码散列算法有 SHA-1、SHA-256 、MD5  \n    算出来就不可逆了，主要用来确定来源的\n</code></pre>\n<h1 id=\"签名算法-SHA1withRSA\"><a href=\"#签名算法-SHA1withRSA\" class=\"headerlink\" title=\"签名算法-SHA1withRSA\"></a>签名算法-SHA1withRSA</h1><p>用SHA算法进行签名，用RSA算法进行加密</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$str</span>        = chunk_split(<span class=\"variable\">$myPrivateKeyStr</span>, <span class=\"number\">64</span>, <span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\"><span class=\"variable\">$privateKey</span> = <span class=\"string\">&quot;-----BEGIN RSA PRIVATE KEY-----\\n<span class=\"subst\">$str</span>-----END RSA PRIVATE KEY-----\\n&quot;</span>;</span><br><span class=\"line\">openssl_sign(<span class=\"variable\">$paramStr</span>, <span class=\"variable\">$sign</span>, <span class=\"variable\">$privateKey</span>);</span><br><span class=\"line\"><span class=\"variable\">$resSign</span> = base64_encode(<span class=\"variable\">$sign</span>);</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"RSA加密\"><a href=\"#RSA加密\" class=\"headerlink\" title=\"RSA加密\"></a>RSA加密</h1><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * RSA分段加密</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> $context string 待加密字符串</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> $type string  &#x27;private&#x27; or &#x27;public&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> $key string 公钥 or 私钥</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"built_in\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">encrypt</span>(<span class=\"params\"><span class=\"variable\">$context</span>, <span class=\"variable\">$type</span>, <span class=\"variable\">$key</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//http://www.php.net/manual/en/function.openssl-public-encrypt.php#95307</span></span><br><span class=\"line\">    <span class=\"comment\">//Assumes 1024 bit key and encrypts in chunks.</span></span><br><span class=\"line\">    <span class=\"variable\">$maxlength</span> = <span class=\"number\">117</span>;</span><br><span class=\"line\">    <span class=\"variable\">$output</span> = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"variable\">$context</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable\">$input</span> = substr(<span class=\"variable\">$context</span>, <span class=\"number\">0</span>, <span class=\"variable\">$maxlength</span>);</span><br><span class=\"line\">        <span class=\"variable\">$context</span> = substr(<span class=\"variable\">$context</span>, <span class=\"variable\">$maxlength</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable\">$type</span> == <span class=\"string\">&#x27;private&#x27;</span>) &#123;</span><br><span class=\"line\">            <span class=\"variable\">$ok</span> = openssl_private_encrypt(<span class=\"variable\">$input</span>, <span class=\"variable\">$encrypted</span>, <span class=\"variable\">$key</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"variable\">$ok</span> = openssl_public_encrypt(<span class=\"variable\">$input</span>, <span class=\"variable\">$encrypted</span>, <span class=\"variable\">$key</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"variable\">$output</span> .= <span class=\"variable\">$encrypted</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> base64_encode(<span class=\"variable\">$output</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"AES加密\"><a href=\"#AES加密\" class=\"headerlink\" title=\"AES加密\"></a>AES加密</h1><p>openssl_encrypt($data,$method,$key,$options=0,$iv=””,&amp;$tag=NULL,$aad=””,$tag_length=16)</p>\n<p>1.$data：加密明文</p>\n<p>2.$method：加密方法： 可以通过openssl_get_cipher_methods()获取有哪些加密方式</p>\n<p>3.$passwd：加密密钥[密码]</p>\n<p>4.$options：数据格式选项（可选）【选项有：】：0,OPENSSL_RAW_DATA=1,OPENSSL_ZERO_PADDING=2,OPENSSL_NO_PADDING=3</p>\n<p>5.$iv：密初始化向量（可选),需要注意：如果method为DES−ECB，则iv无需填写</p>\n<p>6.$tag：使用 AEAD 密码模式（GCM 或 CCM）时传引用的验证标签(可选)</p>\n<p>7.$aad：附加的验证数据。（可选）</p>\n<p>8.$tag_length：验证 tag 的长度。GCM 模式时，它的范围是 4 到 16(可选)</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openssl_encrypt(json_encode(<span class=\"variable\">$body</span>), <span class=\"string\">&#x27;AES-128-CBC&#x27;</span>, <span class=\"keyword\">$this</span>-&gt;key, OPENSSL_RAW_DATA, <span class=\"keyword\">$this</span>-&gt;iv)</span><br><span class=\"line\"></span><br><span class=\"line\">bin2hex(openssl_encrypt(<span class=\"variable\">$str</span>, <span class=\"string\">&#x27;DES-ECB&#x27;</span>, <span class=\"keyword\">$this</span>-&gt;appSecret, OPENSSL_RAW_DATA));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#一般多需要转换为base64传输</span></span><br><span class=\"line\">base64_encode(openssl_encrypt(json_encode(<span class=\"variable\">$body</span>), <span class=\"string\">&#x27;AES-128-CBC&#x27;</span>, <span class=\"keyword\">$this</span>-&gt;key, OPENSSL_RAW_DATA, <span class=\"keyword\">$this</span>-&gt;iv));</span><br></pre></td></tr></table></figure>\n<h1 id=\"DES加密\"><a href=\"#DES加密\" class=\"headerlink\" title=\"DES加密\"></a>DES加密</h1><p> 填充模式：pkcs5、pkcs7、iso10126、ansix923、zero。</p>\n<p> 加密模式：DES-ECB、DES-CBC、DES-CTR、DES-OFB、DES-CFB。</p>\n<p> ECB模式（电子密码本模式）： 将明文分成块并分别加密，每个块独立处理。<br>                            相同的明文块将加密成相同的密文块，可能存在安全性问题。</p>\n<p> CBC模式（密码块链接模式）： 使用前一个块的密文与当前块的明文进行异或操作，增强了安全性。<br>                            需要一个初始化向量（IV）来加密第一个块。</p>\n<p> CFB模式（密码反馈模式）：   将前一个密文块与密钥流进行异或，再与明文进行异或。<br>                            这种模式使得每个密文块的加密都依赖于前一个密文块。   </p>\n<p> OFB模式（输出反馈模式）：   将前一个输出块与密钥流进行异或，再与明文进行异或。<br>                            类似于CFB模式，但不同的是OFB不直接依赖前一个密文块      </p>\n<p> CTR模式（计数器模式）：       使用一个计数器和密钥流进行异或，得到密文。<br>                            计数器的值会逐块增加，确保相同的明文块不会产生相同的密文块。</p>\n<p>输出类型：无编码，base64编码，hex编码。</p>\n<p>java 下默认是DES-ECB</p>\n<h1 id=\"HMAC-散列消息身份验证码\"><a href=\"#HMAC-散列消息身份验证码\" class=\"headerlink\" title=\"HMAC 散列消息身份验证码\"></a>HMAC 散列消息身份验证码</h1><p>它不是散列函数，而是采用了将MD5或SHA1散列函数与共享机密秘钥（与公钥/秘钥对不同）一起使用的消息身份验证机制。</p>\n<p>目前hmac主要应用在身份验证中，在用户登录传递密码的过程中可以利用，签名来防止密码明文传递。</p>\n<p>在php中hash_hmac函数就能将HMAC和一部分哈希加密算法相结合起来实现HMAC-SHA1  HMAC-SHA256 HMAC-MD5等等算法</p>\n<p>string hash_hmac(string $algo, string $data, string $key, bool $raw_output = false)</p>\n<p>algo：要使用的哈希算法名称，可以是上述提到的md5,sha1等</p>\n<p>data：要进行哈希运算的消息，也就是需要加密的明文。</p>\n<p>key：使用HMAC生成信息摘要是所使用的密钥。</p>\n<p>raw_output：该参数为可选参数，默认为false，如果设为true，则返回原始二进制数据表示的信息摘要，<br>否则返回16进制小写字符串格式表示的信息摘要（注意是16进制数，而非简单的字母加数字）。</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">方案一：hash_hmac(<span class=\"string\">&quot;sha1&quot;</span>, <span class=\"variable\">$str</span>, <span class=\"variable\">$secret</span>)</span><br><span class=\"line\">方案二：bin2hex(hash_hmac(<span class=\"string\">&quot;sha1&quot;</span>, <span class=\"variable\">$str</span>, <span class=\"variable\">$secret</span>, <span class=\"literal\">true</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">hash_hmac( <span class=\"string\">&#x27;md5&#x27;</span>,<span class=\"variable\">$data</span>, <span class=\"keyword\">$this</span>-&gt;appSecret)</span><br><span class=\"line\"></span><br><span class=\"line\">hash_hmac(<span class=\"string\">&#x27;sha256&#x27;</span>, <span class=\"variable\">$data</span>,<span class=\"keyword\">$this</span>-&gt;appSecret)</span><br></pre></td></tr></table></figure>\n"},{"title":"php开发-常用函数总结","abbrlink":"15179f17","date":"2023-07-25T07:54:20.000Z","_content":"\n\n# 一、字符串处理函数\n\n## 1.1 str_pad()\nstr_pad(【必填 需要处理的字符串】,【必填 填充的长度】，【 可选 填充的字符串，默认空白】，【可选 填充字符串的哪边】)\n\n    规定填充字符串的哪边 可能的值：\n    \n    STR_PAD_BOTH - 填充字符串的两侧。如果不是偶数，则右侧获得额外的填充。\n    STR_PAD_LEFT - 填充字符串的左侧。\n    STR_PAD_RIGHT - 填充字符串的右侧。这是默认的。\n\n\n示例 $str=10 ; echo str_pad($str,4,\"0\",STR_PAD_LEFT);  <font color=\"red\">意思就4位长度 不够就往左边补0</font>\n\n## 2.1 strpos、stripos 、strrpos\n\n\n\n## 2.3 substr\n\n\n## 2.4 strtolower strtouplower strlen mb_strlen trim ltrim rtrim explode implode常用\n\n    比较常用，不在赘述\n    \n    \n\n# 二、数组处理函数","source":"_posts/php开发-常用函数总结.md","raw":"---\ntitle: php开发-常用函数总结\ntags: PHP开发\ncategories:\n  - PHP开发\nabbrlink: 15179f17\ndate: 2023-07-25 15:54:20\n---\n\n\n# 一、字符串处理函数\n\n## 1.1 str_pad()\nstr_pad(【必填 需要处理的字符串】,【必填 填充的长度】，【 可选 填充的字符串，默认空白】，【可选 填充字符串的哪边】)\n\n    规定填充字符串的哪边 可能的值：\n    \n    STR_PAD_BOTH - 填充字符串的两侧。如果不是偶数，则右侧获得额外的填充。\n    STR_PAD_LEFT - 填充字符串的左侧。\n    STR_PAD_RIGHT - 填充字符串的右侧。这是默认的。\n\n\n示例 $str=10 ; echo str_pad($str,4,\"0\",STR_PAD_LEFT);  <font color=\"red\">意思就4位长度 不够就往左边补0</font>\n\n## 2.1 strpos、stripos 、strrpos\n\n\n\n## 2.3 substr\n\n\n## 2.4 strtolower strtouplower strlen mb_strlen trim ltrim rtrim explode implode常用\n\n    比较常用，不在赘述\n    \n    \n\n# 二、数组处理函数","slug":"php开发-常用函数总结","published":1,"updated":"2024-02-06T10:58:18.937Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv4w002fpcoc7ammdg8y","content":"<h1 id=\"一、字符串处理函数\"><a href=\"#一、字符串处理函数\" class=\"headerlink\" title=\"一、字符串处理函数\"></a>一、字符串处理函数</h1><h2 id=\"1-1-str-pad\"><a href=\"#1-1-str-pad\" class=\"headerlink\" title=\"1.1 str_pad()\"></a>1.1 str_pad()</h2><p>str_pad(【必填 需要处理的字符串】,【必填 填充的长度】，【 可选 填充的字符串，默认空白】，【可选 填充字符串的哪边】)</p>\n<pre><code>规定填充字符串的哪边 可能的值：\n\nSTR_PAD_BOTH - 填充字符串的两侧。如果不是偶数，则右侧获得额外的填充。\nSTR_PAD_LEFT - 填充字符串的左侧。\nSTR_PAD_RIGHT - 填充字符串的右侧。这是默认的。\n</code></pre>\n<p>示例 $str=10 ; echo str_pad($str,4,”0”,STR_PAD_LEFT);  <font color=\"red\">意思就4位长度 不够就往左边补0</font></p>\n<h2 id=\"2-1-strpos、stripos-、strrpos\"><a href=\"#2-1-strpos、stripos-、strrpos\" class=\"headerlink\" title=\"2.1 strpos、stripos 、strrpos\"></a>2.1 strpos、stripos 、strrpos</h2><h2 id=\"2-3-substr\"><a href=\"#2-3-substr\" class=\"headerlink\" title=\"2.3 substr\"></a>2.3 substr</h2><h2 id=\"2-4-strtolower-strtouplower-strlen-mb-strlen-trim-ltrim-rtrim-explode-implode常用\"><a href=\"#2-4-strtolower-strtouplower-strlen-mb-strlen-trim-ltrim-rtrim-explode-implode常用\" class=\"headerlink\" title=\"2.4 strtolower strtouplower strlen mb_strlen trim ltrim rtrim explode implode常用\"></a>2.4 strtolower strtouplower strlen mb_strlen trim ltrim rtrim explode implode常用</h2><pre><code>比较常用，不在赘述\n</code></pre>\n<h1 id=\"二、数组处理函数\"><a href=\"#二、数组处理函数\" class=\"headerlink\" title=\"二、数组处理函数\"></a>二、数组处理函数</h1>","site":{"data":{}},"length":370,"excerpt":"","more":"<h1 id=\"一、字符串处理函数\"><a href=\"#一、字符串处理函数\" class=\"headerlink\" title=\"一、字符串处理函数\"></a>一、字符串处理函数</h1><h2 id=\"1-1-str-pad\"><a href=\"#1-1-str-pad\" class=\"headerlink\" title=\"1.1 str_pad()\"></a>1.1 str_pad()</h2><p>str_pad(【必填 需要处理的字符串】,【必填 填充的长度】，【 可选 填充的字符串，默认空白】，【可选 填充字符串的哪边】)</p>\n<pre><code>规定填充字符串的哪边 可能的值：\n\nSTR_PAD_BOTH - 填充字符串的两侧。如果不是偶数，则右侧获得额外的填充。\nSTR_PAD_LEFT - 填充字符串的左侧。\nSTR_PAD_RIGHT - 填充字符串的右侧。这是默认的。\n</code></pre>\n<p>示例 $str=10 ; echo str_pad($str,4,”0”,STR_PAD_LEFT);  <font color=\"red\">意思就4位长度 不够就往左边补0</font></p>\n<h2 id=\"2-1-strpos、stripos-、strrpos\"><a href=\"#2-1-strpos、stripos-、strrpos\" class=\"headerlink\" title=\"2.1 strpos、stripos 、strrpos\"></a>2.1 strpos、stripos 、strrpos</h2><h2 id=\"2-3-substr\"><a href=\"#2-3-substr\" class=\"headerlink\" title=\"2.3 substr\"></a>2.3 substr</h2><h2 id=\"2-4-strtolower-strtouplower-strlen-mb-strlen-trim-ltrim-rtrim-explode-implode常用\"><a href=\"#2-4-strtolower-strtouplower-strlen-mb-strlen-trim-ltrim-rtrim-explode-implode常用\" class=\"headerlink\" title=\"2.4 strtolower strtouplower strlen mb_strlen trim ltrim rtrim explode implode常用\"></a>2.4 strtolower strtouplower strlen mb_strlen trim ltrim rtrim explode implode常用</h2><pre><code>比较常用，不在赘述\n</code></pre>\n<h1 id=\"二、数组处理函数\"><a href=\"#二、数组处理函数\" class=\"headerlink\" title=\"二、数组处理函数\"></a>二、数组处理函数</h1>"},{"title":"php开发-注册登录","abbrlink":"a634ca62","date":"2024-03-18T07:43:30.000Z","_content":"\n# 一、验证码\n    \n## 1.1 生成\n### 随机字符串 方案\n```php\n    $codeset= \"2345678abcdefhijkmnpqrstuvwxyzABCDEFGHJKLMNPQRTUVWXY\n     for ($i = 0; $i < $length; $i++) {\n            $code[$i] = $codeSet[mt_rand(0, strlen($codeset) - 1)];\n     }\n     return $code;\n ```\n### 加减法 方案\n\n### 拖动拼图方案 \n   \n## 1.2 存储验证码  \n\n   cookie session \n   \n## 1.3 验证验证码   \n  \n  session\n    \n    \n# 二、注册方式\n    \n## 用户名+密码+邮箱注册\n\n### 注册处理\n\n    存储数据库 过期没激活 删除 \n     \n    url 中加个唯一的key  发送邮件\n    \n### 激活模块\n\n    根据  url 中唯一的key 查询处理\n\n## 用户名+密码+手机验证码\n    \n    生成验证码 存储  然后发送短信\n\n## 第三方注册\n\n\n# 登录方式\n\n## 用户名+密码\n\n基于cookie+session \n\n## 手机号+验证码+手机验证码\n\nPC端 前后端不分离 手机号码 + 验证码  基于cookie+session \n\n移动端 token 方式 用户名密码 验证成功 就生成$token \n然后$token+$user_id 绑定\n生成token 示例：\n```php\n\n  /**\n     * 获取全球唯一标识\n     * @return string\n     */\n    public static function uuid()\n    {\n        return sprintf(\n            '%04x%04x-%04x-%04x-%04x-%04x%04x%04x',\n            mt_rand(0, 0xffff),\n            mt_rand(0, 0xffff),\n            mt_rand(0, 0xffff),\n            mt_rand(0, 0x0fff) | 0x4000,\n            mt_rand(0, 0x3fff) | 0x8000,\n            mt_rand(0, 0xffff),\n            mt_rand(0, 0xffff),\n            mt_rand(0, 0xffff)\n        );\n    }\n```\n\n## 本机号码一键登录\n\n## 第三方授权登录\n\n## 手机号+验证码+绑定第三方授权\n\n\n## 记住功能\n\n设置session的保存时长\n\n# 单点登录\n\n## 直接基于Cookie与Session实现单点登录\n\n## 基于CAS方案实现单点登录\n\n## 基于OAuth方案实现单点登录\n\n# 多终端设备的用户互踢","source":"_posts/php开发-注册登录登录.md","raw":"---\ntitle: php开发-注册登录\nabbrlink: a634ca62\ndate: 2024-03-18 15:43:30\ntags:\ncategories:\n  - PHP开发\n---\n\n# 一、验证码\n    \n## 1.1 生成\n### 随机字符串 方案\n```php\n    $codeset= \"2345678abcdefhijkmnpqrstuvwxyzABCDEFGHJKLMNPQRTUVWXY\n     for ($i = 0; $i < $length; $i++) {\n            $code[$i] = $codeSet[mt_rand(0, strlen($codeset) - 1)];\n     }\n     return $code;\n ```\n### 加减法 方案\n\n### 拖动拼图方案 \n   \n## 1.2 存储验证码  \n\n   cookie session \n   \n## 1.3 验证验证码   \n  \n  session\n    \n    \n# 二、注册方式\n    \n## 用户名+密码+邮箱注册\n\n### 注册处理\n\n    存储数据库 过期没激活 删除 \n     \n    url 中加个唯一的key  发送邮件\n    \n### 激活模块\n\n    根据  url 中唯一的key 查询处理\n\n## 用户名+密码+手机验证码\n    \n    生成验证码 存储  然后发送短信\n\n## 第三方注册\n\n\n# 登录方式\n\n## 用户名+密码\n\n基于cookie+session \n\n## 手机号+验证码+手机验证码\n\nPC端 前后端不分离 手机号码 + 验证码  基于cookie+session \n\n移动端 token 方式 用户名密码 验证成功 就生成$token \n然后$token+$user_id 绑定\n生成token 示例：\n```php\n\n  /**\n     * 获取全球唯一标识\n     * @return string\n     */\n    public static function uuid()\n    {\n        return sprintf(\n            '%04x%04x-%04x-%04x-%04x-%04x%04x%04x',\n            mt_rand(0, 0xffff),\n            mt_rand(0, 0xffff),\n            mt_rand(0, 0xffff),\n            mt_rand(0, 0x0fff) | 0x4000,\n            mt_rand(0, 0x3fff) | 0x8000,\n            mt_rand(0, 0xffff),\n            mt_rand(0, 0xffff),\n            mt_rand(0, 0xffff)\n        );\n    }\n```\n\n## 本机号码一键登录\n\n## 第三方授权登录\n\n## 手机号+验证码+绑定第三方授权\n\n\n## 记住功能\n\n设置session的保存时长\n\n# 单点登录\n\n## 直接基于Cookie与Session实现单点登录\n\n## 基于CAS方案实现单点登录\n\n## 基于OAuth方案实现单点登录\n\n# 多终端设备的用户互踢","slug":"php开发-注册登录登录","published":1,"updated":"2024-11-25T11:34:26.165Z","_id":"clxb4gv4x002hpcocdyk89f1i","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、验证码\"><a href=\"#一、验证码\" class=\"headerlink\" title=\"一、验证码\"></a>一、验证码</h1><h2 id=\"1-1-生成\"><a href=\"#1-1-生成\" class=\"headerlink\" title=\"1.1 生成\"></a>1.1 生成</h2><h3 id=\"随机字符串-方案\"><a href=\"#随机字符串-方案\" class=\"headerlink\" title=\"随机字符串 方案\"></a>随机字符串 方案</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$codeset</span>= <span class=\"string\">&quot;2345678abcdefhijkmnpqrstuvwxyzABCDEFGHJKLMNPQRTUVWXY</span></span><br><span class=\"line\"><span class=\"string\"> for (<span class=\"subst\">$i</span> = 0; <span class=\"subst\">$i</span> &lt; <span class=\"subst\">$length</span>; <span class=\"subst\">$i</span>++) &#123;</span></span><br><span class=\"line\"><span class=\"string\">        <span class=\"subst\">$code</span>[<span class=\"subst\">$i</span>] = <span class=\"subst\">$codeSet</span>[mt_rand(0, strlen(<span class=\"subst\">$codeset</span>) - 1)];</span></span><br><span class=\"line\"><span class=\"string\"> &#125;</span></span><br><span class=\"line\"><span class=\"string\"> return <span class=\"subst\">$code</span>;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"加减法-方案\"><a href=\"#加减法-方案\" class=\"headerlink\" title=\"加减法 方案\"></a>加减法 方案</h3><h3 id=\"拖动拼图方案\"><a href=\"#拖动拼图方案\" class=\"headerlink\" title=\"拖动拼图方案\"></a>拖动拼图方案</h3><h2 id=\"1-2-存储验证码\"><a href=\"#1-2-存储验证码\" class=\"headerlink\" title=\"1.2 存储验证码\"></a>1.2 存储验证码</h2><p>   cookie session </p>\n<h2 id=\"1-3-验证验证码\"><a href=\"#1-3-验证验证码\" class=\"headerlink\" title=\"1.3 验证验证码\"></a>1.3 验证验证码</h2><p>  session</p>\n<h1 id=\"二、注册方式\"><a href=\"#二、注册方式\" class=\"headerlink\" title=\"二、注册方式\"></a>二、注册方式</h1><h2 id=\"用户名-密码-邮箱注册\"><a href=\"#用户名-密码-邮箱注册\" class=\"headerlink\" title=\"用户名+密码+邮箱注册\"></a>用户名+密码+邮箱注册</h2><h3 id=\"注册处理\"><a href=\"#注册处理\" class=\"headerlink\" title=\"注册处理\"></a>注册处理</h3><pre><code>存储数据库 过期没激活 删除 \n \nurl 中加个唯一的key  发送邮件\n</code></pre>\n<h3 id=\"激活模块\"><a href=\"#激活模块\" class=\"headerlink\" title=\"激活模块\"></a>激活模块</h3><pre><code>根据  url 中唯一的key 查询处理\n</code></pre>\n<h2 id=\"用户名-密码-手机验证码\"><a href=\"#用户名-密码-手机验证码\" class=\"headerlink\" title=\"用户名+密码+手机验证码\"></a>用户名+密码+手机验证码</h2><pre><code>生成验证码 存储  然后发送短信\n</code></pre>\n<h2 id=\"第三方注册\"><a href=\"#第三方注册\" class=\"headerlink\" title=\"第三方注册\"></a>第三方注册</h2><h1 id=\"登录方式\"><a href=\"#登录方式\" class=\"headerlink\" title=\"登录方式\"></a>登录方式</h1><h2 id=\"用户名-密码\"><a href=\"#用户名-密码\" class=\"headerlink\" title=\"用户名+密码\"></a>用户名+密码</h2><p>基于cookie+session </p>\n<h2 id=\"手机号-验证码-手机验证码\"><a href=\"#手机号-验证码-手机验证码\" class=\"headerlink\" title=\"手机号+验证码+手机验证码\"></a>手机号+验证码+手机验证码</h2><p>PC端 前后端不分离 手机号码 + 验证码  基于cookie+session </p>\n<p>移动端 token 方式 用户名密码 验证成功 就生成$token<br>然后$token+$user_id 绑定<br>生成token 示例：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * 获取全球唯一标识</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@return</span> string</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"built_in\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">uuid</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> sprintf(</span><br><span class=\"line\">          <span class=\"string\">&#x27;%04x%04x-%04x-%04x-%04x-%04x%04x%04x&#x27;</span>,</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0xffff</span>),</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0xffff</span>),</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0xffff</span>),</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0x0fff</span>) | <span class=\"number\">0x4000</span>,</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0x3fff</span>) | <span class=\"number\">0x8000</span>,</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0xffff</span>),</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0xffff</span>),</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0xffff</span>)</span><br><span class=\"line\">      );</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"本机号码一键登录\"><a href=\"#本机号码一键登录\" class=\"headerlink\" title=\"本机号码一键登录\"></a>本机号码一键登录</h2><h2 id=\"第三方授权登录\"><a href=\"#第三方授权登录\" class=\"headerlink\" title=\"第三方授权登录\"></a>第三方授权登录</h2><h2 id=\"手机号-验证码-绑定第三方授权\"><a href=\"#手机号-验证码-绑定第三方授权\" class=\"headerlink\" title=\"手机号+验证码+绑定第三方授权\"></a>手机号+验证码+绑定第三方授权</h2><h2 id=\"记住功能\"><a href=\"#记住功能\" class=\"headerlink\" title=\"记住功能\"></a>记住功能</h2><p>设置session的保存时长</p>\n<h1 id=\"单点登录\"><a href=\"#单点登录\" class=\"headerlink\" title=\"单点登录\"></a>单点登录</h1><h2 id=\"直接基于Cookie与Session实现单点登录\"><a href=\"#直接基于Cookie与Session实现单点登录\" class=\"headerlink\" title=\"直接基于Cookie与Session实现单点登录\"></a>直接基于Cookie与Session实现单点登录</h2><h2 id=\"基于CAS方案实现单点登录\"><a href=\"#基于CAS方案实现单点登录\" class=\"headerlink\" title=\"基于CAS方案实现单点登录\"></a>基于CAS方案实现单点登录</h2><h2 id=\"基于OAuth方案实现单点登录\"><a href=\"#基于OAuth方案实现单点登录\" class=\"headerlink\" title=\"基于OAuth方案实现单点登录\"></a>基于OAuth方案实现单点登录</h2><h1 id=\"多终端设备的用户互踢\"><a href=\"#多终端设备的用户互踢\" class=\"headerlink\" title=\"多终端设备的用户互踢\"></a>多终端设备的用户互踢</h1>","site":{"data":{}},"length":897,"excerpt":"","more":"<h1 id=\"一、验证码\"><a href=\"#一、验证码\" class=\"headerlink\" title=\"一、验证码\"></a>一、验证码</h1><h2 id=\"1-1-生成\"><a href=\"#1-1-生成\" class=\"headerlink\" title=\"1.1 生成\"></a>1.1 生成</h2><h3 id=\"随机字符串-方案\"><a href=\"#随机字符串-方案\" class=\"headerlink\" title=\"随机字符串 方案\"></a>随机字符串 方案</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$codeset</span>= <span class=\"string\">&quot;2345678abcdefhijkmnpqrstuvwxyzABCDEFGHJKLMNPQRTUVWXY</span></span><br><span class=\"line\"><span class=\"string\"> for (<span class=\"subst\">$i</span> = 0; <span class=\"subst\">$i</span> &lt; <span class=\"subst\">$length</span>; <span class=\"subst\">$i</span>++) &#123;</span></span><br><span class=\"line\"><span class=\"string\">        <span class=\"subst\">$code</span>[<span class=\"subst\">$i</span>] = <span class=\"subst\">$codeSet</span>[mt_rand(0, strlen(<span class=\"subst\">$codeset</span>) - 1)];</span></span><br><span class=\"line\"><span class=\"string\"> &#125;</span></span><br><span class=\"line\"><span class=\"string\"> return <span class=\"subst\">$code</span>;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"加减法-方案\"><a href=\"#加减法-方案\" class=\"headerlink\" title=\"加减法 方案\"></a>加减法 方案</h3><h3 id=\"拖动拼图方案\"><a href=\"#拖动拼图方案\" class=\"headerlink\" title=\"拖动拼图方案\"></a>拖动拼图方案</h3><h2 id=\"1-2-存储验证码\"><a href=\"#1-2-存储验证码\" class=\"headerlink\" title=\"1.2 存储验证码\"></a>1.2 存储验证码</h2><p>   cookie session </p>\n<h2 id=\"1-3-验证验证码\"><a href=\"#1-3-验证验证码\" class=\"headerlink\" title=\"1.3 验证验证码\"></a>1.3 验证验证码</h2><p>  session</p>\n<h1 id=\"二、注册方式\"><a href=\"#二、注册方式\" class=\"headerlink\" title=\"二、注册方式\"></a>二、注册方式</h1><h2 id=\"用户名-密码-邮箱注册\"><a href=\"#用户名-密码-邮箱注册\" class=\"headerlink\" title=\"用户名+密码+邮箱注册\"></a>用户名+密码+邮箱注册</h2><h3 id=\"注册处理\"><a href=\"#注册处理\" class=\"headerlink\" title=\"注册处理\"></a>注册处理</h3><pre><code>存储数据库 过期没激活 删除 \n \nurl 中加个唯一的key  发送邮件\n</code></pre>\n<h3 id=\"激活模块\"><a href=\"#激活模块\" class=\"headerlink\" title=\"激活模块\"></a>激活模块</h3><pre><code>根据  url 中唯一的key 查询处理\n</code></pre>\n<h2 id=\"用户名-密码-手机验证码\"><a href=\"#用户名-密码-手机验证码\" class=\"headerlink\" title=\"用户名+密码+手机验证码\"></a>用户名+密码+手机验证码</h2><pre><code>生成验证码 存储  然后发送短信\n</code></pre>\n<h2 id=\"第三方注册\"><a href=\"#第三方注册\" class=\"headerlink\" title=\"第三方注册\"></a>第三方注册</h2><h1 id=\"登录方式\"><a href=\"#登录方式\" class=\"headerlink\" title=\"登录方式\"></a>登录方式</h1><h2 id=\"用户名-密码\"><a href=\"#用户名-密码\" class=\"headerlink\" title=\"用户名+密码\"></a>用户名+密码</h2><p>基于cookie+session </p>\n<h2 id=\"手机号-验证码-手机验证码\"><a href=\"#手机号-验证码-手机验证码\" class=\"headerlink\" title=\"手机号+验证码+手机验证码\"></a>手机号+验证码+手机验证码</h2><p>PC端 前后端不分离 手机号码 + 验证码  基于cookie+session </p>\n<p>移动端 token 方式 用户名密码 验证成功 就生成$token<br>然后$token+$user_id 绑定<br>生成token 示例：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * 获取全球唯一标识</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@return</span> string</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"built_in\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">uuid</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> sprintf(</span><br><span class=\"line\">          <span class=\"string\">&#x27;%04x%04x-%04x-%04x-%04x-%04x%04x%04x&#x27;</span>,</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0xffff</span>),</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0xffff</span>),</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0xffff</span>),</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0x0fff</span>) | <span class=\"number\">0x4000</span>,</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0x3fff</span>) | <span class=\"number\">0x8000</span>,</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0xffff</span>),</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0xffff</span>),</span><br><span class=\"line\">          mt_rand(<span class=\"number\">0</span>, <span class=\"number\">0xffff</span>)</span><br><span class=\"line\">      );</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"本机号码一键登录\"><a href=\"#本机号码一键登录\" class=\"headerlink\" title=\"本机号码一键登录\"></a>本机号码一键登录</h2><h2 id=\"第三方授权登录\"><a href=\"#第三方授权登录\" class=\"headerlink\" title=\"第三方授权登录\"></a>第三方授权登录</h2><h2 id=\"手机号-验证码-绑定第三方授权\"><a href=\"#手机号-验证码-绑定第三方授权\" class=\"headerlink\" title=\"手机号+验证码+绑定第三方授权\"></a>手机号+验证码+绑定第三方授权</h2><h2 id=\"记住功能\"><a href=\"#记住功能\" class=\"headerlink\" title=\"记住功能\"></a>记住功能</h2><p>设置session的保存时长</p>\n<h1 id=\"单点登录\"><a href=\"#单点登录\" class=\"headerlink\" title=\"单点登录\"></a>单点登录</h1><h2 id=\"直接基于Cookie与Session实现单点登录\"><a href=\"#直接基于Cookie与Session实现单点登录\" class=\"headerlink\" title=\"直接基于Cookie与Session实现单点登录\"></a>直接基于Cookie与Session实现单点登录</h2><h2 id=\"基于CAS方案实现单点登录\"><a href=\"#基于CAS方案实现单点登录\" class=\"headerlink\" title=\"基于CAS方案实现单点登录\"></a>基于CAS方案实现单点登录</h2><h2 id=\"基于OAuth方案实现单点登录\"><a href=\"#基于OAuth方案实现单点登录\" class=\"headerlink\" title=\"基于OAuth方案实现单点登录\"></a>基于OAuth方案实现单点登录</h2><h1 id=\"多终端设备的用户互踢\"><a href=\"#多终端设备的用户互踢\" class=\"headerlink\" title=\"多终端设备的用户互踢\"></a>多终端设备的用户互踢</h1>"},{"title":"php开发-微信授权登录","abbrlink":"dc9d89c5","date":"2024-03-19T11:21:50.000Z","_content":"\n\n# 一、注册微信开放平台\n\n    网址：https://open.weixin.qq.com/\n    \n    需要哪些资质  \n    \n#     ","source":"_posts/php开发-微信授权登录.md","raw":"---\ntitle: php开发-微信授权登录\nabbrlink: dc9d89c5\ndate: 2024-03-19 19:21:50\ntags:\n  - 微信\ncategories:\n  - PHP开发\n---\n\n\n# 一、注册微信开放平台\n\n    网址：https://open.weixin.qq.com/\n    \n    需要哪些资质  \n    \n#     ","slug":"php开发-微信授权登录","published":1,"updated":"2025-04-22T03:33:53.293Z","_id":"clxb4gv4x002kpcoc4sc38ix6","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、注册微信开放平台\"><a href=\"#一、注册微信开放平台\" class=\"headerlink\" title=\"一、注册微信开放平台\"></a>一、注册微信开放平台</h1><pre><code>网址：https://open.weixin.qq.com/\n\n需要哪些资质  \n</code></pre>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>","site":{"data":{}},"length":46,"excerpt":"","more":"<h1 id=\"一、注册微信开放平台\"><a href=\"#一、注册微信开放平台\" class=\"headerlink\" title=\"一、注册微信开放平台\"></a>一、注册微信开放平台</h1><pre><code>网址：https://open.weixin.qq.com/\n\n需要哪些资质  \n</code></pre>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>"},{"title":"redis基础","abbrlink":"78b568c7","date":"2023-09-25T07:48:26.000Z","_content":"\n# redis 简介\n\nRedis支持数据的持久化，可以将内存中的数据保存在磁盘中，重启的时候可以再次加载进行使用\nRedis不仅仅支持简单的key-value类型的数据，同时还提供list，set，zset，hash等数据结构的存储\nRedis支持数据的备份，即master-slave模式的数据备份\n\nRedis是单进程的\n\n# redis 持久化方案\n\n## AOF持久化\n\n三种写回策略\nalways，同步写回，每个子命令执行完，都立即将日志写回磁盘。\n\neverysec，每个命令执行完，只是先把日志写到AOF内存缓冲区，每隔一秒同步到磁盘。\n\nno：只是先把日志写到AOF内存缓冲区，有操作系统去决定何时写入磁盘\n\n数据保证：我们可以设置fsync策略，一般默认是everysec，也可以设置每次写入追加，\n所以即使服务死掉了，也最多丢失一秒数据\n\n## RDB持久化\n\n体积更小：相同的数据量rdb数据比aof的小，因为rdb是紧凑型文件。\n恢复更快：因为rdb是数据的快照，基本上就是数据的复制，不用重新读取再写入内存。\n性能更高:父进程在保存rdb时候只需要fork一个子进程，无需父进程的进行其他io操作，也保证了服务器的性能。\n\n## 如何选择RDB和AOF\n\n如果数据不能丢失，RDB和AOF混用\n如果只作为缓存使用，可以承受几分钟的数据丢失的话，可以只使用RDB。\n如果只使用AOF，优先使用everysec的写回策略。\n\n# RDB(快照)持久化 配置\n\n    #   900秒（15分钟）内至少1个key值改变（则进行数据库保存--持久化）  \n    #   300秒（5分钟）内至少10个key值改变（则进行数据库保存--持久化）  \n    #   60秒（1分钟）内至少10000个key值改变（则进行数据库保存--持久化） \n    save 900 1  \n    save 300 10  \n    save 60 10000 \n    \n    \n    #在默认情况下，如果RDB快照持久化操作被激活（至少一个条件被激活）并且持久化操作失败，Redis则会停止接受更新操作。  \n    #这样会让用户了解到数据没有被正确的存储到磁盘上。否则没人会注意到这个问题，可能会造成灾难。  \n    #  \n    #如果后台存储（持久化）操作进程再次工作，Redis会自动允许更新操作。  \n    #  \n    #然而，如果你已经恰当的配置了对Redis服务器的监视和备份，你也许想关掉这项功能。  \n    #如此一来即使后台保存操作出错,redis也仍然可以继续像平常一样工作。  \n    stop-writes-on-bgsave-error yes\n    \n    #是否压缩数据\n    rdbcompression yes\n    #没有校验的RDB文件会有一个0校验位，来告诉加载代码跳过校验检查。  \n    rdbchecksum yes \n    # 导出数据库的文件名称  \n    dbfilename dump.rdb\n    \n    dir ./\n    \n#  AOF(Append Only File 日志)  配置\n    \n    appendonly yes\n    appendfilename \"appendonly_6379.aof\"\n    appendfsync everysec\n    1、不适用fsync模式，仅仅使用操作系统的写数据策略；（no）\n    2、总是启动用fsync；（always） \n    3、每秒同步一次。（everyse）\n    \n    #在rewrite的时候不进行fsync，避免响应过慢。为了避免丢数据建议设置成no\n    #rewrite操作时，appendfsync会被阻塞。如果当前AOF文件很大，\n    #那么相应的rewrite时间会变长，appendfsync被阻塞的时间也会更长\n    no-appendfsync-on-rewrite no\n    \n    #AOF文件如果不执行rewrite，文件会不断的增长。\n    #可以设置达到一定量就开始执行rewrite，避免磁盘耗尽\n    auto-aof-rewrite-percentage 100\n    \n    #过最后一次rewrite文件大小的百分比，如果设置为0表示不自动aof。\n    #如果数据量比较小，设置百分比就会一直执行rewrite，消耗信息，这时候就可以设置最小rewrite的大小。\n    auto-aof-rewrite-min-size 64mb\n    \n    #如果redis异常推出，会导致aof不完整，\n    #如果设置为yes，启动时就会加载aof异常文件，如果设置为no，就不会加载，启动失败。\n    aof-load-truncated yes\n    \n    #启动的时候使用rdb文件会加载数据比较快，再执行aof操作，可以减少数据加载时间\n    aof-use-rdb-preamble yes\n   \n   \n# 基础配置    \n\n    redis默认是没有使用守护进程进行运行。可以通过daemonize参数进行设置  \n    daemonize yes\n    loglevel notice\n    requirepass  密码\n    \n    #有限时间内,移除那些TTL值最小的key,ttl最小代表最近要过期\n    maxmemory-policy  allkeys-lru\n    \n    设置在执行淘汰策略时，要考虑的样本数量。\n    较大的样本数可以提高淘汰算法的准确性，但也会增加CPU负载。\n    默认值为5，您可以根据实际情况进行调整\n    maxmemory-samples 10\n    \n    noeviction(默认策略)：对于写请求不再提供服务，直接返回错误（DEL请求和部分特殊请求除外）\n    allkeys-lru：从所有key中使用LRU算法进行淘汰\n    volatile-lru：从设置了过期时间的key中使用LRU算法进行淘汰\n    allkeys-random：从所有key中随机淘汰数据\n    volatile-random：从设置了过期时间的key中随机淘汰\n    volatile-ttl：在设置了过期时间的key中，根据key的过期时间进行淘汰，越早过期的越优先被淘汰\n    \n    #用于设置慢查询的评定时间，也就是说超过此配置项的命令，\n    将会被当成慢操作记录在慢查询日志中，\n    它执行单位是微秒 (1 秒等于 1000000 微秒)\n    slowlog-log-slower-than:100\n    \n    #用来配置慢查询日志的最大记录数\n    slowlog-max-len:100\n    \n    #表示当 Redis 运行内存超过最大内存时，是否开启 lazy free 机制删除\n    lazyfree-lazy-eviction no \n    \n    #表示设置了过期时间的键值，当过期之后是否开启 lazy free 机制删除\n    lazyfree-lazy-expire no \n    \n    #有些指令在处理已存在的键时，会带有一个隐式的 del 键的操作，\n    比如rename(修改key的名称) 命令，当目标键已存在，Redis 会先删除目标键，如果这些目标键是一个 big key，\n    就会造成阻塞删除的问题，此配置表示在这种场景中是否开启 lazy free 机制删除\n    lazyfree-lazy-server-del no \n    \n    #针对 slave(从节点) 进行全量数据同步，slave 在加载 master 的 RDB 文件前，\n    会运行 flushall 来清理自己的数据，\n    它表示此时是否开启 lazy free 机制删除\n    slave-lazy-flush no\n    \n    \n    \n   \n\n\n    \n    ","source":"_posts/redis基础.md","raw":"---\ntitle: redis基础\nabbrlink: 78b568c7\ndate: 2023-09-25 15:48:26\ntags:\n - redis\n---\n\n# redis 简介\n\nRedis支持数据的持久化，可以将内存中的数据保存在磁盘中，重启的时候可以再次加载进行使用\nRedis不仅仅支持简单的key-value类型的数据，同时还提供list，set，zset，hash等数据结构的存储\nRedis支持数据的备份，即master-slave模式的数据备份\n\nRedis是单进程的\n\n# redis 持久化方案\n\n## AOF持久化\n\n三种写回策略\nalways，同步写回，每个子命令执行完，都立即将日志写回磁盘。\n\neverysec，每个命令执行完，只是先把日志写到AOF内存缓冲区，每隔一秒同步到磁盘。\n\nno：只是先把日志写到AOF内存缓冲区，有操作系统去决定何时写入磁盘\n\n数据保证：我们可以设置fsync策略，一般默认是everysec，也可以设置每次写入追加，\n所以即使服务死掉了，也最多丢失一秒数据\n\n## RDB持久化\n\n体积更小：相同的数据量rdb数据比aof的小，因为rdb是紧凑型文件。\n恢复更快：因为rdb是数据的快照，基本上就是数据的复制，不用重新读取再写入内存。\n性能更高:父进程在保存rdb时候只需要fork一个子进程，无需父进程的进行其他io操作，也保证了服务器的性能。\n\n## 如何选择RDB和AOF\n\n如果数据不能丢失，RDB和AOF混用\n如果只作为缓存使用，可以承受几分钟的数据丢失的话，可以只使用RDB。\n如果只使用AOF，优先使用everysec的写回策略。\n\n# RDB(快照)持久化 配置\n\n    #   900秒（15分钟）内至少1个key值改变（则进行数据库保存--持久化）  \n    #   300秒（5分钟）内至少10个key值改变（则进行数据库保存--持久化）  \n    #   60秒（1分钟）内至少10000个key值改变（则进行数据库保存--持久化） \n    save 900 1  \n    save 300 10  \n    save 60 10000 \n    \n    \n    #在默认情况下，如果RDB快照持久化操作被激活（至少一个条件被激活）并且持久化操作失败，Redis则会停止接受更新操作。  \n    #这样会让用户了解到数据没有被正确的存储到磁盘上。否则没人会注意到这个问题，可能会造成灾难。  \n    #  \n    #如果后台存储（持久化）操作进程再次工作，Redis会自动允许更新操作。  \n    #  \n    #然而，如果你已经恰当的配置了对Redis服务器的监视和备份，你也许想关掉这项功能。  \n    #如此一来即使后台保存操作出错,redis也仍然可以继续像平常一样工作。  \n    stop-writes-on-bgsave-error yes\n    \n    #是否压缩数据\n    rdbcompression yes\n    #没有校验的RDB文件会有一个0校验位，来告诉加载代码跳过校验检查。  \n    rdbchecksum yes \n    # 导出数据库的文件名称  \n    dbfilename dump.rdb\n    \n    dir ./\n    \n#  AOF(Append Only File 日志)  配置\n    \n    appendonly yes\n    appendfilename \"appendonly_6379.aof\"\n    appendfsync everysec\n    1、不适用fsync模式，仅仅使用操作系统的写数据策略；（no）\n    2、总是启动用fsync；（always） \n    3、每秒同步一次。（everyse）\n    \n    #在rewrite的时候不进行fsync，避免响应过慢。为了避免丢数据建议设置成no\n    #rewrite操作时，appendfsync会被阻塞。如果当前AOF文件很大，\n    #那么相应的rewrite时间会变长，appendfsync被阻塞的时间也会更长\n    no-appendfsync-on-rewrite no\n    \n    #AOF文件如果不执行rewrite，文件会不断的增长。\n    #可以设置达到一定量就开始执行rewrite，避免磁盘耗尽\n    auto-aof-rewrite-percentage 100\n    \n    #过最后一次rewrite文件大小的百分比，如果设置为0表示不自动aof。\n    #如果数据量比较小，设置百分比就会一直执行rewrite，消耗信息，这时候就可以设置最小rewrite的大小。\n    auto-aof-rewrite-min-size 64mb\n    \n    #如果redis异常推出，会导致aof不完整，\n    #如果设置为yes，启动时就会加载aof异常文件，如果设置为no，就不会加载，启动失败。\n    aof-load-truncated yes\n    \n    #启动的时候使用rdb文件会加载数据比较快，再执行aof操作，可以减少数据加载时间\n    aof-use-rdb-preamble yes\n   \n   \n# 基础配置    \n\n    redis默认是没有使用守护进程进行运行。可以通过daemonize参数进行设置  \n    daemonize yes\n    loglevel notice\n    requirepass  密码\n    \n    #有限时间内,移除那些TTL值最小的key,ttl最小代表最近要过期\n    maxmemory-policy  allkeys-lru\n    \n    设置在执行淘汰策略时，要考虑的样本数量。\n    较大的样本数可以提高淘汰算法的准确性，但也会增加CPU负载。\n    默认值为5，您可以根据实际情况进行调整\n    maxmemory-samples 10\n    \n    noeviction(默认策略)：对于写请求不再提供服务，直接返回错误（DEL请求和部分特殊请求除外）\n    allkeys-lru：从所有key中使用LRU算法进行淘汰\n    volatile-lru：从设置了过期时间的key中使用LRU算法进行淘汰\n    allkeys-random：从所有key中随机淘汰数据\n    volatile-random：从设置了过期时间的key中随机淘汰\n    volatile-ttl：在设置了过期时间的key中，根据key的过期时间进行淘汰，越早过期的越优先被淘汰\n    \n    #用于设置慢查询的评定时间，也就是说超过此配置项的命令，\n    将会被当成慢操作记录在慢查询日志中，\n    它执行单位是微秒 (1 秒等于 1000000 微秒)\n    slowlog-log-slower-than:100\n    \n    #用来配置慢查询日志的最大记录数\n    slowlog-max-len:100\n    \n    #表示当 Redis 运行内存超过最大内存时，是否开启 lazy free 机制删除\n    lazyfree-lazy-eviction no \n    \n    #表示设置了过期时间的键值，当过期之后是否开启 lazy free 机制删除\n    lazyfree-lazy-expire no \n    \n    #有些指令在处理已存在的键时，会带有一个隐式的 del 键的操作，\n    比如rename(修改key的名称) 命令，当目标键已存在，Redis 会先删除目标键，如果这些目标键是一个 big key，\n    就会造成阻塞删除的问题，此配置表示在这种场景中是否开启 lazy free 机制删除\n    lazyfree-lazy-server-del no \n    \n    #针对 slave(从节点) 进行全量数据同步，slave 在加载 master 的 RDB 文件前，\n    会运行 flushall 来清理自己的数据，\n    它表示此时是否开启 lazy free 机制删除\n    slave-lazy-flush no\n    \n    \n    \n   \n\n\n    \n    ","slug":"redis基础","published":1,"updated":"2024-11-25T11:33:40.486Z","_id":"clxb4gv4y002opcoc3xet5y4t","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"redis-简介\"><a href=\"#redis-简介\" class=\"headerlink\" title=\"redis 简介\"></a>redis 简介</h1><p>Redis支持数据的持久化，可以将内存中的数据保存在磁盘中，重启的时候可以再次加载进行使用<br>Redis不仅仅支持简单的key-value类型的数据，同时还提供list，set，zset，hash等数据结构的存储<br>Redis支持数据的备份，即master-slave模式的数据备份</p>\n<p>Redis是单进程的</p>\n<h1 id=\"redis-持久化方案\"><a href=\"#redis-持久化方案\" class=\"headerlink\" title=\"redis 持久化方案\"></a>redis 持久化方案</h1><h2 id=\"AOF持久化\"><a href=\"#AOF持久化\" class=\"headerlink\" title=\"AOF持久化\"></a>AOF持久化</h2><p>三种写回策略<br>always，同步写回，每个子命令执行完，都立即将日志写回磁盘。</p>\n<p>everysec，每个命令执行完，只是先把日志写到AOF内存缓冲区，每隔一秒同步到磁盘。</p>\n<p>no：只是先把日志写到AOF内存缓冲区，有操作系统去决定何时写入磁盘</p>\n<p>数据保证：我们可以设置fsync策略，一般默认是everysec，也可以设置每次写入追加，<br>所以即使服务死掉了，也最多丢失一秒数据</p>\n<h2 id=\"RDB持久化\"><a href=\"#RDB持久化\" class=\"headerlink\" title=\"RDB持久化\"></a>RDB持久化</h2><p>体积更小：相同的数据量rdb数据比aof的小，因为rdb是紧凑型文件。<br>恢复更快：因为rdb是数据的快照，基本上就是数据的复制，不用重新读取再写入内存。<br>性能更高:父进程在保存rdb时候只需要fork一个子进程，无需父进程的进行其他io操作，也保证了服务器的性能。</p>\n<h2 id=\"如何选择RDB和AOF\"><a href=\"#如何选择RDB和AOF\" class=\"headerlink\" title=\"如何选择RDB和AOF\"></a>如何选择RDB和AOF</h2><p>如果数据不能丢失，RDB和AOF混用<br>如果只作为缓存使用，可以承受几分钟的数据丢失的话，可以只使用RDB。<br>如果只使用AOF，优先使用everysec的写回策略。</p>\n<h1 id=\"RDB-快照-持久化-配置\"><a href=\"#RDB-快照-持久化-配置\" class=\"headerlink\" title=\"RDB(快照)持久化 配置\"></a>RDB(快照)持久化 配置</h1><pre><code>#   900秒（15分钟）内至少1个key值改变（则进行数据库保存--持久化）  \n#   300秒（5分钟）内至少10个key值改变（则进行数据库保存--持久化）  \n#   60秒（1分钟）内至少10000个key值改变（则进行数据库保存--持久化） \nsave 900 1  \nsave 300 10  \nsave 60 10000 \n\n\n#在默认情况下，如果RDB快照持久化操作被激活（至少一个条件被激活）并且持久化操作失败，Redis则会停止接受更新操作。  \n#这样会让用户了解到数据没有被正确的存储到磁盘上。否则没人会注意到这个问题，可能会造成灾难。  \n#  \n#如果后台存储（持久化）操作进程再次工作，Redis会自动允许更新操作。  \n#  \n#然而，如果你已经恰当的配置了对Redis服务器的监视和备份，你也许想关掉这项功能。  \n#如此一来即使后台保存操作出错,redis也仍然可以继续像平常一样工作。  \nstop-writes-on-bgsave-error yes\n\n#是否压缩数据\nrdbcompression yes\n#没有校验的RDB文件会有一个0校验位，来告诉加载代码跳过校验检查。  \nrdbchecksum yes \n# 导出数据库的文件名称  \ndbfilename dump.rdb\n\ndir ./\n</code></pre>\n<h1 id=\"AOF-Append-Only-File-日志-配置\"><a href=\"#AOF-Append-Only-File-日志-配置\" class=\"headerlink\" title=\"AOF(Append Only File 日志)  配置\"></a>AOF(Append Only File 日志)  配置</h1><pre><code>appendonly yes\nappendfilename &quot;appendonly_6379.aof&quot;\nappendfsync everysec\n1、不适用fsync模式，仅仅使用操作系统的写数据策略；（no）\n2、总是启动用fsync；（always） \n3、每秒同步一次。（everyse）\n\n#在rewrite的时候不进行fsync，避免响应过慢。为了避免丢数据建议设置成no\n#rewrite操作时，appendfsync会被阻塞。如果当前AOF文件很大，\n#那么相应的rewrite时间会变长，appendfsync被阻塞的时间也会更长\nno-appendfsync-on-rewrite no\n\n#AOF文件如果不执行rewrite，文件会不断的增长。\n#可以设置达到一定量就开始执行rewrite，避免磁盘耗尽\nauto-aof-rewrite-percentage 100\n\n#过最后一次rewrite文件大小的百分比，如果设置为0表示不自动aof。\n#如果数据量比较小，设置百分比就会一直执行rewrite，消耗信息，这时候就可以设置最小rewrite的大小。\nauto-aof-rewrite-min-size 64mb\n\n#如果redis异常推出，会导致aof不完整，\n#如果设置为yes，启动时就会加载aof异常文件，如果设置为no，就不会加载，启动失败。\naof-load-truncated yes\n\n#启动的时候使用rdb文件会加载数据比较快，再执行aof操作，可以减少数据加载时间\naof-use-rdb-preamble yes\n</code></pre>\n<h1 id=\"基础配置\"><a href=\"#基础配置\" class=\"headerlink\" title=\"基础配置\"></a>基础配置</h1><pre><code>redis默认是没有使用守护进程进行运行。可以通过daemonize参数进行设置  \ndaemonize yes\nloglevel notice\nrequirepass  密码\n\n#有限时间内,移除那些TTL值最小的key,ttl最小代表最近要过期\nmaxmemory-policy  allkeys-lru\n\n设置在执行淘汰策略时，要考虑的样本数量。\n较大的样本数可以提高淘汰算法的准确性，但也会增加CPU负载。\n默认值为5，您可以根据实际情况进行调整\nmaxmemory-samples 10\n\nnoeviction(默认策略)：对于写请求不再提供服务，直接返回错误（DEL请求和部分特殊请求除外）\nallkeys-lru：从所有key中使用LRU算法进行淘汰\nvolatile-lru：从设置了过期时间的key中使用LRU算法进行淘汰\nallkeys-random：从所有key中随机淘汰数据\nvolatile-random：从设置了过期时间的key中随机淘汰\nvolatile-ttl：在设置了过期时间的key中，根据key的过期时间进行淘汰，越早过期的越优先被淘汰\n\n#用于设置慢查询的评定时间，也就是说超过此配置项的命令，\n将会被当成慢操作记录在慢查询日志中，\n它执行单位是微秒 (1 秒等于 1000000 微秒)\nslowlog-log-slower-than:100\n\n#用来配置慢查询日志的最大记录数\nslowlog-max-len:100\n\n#表示当 Redis 运行内存超过最大内存时，是否开启 lazy free 机制删除\nlazyfree-lazy-eviction no \n\n#表示设置了过期时间的键值，当过期之后是否开启 lazy free 机制删除\nlazyfree-lazy-expire no \n\n#有些指令在处理已存在的键时，会带有一个隐式的 del 键的操作，\n比如rename(修改key的名称) 命令，当目标键已存在，Redis 会先删除目标键，如果这些目标键是一个 big key，\n就会造成阻塞删除的问题，此配置表示在这种场景中是否开启 lazy free 机制删除\nlazyfree-lazy-server-del no \n\n#针对 slave(从节点) 进行全量数据同步，slave 在加载 master 的 RDB 文件前，\n会运行 flushall 来清理自己的数据，\n它表示此时是否开启 lazy free 机制删除\nslave-lazy-flush no\n</code></pre>\n","site":{"data":{}},"length":2738,"excerpt":"","more":"<h1 id=\"redis-简介\"><a href=\"#redis-简介\" class=\"headerlink\" title=\"redis 简介\"></a>redis 简介</h1><p>Redis支持数据的持久化，可以将内存中的数据保存在磁盘中，重启的时候可以再次加载进行使用<br>Redis不仅仅支持简单的key-value类型的数据，同时还提供list，set，zset，hash等数据结构的存储<br>Redis支持数据的备份，即master-slave模式的数据备份</p>\n<p>Redis是单进程的</p>\n<h1 id=\"redis-持久化方案\"><a href=\"#redis-持久化方案\" class=\"headerlink\" title=\"redis 持久化方案\"></a>redis 持久化方案</h1><h2 id=\"AOF持久化\"><a href=\"#AOF持久化\" class=\"headerlink\" title=\"AOF持久化\"></a>AOF持久化</h2><p>三种写回策略<br>always，同步写回，每个子命令执行完，都立即将日志写回磁盘。</p>\n<p>everysec，每个命令执行完，只是先把日志写到AOF内存缓冲区，每隔一秒同步到磁盘。</p>\n<p>no：只是先把日志写到AOF内存缓冲区，有操作系统去决定何时写入磁盘</p>\n<p>数据保证：我们可以设置fsync策略，一般默认是everysec，也可以设置每次写入追加，<br>所以即使服务死掉了，也最多丢失一秒数据</p>\n<h2 id=\"RDB持久化\"><a href=\"#RDB持久化\" class=\"headerlink\" title=\"RDB持久化\"></a>RDB持久化</h2><p>体积更小：相同的数据量rdb数据比aof的小，因为rdb是紧凑型文件。<br>恢复更快：因为rdb是数据的快照，基本上就是数据的复制，不用重新读取再写入内存。<br>性能更高:父进程在保存rdb时候只需要fork一个子进程，无需父进程的进行其他io操作，也保证了服务器的性能。</p>\n<h2 id=\"如何选择RDB和AOF\"><a href=\"#如何选择RDB和AOF\" class=\"headerlink\" title=\"如何选择RDB和AOF\"></a>如何选择RDB和AOF</h2><p>如果数据不能丢失，RDB和AOF混用<br>如果只作为缓存使用，可以承受几分钟的数据丢失的话，可以只使用RDB。<br>如果只使用AOF，优先使用everysec的写回策略。</p>\n<h1 id=\"RDB-快照-持久化-配置\"><a href=\"#RDB-快照-持久化-配置\" class=\"headerlink\" title=\"RDB(快照)持久化 配置\"></a>RDB(快照)持久化 配置</h1><pre><code>#   900秒（15分钟）内至少1个key值改变（则进行数据库保存--持久化）  \n#   300秒（5分钟）内至少10个key值改变（则进行数据库保存--持久化）  \n#   60秒（1分钟）内至少10000个key值改变（则进行数据库保存--持久化） \nsave 900 1  \nsave 300 10  \nsave 60 10000 \n\n\n#在默认情况下，如果RDB快照持久化操作被激活（至少一个条件被激活）并且持久化操作失败，Redis则会停止接受更新操作。  \n#这样会让用户了解到数据没有被正确的存储到磁盘上。否则没人会注意到这个问题，可能会造成灾难。  \n#  \n#如果后台存储（持久化）操作进程再次工作，Redis会自动允许更新操作。  \n#  \n#然而，如果你已经恰当的配置了对Redis服务器的监视和备份，你也许想关掉这项功能。  \n#如此一来即使后台保存操作出错,redis也仍然可以继续像平常一样工作。  \nstop-writes-on-bgsave-error yes\n\n#是否压缩数据\nrdbcompression yes\n#没有校验的RDB文件会有一个0校验位，来告诉加载代码跳过校验检查。  \nrdbchecksum yes \n# 导出数据库的文件名称  \ndbfilename dump.rdb\n\ndir ./\n</code></pre>\n<h1 id=\"AOF-Append-Only-File-日志-配置\"><a href=\"#AOF-Append-Only-File-日志-配置\" class=\"headerlink\" title=\"AOF(Append Only File 日志)  配置\"></a>AOF(Append Only File 日志)  配置</h1><pre><code>appendonly yes\nappendfilename &quot;appendonly_6379.aof&quot;\nappendfsync everysec\n1、不适用fsync模式，仅仅使用操作系统的写数据策略；（no）\n2、总是启动用fsync；（always） \n3、每秒同步一次。（everyse）\n\n#在rewrite的时候不进行fsync，避免响应过慢。为了避免丢数据建议设置成no\n#rewrite操作时，appendfsync会被阻塞。如果当前AOF文件很大，\n#那么相应的rewrite时间会变长，appendfsync被阻塞的时间也会更长\nno-appendfsync-on-rewrite no\n\n#AOF文件如果不执行rewrite，文件会不断的增长。\n#可以设置达到一定量就开始执行rewrite，避免磁盘耗尽\nauto-aof-rewrite-percentage 100\n\n#过最后一次rewrite文件大小的百分比，如果设置为0表示不自动aof。\n#如果数据量比较小，设置百分比就会一直执行rewrite，消耗信息，这时候就可以设置最小rewrite的大小。\nauto-aof-rewrite-min-size 64mb\n\n#如果redis异常推出，会导致aof不完整，\n#如果设置为yes，启动时就会加载aof异常文件，如果设置为no，就不会加载，启动失败。\naof-load-truncated yes\n\n#启动的时候使用rdb文件会加载数据比较快，再执行aof操作，可以减少数据加载时间\naof-use-rdb-preamble yes\n</code></pre>\n<h1 id=\"基础配置\"><a href=\"#基础配置\" class=\"headerlink\" title=\"基础配置\"></a>基础配置</h1><pre><code>redis默认是没有使用守护进程进行运行。可以通过daemonize参数进行设置  \ndaemonize yes\nloglevel notice\nrequirepass  密码\n\n#有限时间内,移除那些TTL值最小的key,ttl最小代表最近要过期\nmaxmemory-policy  allkeys-lru\n\n设置在执行淘汰策略时，要考虑的样本数量。\n较大的样本数可以提高淘汰算法的准确性，但也会增加CPU负载。\n默认值为5，您可以根据实际情况进行调整\nmaxmemory-samples 10\n\nnoeviction(默认策略)：对于写请求不再提供服务，直接返回错误（DEL请求和部分特殊请求除外）\nallkeys-lru：从所有key中使用LRU算法进行淘汰\nvolatile-lru：从设置了过期时间的key中使用LRU算法进行淘汰\nallkeys-random：从所有key中随机淘汰数据\nvolatile-random：从设置了过期时间的key中随机淘汰\nvolatile-ttl：在设置了过期时间的key中，根据key的过期时间进行淘汰，越早过期的越优先被淘汰\n\n#用于设置慢查询的评定时间，也就是说超过此配置项的命令，\n将会被当成慢操作记录在慢查询日志中，\n它执行单位是微秒 (1 秒等于 1000000 微秒)\nslowlog-log-slower-than:100\n\n#用来配置慢查询日志的最大记录数\nslowlog-max-len:100\n\n#表示当 Redis 运行内存超过最大内存时，是否开启 lazy free 机制删除\nlazyfree-lazy-eviction no \n\n#表示设置了过期时间的键值，当过期之后是否开启 lazy free 机制删除\nlazyfree-lazy-expire no \n\n#有些指令在处理已存在的键时，会带有一个隐式的 del 键的操作，\n比如rename(修改key的名称) 命令，当目标键已存在，Redis 会先删除目标键，如果这些目标键是一个 big key，\n就会造成阻塞删除的问题，此配置表示在这种场景中是否开启 lazy free 机制删除\nlazyfree-lazy-server-del no \n\n#针对 slave(从节点) 进行全量数据同步，slave 在加载 master 的 RDB 文件前，\n会运行 flushall 来清理自己的数据，\n它表示此时是否开启 lazy free 机制删除\nslave-lazy-flush no\n</code></pre>\n"},{"title":"redis基本数据结构","abbrlink":"660a1c80","date":"2023-09-26T10:47:44.000Z","_content":"# 简介\n    \n    Redis五大数据类型：String、Hash、List、Set、Sorted set\n \n\n# 字符串\n\nString类型的最大能存储512M 应用场景 【缓存】\n\n    1.SET key value [EX seconds] [PX milliseconds] [NX|XX]\n    \n    EX和PX参数可选，用于设置键的过期时间，单位分别为秒和毫秒\n    \n    NX表示只在键不存在时创建，XX表示只在键已存在时执行操作。\n    \n    将键 \"abc\" 设置为值 \"123\" 并设置过期时间为 12 秒\n    \n        set abc 123 ex 12\n   \n    2. MSET key1 value1 [key2 value2 ...]  设置多条\n         mset a 1 b 2 \n           \n    3.EXPIRE key seconds    设置过期时间\n   \n    4.SETEX key seconds value 可用于一次设置带有过期时间的键值对\n\n    select命令切换数据库，分库的作用主要用来业务分片：\n    dbsize查看当前数据库的key的数量\n    flushdb清除当前库所有key(当前库)：\n    \n\n# Hash(哈希表)\n\n    hget：通过key值，从hash里取对应的value\n    \n    hset：往hash里，添加key-value\n    \n    hmset\n    hmget：一次性获取多个key的value\n    \n    hmset user:2 name:kati age 28 sex woman\n    \n    hmget user:2 name age sex\n\n# List(列表)\n\n    lpush：从列表List的左边插入一个元素。\n    \n    lpop：从列表List的左边移出一个元素。\n    \n    rpush：从列表List的右边插入一个元素。\n    \n    rpop：从列表List的右边移出一个元素。\n    \n    llen：打印当前列表List中的元素个数。\n\n# Set(集合) \n\n# Sorted set(有序集合)","source":"_posts/redis基本数据结构.md","raw":"---\ntitle: redis基本数据结构\nabbrlink: 660a1c80\ndate: 2023-09-26 18:47:44\ntags:\n - redis\n---\n# 简介\n    \n    Redis五大数据类型：String、Hash、List、Set、Sorted set\n \n\n# 字符串\n\nString类型的最大能存储512M 应用场景 【缓存】\n\n    1.SET key value [EX seconds] [PX milliseconds] [NX|XX]\n    \n    EX和PX参数可选，用于设置键的过期时间，单位分别为秒和毫秒\n    \n    NX表示只在键不存在时创建，XX表示只在键已存在时执行操作。\n    \n    将键 \"abc\" 设置为值 \"123\" 并设置过期时间为 12 秒\n    \n        set abc 123 ex 12\n   \n    2. MSET key1 value1 [key2 value2 ...]  设置多条\n         mset a 1 b 2 \n           \n    3.EXPIRE key seconds    设置过期时间\n   \n    4.SETEX key seconds value 可用于一次设置带有过期时间的键值对\n\n    select命令切换数据库，分库的作用主要用来业务分片：\n    dbsize查看当前数据库的key的数量\n    flushdb清除当前库所有key(当前库)：\n    \n\n# Hash(哈希表)\n\n    hget：通过key值，从hash里取对应的value\n    \n    hset：往hash里，添加key-value\n    \n    hmset\n    hmget：一次性获取多个key的value\n    \n    hmset user:2 name:kati age 28 sex woman\n    \n    hmget user:2 name age sex\n\n# List(列表)\n\n    lpush：从列表List的左边插入一个元素。\n    \n    lpop：从列表List的左边移出一个元素。\n    \n    rpush：从列表List的右边插入一个元素。\n    \n    rpop：从列表List的右边移出一个元素。\n    \n    llen：打印当前列表List中的元素个数。\n\n# Set(集合) \n\n# Sorted set(有序集合)","slug":"redis基本数据结构","published":1,"updated":"2024-11-25T11:33:46.697Z","_id":"clxb4gv4y002ppcoc8s5e2l6o","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><pre><code>Redis五大数据类型：String、Hash、List、Set、Sorted set\n</code></pre>\n<h1 id=\"字符串\"><a href=\"#字符串\" class=\"headerlink\" title=\"字符串\"></a>字符串</h1><p>String类型的最大能存储512M 应用场景 【缓存】</p>\n<pre><code>1.SET key value [EX seconds] [PX milliseconds] [NX|XX]\n\nEX和PX参数可选，用于设置键的过期时间，单位分别为秒和毫秒\n\nNX表示只在键不存在时创建，XX表示只在键已存在时执行操作。\n\n将键 &quot;abc&quot; 设置为值 &quot;123&quot; 并设置过期时间为 12 秒\n\n    set abc 123 ex 12\n\n2. MSET key1 value1 [key2 value2 ...]  设置多条\n     mset a 1 b 2 \n       \n3.EXPIRE key seconds    设置过期时间\n\n4.SETEX key seconds value 可用于一次设置带有过期时间的键值对\n\nselect命令切换数据库，分库的作用主要用来业务分片：\ndbsize查看当前数据库的key的数量\nflushdb清除当前库所有key(当前库)：\n</code></pre>\n<h1 id=\"Hash-哈希表\"><a href=\"#Hash-哈希表\" class=\"headerlink\" title=\"Hash(哈希表)\"></a>Hash(哈希表)</h1><pre><code>hget：通过key值，从hash里取对应的value\n\nhset：往hash里，添加key-value\n\nhmset\nhmget：一次性获取多个key的value\n\nhmset user:2 name:kati age 28 sex woman\n\nhmget user:2 name age sex\n</code></pre>\n<h1 id=\"List-列表\"><a href=\"#List-列表\" class=\"headerlink\" title=\"List(列表)\"></a>List(列表)</h1><pre><code>lpush：从列表List的左边插入一个元素。\n\nlpop：从列表List的左边移出一个元素。\n\nrpush：从列表List的右边插入一个元素。\n\nrpop：从列表List的右边移出一个元素。\n\nllen：打印当前列表List中的元素个数。\n</code></pre>\n<h1 id=\"Set-集合\"><a href=\"#Set-集合\" class=\"headerlink\" title=\"Set(集合)\"></a>Set(集合)</h1><h1 id=\"Sorted-set-有序集合\"><a href=\"#Sorted-set-有序集合\" class=\"headerlink\" title=\"Sorted set(有序集合)\"></a>Sorted set(有序集合)</h1>","site":{"data":{}},"length":699,"excerpt":"","more":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><pre><code>Redis五大数据类型：String、Hash、List、Set、Sorted set\n</code></pre>\n<h1 id=\"字符串\"><a href=\"#字符串\" class=\"headerlink\" title=\"字符串\"></a>字符串</h1><p>String类型的最大能存储512M 应用场景 【缓存】</p>\n<pre><code>1.SET key value [EX seconds] [PX milliseconds] [NX|XX]\n\nEX和PX参数可选，用于设置键的过期时间，单位分别为秒和毫秒\n\nNX表示只在键不存在时创建，XX表示只在键已存在时执行操作。\n\n将键 &quot;abc&quot; 设置为值 &quot;123&quot; 并设置过期时间为 12 秒\n\n    set abc 123 ex 12\n\n2. MSET key1 value1 [key2 value2 ...]  设置多条\n     mset a 1 b 2 \n       \n3.EXPIRE key seconds    设置过期时间\n\n4.SETEX key seconds value 可用于一次设置带有过期时间的键值对\n\nselect命令切换数据库，分库的作用主要用来业务分片：\ndbsize查看当前数据库的key的数量\nflushdb清除当前库所有key(当前库)：\n</code></pre>\n<h1 id=\"Hash-哈希表\"><a href=\"#Hash-哈希表\" class=\"headerlink\" title=\"Hash(哈希表)\"></a>Hash(哈希表)</h1><pre><code>hget：通过key值，从hash里取对应的value\n\nhset：往hash里，添加key-value\n\nhmset\nhmget：一次性获取多个key的value\n\nhmset user:2 name:kati age 28 sex woman\n\nhmget user:2 name age sex\n</code></pre>\n<h1 id=\"List-列表\"><a href=\"#List-列表\" class=\"headerlink\" title=\"List(列表)\"></a>List(列表)</h1><pre><code>lpush：从列表List的左边插入一个元素。\n\nlpop：从列表List的左边移出一个元素。\n\nrpush：从列表List的右边插入一个元素。\n\nrpop：从列表List的右边移出一个元素。\n\nllen：打印当前列表List中的元素个数。\n</code></pre>\n<h1 id=\"Set-集合\"><a href=\"#Set-集合\" class=\"headerlink\" title=\"Set(集合)\"></a>Set(集合)</h1><h1 id=\"Sorted-set-有序集合\"><a href=\"#Sorted-set-有序集合\" class=\"headerlink\" title=\"Sorted set(有序集合)\"></a>Sorted set(有序集合)</h1>"},{"title":"vue学习1","abbrlink":"5dd4fb79","date":"2023-02-22T14:18:25.000Z","_content":"\n\n# vuecli  vue脚手架\n    vue 它是一个插件  最基础的项目架构 帮集成webpack 构建 打包 编译 包含基本的架子\n  \n    安装命令：    npm install -g @vue/cli\n                npm i -g @vue/cli\n                -g      表示全局安装\n\n\n    查看脚手架版本         vue --version\n\n\n\n# 创建项目\n\n    vue create [项目名称]\n    默认安装项   [babel]  编译es6的语法    [eslint]     项目语法检查  可开关\n\n\n    vue ui 启动vue ui操作界面\n    \n\n\n# 项目目录\n\n    /src/assets  目录存放 icon 图片\n    /src/api     存放  api  文件夹\n    /src/util    存放  一些工具方法\n    /src/storage 存放 数据存储的工具箱\n    /src/pages\n    /src/router.js","source":"_posts/vue学习1.md","raw":"---\ntitle: vue学习1\nabbrlink: 5dd4fb79\ncategories:\n  - 前端\n  - vue\ndate: 2023-02-22 22:18:25\ntags:\n - vue\n---\n\n\n# vuecli  vue脚手架\n    vue 它是一个插件  最基础的项目架构 帮集成webpack 构建 打包 编译 包含基本的架子\n  \n    安装命令：    npm install -g @vue/cli\n                npm i -g @vue/cli\n                -g      表示全局安装\n\n\n    查看脚手架版本         vue --version\n\n\n\n# 创建项目\n\n    vue create [项目名称]\n    默认安装项   [babel]  编译es6的语法    [eslint]     项目语法检查  可开关\n\n\n    vue ui 启动vue ui操作界面\n    \n\n\n# 项目目录\n\n    /src/assets  目录存放 icon 图片\n    /src/api     存放  api  文件夹\n    /src/util    存放  一些工具方法\n    /src/storage 存放 数据存储的工具箱\n    /src/pages\n    /src/router.js","slug":"vue学习1","published":1,"updated":"2024-11-25T11:31:21.686Z","_id":"clxb4gv51002vpcoch6qre4qt","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"vuecli-vue脚手架\"><a href=\"#vuecli-vue脚手架\" class=\"headerlink\" title=\"vuecli  vue脚手架\"></a>vuecli  vue脚手架</h1><pre><code>vue 它是一个插件  最基础的项目架构 帮集成webpack 构建 打包 编译 包含基本的架子\n\n安装命令：    npm install -g @vue/cli\n            npm i -g @vue/cli\n            -g      表示全局安装\n\n\n查看脚手架版本         vue --version\n</code></pre>\n<h1 id=\"创建项目\"><a href=\"#创建项目\" class=\"headerlink\" title=\"创建项目\"></a>创建项目</h1><pre><code>vue create [项目名称]\n默认安装项   [babel]  编译es6的语法    [eslint]     项目语法检查  可开关\n\n\nvue ui 启动vue ui操作界面\n</code></pre>\n<h1 id=\"项目目录\"><a href=\"#项目目录\" class=\"headerlink\" title=\"项目目录\"></a>项目目录</h1><pre><code>/src/assets  目录存放 icon 图片\n/src/api     存放  api  文件夹\n/src/util    存放  一些工具方法\n/src/storage 存放 数据存储的工具箱\n/src/pages\n/src/router.js\n</code></pre>\n","site":{"data":{}},"length":294,"excerpt":"","more":"<h1 id=\"vuecli-vue脚手架\"><a href=\"#vuecli-vue脚手架\" class=\"headerlink\" title=\"vuecli  vue脚手架\"></a>vuecli  vue脚手架</h1><pre><code>vue 它是一个插件  最基础的项目架构 帮集成webpack 构建 打包 编译 包含基本的架子\n\n安装命令：    npm install -g @vue/cli\n            npm i -g @vue/cli\n            -g      表示全局安装\n\n\n查看脚手架版本         vue --version\n</code></pre>\n<h1 id=\"创建项目\"><a href=\"#创建项目\" class=\"headerlink\" title=\"创建项目\"></a>创建项目</h1><pre><code>vue create [项目名称]\n默认安装项   [babel]  编译es6的语法    [eslint]     项目语法检查  可开关\n\n\nvue ui 启动vue ui操作界面\n</code></pre>\n<h1 id=\"项目目录\"><a href=\"#项目目录\" class=\"headerlink\" title=\"项目目录\"></a>项目目录</h1><pre><code>/src/assets  目录存放 icon 图片\n/src/api     存放  api  文件夹\n/src/util    存放  一些工具方法\n/src/storage 存放 数据存储的工具箱\n/src/pages\n/src/router.js\n</code></pre>\n"},{"title":"通过vsftpd搭建ftp服务器","abbrlink":"40a34212","date":"2022-04-15T14:12:12.000Z","_content":"\n# 一、yum 安装\n\n    yum install vsftpd\n\n\n# 二、编译安装\n\n    yum -y install epel-release && yum -y install pam pam-devel db4-utils\n    wget https://security.appspot.com/downloads/vsftpd-3.0.5.tar.gz\n\n    tar xf vsftpd-3.0.3.tar.gz\n    \n    make clean && make -j 4 && make install\n\n\n    如果编译的时候报错\n    /usr/bin/ld: cannot find -lcap\n    查找该 .so 文件\n    find / -name \"*libcap.so*\"\n    /usr/lib64/libcap.so.2.22\n    /usr/lib64/libcap.so.2\n    ln -sv /usr/lib64/libcap.so.2 /usr/lib64/libcap.so\n    \n    \n    \n# 三、/etc/vsftpd/vsftp.conf  配置文件    \n\n    配置文件  vsftp.conf \n\n```\n    #关闭匿名访问\n    anonymous_enable=NO\n    local_enable=YES\n    #启用虚拟账户\n    guest_enable=YES\n    ##把虚拟账户映射到系统账户virftp\n    guest_username=virftp\n    ##使用虚拟用户验证（PAM验证）\n    pam_service_name=vsftpd\n    #设置存放各虚拟用户配置文件的目录（此目录下与虚拟用户名相同的文件为他的配置文件）\n    user_config_dir=/etc/vsftpd/vsftpd_viruser\n    ##启用chroot时，虚拟用户根目录允许写入\n    allow_writeable_chroot=YES\n    \n    # Uncomment this to enable any form of FTP write command.\n    write_enable=YES\n    #\n    # Default umask for local users is 077. You may wish to change this to 022,\n    # if your users expect that (022 is used by most other ftpd's)\n    local_umask=022\n    #监听端口 默认21\n    listen_port=10021\n    #数据传输端口 默认20\n    ftp_data_port=10020\n    \n    #被动模式 配置\n    pasv_enable=YES\n    pasv_min_port=20000\n    pasv_max_port=20010\n    # 可以发送消息当访问某个目录时\n    dirmessage_enable=YES\n    # 开启上传下载记录\n    xferlog_enable=YES\n    # 日志标准输出\n    xferlog_std_format=YES\n    \n    connect_from_port_20=YES\n    #监听ipv4\n    listen=NO\n    # 监听IPv6和监听IPv4\n    listen_ipv6=YES\n\n    userlist_enable=YES\n    # 访问控制\n    tcp_wrappers=YES\n```\n**注意 根据需求自行修改<b><i>vsftp.conf</i></b>端口号以及模式：**\n<font color=\"#FF0000\">#监听端口 默认21<br/>listen_port=10021<br/>#数据传输端口 默认20<br/>ftp_data_port=10020<br/>#被动模式 配置<br/>pasv_enable=YES<br/>pasv_min_port=20000<br/> pasv_max_port=20010<br/></font> \n\n\n\n\n# 四、生成虚拟用户数据库：\n\n    touch /etc/vsftpd/vir_user\n    vir_user文件内容：\n        user1\n        password1\n        user2\n        password2\n\n    yum -y install libdb-utils\n    db_load -T -t hash -f /etc/vsftpd/vir_user /etc/vsftpd/vir_user.db\n    chmod 700 /etc/vsftpd/vir_user.db\n\n\n# 五、将auth及account的所有配置行均注释掉，添加如下两行\n```\nvim /etc/pam.d/vsftpd\n\nauth                 required     pam_userdb.so   db=/etc/vsftpd/vir_user \naccount              required     pam_userdb.so   db=/etc/vsftpd/vir_user\n```\n\n# 六、增加一个系统用户\n```\nmkdir /home/ftproot\nuseradd -d /home/ftproot -s /sbin/nologin virftp\nchown -R virftp:virftp /home/ftproot\n```\n\n# 七、创建和配置虚拟用户各自的配置文件，文件名称是‘虚拟用户名\n```\nvim /etc/vsftpd/vsftpd_viruser/根据创建虚拟用户密码文件来(user1,user2)\n\n\n#允许写入\nwrite_enable=YES\n#允许浏览FTP目录和下载\nanon_world_readable_only=NO\n#允许虚拟用户上传文件\nanon_upload_enable=YES\n#允许虚拟用户创建目录\nanon_mkdir_write_enable=YES\n#允许虚拟用户执行其他操作（如改名、删除）\nanon_other_write_enable=YES\n#上传文件的掩码,如022时，上传目录权限为755,文件权限为644\nanon_umask=022\n#指定虚拟用户的虚拟目录（虚拟用户登录后的主目录） 可以指定其他目录  注意权限（给虚拟账号权限chown -R virftp:virftp 目录）\nlocal_root=/ftproot/admin/\n\n```\n\n# 八、各配置文件说明：\n\n    /etc/vsftpd/vsftpd.conf                             ：vsftpd的主配置文件\n    /etc/vsftpd/vir_user                                   ：虚拟用户的账号密码文件  \n    /etc/vsftpd/vsftpd_viruser/user1            ：虚拟用户‘user1’的配置文件\n    /etc/pam.d/vsftpd                                     ：启用虚拟用户验证功能的配置文件\n  \n\n\n# 九、客户端命令\n\n    ftp -p 192.168.100.230 22221\n    \n    passive on   # 切换模式 显示    Passive mode on.  为被动模式\n    \n    get  文件名  # 下载文件\n    \n    rename [filename]  [newfilename]，重命名远程Linux FTP服务器上指定的文件｡\n    rename 1111.xlsx   processed/1111.xlsx\n    \n    ","source":"_posts/vsftpd-server.md","raw":"---\ntitle: 通过vsftpd搭建ftp服务器\ncategories:\n  - 服务器相关\nabbrlink: 40a34212\ndate: 2022-04-15 22:12:12\ntags:\n---\n\n# 一、yum 安装\n\n    yum install vsftpd\n\n\n# 二、编译安装\n\n    yum -y install epel-release && yum -y install pam pam-devel db4-utils\n    wget https://security.appspot.com/downloads/vsftpd-3.0.5.tar.gz\n\n    tar xf vsftpd-3.0.3.tar.gz\n    \n    make clean && make -j 4 && make install\n\n\n    如果编译的时候报错\n    /usr/bin/ld: cannot find -lcap\n    查找该 .so 文件\n    find / -name \"*libcap.so*\"\n    /usr/lib64/libcap.so.2.22\n    /usr/lib64/libcap.so.2\n    ln -sv /usr/lib64/libcap.so.2 /usr/lib64/libcap.so\n    \n    \n    \n# 三、/etc/vsftpd/vsftp.conf  配置文件    \n\n    配置文件  vsftp.conf \n\n```\n    #关闭匿名访问\n    anonymous_enable=NO\n    local_enable=YES\n    #启用虚拟账户\n    guest_enable=YES\n    ##把虚拟账户映射到系统账户virftp\n    guest_username=virftp\n    ##使用虚拟用户验证（PAM验证）\n    pam_service_name=vsftpd\n    #设置存放各虚拟用户配置文件的目录（此目录下与虚拟用户名相同的文件为他的配置文件）\n    user_config_dir=/etc/vsftpd/vsftpd_viruser\n    ##启用chroot时，虚拟用户根目录允许写入\n    allow_writeable_chroot=YES\n    \n    # Uncomment this to enable any form of FTP write command.\n    write_enable=YES\n    #\n    # Default umask for local users is 077. You may wish to change this to 022,\n    # if your users expect that (022 is used by most other ftpd's)\n    local_umask=022\n    #监听端口 默认21\n    listen_port=10021\n    #数据传输端口 默认20\n    ftp_data_port=10020\n    \n    #被动模式 配置\n    pasv_enable=YES\n    pasv_min_port=20000\n    pasv_max_port=20010\n    # 可以发送消息当访问某个目录时\n    dirmessage_enable=YES\n    # 开启上传下载记录\n    xferlog_enable=YES\n    # 日志标准输出\n    xferlog_std_format=YES\n    \n    connect_from_port_20=YES\n    #监听ipv4\n    listen=NO\n    # 监听IPv6和监听IPv4\n    listen_ipv6=YES\n\n    userlist_enable=YES\n    # 访问控制\n    tcp_wrappers=YES\n```\n**注意 根据需求自行修改<b><i>vsftp.conf</i></b>端口号以及模式：**\n<font color=\"#FF0000\">#监听端口 默认21<br/>listen_port=10021<br/>#数据传输端口 默认20<br/>ftp_data_port=10020<br/>#被动模式 配置<br/>pasv_enable=YES<br/>pasv_min_port=20000<br/> pasv_max_port=20010<br/></font> \n\n\n\n\n# 四、生成虚拟用户数据库：\n\n    touch /etc/vsftpd/vir_user\n    vir_user文件内容：\n        user1\n        password1\n        user2\n        password2\n\n    yum -y install libdb-utils\n    db_load -T -t hash -f /etc/vsftpd/vir_user /etc/vsftpd/vir_user.db\n    chmod 700 /etc/vsftpd/vir_user.db\n\n\n# 五、将auth及account的所有配置行均注释掉，添加如下两行\n```\nvim /etc/pam.d/vsftpd\n\nauth                 required     pam_userdb.so   db=/etc/vsftpd/vir_user \naccount              required     pam_userdb.so   db=/etc/vsftpd/vir_user\n```\n\n# 六、增加一个系统用户\n```\nmkdir /home/ftproot\nuseradd -d /home/ftproot -s /sbin/nologin virftp\nchown -R virftp:virftp /home/ftproot\n```\n\n# 七、创建和配置虚拟用户各自的配置文件，文件名称是‘虚拟用户名\n```\nvim /etc/vsftpd/vsftpd_viruser/根据创建虚拟用户密码文件来(user1,user2)\n\n\n#允许写入\nwrite_enable=YES\n#允许浏览FTP目录和下载\nanon_world_readable_only=NO\n#允许虚拟用户上传文件\nanon_upload_enable=YES\n#允许虚拟用户创建目录\nanon_mkdir_write_enable=YES\n#允许虚拟用户执行其他操作（如改名、删除）\nanon_other_write_enable=YES\n#上传文件的掩码,如022时，上传目录权限为755,文件权限为644\nanon_umask=022\n#指定虚拟用户的虚拟目录（虚拟用户登录后的主目录） 可以指定其他目录  注意权限（给虚拟账号权限chown -R virftp:virftp 目录）\nlocal_root=/ftproot/admin/\n\n```\n\n# 八、各配置文件说明：\n\n    /etc/vsftpd/vsftpd.conf                             ：vsftpd的主配置文件\n    /etc/vsftpd/vir_user                                   ：虚拟用户的账号密码文件  \n    /etc/vsftpd/vsftpd_viruser/user1            ：虚拟用户‘user1’的配置文件\n    /etc/pam.d/vsftpd                                     ：启用虚拟用户验证功能的配置文件\n  \n\n\n# 九、客户端命令\n\n    ftp -p 192.168.100.230 22221\n    \n    passive on   # 切换模式 显示    Passive mode on.  为被动模式\n    \n    get  文件名  # 下载文件\n    \n    rename [filename]  [newfilename]，重命名远程Linux FTP服务器上指定的文件｡\n    rename 1111.xlsx   processed/1111.xlsx\n    \n    ","slug":"vsftpd-server","published":1,"updated":"2024-03-20T09:47:05.963Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv55002zpcocdr80875l","content":"<h1 id=\"一、yum-安装\"><a href=\"#一、yum-安装\" class=\"headerlink\" title=\"一、yum 安装\"></a>一、yum 安装</h1><pre><code>yum install vsftpd\n</code></pre>\n<h1 id=\"二、编译安装\"><a href=\"#二、编译安装\" class=\"headerlink\" title=\"二、编译安装\"></a>二、编译安装</h1><pre><code>yum -y install epel-release &amp;&amp; yum -y install pam pam-devel db4-utils\nwget https://security.appspot.com/downloads/vsftpd-3.0.5.tar.gz\n\ntar xf vsftpd-3.0.3.tar.gz\n\nmake clean &amp;&amp; make -j 4 &amp;&amp; make install\n\n\n如果编译的时候报错\n/usr/bin/ld: cannot find -lcap\n查找该 .so 文件\nfind / -name &quot;*libcap.so*&quot;\n/usr/lib64/libcap.so.2.22\n/usr/lib64/libcap.so.2\nln -sv /usr/lib64/libcap.so.2 /usr/lib64/libcap.so\n</code></pre>\n<h1 id=\"三、-etc-vsftpd-vsftp-conf-配置文件\"><a href=\"#三、-etc-vsftpd-vsftp-conf-配置文件\" class=\"headerlink\" title=\"三、/etc/vsftpd/vsftp.conf  配置文件\"></a>三、/etc/vsftpd/vsftp.conf  配置文件</h1><pre><code>配置文件  vsftp.conf \n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#关闭匿名访问</span><br><span class=\"line\">anonymous_enable=NO</span><br><span class=\"line\">local_enable=YES</span><br><span class=\"line\">#启用虚拟账户</span><br><span class=\"line\">guest_enable=YES</span><br><span class=\"line\">##把虚拟账户映射到系统账户virftp</span><br><span class=\"line\">guest_username=virftp</span><br><span class=\"line\">##使用虚拟用户验证（PAM验证）</span><br><span class=\"line\">pam_service_name=vsftpd</span><br><span class=\"line\">#设置存放各虚拟用户配置文件的目录（此目录下与虚拟用户名相同的文件为他的配置文件）</span><br><span class=\"line\">user_config_dir=/etc/vsftpd/vsftpd_viruser</span><br><span class=\"line\">##启用chroot时，虚拟用户根目录允许写入</span><br><span class=\"line\">allow_writeable_chroot=YES</span><br><span class=\"line\"></span><br><span class=\"line\"># Uncomment this to enable any form of FTP write command.</span><br><span class=\"line\">write_enable=YES</span><br><span class=\"line\">#</span><br><span class=\"line\"># Default umask for local users is 077. You may wish to change this to 022,</span><br><span class=\"line\"># if your users expect that (022 is used by most other ftpd&#x27;s)</span><br><span class=\"line\">local_umask=022</span><br><span class=\"line\">#监听端口 默认21</span><br><span class=\"line\">listen_port=10021</span><br><span class=\"line\">#数据传输端口 默认20</span><br><span class=\"line\">ftp_data_port=10020</span><br><span class=\"line\"></span><br><span class=\"line\">#被动模式 配置</span><br><span class=\"line\">pasv_enable=YES</span><br><span class=\"line\">pasv_min_port=20000</span><br><span class=\"line\">pasv_max_port=20010</span><br><span class=\"line\"># 可以发送消息当访问某个目录时</span><br><span class=\"line\">dirmessage_enable=YES</span><br><span class=\"line\"># 开启上传下载记录</span><br><span class=\"line\">xferlog_enable=YES</span><br><span class=\"line\"># 日志标准输出</span><br><span class=\"line\">xferlog_std_format=YES</span><br><span class=\"line\"></span><br><span class=\"line\">connect_from_port_20=YES</span><br><span class=\"line\">#监听ipv4</span><br><span class=\"line\">listen=NO</span><br><span class=\"line\"># 监听IPv6和监听IPv4</span><br><span class=\"line\">listen_ipv6=YES</span><br><span class=\"line\"></span><br><span class=\"line\">userlist_enable=YES</span><br><span class=\"line\"># 访问控制</span><br><span class=\"line\">tcp_wrappers=YES</span><br></pre></td></tr></table></figure>\n<p><strong>注意 根据需求自行修改<b><i>vsftp.conf</i></b>端口号以及模式：</strong><br><font color=\"#FF0000\">#监听端口 默认21<br/>listen_port=10021<br/>#数据传输端口 默认20<br/>ftp_data_port=10020<br/>#被动模式 配置<br/>pasv_enable=YES<br/>pasv_min_port=20000<br/> pasv_max_port=20010<br/></font> </p>\n<h1 id=\"四、生成虚拟用户数据库：\"><a href=\"#四、生成虚拟用户数据库：\" class=\"headerlink\" title=\"四、生成虚拟用户数据库：\"></a>四、生成虚拟用户数据库：</h1><pre><code>touch /etc/vsftpd/vir_user\nvir_user文件内容：\n    user1\n    password1\n    user2\n    password2\n\nyum -y install libdb-utils\ndb_load -T -t hash -f /etc/vsftpd/vir_user /etc/vsftpd/vir_user.db\nchmod 700 /etc/vsftpd/vir_user.db\n</code></pre>\n<h1 id=\"五、将auth及account的所有配置行均注释掉，添加如下两行\"><a href=\"#五、将auth及account的所有配置行均注释掉，添加如下两行\" class=\"headerlink\" title=\"五、将auth及account的所有配置行均注释掉，添加如下两行\"></a>五、将auth及account的所有配置行均注释掉，添加如下两行</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/pam.d/vsftpd</span><br><span class=\"line\"></span><br><span class=\"line\">auth                 required     pam_userdb.so   db=/etc/vsftpd/vir_user </span><br><span class=\"line\">account              required     pam_userdb.so   db=/etc/vsftpd/vir_user</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"六、增加一个系统用户\"><a href=\"#六、增加一个系统用户\" class=\"headerlink\" title=\"六、增加一个系统用户\"></a>六、增加一个系统用户</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir /home/ftproot</span><br><span class=\"line\">useradd -d /home/ftproot -s /sbin/nologin virftp</span><br><span class=\"line\">chown -R virftp:virftp /home/ftproot</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"七、创建和配置虚拟用户各自的配置文件，文件名称是‘虚拟用户名\"><a href=\"#七、创建和配置虚拟用户各自的配置文件，文件名称是‘虚拟用户名\" class=\"headerlink\" title=\"七、创建和配置虚拟用户各自的配置文件，文件名称是‘虚拟用户名\"></a>七、创建和配置虚拟用户各自的配置文件，文件名称是‘虚拟用户名</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/vsftpd/vsftpd_viruser/根据创建虚拟用户密码文件来(user1,user2)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#允许写入</span><br><span class=\"line\">write_enable=YES</span><br><span class=\"line\">#允许浏览FTP目录和下载</span><br><span class=\"line\">anon_world_readable_only=NO</span><br><span class=\"line\">#允许虚拟用户上传文件</span><br><span class=\"line\">anon_upload_enable=YES</span><br><span class=\"line\">#允许虚拟用户创建目录</span><br><span class=\"line\">anon_mkdir_write_enable=YES</span><br><span class=\"line\">#允许虚拟用户执行其他操作（如改名、删除）</span><br><span class=\"line\">anon_other_write_enable=YES</span><br><span class=\"line\">#上传文件的掩码,如022时，上传目录权限为755,文件权限为644</span><br><span class=\"line\">anon_umask=022</span><br><span class=\"line\">#指定虚拟用户的虚拟目录（虚拟用户登录后的主目录） 可以指定其他目录  注意权限（给虚拟账号权限chown -R virftp:virftp 目录）</span><br><span class=\"line\">local_root=/ftproot/admin/</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"八、各配置文件说明：\"><a href=\"#八、各配置文件说明：\" class=\"headerlink\" title=\"八、各配置文件说明：\"></a>八、各配置文件说明：</h1><pre><code>/etc/vsftpd/vsftpd.conf                             ：vsftpd的主配置文件\n/etc/vsftpd/vir_user                                   ：虚拟用户的账号密码文件  \n/etc/vsftpd/vsftpd_viruser/user1            ：虚拟用户‘user1’的配置文件\n/etc/pam.d/vsftpd                                     ：启用虚拟用户验证功能的配置文件\n</code></pre>\n<h1 id=\"九、客户端命令\"><a href=\"#九、客户端命令\" class=\"headerlink\" title=\"九、客户端命令\"></a>九、客户端命令</h1><pre><code>ftp -p 192.168.100.230 22221\n\npassive on   # 切换模式 显示    Passive mode on.  为被动模式\n\nget  文件名  # 下载文件\n\nrename [filename]  [newfilename]，重命名远程Linux FTP服务器上指定的文件｡\nrename 1111.xlsx   processed/1111.xlsx\n</code></pre>\n","site":{"data":{}},"length":2670,"excerpt":"","more":"<h1 id=\"一、yum-安装\"><a href=\"#一、yum-安装\" class=\"headerlink\" title=\"一、yum 安装\"></a>一、yum 安装</h1><pre><code>yum install vsftpd\n</code></pre>\n<h1 id=\"二、编译安装\"><a href=\"#二、编译安装\" class=\"headerlink\" title=\"二、编译安装\"></a>二、编译安装</h1><pre><code>yum -y install epel-release &amp;&amp; yum -y install pam pam-devel db4-utils\nwget https://security.appspot.com/downloads/vsftpd-3.0.5.tar.gz\n\ntar xf vsftpd-3.0.3.tar.gz\n\nmake clean &amp;&amp; make -j 4 &amp;&amp; make install\n\n\n如果编译的时候报错\n/usr/bin/ld: cannot find -lcap\n查找该 .so 文件\nfind / -name &quot;*libcap.so*&quot;\n/usr/lib64/libcap.so.2.22\n/usr/lib64/libcap.so.2\nln -sv /usr/lib64/libcap.so.2 /usr/lib64/libcap.so\n</code></pre>\n<h1 id=\"三、-etc-vsftpd-vsftp-conf-配置文件\"><a href=\"#三、-etc-vsftpd-vsftp-conf-配置文件\" class=\"headerlink\" title=\"三、/etc/vsftpd/vsftp.conf  配置文件\"></a>三、/etc/vsftpd/vsftp.conf  配置文件</h1><pre><code>配置文件  vsftp.conf \n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#关闭匿名访问</span><br><span class=\"line\">anonymous_enable=NO</span><br><span class=\"line\">local_enable=YES</span><br><span class=\"line\">#启用虚拟账户</span><br><span class=\"line\">guest_enable=YES</span><br><span class=\"line\">##把虚拟账户映射到系统账户virftp</span><br><span class=\"line\">guest_username=virftp</span><br><span class=\"line\">##使用虚拟用户验证（PAM验证）</span><br><span class=\"line\">pam_service_name=vsftpd</span><br><span class=\"line\">#设置存放各虚拟用户配置文件的目录（此目录下与虚拟用户名相同的文件为他的配置文件）</span><br><span class=\"line\">user_config_dir=/etc/vsftpd/vsftpd_viruser</span><br><span class=\"line\">##启用chroot时，虚拟用户根目录允许写入</span><br><span class=\"line\">allow_writeable_chroot=YES</span><br><span class=\"line\"></span><br><span class=\"line\"># Uncomment this to enable any form of FTP write command.</span><br><span class=\"line\">write_enable=YES</span><br><span class=\"line\">#</span><br><span class=\"line\"># Default umask for local users is 077. You may wish to change this to 022,</span><br><span class=\"line\"># if your users expect that (022 is used by most other ftpd&#x27;s)</span><br><span class=\"line\">local_umask=022</span><br><span class=\"line\">#监听端口 默认21</span><br><span class=\"line\">listen_port=10021</span><br><span class=\"line\">#数据传输端口 默认20</span><br><span class=\"line\">ftp_data_port=10020</span><br><span class=\"line\"></span><br><span class=\"line\">#被动模式 配置</span><br><span class=\"line\">pasv_enable=YES</span><br><span class=\"line\">pasv_min_port=20000</span><br><span class=\"line\">pasv_max_port=20010</span><br><span class=\"line\"># 可以发送消息当访问某个目录时</span><br><span class=\"line\">dirmessage_enable=YES</span><br><span class=\"line\"># 开启上传下载记录</span><br><span class=\"line\">xferlog_enable=YES</span><br><span class=\"line\"># 日志标准输出</span><br><span class=\"line\">xferlog_std_format=YES</span><br><span class=\"line\"></span><br><span class=\"line\">connect_from_port_20=YES</span><br><span class=\"line\">#监听ipv4</span><br><span class=\"line\">listen=NO</span><br><span class=\"line\"># 监听IPv6和监听IPv4</span><br><span class=\"line\">listen_ipv6=YES</span><br><span class=\"line\"></span><br><span class=\"line\">userlist_enable=YES</span><br><span class=\"line\"># 访问控制</span><br><span class=\"line\">tcp_wrappers=YES</span><br></pre></td></tr></table></figure>\n<p><strong>注意 根据需求自行修改<b><i>vsftp.conf</i></b>端口号以及模式：</strong><br><font color=\"#FF0000\">#监听端口 默认21<br/>listen_port=10021<br/>#数据传输端口 默认20<br/>ftp_data_port=10020<br/>#被动模式 配置<br/>pasv_enable=YES<br/>pasv_min_port=20000<br/> pasv_max_port=20010<br/></font> </p>\n<h1 id=\"四、生成虚拟用户数据库：\"><a href=\"#四、生成虚拟用户数据库：\" class=\"headerlink\" title=\"四、生成虚拟用户数据库：\"></a>四、生成虚拟用户数据库：</h1><pre><code>touch /etc/vsftpd/vir_user\nvir_user文件内容：\n    user1\n    password1\n    user2\n    password2\n\nyum -y install libdb-utils\ndb_load -T -t hash -f /etc/vsftpd/vir_user /etc/vsftpd/vir_user.db\nchmod 700 /etc/vsftpd/vir_user.db\n</code></pre>\n<h1 id=\"五、将auth及account的所有配置行均注释掉，添加如下两行\"><a href=\"#五、将auth及account的所有配置行均注释掉，添加如下两行\" class=\"headerlink\" title=\"五、将auth及account的所有配置行均注释掉，添加如下两行\"></a>五、将auth及account的所有配置行均注释掉，添加如下两行</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/pam.d/vsftpd</span><br><span class=\"line\"></span><br><span class=\"line\">auth                 required     pam_userdb.so   db=/etc/vsftpd/vir_user </span><br><span class=\"line\">account              required     pam_userdb.so   db=/etc/vsftpd/vir_user</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"六、增加一个系统用户\"><a href=\"#六、增加一个系统用户\" class=\"headerlink\" title=\"六、增加一个系统用户\"></a>六、增加一个系统用户</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir /home/ftproot</span><br><span class=\"line\">useradd -d /home/ftproot -s /sbin/nologin virftp</span><br><span class=\"line\">chown -R virftp:virftp /home/ftproot</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"七、创建和配置虚拟用户各自的配置文件，文件名称是‘虚拟用户名\"><a href=\"#七、创建和配置虚拟用户各自的配置文件，文件名称是‘虚拟用户名\" class=\"headerlink\" title=\"七、创建和配置虚拟用户各自的配置文件，文件名称是‘虚拟用户名\"></a>七、创建和配置虚拟用户各自的配置文件，文件名称是‘虚拟用户名</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/vsftpd/vsftpd_viruser/根据创建虚拟用户密码文件来(user1,user2)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#允许写入</span><br><span class=\"line\">write_enable=YES</span><br><span class=\"line\">#允许浏览FTP目录和下载</span><br><span class=\"line\">anon_world_readable_only=NO</span><br><span class=\"line\">#允许虚拟用户上传文件</span><br><span class=\"line\">anon_upload_enable=YES</span><br><span class=\"line\">#允许虚拟用户创建目录</span><br><span class=\"line\">anon_mkdir_write_enable=YES</span><br><span class=\"line\">#允许虚拟用户执行其他操作（如改名、删除）</span><br><span class=\"line\">anon_other_write_enable=YES</span><br><span class=\"line\">#上传文件的掩码,如022时，上传目录权限为755,文件权限为644</span><br><span class=\"line\">anon_umask=022</span><br><span class=\"line\">#指定虚拟用户的虚拟目录（虚拟用户登录后的主目录） 可以指定其他目录  注意权限（给虚拟账号权限chown -R virftp:virftp 目录）</span><br><span class=\"line\">local_root=/ftproot/admin/</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"八、各配置文件说明：\"><a href=\"#八、各配置文件说明：\" class=\"headerlink\" title=\"八、各配置文件说明：\"></a>八、各配置文件说明：</h1><pre><code>/etc/vsftpd/vsftpd.conf                             ：vsftpd的主配置文件\n/etc/vsftpd/vir_user                                   ：虚拟用户的账号密码文件  \n/etc/vsftpd/vsftpd_viruser/user1            ：虚拟用户‘user1’的配置文件\n/etc/pam.d/vsftpd                                     ：启用虚拟用户验证功能的配置文件\n</code></pre>\n<h1 id=\"九、客户端命令\"><a href=\"#九、客户端命令\" class=\"headerlink\" title=\"九、客户端命令\"></a>九、客户端命令</h1><pre><code>ftp -p 192.168.100.230 22221\n\npassive on   # 切换模式 显示    Passive mode on.  为被动模式\n\nget  文件名  # 下载文件\n\nrename [filename]  [newfilename]，重命名远程Linux FTP服务器上指定的文件｡\nrename 1111.xlsx   processed/1111.xlsx\n</code></pre>\n"},{"title":"webpack学习笔记1","abbrlink":"30bc514d","date":"2022-01-01T07:19:05.000Z","_content":"\n#1. webpack 安装\n\n    全局安装 nodejs\n        验证  node -v\n              npm -v\n    npm install webpack -g\n    npm install webpack-cli -g\n    正常情况下 安装webpack-cli 会自动安装webpack\n    npm uninstall webpack -g 全局卸载\n\n    单独项目内安装\n    npm install webpack webpack-cli --save-dev\n    或者\n    npm install webpack webpack-cli -D\n\n    运行npx webpack -v   //注 npx 会在node_module文件夹中找\n    \n    安装特定版本\n    npm info webpack   //查看webpack有那些版本\n    npm install webpack@4.16.5 webpack-cli -D\n\n\n#2.webpack 基本使用\n\n    npm init    增加package.json文件\n    npm init -y\n\n\n#3.一些语法\n    \n    ES Module 模块引入方式\n    \n\n\n\n","source":"_posts/webpack学习笔记1.md","raw":"---\ntitle: webpack学习笔记1\nabbrlink: 30bc514d\ncategories:\n  - 前端\n  - webpack\ndate: 2022-01-01 15:19:05\ntags:\n---\n\n#1. webpack 安装\n\n    全局安装 nodejs\n        验证  node -v\n              npm -v\n    npm install webpack -g\n    npm install webpack-cli -g\n    正常情况下 安装webpack-cli 会自动安装webpack\n    npm uninstall webpack -g 全局卸载\n\n    单独项目内安装\n    npm install webpack webpack-cli --save-dev\n    或者\n    npm install webpack webpack-cli -D\n\n    运行npx webpack -v   //注 npx 会在node_module文件夹中找\n    \n    安装特定版本\n    npm info webpack   //查看webpack有那些版本\n    npm install webpack@4.16.5 webpack-cli -D\n\n\n#2.webpack 基本使用\n\n    npm init    增加package.json文件\n    npm init -y\n\n\n#3.一些语法\n    \n    ES Module 模块引入方式\n    \n\n\n\n","slug":"webpack学习笔记1","published":1,"updated":"2024-11-25T11:31:36.361Z","_id":"clxb4gv550031pcoch82reip5","comments":1,"layout":"post","photos":[],"link":"","content":"<p>#1. webpack 安装</p>\n<pre><code>全局安装 nodejs\n    验证  node -v\n          npm -v\nnpm install webpack -g\nnpm install webpack-cli -g\n正常情况下 安装webpack-cli 会自动安装webpack\nnpm uninstall webpack -g 全局卸载\n\n单独项目内安装\nnpm install webpack webpack-cli --save-dev\n或者\nnpm install webpack webpack-cli -D\n\n运行npx webpack -v   //注 npx 会在node_module文件夹中找\n\n安装特定版本\nnpm info webpack   //查看webpack有那些版本\nnpm install webpack@4.16.5 webpack-cli -D\n</code></pre>\n<p>#2.webpack 基本使用</p>\n<pre><code>npm init    增加package.json文件\nnpm init -y\n</code></pre>\n<p>#3.一些语法</p>\n<pre><code>ES Module 模块引入方式\n</code></pre>\n","site":{"data":{}},"length":387,"excerpt":"","more":"<p>#1. webpack 安装</p>\n<pre><code>全局安装 nodejs\n    验证  node -v\n          npm -v\nnpm install webpack -g\nnpm install webpack-cli -g\n正常情况下 安装webpack-cli 会自动安装webpack\nnpm uninstall webpack -g 全局卸载\n\n单独项目内安装\nnpm install webpack webpack-cli --save-dev\n或者\nnpm install webpack webpack-cli -D\n\n运行npx webpack -v   //注 npx 会在node_module文件夹中找\n\n安装特定版本\nnpm info webpack   //查看webpack有那些版本\nnpm install webpack@4.16.5 webpack-cli -D\n</code></pre>\n<p>#2.webpack 基本使用</p>\n<pre><code>npm init    增加package.json文件\nnpm init -y\n</code></pre>\n<p>#3.一些语法</p>\n<pre><code>ES Module 模块引入方式\n</code></pre>\n"},{"title":"web备份方案","abbrlink":"13c1c2ab","date":"2021-12-23T12:33:32.000Z","_content":"\n\n## 一、服务器环境\n\n        192.168.100.230 web服务器\n        192.168.100.20  备份服务器 （rsync服务端）\n\n## 二、备份服务器安装 rsync 服务端\n\n    rpm -qa|grep rsync    //检查是否安装 rsync\n    \n    yum install -y rsync\n    \n    vim /etc/rsyncd.conf   //编辑rsyncd服务\n    \n    rsyncd.conf配置文件如下\n```\n#rsyncd.conf start\nuid = rsync                                \ngid = rsync\nuse chroot=no\nmax connections=200\ntimeout = 300\npid file = /var/run/rsyncd.pid\nlock file = /var/run/rsyncd.lock\nlog file = /var/log/rsyncd.log\nignore errors\nread only = false\nlist = false \nhosts allow = 172.16.1.0/24\n#hosts deny = 0.0.0.0/32\nauth users = rsync_backup\nsecrets file = /etc/rsync.password\nfake super = yes\n[backup]\ncomment = \"backup dir by oldboy\"\npath = /home/backup  \n#备份的目录\n```\n        \n        \n    创建rsync 服务管理用户\n    useradd -s /sbin/nologin -M rsync\n    \n    创建数据备份存储目录\n    chown -R rsyn.rsync /home/backup\n    \n    创建认证用户密码文件\n    echo \"rsync_backup:admin.123!@#$\"  >/etc/rsync.password\n    chmod 600 /etc/rsync.password\n\n    启动rsync服务\n    systemctl start rsyncd       \n\n\n\n\n## 三、配置web 服务器端（192.168.100.230）\n\n        确认 rsync是否安装\n            rpm -qa|grep rsync\n        \n        建立认证文件\n        \n            echo \"密码字符串（与rsync一致）\"  >/etc/rsync.password\n            chmod 600 /etc/rsync.password\n        \n        web01主机数据传输到backup主机测试测试传输\n        \n            Push: rsync [OPTION...] SRC... [USER@]HOST::DEST\n            交互式：rsync -avz /etc/hosts  rsync_backup@172.16.1.41::backup\n            非交互式：rsync -avz /etc/hosts  rsync_backup@172.16.1.41::backup --password-file=/etc/rsync.password\n            \n            \n        shell 脚本\n```#!/bin/bash\nobjectFilename=('文件夹名称');\nsourcePath='/apps/web/';\nfor(( i=0;i<${#objectFilename[@]};i++)) \ndo \n    tar zcf /home/backup/web/source/${objectFilename[i]}-$(date +%Y-%m-%d).tar.gz -C ${sourcePath} ${objectFilename[i]}; \n    rsync -avz /home/backup/web/source/  rsync_backup@192.168.100.20::backup --password-file=/etc/rsync.password\n    rm -rf /home/backup/web/source/${objectFilename[i]}-$(date +%Y-%m-%d).tar.gz\ndone;\n ```\n\n## 四、注意事项\n    特殊情况 总是提示权限问题修改 服务端\n\n        uid = root                                \n        gid = root\n        fake super = no\n\n\n    脚本备份大文件有问题\n\n\n\n","source":"_posts/web备份方案.md","raw":"---\ntitle: web备份方案\nabbrlink: 13c1c2ab\ndate: 2021-12-23 20:33:32\ntags:\n---\n\n\n## 一、服务器环境\n\n        192.168.100.230 web服务器\n        192.168.100.20  备份服务器 （rsync服务端）\n\n## 二、备份服务器安装 rsync 服务端\n\n    rpm -qa|grep rsync    //检查是否安装 rsync\n    \n    yum install -y rsync\n    \n    vim /etc/rsyncd.conf   //编辑rsyncd服务\n    \n    rsyncd.conf配置文件如下\n```\n#rsyncd.conf start\nuid = rsync                                \ngid = rsync\nuse chroot=no\nmax connections=200\ntimeout = 300\npid file = /var/run/rsyncd.pid\nlock file = /var/run/rsyncd.lock\nlog file = /var/log/rsyncd.log\nignore errors\nread only = false\nlist = false \nhosts allow = 172.16.1.0/24\n#hosts deny = 0.0.0.0/32\nauth users = rsync_backup\nsecrets file = /etc/rsync.password\nfake super = yes\n[backup]\ncomment = \"backup dir by oldboy\"\npath = /home/backup  \n#备份的目录\n```\n        \n        \n    创建rsync 服务管理用户\n    useradd -s /sbin/nologin -M rsync\n    \n    创建数据备份存储目录\n    chown -R rsyn.rsync /home/backup\n    \n    创建认证用户密码文件\n    echo \"rsync_backup:admin.123!@#$\"  >/etc/rsync.password\n    chmod 600 /etc/rsync.password\n\n    启动rsync服务\n    systemctl start rsyncd       \n\n\n\n\n## 三、配置web 服务器端（192.168.100.230）\n\n        确认 rsync是否安装\n            rpm -qa|grep rsync\n        \n        建立认证文件\n        \n            echo \"密码字符串（与rsync一致）\"  >/etc/rsync.password\n            chmod 600 /etc/rsync.password\n        \n        web01主机数据传输到backup主机测试测试传输\n        \n            Push: rsync [OPTION...] SRC... [USER@]HOST::DEST\n            交互式：rsync -avz /etc/hosts  rsync_backup@172.16.1.41::backup\n            非交互式：rsync -avz /etc/hosts  rsync_backup@172.16.1.41::backup --password-file=/etc/rsync.password\n            \n            \n        shell 脚本\n```#!/bin/bash\nobjectFilename=('文件夹名称');\nsourcePath='/apps/web/';\nfor(( i=0;i<${#objectFilename[@]};i++)) \ndo \n    tar zcf /home/backup/web/source/${objectFilename[i]}-$(date +%Y-%m-%d).tar.gz -C ${sourcePath} ${objectFilename[i]}; \n    rsync -avz /home/backup/web/source/  rsync_backup@192.168.100.20::backup --password-file=/etc/rsync.password\n    rm -rf /home/backup/web/source/${objectFilename[i]}-$(date +%Y-%m-%d).tar.gz\ndone;\n ```\n\n## 四、注意事项\n    特殊情况 总是提示权限问题修改 服务端\n\n        uid = root                                \n        gid = root\n        fake super = no\n\n\n    脚本备份大文件有问题\n\n\n\n","slug":"web备份方案","published":1,"updated":"2024-02-06T05:50:34.969Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv560032pcocaxuqdfl6","content":"<h2 id=\"一、服务器环境\"><a href=\"#一、服务器环境\" class=\"headerlink\" title=\"一、服务器环境\"></a>一、服务器环境</h2><pre><code>    192.168.100.230 web服务器\n    192.168.100.20  备份服务器 （rsync服务端）\n</code></pre>\n<h2 id=\"二、备份服务器安装-rsync-服务端\"><a href=\"#二、备份服务器安装-rsync-服务端\" class=\"headerlink\" title=\"二、备份服务器安装 rsync 服务端\"></a>二、备份服务器安装 rsync 服务端</h2><pre><code>rpm -qa|grep rsync    //检查是否安装 rsync\n\nyum install -y rsync\n\nvim /etc/rsyncd.conf   //编辑rsyncd服务\n\nrsyncd.conf配置文件如下\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#rsyncd.conf start</span><br><span class=\"line\">uid = rsync                                </span><br><span class=\"line\">gid = rsync</span><br><span class=\"line\">use chroot=no</span><br><span class=\"line\">max connections=200</span><br><span class=\"line\">timeout = 300</span><br><span class=\"line\">pid file = /var/run/rsyncd.pid</span><br><span class=\"line\">lock file = /var/run/rsyncd.lock</span><br><span class=\"line\">log file = /var/log/rsyncd.log</span><br><span class=\"line\">ignore errors</span><br><span class=\"line\">read only = false</span><br><span class=\"line\">list = false </span><br><span class=\"line\">hosts allow = 172.16.1.0/24</span><br><span class=\"line\">#hosts deny = 0.0.0.0/32</span><br><span class=\"line\">auth users = rsync_backup</span><br><span class=\"line\">secrets file = /etc/rsync.password</span><br><span class=\"line\">fake super = yes</span><br><span class=\"line\">[backup]</span><br><span class=\"line\">comment = &quot;backup dir by oldboy&quot;</span><br><span class=\"line\">path = /home/backup  </span><br><span class=\"line\">#备份的目录</span><br></pre></td></tr></table></figure>\n<pre><code>创建rsync 服务管理用户\nuseradd -s /sbin/nologin -M rsync\n\n创建数据备份存储目录\nchown -R rsyn.rsync /home/backup\n\n创建认证用户密码文件\necho &quot;rsync_backup:admin.123!@#$&quot;  &gt;/etc/rsync.password\nchmod 600 /etc/rsync.password\n\n启动rsync服务\nsystemctl start rsyncd       \n</code></pre>\n<h2 id=\"三、配置web-服务器端（192-168-100-230）\"><a href=\"#三、配置web-服务器端（192-168-100-230）\" class=\"headerlink\" title=\"三、配置web 服务器端（192.168.100.230）\"></a>三、配置web 服务器端（192.168.100.230）</h2><pre><code>    确认 rsync是否安装\n        rpm -qa|grep rsync\n    \n    建立认证文件\n    \n        echo &quot;密码字符串（与rsync一致）&quot;  &gt;/etc/rsync.password\n        chmod 600 /etc/rsync.password\n    \n    web01主机数据传输到backup主机测试测试传输\n    \n        Push: rsync [OPTION...] SRC... [USER@]HOST::DEST\n        交互式：rsync -avz /etc/hosts  rsync_backup@172.16.1.41::backup\n        非交互式：rsync -avz /etc/hosts  rsync_backup@172.16.1.41::backup --password-file=/etc/rsync.password\n        \n        \n    shell 脚本\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">objectFilename=(&#x27;文件夹名称&#x27;);</span><br><span class=\"line\">sourcePath=&#x27;/apps/web/&#x27;;</span><br><span class=\"line\">for(( i=0;i&lt;$&#123;#objectFilename[@]&#125;;i++)) </span><br><span class=\"line\">do </span><br><span class=\"line\">    tar zcf /home/backup/web/source/$&#123;objectFilename[i]&#125;-$(date +%Y-%m-%d).tar.gz -C $&#123;sourcePath&#125; $&#123;objectFilename[i]&#125;; </span><br><span class=\"line\">    rsync -avz /home/backup/web/source/  rsync_backup@192.168.100.20::backup --password-file=/etc/rsync.password</span><br><span class=\"line\">    rm -rf /home/backup/web/source/$&#123;objectFilename[i]&#125;-$(date +%Y-%m-%d).tar.gz</span><br><span class=\"line\">done;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"四、注意事项\"><a href=\"#四、注意事项\" class=\"headerlink\" title=\"四、注意事项\"></a>四、注意事项</h2><pre><code>特殊情况 总是提示权限问题修改 服务端\n\n    uid = root                                \n    gid = root\n    fake super = no\n\n\n脚本备份大文件有问题\n</code></pre>\n","site":{"data":{}},"length":1674,"excerpt":"","more":"<h2 id=\"一、服务器环境\"><a href=\"#一、服务器环境\" class=\"headerlink\" title=\"一、服务器环境\"></a>一、服务器环境</h2><pre><code>    192.168.100.230 web服务器\n    192.168.100.20  备份服务器 （rsync服务端）\n</code></pre>\n<h2 id=\"二、备份服务器安装-rsync-服务端\"><a href=\"#二、备份服务器安装-rsync-服务端\" class=\"headerlink\" title=\"二、备份服务器安装 rsync 服务端\"></a>二、备份服务器安装 rsync 服务端</h2><pre><code>rpm -qa|grep rsync    //检查是否安装 rsync\n\nyum install -y rsync\n\nvim /etc/rsyncd.conf   //编辑rsyncd服务\n\nrsyncd.conf配置文件如下\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#rsyncd.conf start</span><br><span class=\"line\">uid = rsync                                </span><br><span class=\"line\">gid = rsync</span><br><span class=\"line\">use chroot=no</span><br><span class=\"line\">max connections=200</span><br><span class=\"line\">timeout = 300</span><br><span class=\"line\">pid file = /var/run/rsyncd.pid</span><br><span class=\"line\">lock file = /var/run/rsyncd.lock</span><br><span class=\"line\">log file = /var/log/rsyncd.log</span><br><span class=\"line\">ignore errors</span><br><span class=\"line\">read only = false</span><br><span class=\"line\">list = false </span><br><span class=\"line\">hosts allow = 172.16.1.0/24</span><br><span class=\"line\">#hosts deny = 0.0.0.0/32</span><br><span class=\"line\">auth users = rsync_backup</span><br><span class=\"line\">secrets file = /etc/rsync.password</span><br><span class=\"line\">fake super = yes</span><br><span class=\"line\">[backup]</span><br><span class=\"line\">comment = &quot;backup dir by oldboy&quot;</span><br><span class=\"line\">path = /home/backup  </span><br><span class=\"line\">#备份的目录</span><br></pre></td></tr></table></figure>\n<pre><code>创建rsync 服务管理用户\nuseradd -s /sbin/nologin -M rsync\n\n创建数据备份存储目录\nchown -R rsyn.rsync /home/backup\n\n创建认证用户密码文件\necho &quot;rsync_backup:admin.123!@#$&quot;  &gt;/etc/rsync.password\nchmod 600 /etc/rsync.password\n\n启动rsync服务\nsystemctl start rsyncd       \n</code></pre>\n<h2 id=\"三、配置web-服务器端（192-168-100-230）\"><a href=\"#三、配置web-服务器端（192-168-100-230）\" class=\"headerlink\" title=\"三、配置web 服务器端（192.168.100.230）\"></a>三、配置web 服务器端（192.168.100.230）</h2><pre><code>    确认 rsync是否安装\n        rpm -qa|grep rsync\n    \n    建立认证文件\n    \n        echo &quot;密码字符串（与rsync一致）&quot;  &gt;/etc/rsync.password\n        chmod 600 /etc/rsync.password\n    \n    web01主机数据传输到backup主机测试测试传输\n    \n        Push: rsync [OPTION...] SRC... [USER@]HOST::DEST\n        交互式：rsync -avz /etc/hosts  rsync_backup@172.16.1.41::backup\n        非交互式：rsync -avz /etc/hosts  rsync_backup@172.16.1.41::backup --password-file=/etc/rsync.password\n        \n        \n    shell 脚本\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">objectFilename=(&#x27;文件夹名称&#x27;);</span><br><span class=\"line\">sourcePath=&#x27;/apps/web/&#x27;;</span><br><span class=\"line\">for(( i=0;i&lt;$&#123;#objectFilename[@]&#125;;i++)) </span><br><span class=\"line\">do </span><br><span class=\"line\">    tar zcf /home/backup/web/source/$&#123;objectFilename[i]&#125;-$(date +%Y-%m-%d).tar.gz -C $&#123;sourcePath&#125; $&#123;objectFilename[i]&#125;; </span><br><span class=\"line\">    rsync -avz /home/backup/web/source/  rsync_backup@192.168.100.20::backup --password-file=/etc/rsync.password</span><br><span class=\"line\">    rm -rf /home/backup/web/source/$&#123;objectFilename[i]&#125;-$(date +%Y-%m-%d).tar.gz</span><br><span class=\"line\">done;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"四、注意事项\"><a href=\"#四、注意事项\" class=\"headerlink\" title=\"四、注意事项\"></a>四、注意事项</h2><pre><code>特殊情况 总是提示权限问题修改 服务端\n\n    uid = root                                \n    gid = root\n    fake super = no\n\n\n脚本备份大文件有问题\n</code></pre>\n"},{"title":"web安全","abbrlink":"def64e49","date":"2023-07-09T06:16:41.000Z","_content":"\n# php安全配置\n\n    主要控制php执行危险函数，默认是关闭：Off\n    sql.safe_mode=On\n    禁止显示PHP版本号\n    expose_php = Off\n    关闭重定向执行php文件（你的网站url/as=你的网站url/sdf/muma.php）\n    cgi.force_redirect = 0\n    禁止解析非法php文件\n    cgi.fix_pathinfo = 0\n    关闭错误信息输出\n    display_error = Off\n    error_reporting = E_WARNING & E_ERROR\n    记录错误日志至后台, 方便追溯\n    log_errors = On\n    error_log = /var/log/php_error.log\n    禁止远程执行phpshell\n    allow_url_include = Off\n    静止file_get_content函数获取资源\n    allow_url_fopen = Off\n    格式化时间\n    date.timezone=Asia/Shanghai\n    \n    \n# nginx安全配置    \n\n    add_header X-Content-Type-Options nosniff;\n    add_header 'Referrer-Policy' 'origin';\n    add_header X-Download-Options \"noopen\" always;\n    add_header Strict-Transport-Security \"max-age=63072000; includeSubdomains; preload\";\n    add_header X-Permitted-Cross-Domain-Policies  \"master-only\";\n    add_header X-Frame-Options SAMEORIGIN;\n    #add_header Content-Security-Policy \"default-src 'self' data: *.xxx.com  'unsaf\n    add_header X-XSS-Protection \"1; mode=block\";\n    # add_header Content-Security-Policy \"default-src *;style-src 'self' 'unsafe-inline';script-src 'self' 'unsafe-inline' 'unsafe-eval';img-src * data:;worker-src * blob:;font-src 'self' data:;\"\n    \n    \n    location / {\n        if ($http_origin ~* (https?://[^/]*\\.kuaidasoft\\.com)){\n                  add_header 'Access-Control-Allow-Origin' \"$http_origin\";\n        }\n        try_files $uri $uri/ /index.html;\n    }  \n    \n    \n    \n    #指定允许跨域的方法，*代表所有\n    add_header Access-Control-Allow-Methods 'GET,PUT,POST,DELETE,OPTIONS';\n    \n    # 预检命令的缓存，如果不缓存每次会发送两次请求\n    add_header Access-Control-Max-Age 3600;\n    \n    #带cookie请求需要加上这个字段，并设置为true\n    add_header Access-Control-Allow-Credentials true;\n    \n    #   表示允许这个域跨域调用（客户端发送请求的域名和端口） \n    #   $http_origin动态获取请求客户端请求的域   不用*的原因是带cookie的请求不支持*号\n    #add_header Access-Control-Allow-Origin $http_origin;\n    #   表示请求头的字段 动态获取\n    add_header Access-Control-Allow-Headers $http_access_control_request_headers;\n    \n    \n    \n # mysql   \n\n\n","source":"_posts/web安全.md","raw":"---\ntitle: web安全\nabbrlink: def64e49\ndate: 2023-07-09 14:16:41\ntags:\n---\n\n# php安全配置\n\n    主要控制php执行危险函数，默认是关闭：Off\n    sql.safe_mode=On\n    禁止显示PHP版本号\n    expose_php = Off\n    关闭重定向执行php文件（你的网站url/as=你的网站url/sdf/muma.php）\n    cgi.force_redirect = 0\n    禁止解析非法php文件\n    cgi.fix_pathinfo = 0\n    关闭错误信息输出\n    display_error = Off\n    error_reporting = E_WARNING & E_ERROR\n    记录错误日志至后台, 方便追溯\n    log_errors = On\n    error_log = /var/log/php_error.log\n    禁止远程执行phpshell\n    allow_url_include = Off\n    静止file_get_content函数获取资源\n    allow_url_fopen = Off\n    格式化时间\n    date.timezone=Asia/Shanghai\n    \n    \n# nginx安全配置    \n\n    add_header X-Content-Type-Options nosniff;\n    add_header 'Referrer-Policy' 'origin';\n    add_header X-Download-Options \"noopen\" always;\n    add_header Strict-Transport-Security \"max-age=63072000; includeSubdomains; preload\";\n    add_header X-Permitted-Cross-Domain-Policies  \"master-only\";\n    add_header X-Frame-Options SAMEORIGIN;\n    #add_header Content-Security-Policy \"default-src 'self' data: *.xxx.com  'unsaf\n    add_header X-XSS-Protection \"1; mode=block\";\n    # add_header Content-Security-Policy \"default-src *;style-src 'self' 'unsafe-inline';script-src 'self' 'unsafe-inline' 'unsafe-eval';img-src * data:;worker-src * blob:;font-src 'self' data:;\"\n    \n    \n    location / {\n        if ($http_origin ~* (https?://[^/]*\\.kuaidasoft\\.com)){\n                  add_header 'Access-Control-Allow-Origin' \"$http_origin\";\n        }\n        try_files $uri $uri/ /index.html;\n    }  \n    \n    \n    \n    #指定允许跨域的方法，*代表所有\n    add_header Access-Control-Allow-Methods 'GET,PUT,POST,DELETE,OPTIONS';\n    \n    # 预检命令的缓存，如果不缓存每次会发送两次请求\n    add_header Access-Control-Max-Age 3600;\n    \n    #带cookie请求需要加上这个字段，并设置为true\n    add_header Access-Control-Allow-Credentials true;\n    \n    #   表示允许这个域跨域调用（客户端发送请求的域名和端口） \n    #   $http_origin动态获取请求客户端请求的域   不用*的原因是带cookie的请求不支持*号\n    #add_header Access-Control-Allow-Origin $http_origin;\n    #   表示请求头的字段 动态获取\n    add_header Access-Control-Allow-Headers $http_access_control_request_headers;\n    \n    \n    \n # mysql   \n\n\n","slug":"web安全","published":1,"updated":"2024-02-06T05:50:34.974Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv570034pcoc1vdl31oo","content":"<h1 id=\"php安全配置\"><a href=\"#php安全配置\" class=\"headerlink\" title=\"php安全配置\"></a>php安全配置</h1><pre><code>主要控制php执行危险函数，默认是关闭：Off\nsql.safe_mode=On\n禁止显示PHP版本号\nexpose_php = Off\n关闭重定向执行php文件（你的网站url/as=你的网站url/sdf/muma.php）\ncgi.force_redirect = 0\n禁止解析非法php文件\ncgi.fix_pathinfo = 0\n关闭错误信息输出\ndisplay_error = Off\nerror_reporting = E_WARNING &amp; E_ERROR\n记录错误日志至后台, 方便追溯\nlog_errors = On\nerror_log = /var/log/php_error.log\n禁止远程执行phpshell\nallow_url_include = Off\n静止file_get_content函数获取资源\nallow_url_fopen = Off\n格式化时间\ndate.timezone=Asia/Shanghai\n</code></pre>\n<h1 id=\"nginx安全配置\"><a href=\"#nginx安全配置\" class=\"headerlink\" title=\"nginx安全配置\"></a>nginx安全配置</h1><pre><code>add_header X-Content-Type-Options nosniff;\nadd_header &#39;Referrer-Policy&#39; &#39;origin&#39;;\nadd_header X-Download-Options &quot;noopen&quot; always;\nadd_header Strict-Transport-Security &quot;max-age=63072000; includeSubdomains; preload&quot;;\nadd_header X-Permitted-Cross-Domain-Policies  &quot;master-only&quot;;\nadd_header X-Frame-Options SAMEORIGIN;\n#add_header Content-Security-Policy &quot;default-src &#39;self&#39; data: *.xxx.com  &#39;unsaf\nadd_header X-XSS-Protection &quot;1; mode=block&quot;;\n# add_header Content-Security-Policy &quot;default-src *;style-src &#39;self&#39; &#39;unsafe-inline&#39;;script-src &#39;self&#39; &#39;unsafe-inline&#39; &#39;unsafe-eval&#39;;img-src * data:;worker-src * blob:;font-src &#39;self&#39; data:;&quot;\n\n\nlocation / &#123;\n    if ($http_origin ~* (https?://[^/]*\\.kuaidasoft\\.com))&#123;\n              add_header &#39;Access-Control-Allow-Origin&#39; &quot;$http_origin&quot;;\n    &#125;\n    try_files $uri $uri/ /index.html;\n&#125;  \n\n\n\n#指定允许跨域的方法，*代表所有\nadd_header Access-Control-Allow-Methods &#39;GET,PUT,POST,DELETE,OPTIONS&#39;;\n\n# 预检命令的缓存，如果不缓存每次会发送两次请求\nadd_header Access-Control-Max-Age 3600;\n\n#带cookie请求需要加上这个字段，并设置为true\nadd_header Access-Control-Allow-Credentials true;\n\n#   表示允许这个域跨域调用（客户端发送请求的域名和端口） \n#   $http_origin动态获取请求客户端请求的域   不用*的原因是带cookie的请求不支持*号\n#add_header Access-Control-Allow-Origin $http_origin;\n#   表示请求头的字段 动态获取\nadd_header Access-Control-Allow-Headers $http_access_control_request_headers;\n</code></pre>\n<h1 id=\"mysql\"><a href=\"#mysql\" class=\"headerlink\" title=\"mysql\"></a>mysql</h1>","site":{"data":{}},"length":1747,"excerpt":"","more":"<h1 id=\"php安全配置\"><a href=\"#php安全配置\" class=\"headerlink\" title=\"php安全配置\"></a>php安全配置</h1><pre><code>主要控制php执行危险函数，默认是关闭：Off\nsql.safe_mode=On\n禁止显示PHP版本号\nexpose_php = Off\n关闭重定向执行php文件（你的网站url/as=你的网站url/sdf/muma.php）\ncgi.force_redirect = 0\n禁止解析非法php文件\ncgi.fix_pathinfo = 0\n关闭错误信息输出\ndisplay_error = Off\nerror_reporting = E_WARNING &amp; E_ERROR\n记录错误日志至后台, 方便追溯\nlog_errors = On\nerror_log = /var/log/php_error.log\n禁止远程执行phpshell\nallow_url_include = Off\n静止file_get_content函数获取资源\nallow_url_fopen = Off\n格式化时间\ndate.timezone=Asia/Shanghai\n</code></pre>\n<h1 id=\"nginx安全配置\"><a href=\"#nginx安全配置\" class=\"headerlink\" title=\"nginx安全配置\"></a>nginx安全配置</h1><pre><code>add_header X-Content-Type-Options nosniff;\nadd_header &#39;Referrer-Policy&#39; &#39;origin&#39;;\nadd_header X-Download-Options &quot;noopen&quot; always;\nadd_header Strict-Transport-Security &quot;max-age=63072000; includeSubdomains; preload&quot;;\nadd_header X-Permitted-Cross-Domain-Policies  &quot;master-only&quot;;\nadd_header X-Frame-Options SAMEORIGIN;\n#add_header Content-Security-Policy &quot;default-src &#39;self&#39; data: *.xxx.com  &#39;unsaf\nadd_header X-XSS-Protection &quot;1; mode=block&quot;;\n# add_header Content-Security-Policy &quot;default-src *;style-src &#39;self&#39; &#39;unsafe-inline&#39;;script-src &#39;self&#39; &#39;unsafe-inline&#39; &#39;unsafe-eval&#39;;img-src * data:;worker-src * blob:;font-src &#39;self&#39; data:;&quot;\n\n\nlocation / &#123;\n    if ($http_origin ~* (https?://[^/]*\\.kuaidasoft\\.com))&#123;\n              add_header &#39;Access-Control-Allow-Origin&#39; &quot;$http_origin&quot;;\n    &#125;\n    try_files $uri $uri/ /index.html;\n&#125;  \n\n\n\n#指定允许跨域的方法，*代表所有\nadd_header Access-Control-Allow-Methods &#39;GET,PUT,POST,DELETE,OPTIONS&#39;;\n\n# 预检命令的缓存，如果不缓存每次会发送两次请求\nadd_header Access-Control-Max-Age 3600;\n\n#带cookie请求需要加上这个字段，并设置为true\nadd_header Access-Control-Allow-Credentials true;\n\n#   表示允许这个域跨域调用（客户端发送请求的域名和端口） \n#   $http_origin动态获取请求客户端请求的域   不用*的原因是带cookie的请求不支持*号\n#add_header Access-Control-Allow-Origin $http_origin;\n#   表示请求头的字段 动态获取\nadd_header Access-Control-Allow-Headers $http_access_control_request_headers;\n</code></pre>\n<h1 id=\"mysql\"><a href=\"#mysql\" class=\"headerlink\" title=\"mysql\"></a>mysql</h1>"},{"title":"web开发中实时通信技术","abbrlink":"b90b7557","date":"2022-03-01T06:53:36.000Z","_content":"\n\n# 常用技术\n\n协议\n\n    TCP/IP网络通信：TCP/IP是互联网的基础通信协议，可以实现高速、可靠的数据传输。\n    UDP（用户数据报协议）：UDP是一种无连接的通信方式，适用于实时数据传输，但数据包丢失率较高。\n    WebSocket：WebSocket是一种基于TCP的协议，可以实现客户端和服务器之间的双向通信，适用于实时应用。\n    RTP（实时传输协议）：RTP是用于音频和视频数据的传输协议，适用于实时通信场景。\n    AMQP（高级消息队列协议）：AMQP是一种消息传递协议，可以实现不同系统之间的通信和数据交换。\n    \nWebSocket\n     \n    WebSocket 可以用于桌面端软件的通信。WebSocket 是一种网络通信协议，它允许在单个 TCP 连接上进行全双工通信，\n    使得客户端和服务器之间可以实时地交换数据。在桌面端软件中，可以使用 WebSocket 来实现实时通信和数据交换，\n    例如在游戏、远程桌面控制、实时聊天等场景中。\n    \n    \n即时通信 IM（Instant Messaging）\n\n    即即时通讯技术，是一种允许两人或多人使用网络即时传递文字、图像、音频和视频等各类信息的技术。\n    它通常基于软件运行，是一种聊天工具，例如 QQ、微信等。通过 IM 技术，人们可以方便地与他人进行实时交流，\n    极大地提高了沟通效率。此外，IM 技术还可以支持多人语音、视频通话等功能，进一步提升了沟通体验\n    \n    \nSocket.IO\n\n    是一个基于Node.js和WebSocket的实时通信（Real-Time Communication）库\n    它提供了一种简单而强大的方式来在客户端和服务器之间进行实时通信，支持多种协议\n    如WebSocket、HTTP、WebRTC等。Socket.IO具有实时性、高效性、双向通信和连接管理等特点\n    因此在Web应用程序中广泛应用，可以用于实时聊天、实时数据同步、实时游戏等场景","source":"_posts/web开发中实时通信技术.md","raw":"---\ntitle: web开发中实时通信技术\nabbrlink: b90b7557\ndate: 2022-03-01 14:53:36\ntags:\n---\n\n\n# 常用技术\n\n协议\n\n    TCP/IP网络通信：TCP/IP是互联网的基础通信协议，可以实现高速、可靠的数据传输。\n    UDP（用户数据报协议）：UDP是一种无连接的通信方式，适用于实时数据传输，但数据包丢失率较高。\n    WebSocket：WebSocket是一种基于TCP的协议，可以实现客户端和服务器之间的双向通信，适用于实时应用。\n    RTP（实时传输协议）：RTP是用于音频和视频数据的传输协议，适用于实时通信场景。\n    AMQP（高级消息队列协议）：AMQP是一种消息传递协议，可以实现不同系统之间的通信和数据交换。\n    \nWebSocket\n     \n    WebSocket 可以用于桌面端软件的通信。WebSocket 是一种网络通信协议，它允许在单个 TCP 连接上进行全双工通信，\n    使得客户端和服务器之间可以实时地交换数据。在桌面端软件中，可以使用 WebSocket 来实现实时通信和数据交换，\n    例如在游戏、远程桌面控制、实时聊天等场景中。\n    \n    \n即时通信 IM（Instant Messaging）\n\n    即即时通讯技术，是一种允许两人或多人使用网络即时传递文字、图像、音频和视频等各类信息的技术。\n    它通常基于软件运行，是一种聊天工具，例如 QQ、微信等。通过 IM 技术，人们可以方便地与他人进行实时交流，\n    极大地提高了沟通效率。此外，IM 技术还可以支持多人语音、视频通话等功能，进一步提升了沟通体验\n    \n    \nSocket.IO\n\n    是一个基于Node.js和WebSocket的实时通信（Real-Time Communication）库\n    它提供了一种简单而强大的方式来在客户端和服务器之间进行实时通信，支持多种协议\n    如WebSocket、HTTP、WebRTC等。Socket.IO具有实时性、高效性、双向通信和连接管理等特点\n    因此在Web应用程序中广泛应用，可以用于实时聊天、实时数据同步、实时游戏等场景","slug":"web开发中实时通信技术","published":1,"updated":"2024-03-06T08:04:05.068Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv570036pcoc84ew723j","content":"<h1 id=\"常用技术\"><a href=\"#常用技术\" class=\"headerlink\" title=\"常用技术\"></a>常用技术</h1><p>协议</p>\n<pre><code>TCP/IP网络通信：TCP/IP是互联网的基础通信协议，可以实现高速、可靠的数据传输。\nUDP（用户数据报协议）：UDP是一种无连接的通信方式，适用于实时数据传输，但数据包丢失率较高。\nWebSocket：WebSocket是一种基于TCP的协议，可以实现客户端和服务器之间的双向通信，适用于实时应用。\nRTP（实时传输协议）：RTP是用于音频和视频数据的传输协议，适用于实时通信场景。\nAMQP（高级消息队列协议）：AMQP是一种消息传递协议，可以实现不同系统之间的通信和数据交换。\n</code></pre>\n<p>WebSocket</p>\n<pre><code>WebSocket 可以用于桌面端软件的通信。WebSocket 是一种网络通信协议，它允许在单个 TCP 连接上进行全双工通信，\n使得客户端和服务器之间可以实时地交换数据。在桌面端软件中，可以使用 WebSocket 来实现实时通信和数据交换，\n例如在游戏、远程桌面控制、实时聊天等场景中。\n</code></pre>\n<p>即时通信 IM（Instant Messaging）</p>\n<pre><code>即即时通讯技术，是一种允许两人或多人使用网络即时传递文字、图像、音频和视频等各类信息的技术。\n它通常基于软件运行，是一种聊天工具，例如 QQ、微信等。通过 IM 技术，人们可以方便地与他人进行实时交流，\n极大地提高了沟通效率。此外，IM 技术还可以支持多人语音、视频通话等功能，进一步提升了沟通体验\n</code></pre>\n<p>Socket.IO</p>\n<pre><code>是一个基于Node.js和WebSocket的实时通信（Real-Time Communication）库\n它提供了一种简单而强大的方式来在客户端和服务器之间进行实时通信，支持多种协议\n如WebSocket、HTTP、WebRTC等。Socket.IO具有实时性、高效性、双向通信和连接管理等特点\n因此在Web应用程序中广泛应用，可以用于实时聊天、实时数据同步、实时游戏等场景\n</code></pre>\n","site":{"data":{}},"length":752,"excerpt":"","more":"<h1 id=\"常用技术\"><a href=\"#常用技术\" class=\"headerlink\" title=\"常用技术\"></a>常用技术</h1><p>协议</p>\n<pre><code>TCP/IP网络通信：TCP/IP是互联网的基础通信协议，可以实现高速、可靠的数据传输。\nUDP（用户数据报协议）：UDP是一种无连接的通信方式，适用于实时数据传输，但数据包丢失率较高。\nWebSocket：WebSocket是一种基于TCP的协议，可以实现客户端和服务器之间的双向通信，适用于实时应用。\nRTP（实时传输协议）：RTP是用于音频和视频数据的传输协议，适用于实时通信场景。\nAMQP（高级消息队列协议）：AMQP是一种消息传递协议，可以实现不同系统之间的通信和数据交换。\n</code></pre>\n<p>WebSocket</p>\n<pre><code>WebSocket 可以用于桌面端软件的通信。WebSocket 是一种网络通信协议，它允许在单个 TCP 连接上进行全双工通信，\n使得客户端和服务器之间可以实时地交换数据。在桌面端软件中，可以使用 WebSocket 来实现实时通信和数据交换，\n例如在游戏、远程桌面控制、实时聊天等场景中。\n</code></pre>\n<p>即时通信 IM（Instant Messaging）</p>\n<pre><code>即即时通讯技术，是一种允许两人或多人使用网络即时传递文字、图像、音频和视频等各类信息的技术。\n它通常基于软件运行，是一种聊天工具，例如 QQ、微信等。通过 IM 技术，人们可以方便地与他人进行实时交流，\n极大地提高了沟通效率。此外，IM 技术还可以支持多人语音、视频通话等功能，进一步提升了沟通体验\n</code></pre>\n<p>Socket.IO</p>\n<pre><code>是一个基于Node.js和WebSocket的实时通信（Real-Time Communication）库\n它提供了一种简单而强大的方式来在客户端和服务器之间进行实时通信，支持多种协议\n如WebSocket、HTTP、WebRTC等。Socket.IO具有实时性、高效性、双向通信和连接管理等特点\n因此在Web应用程序中广泛应用，可以用于实时聊天、实时数据同步、实时游戏等场景\n</code></pre>\n"},{"title":"windows搭建apache+php+mysql5.6","abbrlink":"27e26578","date":"2023-02-25T03:51:34.000Z","_content":"# 安装mysql服务\n    \n    1.下载地址：https://downloads.mysql.com/archives/community/\n    \n    2.下载相应windows版本\n    \n    3.解压后cmd cd到文件目录mysqld.exe  执行   mysqld.exe install【mysqld remove 移除服务 mysqld start 启动服务】\n    \n    4.设置开机启动  然后再win+r 输入services.msc  打开后找到mysql 右键点击属性   将启动类型设置为自动即可\n    \n    【注：期间不同版本可能会报奇奇怪怪的错，百度安装相关的版本vc库】\n    \n     1.缺少msvcr100.dll文件如何解决\n    \n     百度Visual C++ 2010 Redistributable Package 搜索相关 下载安装\n\n## mysql 相关操作     \n     \n     修改密码\n     GRANT ALL PRIVILEGES ON *.* TO 'root'@'%'IDENTIFIED BY 'Storage@202312' WITH GRANT OPTION;\n\n# 安装php\n\n    1.下载地址：https://windows.php.net/downloads/releases/archives/\n    \n    2.下载版本必须有  php7apache2_4.dll  vc版本最好跟apache的版本一样\n    \n    3.配置php.ini 开启相应 扩展\n    \n    4.测试是否能用  到相应目录 执行 php.exe -v\n    \n    \n    【注：期间不同版本可能会报奇奇怪怪的错，百度安装相关的版本vc库】\n    \n    【注：建议放在c:\\php目录，不然可能出现无法加载到ddl扩展】\n    \n    \n\n# 安装apache 服务器\n\n##apache 安装对接php\n    下载：https://www.apachelounge.com/download/VC14/\n    \n    \n    到apache/config/httpd.conf文件\n    找到<IfModule unixd_module>配置行 在其上面添加\n    \n    LoadModule php7_module C:/php/php7apache2_4.dll  【php7apache2_4.dll 不同版本不同  具体目录根据自己的配置】\n    AddType application/x-httpd-php .php .html .htm\n    PHPIniDir c:/php                                 【配置PHP所在目录  具体目录根据自己的配置】  \n    \n    \n    然后通过bin目录下   **httpd.exe  -t** 测试配置是否通过\n    \n    bin目录下 ApacheMonitor.exe 可以用来启动关闭 httpd服务\n    \n    \n## 配置apache项目访问\n### 1.配置项\n\n        httpd.exe -k install -n \"apache2.4\"\n\n\n\n        1.ServerName     配置域名访问地址\n        例：ServerName 192.168.100.34:8080    ServerName www.baidu.com\n        \n        2.ServerRoot  配置apache安装目录\n        \n                 例     Define SRVROOT \"c:/httpd\"\n                        ServerRoot \"${SRVROOT}\"   \n                                 \n        3.Listen      监听端口\n        \n                 例     Listen 8080\n                 \n        4.DocumentRoot    配置项目目录\n        \n                 例：  DocumentRoot \"${SRVROOT}/htdocs/jnyy.iguanwei.com/public\"\n        \n        5.<Directory 目录>\n            权限\n        </>Directory>\n        配置目录权限相关\n        \n            例：\n            <Directory \"${SRVROOT}/htdocs/jnyy.iguanwei.com/public\">\n                        Options Indexes FollowSymLinks\n                        AllowOverride All\n                        Require all granted\n             </Directory>\n             \n        6.配置默认访问文件\n        \n            <IfModule dir_module>\n                  DirectoryIndex  index.php index.html\n            </IfModule>     \n         \n### vhost配置示例\n    \n    主配置文件httpd.conf\n    LoadModule rewrite_module modules/mod_rewrite.so\n    \n    LoadModule vhost_alias_module modules/mod_vhost_alias.so\n    \n    Include conf/extra/httpd-vhosts.conf\n        \n####  vhost配置文件\n        <VirtualHost *:8081>\n                ServerAdmin webmaster@localhost\n                DocumentRoot \"E:/wwwroot/storage/public\"\n                DirectoryIndex index.php\n        \t\tErrorLog \"logs/storage-error.log\"\n                CustomLog \"logs/storage-access.log\" common\n        \t\t<Directory \"E:/wwwroot/storage/public\">\n        \t\t  Options Indexes FollowSymLinks\n        \t\t  AllowOverride all\n        \t\t  Require all granted\n        \t\t  DirectoryIndex index.php index.html\n        \t\t\n        \t\t  AddType application/octet-stream .jpg .jpeg .png .gif .mp4 .avi .mov .flv\n        \t\t</Directory>\n        </VirtualHost>\n        \n        \n        \n        \n        <VirtualHost *:8082>\n                ServerAdmin webmaster@localhost\n                DocumentRoot \"E:/wwwroot/storage-web\"\n                DirectoryIndex index.html\n        \t\tErrorLog \"logs/storage-web-error.log\"\n                CustomLog \"logs/storage-web-access.log\" common\n        \t\t<Directory \"E:/wwwroot/storage-web\">\n        \t\t  Options Indexes FollowSymLinks\n        \t\t  AllowOverride all\n        \t\t  Require all granted\n        \t\t  DirectoryIndex  index.html\n        \t\t</Directory>\n        </VirtualHost>\n        \n        \n        \n### 2.php伪静态\n\n    1. httpd.conf配置文件 启动rewrite模块 如下：\n    \n        LoadModule rewrite_module modules/mod_rewrite.so\n\n\n    2.项目根目录.htaccess文件配置入下  没有则新建\n    \n        <IfModule mod_rewrite.c>\n         RewriteEngine on\n         RewriteBase /\n         RewriteCond %{REQUEST_FILENAME} !-d\n         RewriteCond %{REQUEST_FILENAME} !-f\n         RewriteRule ^(.*)$ index.php?s=/$1 [QSA,PT,L]\n        </IfModule>\n    \n    \n    3.对应apache  httpd.conf配置文件\n    \n         AllowOverride All\n\n        <Directory 项目目录>\n                                Options Indexes FollowSymLinks\n                                AllowOverride All\n                                Require all granted\n        </Directory>\n        \n### 3.vue项目伪静态\n\n    <IfModule mod_rewrite.c>\n        RewriteEngine On\n        RewriteBase /\n        RewriteRule ^index\\.html$ - [L]\n        RewriteCond %{REQUEST_FILENAME} !-f\n        RewriteCond %{REQUEST_FILENAME} !-d\n        RewriteRule . /index.html [L]\n    </ifModule>\t      \n    \n### 配置开机启动\n        \n       1.将apache加入windows服务   \n       \n            apache的bin目录下 执行 httpd.exe -thttpd.exe -k install -n \"apache2.4\"\n       \n       \n       2.设置开机启动  然后再win+r 输入services.msc  打开后找到mysql 右键点击属性   将启动类型设置为自动即可\n       \n\n    \n# apache相关知识\n## windows下apache常用命令\n\n    httpd -k install                           安装apache服务\n    httpd -k uninstall                         移除apache服务\n    \n    httpd -k start                             启动apache服务\n    httpd -k restart                           重启apache服务\n    httpd -k stop                              关闭已安装的apache服务\n    \n    httpd -v                                   查看apache版本\n    httpd -t                                   查看apache配置文件状态    \n## 重写规则\n    网站根目录下创建  .htaccess  文件\n    \n    1) R[=code](force redirect)  #强制外部重定向\n    强制在替代字符串加上http://thishost[:thisport]/前缀重定向到外部的URL.如果code不指定，将用缺省的302 HTTP状态码。\n    2) F(force URL to be forbidden)  #禁用URL,返回403HTTP状态码。\n    3) G(force URL to be gone)  # 强制URL为GONE，返回410HTTP状态码。\n    4) P(force proxy) # 强制使用代理转发。\n    5) L(last rule) # 表明当前规则是最后一条规则，停止分析以后规则的重写。\n    6) N(next round) # 重新从第一条规则开始运行重写过程。\n    7) C(chained with next rule) # 与下一条规则关联\n    如果规则匹配则正常处理，该标志无效，如果不匹配，那么下面所有关联的规则都跳过。\n    8) T=MIME-type(force MIME type) # 强制MIME类型\n    9) NS (used only if no internal sub-request) # 只用于不是内部子请求\n    10) NC(no case) # 不区分大小写\n    11) QSA(query string append) # 追加请求字符串\n    12) NE(no URI escaping of output) # 不在输出转义特殊字符\n    例如：RewriteRule /foo/(.*) /bar?arg=P1%3d$1 [R,NE] # 将能正确的将/foo/zoo转换成/bar?arg=P1=zoo\n    13) PT(pass through to next handler) # 传递给下一个处理\n    例如：\n    RewriteRule ^/abc(.*) /def$1 [PT] # 将会交给/def规则处理\n    Alias /def /ghi\n    14) S=num(skip next rule(s)) # 跳过num条规则\n    15) E=VAR:VAL(set environment variable) # 设置环境变量\n    \n    \n## HTTP 跳转至 HTTPS 示例\n\n    RewriteEngine on  # 开启重写\n    RewriteCond %{SERVER_PORT} !^443$  # 如果访问的不是 443 端口\n    RewriteCond %{REQUEST_URI} !^/tz.php  #如果访问的url 不是 /tz.php\n    RewriteRule (.*) https://%{SERVER_NAME}/$1 [R]     # 跳转到  https：//域名+$1\n    \n    \n    \n    \n## HTTP 80 强制转 HTTPS\n\n    RewriteEngine On\n    RewriteCond %{SERVER_PORT} 80  # 如果访问的是80 端口\n    RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R,L]  # 跳转 https \n    \n    \n    \n    \n## 强制301重定向 HTTPS\n  \n    <IfModule mod_rewrite.c>\n    RewriteEngine on\n    RewriteBase /  # 表示项目根目录\n    RewriteCond %{SERVER_PORT} !^443$  # 如果访问的不是443 端口\n    RewriteRule (.*) https://%{SERVER_NAME}/$1 [R=301,L]  # 重定向到 301\n    </IfModule>\n## 重命名目录\n    \n    RewriteRule   ^/?old_directory/([a-z\\.]+)$   new_directory/$1   [R=301,L]\n   \n   \n   \n   \n## 图片防盗链\n\n   RewriteCond   %{HTTP_REFERER}   !^$ # 如果上个页面地址为空\n   RewriteCond    %{HTTP_REFERER}   !^http://(www\\.)?example\\.com/   [NC]    #或者不是来自你自己的域名\n   RewriteRule   \\.(gif|jpg|png)$   - [F]  #禁止访问\n   \n   \n   \n## 如果文件不存在重定向到404页面\n\n    RewriteCond   %{REQUEST_FILENAME}   !-f  # 如果访问的不是一个文件\n    RewriteCond   %{REQUEST_FILENAME}   !-d  #如果访问的不是一个目录\n    RewriteRule   .?   /404.php   [L]   #跳转到网站根目录\n    # 也可携带参数\n    #RewriteRule ^/?(.*)$ /404.php?url=$1 [L]\n  \n\n","source":"_posts/windows搭建apache-php-mysql5-6.md","raw":"---\ntitle: windows搭建apache+php+mysql5.6\nabbrlink: '27e26578'\ncategories:\n  - 服务器相关\n  - windows\ndate: 2023-02-25 11:51:34\ntags:\n---\n# 安装mysql服务\n    \n    1.下载地址：https://downloads.mysql.com/archives/community/\n    \n    2.下载相应windows版本\n    \n    3.解压后cmd cd到文件目录mysqld.exe  执行   mysqld.exe install【mysqld remove 移除服务 mysqld start 启动服务】\n    \n    4.设置开机启动  然后再win+r 输入services.msc  打开后找到mysql 右键点击属性   将启动类型设置为自动即可\n    \n    【注：期间不同版本可能会报奇奇怪怪的错，百度安装相关的版本vc库】\n    \n     1.缺少msvcr100.dll文件如何解决\n    \n     百度Visual C++ 2010 Redistributable Package 搜索相关 下载安装\n\n## mysql 相关操作     \n     \n     修改密码\n     GRANT ALL PRIVILEGES ON *.* TO 'root'@'%'IDENTIFIED BY 'Storage@202312' WITH GRANT OPTION;\n\n# 安装php\n\n    1.下载地址：https://windows.php.net/downloads/releases/archives/\n    \n    2.下载版本必须有  php7apache2_4.dll  vc版本最好跟apache的版本一样\n    \n    3.配置php.ini 开启相应 扩展\n    \n    4.测试是否能用  到相应目录 执行 php.exe -v\n    \n    \n    【注：期间不同版本可能会报奇奇怪怪的错，百度安装相关的版本vc库】\n    \n    【注：建议放在c:\\php目录，不然可能出现无法加载到ddl扩展】\n    \n    \n\n# 安装apache 服务器\n\n##apache 安装对接php\n    下载：https://www.apachelounge.com/download/VC14/\n    \n    \n    到apache/config/httpd.conf文件\n    找到<IfModule unixd_module>配置行 在其上面添加\n    \n    LoadModule php7_module C:/php/php7apache2_4.dll  【php7apache2_4.dll 不同版本不同  具体目录根据自己的配置】\n    AddType application/x-httpd-php .php .html .htm\n    PHPIniDir c:/php                                 【配置PHP所在目录  具体目录根据自己的配置】  \n    \n    \n    然后通过bin目录下   **httpd.exe  -t** 测试配置是否通过\n    \n    bin目录下 ApacheMonitor.exe 可以用来启动关闭 httpd服务\n    \n    \n## 配置apache项目访问\n### 1.配置项\n\n        httpd.exe -k install -n \"apache2.4\"\n\n\n\n        1.ServerName     配置域名访问地址\n        例：ServerName 192.168.100.34:8080    ServerName www.baidu.com\n        \n        2.ServerRoot  配置apache安装目录\n        \n                 例     Define SRVROOT \"c:/httpd\"\n                        ServerRoot \"${SRVROOT}\"   \n                                 \n        3.Listen      监听端口\n        \n                 例     Listen 8080\n                 \n        4.DocumentRoot    配置项目目录\n        \n                 例：  DocumentRoot \"${SRVROOT}/htdocs/jnyy.iguanwei.com/public\"\n        \n        5.<Directory 目录>\n            权限\n        </>Directory>\n        配置目录权限相关\n        \n            例：\n            <Directory \"${SRVROOT}/htdocs/jnyy.iguanwei.com/public\">\n                        Options Indexes FollowSymLinks\n                        AllowOverride All\n                        Require all granted\n             </Directory>\n             \n        6.配置默认访问文件\n        \n            <IfModule dir_module>\n                  DirectoryIndex  index.php index.html\n            </IfModule>     \n         \n### vhost配置示例\n    \n    主配置文件httpd.conf\n    LoadModule rewrite_module modules/mod_rewrite.so\n    \n    LoadModule vhost_alias_module modules/mod_vhost_alias.so\n    \n    Include conf/extra/httpd-vhosts.conf\n        \n####  vhost配置文件\n        <VirtualHost *:8081>\n                ServerAdmin webmaster@localhost\n                DocumentRoot \"E:/wwwroot/storage/public\"\n                DirectoryIndex index.php\n        \t\tErrorLog \"logs/storage-error.log\"\n                CustomLog \"logs/storage-access.log\" common\n        \t\t<Directory \"E:/wwwroot/storage/public\">\n        \t\t  Options Indexes FollowSymLinks\n        \t\t  AllowOverride all\n        \t\t  Require all granted\n        \t\t  DirectoryIndex index.php index.html\n        \t\t\n        \t\t  AddType application/octet-stream .jpg .jpeg .png .gif .mp4 .avi .mov .flv\n        \t\t</Directory>\n        </VirtualHost>\n        \n        \n        \n        \n        <VirtualHost *:8082>\n                ServerAdmin webmaster@localhost\n                DocumentRoot \"E:/wwwroot/storage-web\"\n                DirectoryIndex index.html\n        \t\tErrorLog \"logs/storage-web-error.log\"\n                CustomLog \"logs/storage-web-access.log\" common\n        \t\t<Directory \"E:/wwwroot/storage-web\">\n        \t\t  Options Indexes FollowSymLinks\n        \t\t  AllowOverride all\n        \t\t  Require all granted\n        \t\t  DirectoryIndex  index.html\n        \t\t</Directory>\n        </VirtualHost>\n        \n        \n        \n### 2.php伪静态\n\n    1. httpd.conf配置文件 启动rewrite模块 如下：\n    \n        LoadModule rewrite_module modules/mod_rewrite.so\n\n\n    2.项目根目录.htaccess文件配置入下  没有则新建\n    \n        <IfModule mod_rewrite.c>\n         RewriteEngine on\n         RewriteBase /\n         RewriteCond %{REQUEST_FILENAME} !-d\n         RewriteCond %{REQUEST_FILENAME} !-f\n         RewriteRule ^(.*)$ index.php?s=/$1 [QSA,PT,L]\n        </IfModule>\n    \n    \n    3.对应apache  httpd.conf配置文件\n    \n         AllowOverride All\n\n        <Directory 项目目录>\n                                Options Indexes FollowSymLinks\n                                AllowOverride All\n                                Require all granted\n        </Directory>\n        \n### 3.vue项目伪静态\n\n    <IfModule mod_rewrite.c>\n        RewriteEngine On\n        RewriteBase /\n        RewriteRule ^index\\.html$ - [L]\n        RewriteCond %{REQUEST_FILENAME} !-f\n        RewriteCond %{REQUEST_FILENAME} !-d\n        RewriteRule . /index.html [L]\n    </ifModule>\t      \n    \n### 配置开机启动\n        \n       1.将apache加入windows服务   \n       \n            apache的bin目录下 执行 httpd.exe -thttpd.exe -k install -n \"apache2.4\"\n       \n       \n       2.设置开机启动  然后再win+r 输入services.msc  打开后找到mysql 右键点击属性   将启动类型设置为自动即可\n       \n\n    \n# apache相关知识\n## windows下apache常用命令\n\n    httpd -k install                           安装apache服务\n    httpd -k uninstall                         移除apache服务\n    \n    httpd -k start                             启动apache服务\n    httpd -k restart                           重启apache服务\n    httpd -k stop                              关闭已安装的apache服务\n    \n    httpd -v                                   查看apache版本\n    httpd -t                                   查看apache配置文件状态    \n## 重写规则\n    网站根目录下创建  .htaccess  文件\n    \n    1) R[=code](force redirect)  #强制外部重定向\n    强制在替代字符串加上http://thishost[:thisport]/前缀重定向到外部的URL.如果code不指定，将用缺省的302 HTTP状态码。\n    2) F(force URL to be forbidden)  #禁用URL,返回403HTTP状态码。\n    3) G(force URL to be gone)  # 强制URL为GONE，返回410HTTP状态码。\n    4) P(force proxy) # 强制使用代理转发。\n    5) L(last rule) # 表明当前规则是最后一条规则，停止分析以后规则的重写。\n    6) N(next round) # 重新从第一条规则开始运行重写过程。\n    7) C(chained with next rule) # 与下一条规则关联\n    如果规则匹配则正常处理，该标志无效，如果不匹配，那么下面所有关联的规则都跳过。\n    8) T=MIME-type(force MIME type) # 强制MIME类型\n    9) NS (used only if no internal sub-request) # 只用于不是内部子请求\n    10) NC(no case) # 不区分大小写\n    11) QSA(query string append) # 追加请求字符串\n    12) NE(no URI escaping of output) # 不在输出转义特殊字符\n    例如：RewriteRule /foo/(.*) /bar?arg=P1%3d$1 [R,NE] # 将能正确的将/foo/zoo转换成/bar?arg=P1=zoo\n    13) PT(pass through to next handler) # 传递给下一个处理\n    例如：\n    RewriteRule ^/abc(.*) /def$1 [PT] # 将会交给/def规则处理\n    Alias /def /ghi\n    14) S=num(skip next rule(s)) # 跳过num条规则\n    15) E=VAR:VAL(set environment variable) # 设置环境变量\n    \n    \n## HTTP 跳转至 HTTPS 示例\n\n    RewriteEngine on  # 开启重写\n    RewriteCond %{SERVER_PORT} !^443$  # 如果访问的不是 443 端口\n    RewriteCond %{REQUEST_URI} !^/tz.php  #如果访问的url 不是 /tz.php\n    RewriteRule (.*) https://%{SERVER_NAME}/$1 [R]     # 跳转到  https：//域名+$1\n    \n    \n    \n    \n## HTTP 80 强制转 HTTPS\n\n    RewriteEngine On\n    RewriteCond %{SERVER_PORT} 80  # 如果访问的是80 端口\n    RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R,L]  # 跳转 https \n    \n    \n    \n    \n## 强制301重定向 HTTPS\n  \n    <IfModule mod_rewrite.c>\n    RewriteEngine on\n    RewriteBase /  # 表示项目根目录\n    RewriteCond %{SERVER_PORT} !^443$  # 如果访问的不是443 端口\n    RewriteRule (.*) https://%{SERVER_NAME}/$1 [R=301,L]  # 重定向到 301\n    </IfModule>\n## 重命名目录\n    \n    RewriteRule   ^/?old_directory/([a-z\\.]+)$   new_directory/$1   [R=301,L]\n   \n   \n   \n   \n## 图片防盗链\n\n   RewriteCond   %{HTTP_REFERER}   !^$ # 如果上个页面地址为空\n   RewriteCond    %{HTTP_REFERER}   !^http://(www\\.)?example\\.com/   [NC]    #或者不是来自你自己的域名\n   RewriteRule   \\.(gif|jpg|png)$   - [F]  #禁止访问\n   \n   \n   \n## 如果文件不存在重定向到404页面\n\n    RewriteCond   %{REQUEST_FILENAME}   !-f  # 如果访问的不是一个文件\n    RewriteCond   %{REQUEST_FILENAME}   !-d  #如果访问的不是一个目录\n    RewriteRule   .?   /404.php   [L]   #跳转到网站根目录\n    # 也可携带参数\n    #RewriteRule ^/?(.*)$ /404.php?url=$1 [L]\n  \n\n","slug":"windows搭建apache-php-mysql5-6","published":1,"updated":"2025-02-24T12:26:43.050Z","_id":"clxb4gv59003apcoc7yzreos2","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"安装mysql服务\"><a href=\"#安装mysql服务\" class=\"headerlink\" title=\"安装mysql服务\"></a>安装mysql服务</h1><pre><code>1.下载地址：https://downloads.mysql.com/archives/community/\n\n2.下载相应windows版本\n\n3.解压后cmd cd到文件目录mysqld.exe  执行   mysqld.exe install【mysqld remove 移除服务 mysqld start 启动服务】\n\n4.设置开机启动  然后再win+r 输入services.msc  打开后找到mysql 右键点击属性   将启动类型设置为自动即可\n\n【注：期间不同版本可能会报奇奇怪怪的错，百度安装相关的版本vc库】\n\n 1.缺少msvcr100.dll文件如何解决\n\n 百度Visual C++ 2010 Redistributable Package 搜索相关 下载安装\n</code></pre>\n<h2 id=\"mysql-相关操作\"><a href=\"#mysql-相关操作\" class=\"headerlink\" title=\"mysql 相关操作\"></a>mysql 相关操作</h2><pre><code> 修改密码\n GRANT ALL PRIVILEGES ON *.* TO &#39;root&#39;@&#39;%&#39;IDENTIFIED BY &#39;Storage@202312&#39; WITH GRANT OPTION;\n</code></pre>\n<h1 id=\"安装php\"><a href=\"#安装php\" class=\"headerlink\" title=\"安装php\"></a>安装php</h1><pre><code>1.下载地址：https://windows.php.net/downloads/releases/archives/\n\n2.下载版本必须有  php7apache2_4.dll  vc版本最好跟apache的版本一样\n\n3.配置php.ini 开启相应 扩展\n\n4.测试是否能用  到相应目录 执行 php.exe -v\n\n\n【注：期间不同版本可能会报奇奇怪怪的错，百度安装相关的版本vc库】\n\n【注：建议放在c:\\php目录，不然可能出现无法加载到ddl扩展】\n</code></pre>\n<h1 id=\"安装apache-服务器\"><a href=\"#安装apache-服务器\" class=\"headerlink\" title=\"安装apache 服务器\"></a>安装apache 服务器</h1><p>##apache 安装对接php<br>    下载：<a href=\"https://www.apachelounge.com/download/VC14/\">https://www.apachelounge.com/download/VC14/</a></p>\n<pre><code>到apache/config/httpd.conf文件\n找到&lt;IfModule unixd_module&gt;配置行 在其上面添加\n\nLoadModule php7_module C:/php/php7apache2_4.dll  【php7apache2_4.dll 不同版本不同  具体目录根据自己的配置】\nAddType application/x-httpd-php .php .html .htm\nPHPIniDir c:/php                                 【配置PHP所在目录  具体目录根据自己的配置】  \n\n\n然后通过bin目录下   **httpd.exe  -t** 测试配置是否通过\n\nbin目录下 ApacheMonitor.exe 可以用来启动关闭 httpd服务\n</code></pre>\n<h2 id=\"配置apache项目访问\"><a href=\"#配置apache项目访问\" class=\"headerlink\" title=\"配置apache项目访问\"></a>配置apache项目访问</h2><h3 id=\"1-配置项\"><a href=\"#1-配置项\" class=\"headerlink\" title=\"1.配置项\"></a>1.配置项</h3><pre><code>    httpd.exe -k install -n &quot;apache2.4&quot;\n\n\n\n    1.ServerName     配置域名访问地址\n    例：ServerName 192.168.100.34:8080    ServerName www.baidu.com\n    \n    2.ServerRoot  配置apache安装目录\n    \n             例     Define SRVROOT &quot;c:/httpd&quot;\n                    ServerRoot &quot;$&#123;SRVROOT&#125;&quot;   \n                             \n    3.Listen      监听端口\n    \n             例     Listen 8080\n             \n    4.DocumentRoot    配置项目目录\n    \n             例：  DocumentRoot &quot;$&#123;SRVROOT&#125;/htdocs/jnyy.iguanwei.com/public&quot;\n    \n    5.&lt;Directory 目录&gt;\n        权限\n    &lt;/&gt;Directory&gt;\n    配置目录权限相关\n    \n        例：\n        &lt;Directory &quot;$&#123;SRVROOT&#125;/htdocs/jnyy.iguanwei.com/public&quot;&gt;\n                    Options Indexes FollowSymLinks\n                    AllowOverride All\n                    Require all granted\n         &lt;/Directory&gt;\n         \n    6.配置默认访问文件\n    \n        &lt;IfModule dir_module&gt;\n              DirectoryIndex  index.php index.html\n        &lt;/IfModule&gt;     \n     \n</code></pre>\n<h3 id=\"vhost配置示例\"><a href=\"#vhost配置示例\" class=\"headerlink\" title=\"vhost配置示例\"></a>vhost配置示例</h3><pre><code>主配置文件httpd.conf\nLoadModule rewrite_module modules/mod_rewrite.so\n\nLoadModule vhost_alias_module modules/mod_vhost_alias.so\n\nInclude conf/extra/httpd-vhosts.conf\n    \n</code></pre>\n<h4 id=\"vhost配置文件\"><a href=\"#vhost配置文件\" class=\"headerlink\" title=\"vhost配置文件\"></a>vhost配置文件</h4><pre><code>    &lt;VirtualHost *:8081&gt;\n            ServerAdmin webmaster@localhost\n            DocumentRoot &quot;E:/wwwroot/storage/public&quot;\n            DirectoryIndex index.php\n            ErrorLog &quot;logs/storage-error.log&quot;\n            CustomLog &quot;logs/storage-access.log&quot; common\n            &lt;Directory &quot;E:/wwwroot/storage/public&quot;&gt;\n              Options Indexes FollowSymLinks\n              AllowOverride all\n              Require all granted\n              DirectoryIndex index.php index.html\n            \n              AddType application/octet-stream .jpg .jpeg .png .gif .mp4 .avi .mov .flv\n            &lt;/Directory&gt;\n    &lt;/VirtualHost&gt;\n    \n    \n    \n    \n    &lt;VirtualHost *:8082&gt;\n            ServerAdmin webmaster@localhost\n            DocumentRoot &quot;E:/wwwroot/storage-web&quot;\n            DirectoryIndex index.html\n            ErrorLog &quot;logs/storage-web-error.log&quot;\n            CustomLog &quot;logs/storage-web-access.log&quot; common\n            &lt;Directory &quot;E:/wwwroot/storage-web&quot;&gt;\n              Options Indexes FollowSymLinks\n              AllowOverride all\n              Require all granted\n              DirectoryIndex  index.html\n            &lt;/Directory&gt;\n    &lt;/VirtualHost&gt;\n    \n    \n    \n</code></pre>\n<h3 id=\"2-php伪静态\"><a href=\"#2-php伪静态\" class=\"headerlink\" title=\"2.php伪静态\"></a>2.php伪静态</h3><pre><code>1. httpd.conf配置文件 启动rewrite模块 如下：\n\n    LoadModule rewrite_module modules/mod_rewrite.so\n\n\n2.项目根目录.htaccess文件配置入下  没有则新建\n\n    &lt;IfModule mod_rewrite.c&gt;\n     RewriteEngine on\n     RewriteBase /\n     RewriteCond %&#123;REQUEST_FILENAME&#125; !-d\n     RewriteCond %&#123;REQUEST_FILENAME&#125; !-f\n     RewriteRule ^(.*)$ index.php?s=/$1 [QSA,PT,L]\n    &lt;/IfModule&gt;\n\n\n3.对应apache  httpd.conf配置文件\n\n     AllowOverride All\n\n    &lt;Directory 项目目录&gt;\n                            Options Indexes FollowSymLinks\n                            AllowOverride All\n                            Require all granted\n    &lt;/Directory&gt;\n    \n</code></pre>\n<h3 id=\"3-vue项目伪静态\"><a href=\"#3-vue项目伪静态\" class=\"headerlink\" title=\"3.vue项目伪静态\"></a>3.vue项目伪静态</h3><pre><code>&lt;IfModule mod_rewrite.c&gt;\n    RewriteEngine On\n    RewriteBase /\n    RewriteRule ^index\\.html$ - [L]\n    RewriteCond %&#123;REQUEST_FILENAME&#125; !-f\n    RewriteCond %&#123;REQUEST_FILENAME&#125; !-d\n    RewriteRule . /index.html [L]\n&lt;/ifModule&gt;          \n</code></pre>\n<h3 id=\"配置开机启动\"><a href=\"#配置开机启动\" class=\"headerlink\" title=\"配置开机启动\"></a>配置开机启动</h3><pre><code>   1.将apache加入windows服务   \n   \n        apache的bin目录下 执行 httpd.exe -thttpd.exe -k install -n &quot;apache2.4&quot;\n   \n   \n   2.设置开机启动  然后再win+r 输入services.msc  打开后找到mysql 右键点击属性   将启动类型设置为自动即可\n   \n</code></pre>\n<h1 id=\"apache相关知识\"><a href=\"#apache相关知识\" class=\"headerlink\" title=\"apache相关知识\"></a>apache相关知识</h1><h2 id=\"windows下apache常用命令\"><a href=\"#windows下apache常用命令\" class=\"headerlink\" title=\"windows下apache常用命令\"></a>windows下apache常用命令</h2><pre><code>httpd -k install                           安装apache服务\nhttpd -k uninstall                         移除apache服务\n\nhttpd -k start                             启动apache服务\nhttpd -k restart                           重启apache服务\nhttpd -k stop                              关闭已安装的apache服务\n\nhttpd -v                                   查看apache版本\nhttpd -t                                   查看apache配置文件状态    \n</code></pre>\n<h2 id=\"重写规则\"><a href=\"#重写规则\" class=\"headerlink\" title=\"重写规则\"></a>重写规则</h2><pre><code>网站根目录下创建  .htaccess  文件\n\n1) R[=code](force redirect)  #强制外部重定向\n强制在替代字符串加上http://thishost[:thisport]/前缀重定向到外部的URL.如果code不指定，将用缺省的302 HTTP状态码。\n2) F(force URL to be forbidden)  #禁用URL,返回403HTTP状态码。\n3) G(force URL to be gone)  # 强制URL为GONE，返回410HTTP状态码。\n4) P(force proxy) # 强制使用代理转发。\n5) L(last rule) # 表明当前规则是最后一条规则，停止分析以后规则的重写。\n6) N(next round) # 重新从第一条规则开始运行重写过程。\n7) C(chained with next rule) # 与下一条规则关联\n如果规则匹配则正常处理，该标志无效，如果不匹配，那么下面所有关联的规则都跳过。\n8) T=MIME-type(force MIME type) # 强制MIME类型\n9) NS (used only if no internal sub-request) # 只用于不是内部子请求\n10) NC(no case) # 不区分大小写\n11) QSA(query string append) # 追加请求字符串\n12) NE(no URI escaping of output) # 不在输出转义特殊字符\n例如：RewriteRule /foo/(.*) /bar?arg=P1%3d$1 [R,NE] # 将能正确的将/foo/zoo转换成/bar?arg=P1=zoo\n13) PT(pass through to next handler) # 传递给下一个处理\n例如：\nRewriteRule ^/abc(.*) /def$1 [PT] # 将会交给/def规则处理\nAlias /def /ghi\n14) S=num(skip next rule(s)) # 跳过num条规则\n15) E=VAR:VAL(set environment variable) # 设置环境变量\n</code></pre>\n<h2 id=\"HTTP-跳转至-HTTPS-示例\"><a href=\"#HTTP-跳转至-HTTPS-示例\" class=\"headerlink\" title=\"HTTP 跳转至 HTTPS 示例\"></a>HTTP 跳转至 HTTPS 示例</h2><pre><code>RewriteEngine on  # 开启重写\nRewriteCond %&#123;SERVER_PORT&#125; !^443$  # 如果访问的不是 443 端口\nRewriteCond %&#123;REQUEST_URI&#125; !^/tz.php  #如果访问的url 不是 /tz.php\nRewriteRule (.*) https://%&#123;SERVER_NAME&#125;/$1 [R]     # 跳转到  https：//域名+$1\n</code></pre>\n<h2 id=\"HTTP-80-强制转-HTTPS\"><a href=\"#HTTP-80-强制转-HTTPS\" class=\"headerlink\" title=\"HTTP 80 强制转 HTTPS\"></a>HTTP 80 强制转 HTTPS</h2><pre><code>RewriteEngine On\nRewriteCond %&#123;SERVER_PORT&#125; 80  # 如果访问的是80 端口\nRewriteRule ^(.*)$ https://%&#123;HTTP_HOST&#125;/$1 [R,L]  # 跳转 https \n</code></pre>\n<h2 id=\"强制301重定向-HTTPS\"><a href=\"#强制301重定向-HTTPS\" class=\"headerlink\" title=\"强制301重定向 HTTPS\"></a>强制301重定向 HTTPS</h2><pre><code>&lt;IfModule mod_rewrite.c&gt;\nRewriteEngine on\nRewriteBase /  # 表示项目根目录\nRewriteCond %&#123;SERVER_PORT&#125; !^443$  # 如果访问的不是443 端口\nRewriteRule (.*) https://%&#123;SERVER_NAME&#125;/$1 [R=301,L]  # 重定向到 301\n&lt;/IfModule&gt;\n</code></pre>\n<h2 id=\"重命名目录\"><a href=\"#重命名目录\" class=\"headerlink\" title=\"重命名目录\"></a>重命名目录</h2><pre><code>RewriteRule   ^/?old_directory/([a-z\\.]+)$   new_directory/$1   [R=301,L]\n</code></pre>\n<h2 id=\"图片防盗链\"><a href=\"#图片防盗链\" class=\"headerlink\" title=\"图片防盗链\"></a>图片防盗链</h2><p>   RewriteCond   %{HTTP_REFERER}   !^$ # 如果上个页面地址为空<br>   RewriteCond    %{HTTP_REFERER}   !^http://(www.)?example.com/   [NC]    #或者不是来自你自己的域名<br>   RewriteRule   .(gif|jpg|png)$   - [F]  #禁止访问</p>\n<h2 id=\"如果文件不存在重定向到404页面\"><a href=\"#如果文件不存在重定向到404页面\" class=\"headerlink\" title=\"如果文件不存在重定向到404页面\"></a>如果文件不存在重定向到404页面</h2><pre><code>RewriteCond   %&#123;REQUEST_FILENAME&#125;   !-f  # 如果访问的不是一个文件\nRewriteCond   %&#123;REQUEST_FILENAME&#125;   !-d  #如果访问的不是一个目录\nRewriteRule   .?   /404.php   [L]   #跳转到网站根目录\n# 也可携带参数\n#RewriteRule ^/?(.*)$ /404.php?url=$1 [L]\n</code></pre>\n","site":{"data":{}},"length":5540,"excerpt":"","more":"<h1 id=\"安装mysql服务\"><a href=\"#安装mysql服务\" class=\"headerlink\" title=\"安装mysql服务\"></a>安装mysql服务</h1><pre><code>1.下载地址：https://downloads.mysql.com/archives/community/\n\n2.下载相应windows版本\n\n3.解压后cmd cd到文件目录mysqld.exe  执行   mysqld.exe install【mysqld remove 移除服务 mysqld start 启动服务】\n\n4.设置开机启动  然后再win+r 输入services.msc  打开后找到mysql 右键点击属性   将启动类型设置为自动即可\n\n【注：期间不同版本可能会报奇奇怪怪的错，百度安装相关的版本vc库】\n\n 1.缺少msvcr100.dll文件如何解决\n\n 百度Visual C++ 2010 Redistributable Package 搜索相关 下载安装\n</code></pre>\n<h2 id=\"mysql-相关操作\"><a href=\"#mysql-相关操作\" class=\"headerlink\" title=\"mysql 相关操作\"></a>mysql 相关操作</h2><pre><code> 修改密码\n GRANT ALL PRIVILEGES ON *.* TO &#39;root&#39;@&#39;%&#39;IDENTIFIED BY &#39;Storage@202312&#39; WITH GRANT OPTION;\n</code></pre>\n<h1 id=\"安装php\"><a href=\"#安装php\" class=\"headerlink\" title=\"安装php\"></a>安装php</h1><pre><code>1.下载地址：https://windows.php.net/downloads/releases/archives/\n\n2.下载版本必须有  php7apache2_4.dll  vc版本最好跟apache的版本一样\n\n3.配置php.ini 开启相应 扩展\n\n4.测试是否能用  到相应目录 执行 php.exe -v\n\n\n【注：期间不同版本可能会报奇奇怪怪的错，百度安装相关的版本vc库】\n\n【注：建议放在c:\\php目录，不然可能出现无法加载到ddl扩展】\n</code></pre>\n<h1 id=\"安装apache-服务器\"><a href=\"#安装apache-服务器\" class=\"headerlink\" title=\"安装apache 服务器\"></a>安装apache 服务器</h1><p>##apache 安装对接php<br>    下载：<a href=\"https://www.apachelounge.com/download/VC14/\">https://www.apachelounge.com/download/VC14/</a></p>\n<pre><code>到apache/config/httpd.conf文件\n找到&lt;IfModule unixd_module&gt;配置行 在其上面添加\n\nLoadModule php7_module C:/php/php7apache2_4.dll  【php7apache2_4.dll 不同版本不同  具体目录根据自己的配置】\nAddType application/x-httpd-php .php .html .htm\nPHPIniDir c:/php                                 【配置PHP所在目录  具体目录根据自己的配置】  \n\n\n然后通过bin目录下   **httpd.exe  -t** 测试配置是否通过\n\nbin目录下 ApacheMonitor.exe 可以用来启动关闭 httpd服务\n</code></pre>\n<h2 id=\"配置apache项目访问\"><a href=\"#配置apache项目访问\" class=\"headerlink\" title=\"配置apache项目访问\"></a>配置apache项目访问</h2><h3 id=\"1-配置项\"><a href=\"#1-配置项\" class=\"headerlink\" title=\"1.配置项\"></a>1.配置项</h3><pre><code>    httpd.exe -k install -n &quot;apache2.4&quot;\n\n\n\n    1.ServerName     配置域名访问地址\n    例：ServerName 192.168.100.34:8080    ServerName www.baidu.com\n    \n    2.ServerRoot  配置apache安装目录\n    \n             例     Define SRVROOT &quot;c:/httpd&quot;\n                    ServerRoot &quot;$&#123;SRVROOT&#125;&quot;   \n                             \n    3.Listen      监听端口\n    \n             例     Listen 8080\n             \n    4.DocumentRoot    配置项目目录\n    \n             例：  DocumentRoot &quot;$&#123;SRVROOT&#125;/htdocs/jnyy.iguanwei.com/public&quot;\n    \n    5.&lt;Directory 目录&gt;\n        权限\n    &lt;/&gt;Directory&gt;\n    配置目录权限相关\n    \n        例：\n        &lt;Directory &quot;$&#123;SRVROOT&#125;/htdocs/jnyy.iguanwei.com/public&quot;&gt;\n                    Options Indexes FollowSymLinks\n                    AllowOverride All\n                    Require all granted\n         &lt;/Directory&gt;\n         \n    6.配置默认访问文件\n    \n        &lt;IfModule dir_module&gt;\n              DirectoryIndex  index.php index.html\n        &lt;/IfModule&gt;     \n     \n</code></pre>\n<h3 id=\"vhost配置示例\"><a href=\"#vhost配置示例\" class=\"headerlink\" title=\"vhost配置示例\"></a>vhost配置示例</h3><pre><code>主配置文件httpd.conf\nLoadModule rewrite_module modules/mod_rewrite.so\n\nLoadModule vhost_alias_module modules/mod_vhost_alias.so\n\nInclude conf/extra/httpd-vhosts.conf\n    \n</code></pre>\n<h4 id=\"vhost配置文件\"><a href=\"#vhost配置文件\" class=\"headerlink\" title=\"vhost配置文件\"></a>vhost配置文件</h4><pre><code>    &lt;VirtualHost *:8081&gt;\n            ServerAdmin webmaster@localhost\n            DocumentRoot &quot;E:/wwwroot/storage/public&quot;\n            DirectoryIndex index.php\n            ErrorLog &quot;logs/storage-error.log&quot;\n            CustomLog &quot;logs/storage-access.log&quot; common\n            &lt;Directory &quot;E:/wwwroot/storage/public&quot;&gt;\n              Options Indexes FollowSymLinks\n              AllowOverride all\n              Require all granted\n              DirectoryIndex index.php index.html\n            \n              AddType application/octet-stream .jpg .jpeg .png .gif .mp4 .avi .mov .flv\n            &lt;/Directory&gt;\n    &lt;/VirtualHost&gt;\n    \n    \n    \n    \n    &lt;VirtualHost *:8082&gt;\n            ServerAdmin webmaster@localhost\n            DocumentRoot &quot;E:/wwwroot/storage-web&quot;\n            DirectoryIndex index.html\n            ErrorLog &quot;logs/storage-web-error.log&quot;\n            CustomLog &quot;logs/storage-web-access.log&quot; common\n            &lt;Directory &quot;E:/wwwroot/storage-web&quot;&gt;\n              Options Indexes FollowSymLinks\n              AllowOverride all\n              Require all granted\n              DirectoryIndex  index.html\n            &lt;/Directory&gt;\n    &lt;/VirtualHost&gt;\n    \n    \n    \n</code></pre>\n<h3 id=\"2-php伪静态\"><a href=\"#2-php伪静态\" class=\"headerlink\" title=\"2.php伪静态\"></a>2.php伪静态</h3><pre><code>1. httpd.conf配置文件 启动rewrite模块 如下：\n\n    LoadModule rewrite_module modules/mod_rewrite.so\n\n\n2.项目根目录.htaccess文件配置入下  没有则新建\n\n    &lt;IfModule mod_rewrite.c&gt;\n     RewriteEngine on\n     RewriteBase /\n     RewriteCond %&#123;REQUEST_FILENAME&#125; !-d\n     RewriteCond %&#123;REQUEST_FILENAME&#125; !-f\n     RewriteRule ^(.*)$ index.php?s=/$1 [QSA,PT,L]\n    &lt;/IfModule&gt;\n\n\n3.对应apache  httpd.conf配置文件\n\n     AllowOverride All\n\n    &lt;Directory 项目目录&gt;\n                            Options Indexes FollowSymLinks\n                            AllowOverride All\n                            Require all granted\n    &lt;/Directory&gt;\n    \n</code></pre>\n<h3 id=\"3-vue项目伪静态\"><a href=\"#3-vue项目伪静态\" class=\"headerlink\" title=\"3.vue项目伪静态\"></a>3.vue项目伪静态</h3><pre><code>&lt;IfModule mod_rewrite.c&gt;\n    RewriteEngine On\n    RewriteBase /\n    RewriteRule ^index\\.html$ - [L]\n    RewriteCond %&#123;REQUEST_FILENAME&#125; !-f\n    RewriteCond %&#123;REQUEST_FILENAME&#125; !-d\n    RewriteRule . /index.html [L]\n&lt;/ifModule&gt;          \n</code></pre>\n<h3 id=\"配置开机启动\"><a href=\"#配置开机启动\" class=\"headerlink\" title=\"配置开机启动\"></a>配置开机启动</h3><pre><code>   1.将apache加入windows服务   \n   \n        apache的bin目录下 执行 httpd.exe -thttpd.exe -k install -n &quot;apache2.4&quot;\n   \n   \n   2.设置开机启动  然后再win+r 输入services.msc  打开后找到mysql 右键点击属性   将启动类型设置为自动即可\n   \n</code></pre>\n<h1 id=\"apache相关知识\"><a href=\"#apache相关知识\" class=\"headerlink\" title=\"apache相关知识\"></a>apache相关知识</h1><h2 id=\"windows下apache常用命令\"><a href=\"#windows下apache常用命令\" class=\"headerlink\" title=\"windows下apache常用命令\"></a>windows下apache常用命令</h2><pre><code>httpd -k install                           安装apache服务\nhttpd -k uninstall                         移除apache服务\n\nhttpd -k start                             启动apache服务\nhttpd -k restart                           重启apache服务\nhttpd -k stop                              关闭已安装的apache服务\n\nhttpd -v                                   查看apache版本\nhttpd -t                                   查看apache配置文件状态    \n</code></pre>\n<h2 id=\"重写规则\"><a href=\"#重写规则\" class=\"headerlink\" title=\"重写规则\"></a>重写规则</h2><pre><code>网站根目录下创建  .htaccess  文件\n\n1) R[=code](force redirect)  #强制外部重定向\n强制在替代字符串加上http://thishost[:thisport]/前缀重定向到外部的URL.如果code不指定，将用缺省的302 HTTP状态码。\n2) F(force URL to be forbidden)  #禁用URL,返回403HTTP状态码。\n3) G(force URL to be gone)  # 强制URL为GONE，返回410HTTP状态码。\n4) P(force proxy) # 强制使用代理转发。\n5) L(last rule) # 表明当前规则是最后一条规则，停止分析以后规则的重写。\n6) N(next round) # 重新从第一条规则开始运行重写过程。\n7) C(chained with next rule) # 与下一条规则关联\n如果规则匹配则正常处理，该标志无效，如果不匹配，那么下面所有关联的规则都跳过。\n8) T=MIME-type(force MIME type) # 强制MIME类型\n9) NS (used only if no internal sub-request) # 只用于不是内部子请求\n10) NC(no case) # 不区分大小写\n11) QSA(query string append) # 追加请求字符串\n12) NE(no URI escaping of output) # 不在输出转义特殊字符\n例如：RewriteRule /foo/(.*) /bar?arg=P1%3d$1 [R,NE] # 将能正确的将/foo/zoo转换成/bar?arg=P1=zoo\n13) PT(pass through to next handler) # 传递给下一个处理\n例如：\nRewriteRule ^/abc(.*) /def$1 [PT] # 将会交给/def规则处理\nAlias /def /ghi\n14) S=num(skip next rule(s)) # 跳过num条规则\n15) E=VAR:VAL(set environment variable) # 设置环境变量\n</code></pre>\n<h2 id=\"HTTP-跳转至-HTTPS-示例\"><a href=\"#HTTP-跳转至-HTTPS-示例\" class=\"headerlink\" title=\"HTTP 跳转至 HTTPS 示例\"></a>HTTP 跳转至 HTTPS 示例</h2><pre><code>RewriteEngine on  # 开启重写\nRewriteCond %&#123;SERVER_PORT&#125; !^443$  # 如果访问的不是 443 端口\nRewriteCond %&#123;REQUEST_URI&#125; !^/tz.php  #如果访问的url 不是 /tz.php\nRewriteRule (.*) https://%&#123;SERVER_NAME&#125;/$1 [R]     # 跳转到  https：//域名+$1\n</code></pre>\n<h2 id=\"HTTP-80-强制转-HTTPS\"><a href=\"#HTTP-80-强制转-HTTPS\" class=\"headerlink\" title=\"HTTP 80 强制转 HTTPS\"></a>HTTP 80 强制转 HTTPS</h2><pre><code>RewriteEngine On\nRewriteCond %&#123;SERVER_PORT&#125; 80  # 如果访问的是80 端口\nRewriteRule ^(.*)$ https://%&#123;HTTP_HOST&#125;/$1 [R,L]  # 跳转 https \n</code></pre>\n<h2 id=\"强制301重定向-HTTPS\"><a href=\"#强制301重定向-HTTPS\" class=\"headerlink\" title=\"强制301重定向 HTTPS\"></a>强制301重定向 HTTPS</h2><pre><code>&lt;IfModule mod_rewrite.c&gt;\nRewriteEngine on\nRewriteBase /  # 表示项目根目录\nRewriteCond %&#123;SERVER_PORT&#125; !^443$  # 如果访问的不是443 端口\nRewriteRule (.*) https://%&#123;SERVER_NAME&#125;/$1 [R=301,L]  # 重定向到 301\n&lt;/IfModule&gt;\n</code></pre>\n<h2 id=\"重命名目录\"><a href=\"#重命名目录\" class=\"headerlink\" title=\"重命名目录\"></a>重命名目录</h2><pre><code>RewriteRule   ^/?old_directory/([a-z\\.]+)$   new_directory/$1   [R=301,L]\n</code></pre>\n<h2 id=\"图片防盗链\"><a href=\"#图片防盗链\" class=\"headerlink\" title=\"图片防盗链\"></a>图片防盗链</h2><p>   RewriteCond   %{HTTP_REFERER}   !^$ # 如果上个页面地址为空<br>   RewriteCond    %{HTTP_REFERER}   !^http://(www.)?example.com/   [NC]    #或者不是来自你自己的域名<br>   RewriteRule   .(gif|jpg|png)$   - [F]  #禁止访问</p>\n<h2 id=\"如果文件不存在重定向到404页面\"><a href=\"#如果文件不存在重定向到404页面\" class=\"headerlink\" title=\"如果文件不存在重定向到404页面\"></a>如果文件不存在重定向到404页面</h2><pre><code>RewriteCond   %&#123;REQUEST_FILENAME&#125;   !-f  # 如果访问的不是一个文件\nRewriteCond   %&#123;REQUEST_FILENAME&#125;   !-d  #如果访问的不是一个目录\nRewriteRule   .?   /404.php   [L]   #跳转到网站根目录\n# 也可携带参数\n#RewriteRule ^/?(.*)$ /404.php?url=$1 [L]\n</code></pre>\n"},{"title":"云主机硬盘扩容","abbrlink":"18f37986","date":"2024-01-03T04:52:02.000Z","_content":"\n# 1.查看分区容量是否增加\n\n    lsblk\n    \n# 2. 扩容MBR分区和ext4文件系统\n \n## 第一步\n    #redhat类系统\n    type growpart || sudo yum install -y cloud-utils-growpart\n    \n    #debian类系统\n    type growpart || sudo apt-get install -y cloud-guest-utils\n## 第二步 扩展分区   \n    sudo LC_ALL=en_US.UTF-8 growpart /dev/vdb 1\n\n## 第三步   扩展文件系统\n\n    sudo resize2fs /dev/vdb1\n    \n# 3. 扩容GPT分区和xfs文件系统\n    \n## 第一步\n    sudo apt-get update\n    type growpart || sudo apt-get install -y cloud-guest-utils\n    \n    type sgdisk || sudo yum install -y gdisk\n## 第二步  扩展分区 \n    # 扩容分区\n    sudo LC_ALL=en_US.UTF-8 growpart /dev/vdb 2\n## 第三步   展文件系统    \n    #扩容文件系统\n    type xfs_growfs || sudo yum install -y xfsprogs\n    sudo xfs_growfs /mnt\n    \n# 裸数据盘\n\n    无分区结构\n        未划分逻辑分区（如 /dev/vdb1、/dev/vdb2），直接以设备名 /dev/vdb 作为操作对象。\n    无文件系统\n        未创建文件系统（如 ext4、XFS），需手动格式化才能存储文件。\n    直接访问物理扇区\n        应用程序可直接读写原始二进制数据，绕过文件系统层，适用于高性能数据库或分布式存储场景\n\n## 裸数据盘创建\n\n    使用 mkfs 命令创建文件系统（无需分区）：\n    sudo mkfs -t ext4 /dev/vdb  # ext4格式\n    # 或使用XFS\n    sudo mkfs -t xfs -f /dev/vdb  # -f强制覆盖现有文件系统\n\n## 扩容裸数据盘\n    sudo resize2fs /dev/vdb","source":"_posts/云主机硬盘扩容.md","raw":"---\ntitle: 云主机硬盘扩容\nabbrlink: 18f37986\ncategories:\n  - 服务器相关\ndate: 2024-01-03 12:52:02\ntags:\n---\n\n# 1.查看分区容量是否增加\n\n    lsblk\n    \n# 2. 扩容MBR分区和ext4文件系统\n \n## 第一步\n    #redhat类系统\n    type growpart || sudo yum install -y cloud-utils-growpart\n    \n    #debian类系统\n    type growpart || sudo apt-get install -y cloud-guest-utils\n## 第二步 扩展分区   \n    sudo LC_ALL=en_US.UTF-8 growpart /dev/vdb 1\n\n## 第三步   扩展文件系统\n\n    sudo resize2fs /dev/vdb1\n    \n# 3. 扩容GPT分区和xfs文件系统\n    \n## 第一步\n    sudo apt-get update\n    type growpart || sudo apt-get install -y cloud-guest-utils\n    \n    type sgdisk || sudo yum install -y gdisk\n## 第二步  扩展分区 \n    # 扩容分区\n    sudo LC_ALL=en_US.UTF-8 growpart /dev/vdb 2\n## 第三步   展文件系统    \n    #扩容文件系统\n    type xfs_growfs || sudo yum install -y xfsprogs\n    sudo xfs_growfs /mnt\n    \n# 裸数据盘\n\n    无分区结构\n        未划分逻辑分区（如 /dev/vdb1、/dev/vdb2），直接以设备名 /dev/vdb 作为操作对象。\n    无文件系统\n        未创建文件系统（如 ext4、XFS），需手动格式化才能存储文件。\n    直接访问物理扇区\n        应用程序可直接读写原始二进制数据，绕过文件系统层，适用于高性能数据库或分布式存储场景\n\n## 裸数据盘创建\n\n    使用 mkfs 命令创建文件系统（无需分区）：\n    sudo mkfs -t ext4 /dev/vdb  # ext4格式\n    # 或使用XFS\n    sudo mkfs -t xfs -f /dev/vdb  # -f强制覆盖现有文件系统\n\n## 扩容裸数据盘\n    sudo resize2fs /dev/vdb","slug":"云主机硬盘扩容","published":1,"updated":"2025-08-01T07:25:53.648Z","_id":"clxb4gv5a003cpcocb12d3xus","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"1-查看分区容量是否增加\"><a href=\"#1-查看分区容量是否增加\" class=\"headerlink\" title=\"1.查看分区容量是否增加\"></a>1.查看分区容量是否增加</h1><pre><code>lsblk\n</code></pre>\n<h1 id=\"2-扩容MBR分区和ext4文件系统\"><a href=\"#2-扩容MBR分区和ext4文件系统\" class=\"headerlink\" title=\"2. 扩容MBR分区和ext4文件系统\"></a>2. 扩容MBR分区和ext4文件系统</h1><h2 id=\"第一步\"><a href=\"#第一步\" class=\"headerlink\" title=\"第一步\"></a>第一步</h2><pre><code>#redhat类系统\ntype growpart || sudo yum install -y cloud-utils-growpart\n\n#debian类系统\ntype growpart || sudo apt-get install -y cloud-guest-utils\n</code></pre>\n<h2 id=\"第二步-扩展分区\"><a href=\"#第二步-扩展分区\" class=\"headerlink\" title=\"第二步 扩展分区\"></a>第二步 扩展分区</h2><pre><code>sudo LC_ALL=en_US.UTF-8 growpart /dev/vdb 1\n</code></pre>\n<h2 id=\"第三步-扩展文件系统\"><a href=\"#第三步-扩展文件系统\" class=\"headerlink\" title=\"第三步   扩展文件系统\"></a>第三步   扩展文件系统</h2><pre><code>sudo resize2fs /dev/vdb1\n</code></pre>\n<h1 id=\"3-扩容GPT分区和xfs文件系统\"><a href=\"#3-扩容GPT分区和xfs文件系统\" class=\"headerlink\" title=\"3. 扩容GPT分区和xfs文件系统\"></a>3. 扩容GPT分区和xfs文件系统</h1><h2 id=\"第一步-1\"><a href=\"#第一步-1\" class=\"headerlink\" title=\"第一步\"></a>第一步</h2><pre><code>sudo apt-get update\ntype growpart || sudo apt-get install -y cloud-guest-utils\n\ntype sgdisk || sudo yum install -y gdisk\n</code></pre>\n<h2 id=\"第二步-扩展分区-1\"><a href=\"#第二步-扩展分区-1\" class=\"headerlink\" title=\"第二步  扩展分区\"></a>第二步  扩展分区</h2><pre><code># 扩容分区\nsudo LC_ALL=en_US.UTF-8 growpart /dev/vdb 2\n</code></pre>\n<h2 id=\"第三步-展文件系统\"><a href=\"#第三步-展文件系统\" class=\"headerlink\" title=\"第三步   展文件系统\"></a>第三步   展文件系统</h2><pre><code>#扩容文件系统\ntype xfs_growfs || sudo yum install -y xfsprogs\nsudo xfs_growfs /mnt\n</code></pre>\n<h1 id=\"裸数据盘\"><a href=\"#裸数据盘\" class=\"headerlink\" title=\"裸数据盘\"></a>裸数据盘</h1><pre><code>无分区结构\n    未划分逻辑分区（如 /dev/vdb1、/dev/vdb2），直接以设备名 /dev/vdb 作为操作对象。\n无文件系统\n    未创建文件系统（如 ext4、XFS），需手动格式化才能存储文件。\n直接访问物理扇区\n    应用程序可直接读写原始二进制数据，绕过文件系统层，适用于高性能数据库或分布式存储场景\n</code></pre>\n<h2 id=\"裸数据盘创建\"><a href=\"#裸数据盘创建\" class=\"headerlink\" title=\"裸数据盘创建\"></a>裸数据盘创建</h2><pre><code>使用 mkfs 命令创建文件系统（无需分区）：\nsudo mkfs -t ext4 /dev/vdb  # ext4格式\n# 或使用XFS\nsudo mkfs -t xfs -f /dev/vdb  # -f强制覆盖现有文件系统\n</code></pre>\n<h2 id=\"扩容裸数据盘\"><a href=\"#扩容裸数据盘\" class=\"headerlink\" title=\"扩容裸数据盘\"></a>扩容裸数据盘</h2><pre><code>sudo resize2fs /dev/vdb\n</code></pre>\n","site":{"data":{}},"length":754,"excerpt":"","more":"<h1 id=\"1-查看分区容量是否增加\"><a href=\"#1-查看分区容量是否增加\" class=\"headerlink\" title=\"1.查看分区容量是否增加\"></a>1.查看分区容量是否增加</h1><pre><code>lsblk\n</code></pre>\n<h1 id=\"2-扩容MBR分区和ext4文件系统\"><a href=\"#2-扩容MBR分区和ext4文件系统\" class=\"headerlink\" title=\"2. 扩容MBR分区和ext4文件系统\"></a>2. 扩容MBR分区和ext4文件系统</h1><h2 id=\"第一步\"><a href=\"#第一步\" class=\"headerlink\" title=\"第一步\"></a>第一步</h2><pre><code>#redhat类系统\ntype growpart || sudo yum install -y cloud-utils-growpart\n\n#debian类系统\ntype growpart || sudo apt-get install -y cloud-guest-utils\n</code></pre>\n<h2 id=\"第二步-扩展分区\"><a href=\"#第二步-扩展分区\" class=\"headerlink\" title=\"第二步 扩展分区\"></a>第二步 扩展分区</h2><pre><code>sudo LC_ALL=en_US.UTF-8 growpart /dev/vdb 1\n</code></pre>\n<h2 id=\"第三步-扩展文件系统\"><a href=\"#第三步-扩展文件系统\" class=\"headerlink\" title=\"第三步   扩展文件系统\"></a>第三步   扩展文件系统</h2><pre><code>sudo resize2fs /dev/vdb1\n</code></pre>\n<h1 id=\"3-扩容GPT分区和xfs文件系统\"><a href=\"#3-扩容GPT分区和xfs文件系统\" class=\"headerlink\" title=\"3. 扩容GPT分区和xfs文件系统\"></a>3. 扩容GPT分区和xfs文件系统</h1><h2 id=\"第一步-1\"><a href=\"#第一步-1\" class=\"headerlink\" title=\"第一步\"></a>第一步</h2><pre><code>sudo apt-get update\ntype growpart || sudo apt-get install -y cloud-guest-utils\n\ntype sgdisk || sudo yum install -y gdisk\n</code></pre>\n<h2 id=\"第二步-扩展分区-1\"><a href=\"#第二步-扩展分区-1\" class=\"headerlink\" title=\"第二步  扩展分区\"></a>第二步  扩展分区</h2><pre><code># 扩容分区\nsudo LC_ALL=en_US.UTF-8 growpart /dev/vdb 2\n</code></pre>\n<h2 id=\"第三步-展文件系统\"><a href=\"#第三步-展文件系统\" class=\"headerlink\" title=\"第三步   展文件系统\"></a>第三步   展文件系统</h2><pre><code>#扩容文件系统\ntype xfs_growfs || sudo yum install -y xfsprogs\nsudo xfs_growfs /mnt\n</code></pre>\n<h1 id=\"裸数据盘\"><a href=\"#裸数据盘\" class=\"headerlink\" title=\"裸数据盘\"></a>裸数据盘</h1><pre><code>无分区结构\n    未划分逻辑分区（如 /dev/vdb1、/dev/vdb2），直接以设备名 /dev/vdb 作为操作对象。\n无文件系统\n    未创建文件系统（如 ext4、XFS），需手动格式化才能存储文件。\n直接访问物理扇区\n    应用程序可直接读写原始二进制数据，绕过文件系统层，适用于高性能数据库或分布式存储场景\n</code></pre>\n<h2 id=\"裸数据盘创建\"><a href=\"#裸数据盘创建\" class=\"headerlink\" title=\"裸数据盘创建\"></a>裸数据盘创建</h2><pre><code>使用 mkfs 命令创建文件系统（无需分区）：\nsudo mkfs -t ext4 /dev/vdb  # ext4格式\n# 或使用XFS\nsudo mkfs -t xfs -f /dev/vdb  # -f强制覆盖现有文件系统\n</code></pre>\n<h2 id=\"扩容裸数据盘\"><a href=\"#扩容裸数据盘\" class=\"headerlink\" title=\"扩容裸数据盘\"></a>扩容裸数据盘</h2><pre><code>sudo resize2fs /dev/vdb\n</code></pre>\n"},{"title":"奇怪问题总结","abbrlink":"c6f6fc00","date":"2023-11-12T11:48:14.000Z","_content":"#奇怪的问题\n\n\n## 无法访问php文件，总是报错 file not found\n\n    解决思路\n        \n        1.首先查询 文件是否存在\n        2.查询nginx php访问的配置\n        3.关闭selinux \n        \n \n ## 配置ssh 免密码 登录总是提示需要输入密码\n \n    解决思路\n    \n        1.排查下authorized_keys 是否存在key\n        2.排查/etc/sshd/sshd_config下是否关闭了 证书登录【PubkeyAuthentication no】\n        \n ## nohup 命令 & 运行后 关闭SSH 还是 存在问题\n \n    disown -h %1\n    \n## sysctl -p 后 docker mysql就无法连接了\n\n    重启服务器就可以了\n    \n## php74 容器中crontab\n    \n    crond  \n    ps -ef|grep crond    \n\n     ","source":"_posts/奇怪问题总结.md","raw":"---\ntitle: 奇怪问题总结\nabbrlink: c6f6fc00\ndate: 2023-11-12 19:48:14\ntags:\n---\n#奇怪的问题\n\n\n## 无法访问php文件，总是报错 file not found\n\n    解决思路\n        \n        1.首先查询 文件是否存在\n        2.查询nginx php访问的配置\n        3.关闭selinux \n        \n \n ## 配置ssh 免密码 登录总是提示需要输入密码\n \n    解决思路\n    \n        1.排查下authorized_keys 是否存在key\n        2.排查/etc/sshd/sshd_config下是否关闭了 证书登录【PubkeyAuthentication no】\n        \n ## nohup 命令 & 运行后 关闭SSH 还是 存在问题\n \n    disown -h %1\n    \n## sysctl -p 后 docker mysql就无法连接了\n\n    重启服务器就可以了\n    \n## php74 容器中crontab\n    \n    crond  \n    ps -ef|grep crond    \n\n     ","slug":"奇怪问题总结","published":1,"updated":"2024-08-15T07:52:07.205Z","_id":"clxb4gv5a003epcocgbgqadg3","comments":1,"layout":"post","photos":[],"link":"","content":"<p>#奇怪的问题</p>\n<h2 id=\"无法访问php文件，总是报错-file-not-found\"><a href=\"#无法访问php文件，总是报错-file-not-found\" class=\"headerlink\" title=\"无法访问php文件，总是报错 file not found\"></a>无法访问php文件，总是报错 file not found</h2><pre><code>解决思路\n    \n    1.首先查询 文件是否存在\n    2.查询nginx php访问的配置\n    3.关闭selinux \n    \n</code></pre>\n<h2 id=\"配置ssh-免密码-登录总是提示需要输入密码\"><a href=\"#配置ssh-免密码-登录总是提示需要输入密码\" class=\"headerlink\" title=\"配置ssh 免密码 登录总是提示需要输入密码\"></a>配置ssh 免密码 登录总是提示需要输入密码</h2><pre><code>解决思路\n\n    1.排查下authorized_keys 是否存在key\n    2.排查/etc/sshd/sshd_config下是否关闭了 证书登录【PubkeyAuthentication no】\n    \n</code></pre>\n<h2 id=\"nohup-命令-amp-运行后-关闭SSH-还是-存在问题\"><a href=\"#nohup-命令-amp-运行后-关闭SSH-还是-存在问题\" class=\"headerlink\" title=\"nohup 命令 &amp; 运行后 关闭SSH 还是 存在问题\"></a>nohup 命令 &amp; 运行后 关闭SSH 还是 存在问题</h2><pre><code>disown -h %1\n</code></pre>\n<h2 id=\"sysctl-p-后-docker-mysql就无法连接了\"><a href=\"#sysctl-p-后-docker-mysql就无法连接了\" class=\"headerlink\" title=\"sysctl -p 后 docker mysql就无法连接了\"></a>sysctl -p 后 docker mysql就无法连接了</h2><pre><code>重启服务器就可以了\n</code></pre>\n<h2 id=\"php74-容器中crontab\"><a href=\"#php74-容器中crontab\" class=\"headerlink\" title=\"php74 容器中crontab\"></a>php74 容器中crontab</h2><pre><code>crond  \nps -ef|grep crond    \n\n \n</code></pre>\n","site":{"data":{}},"length":292,"excerpt":"","more":"<p>#奇怪的问题</p>\n<h2 id=\"无法访问php文件，总是报错-file-not-found\"><a href=\"#无法访问php文件，总是报错-file-not-found\" class=\"headerlink\" title=\"无法访问php文件，总是报错 file not found\"></a>无法访问php文件，总是报错 file not found</h2><pre><code>解决思路\n    \n    1.首先查询 文件是否存在\n    2.查询nginx php访问的配置\n    3.关闭selinux \n    \n</code></pre>\n<h2 id=\"配置ssh-免密码-登录总是提示需要输入密码\"><a href=\"#配置ssh-免密码-登录总是提示需要输入密码\" class=\"headerlink\" title=\"配置ssh 免密码 登录总是提示需要输入密码\"></a>配置ssh 免密码 登录总是提示需要输入密码</h2><pre><code>解决思路\n\n    1.排查下authorized_keys 是否存在key\n    2.排查/etc/sshd/sshd_config下是否关闭了 证书登录【PubkeyAuthentication no】\n    \n</code></pre>\n<h2 id=\"nohup-命令-amp-运行后-关闭SSH-还是-存在问题\"><a href=\"#nohup-命令-amp-运行后-关闭SSH-还是-存在问题\" class=\"headerlink\" title=\"nohup 命令 &amp; 运行后 关闭SSH 还是 存在问题\"></a>nohup 命令 &amp; 运行后 关闭SSH 还是 存在问题</h2><pre><code>disown -h %1\n</code></pre>\n<h2 id=\"sysctl-p-后-docker-mysql就无法连接了\"><a href=\"#sysctl-p-后-docker-mysql就无法连接了\" class=\"headerlink\" title=\"sysctl -p 后 docker mysql就无法连接了\"></a>sysctl -p 后 docker mysql就无法连接了</h2><pre><code>重启服务器就可以了\n</code></pre>\n<h2 id=\"php74-容器中crontab\"><a href=\"#php74-容器中crontab\" class=\"headerlink\" title=\"php74 容器中crontab\"></a>php74 容器中crontab</h2><pre><code>crond  \nps -ef|grep crond    \n\n \n</code></pre>\n"},{"title":"普通心理学笔记1","abbrlink":"257fa2ac","date":"2021-12-21T12:17:10.000Z","_content":"#心理学\n    \n    心理学研究行为和心理过程\n    一门多个专业领域的的科学\n\n#心理学三大分支\n\n    实验心理学 \n        实验心理学家 最少的\n    心理学教学\n        心理学教师\n    应用心理学\n        工业与组织心理学家\n        运动心里学家\n        学校心理学家\n        临床和咨询心理学家\n        法医心理学家\n        环境心理学家\n\n#心理学与精神病学区别\n    \n    精神病学是医学 接受过治疗精神与行为疾病的训练\n    具有开具处方的执照\n    从医学角度看问题\n\n    心理学关注更为广泛 人类的行为和心理过程\n    大脑功能到社会交往\n    心里健康到心理障碍\n    心理学角度 来访者\n\n\n#批判性思考技巧\n    \n    1.其来源出自哪里 问题的来源\n\n        提出问题的人 是否擅长啊\n        由于什么原因 提出了这个问题\n\n    2.这个观点是合理的还是极端的\n\n    3.证据是什么\n\n    4.是否有影响结论的偏差\n        验证性偏差 只记得验证成功的那一面\n\n    5.推理是否避开了常见谬误\n        避免 常识\n\n    6.看待这个问题是否需要多种角度\n    \n    \n    ","source":"_posts/普通心理学笔记1.md","raw":"---\ntitle: 普通心理学笔记1\ncategories:\n  - 心理学\nabbrlink: 257fa2ac\ndate: 2021-12-21 20:17:10\ntags:\n---\n#心理学\n    \n    心理学研究行为和心理过程\n    一门多个专业领域的的科学\n\n#心理学三大分支\n\n    实验心理学 \n        实验心理学家 最少的\n    心理学教学\n        心理学教师\n    应用心理学\n        工业与组织心理学家\n        运动心里学家\n        学校心理学家\n        临床和咨询心理学家\n        法医心理学家\n        环境心理学家\n\n#心理学与精神病学区别\n    \n    精神病学是医学 接受过治疗精神与行为疾病的训练\n    具有开具处方的执照\n    从医学角度看问题\n\n    心理学关注更为广泛 人类的行为和心理过程\n    大脑功能到社会交往\n    心里健康到心理障碍\n    心理学角度 来访者\n\n\n#批判性思考技巧\n    \n    1.其来源出自哪里 问题的来源\n\n        提出问题的人 是否擅长啊\n        由于什么原因 提出了这个问题\n\n    2.这个观点是合理的还是极端的\n\n    3.证据是什么\n\n    4.是否有影响结论的偏差\n        验证性偏差 只记得验证成功的那一面\n\n    5.推理是否避开了常见谬误\n        避免 常识\n\n    6.看待这个问题是否需要多种角度\n    \n    \n    ","slug":"普通心理学笔记1","published":1,"updated":"2024-02-06T05:50:35.003Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv5c003jpcoc5og807bd","content":"<p>#心理学</p>\n<pre><code>心理学研究行为和心理过程\n一门多个专业领域的的科学\n</code></pre>\n<p>#心理学三大分支</p>\n<pre><code>实验心理学 \n    实验心理学家 最少的\n心理学教学\n    心理学教师\n应用心理学\n    工业与组织心理学家\n    运动心里学家\n    学校心理学家\n    临床和咨询心理学家\n    法医心理学家\n    环境心理学家\n</code></pre>\n<p>#心理学与精神病学区别</p>\n<pre><code>精神病学是医学 接受过治疗精神与行为疾病的训练\n具有开具处方的执照\n从医学角度看问题\n\n心理学关注更为广泛 人类的行为和心理过程\n大脑功能到社会交往\n心里健康到心理障碍\n心理学角度 来访者\n</code></pre>\n<p>#批判性思考技巧</p>\n<pre><code>1.其来源出自哪里 问题的来源\n\n    提出问题的人 是否擅长啊\n    由于什么原因 提出了这个问题\n\n2.这个观点是合理的还是极端的\n\n3.证据是什么\n\n4.是否有影响结论的偏差\n    验证性偏差 只记得验证成功的那一面\n\n5.推理是否避开了常见谬误\n    避免 常识\n\n6.看待这个问题是否需要多种角度\n</code></pre>\n","site":{"data":{}},"length":331,"excerpt":"","more":"<p>#心理学</p>\n<pre><code>心理学研究行为和心理过程\n一门多个专业领域的的科学\n</code></pre>\n<p>#心理学三大分支</p>\n<pre><code>实验心理学 \n    实验心理学家 最少的\n心理学教学\n    心理学教师\n应用心理学\n    工业与组织心理学家\n    运动心里学家\n    学校心理学家\n    临床和咨询心理学家\n    法医心理学家\n    环境心理学家\n</code></pre>\n<p>#心理学与精神病学区别</p>\n<pre><code>精神病学是医学 接受过治疗精神与行为疾病的训练\n具有开具处方的执照\n从医学角度看问题\n\n心理学关注更为广泛 人类的行为和心理过程\n大脑功能到社会交往\n心里健康到心理障碍\n心理学角度 来访者\n</code></pre>\n<p>#批判性思考技巧</p>\n<pre><code>1.其来源出自哪里 问题的来源\n\n    提出问题的人 是否擅长啊\n    由于什么原因 提出了这个问题\n\n2.这个观点是合理的还是极端的\n\n3.证据是什么\n\n4.是否有影响结论的偏差\n    验证性偏差 只记得验证成功的那一面\n\n5.推理是否避开了常见谬误\n    避免 常识\n\n6.看待这个问题是否需要多种角度\n</code></pre>\n"},{"title":"普通心理学笔记2","abbrlink":"bc76f316","date":"2021-12-21T13:05:13.000Z","_content":"\n# 现代心理学6个视角\n\n    起源：古希腊哲学家 苏格拉底 柏拉图 亚里士多德 意识和疯癫的理解\n    亚洲和非洲 瑜伽和佛教 探索意识 通过冥想控制意识\n    天主教\n    1.生物视角\n        \n        大脑、神经系统、内分泌系统（激素）和基因        笛卡尔\n\n    2.认知视角\n\n        每个人有各自的知觉模式、解释、预期、信念和记忆   威廉。冯特 威廉詹姆斯     \n        \n    3.行为视角\n        \n        环境的刺激和先前行为的结果                   约翰。华生 斯金纳\n\n    4.全人视角                                   弗洛伊德 古希腊   \n        \n        心理动力：无意识心理的过程\n        人本主义\n        特质和气质：\n\n    5.发展视角                                   安斯沃思\n\n        遗传和环境的交互作用，在毕生发展中塑造\n        \n    6.社会文化视角                                津巴多\n        \n        环境的影响。社会和文化比其他因素更能决定行为\n\n笛卡尔 精神和肉体是分离的  由此生物学视角诞生\n\n生物学主题\n    \n    神经科学\n    进化心理学\n\n德国科学家  威廉 冯特 |内省法  格式塔心理学家\n    \n    科学心理学和现代认知视角的建立\n    元素周期表  研究自然世界的科学方法  结构主义\n    纳克立方体","source":"_posts/普通心理学笔记2.md","raw":"---\ntitle: 普通心理学笔记2\ncategories:\n  - 心理学\nabbrlink: bc76f316\ndate: 2021-12-21 21:05:13\ntags:\n---\n\n# 现代心理学6个视角\n\n    起源：古希腊哲学家 苏格拉底 柏拉图 亚里士多德 意识和疯癫的理解\n    亚洲和非洲 瑜伽和佛教 探索意识 通过冥想控制意识\n    天主教\n    1.生物视角\n        \n        大脑、神经系统、内分泌系统（激素）和基因        笛卡尔\n\n    2.认知视角\n\n        每个人有各自的知觉模式、解释、预期、信念和记忆   威廉。冯特 威廉詹姆斯     \n        \n    3.行为视角\n        \n        环境的刺激和先前行为的结果                   约翰。华生 斯金纳\n\n    4.全人视角                                   弗洛伊德 古希腊   \n        \n        心理动力：无意识心理的过程\n        人本主义\n        特质和气质：\n\n    5.发展视角                                   安斯沃思\n\n        遗传和环境的交互作用，在毕生发展中塑造\n        \n    6.社会文化视角                                津巴多\n        \n        环境的影响。社会和文化比其他因素更能决定行为\n\n笛卡尔 精神和肉体是分离的  由此生物学视角诞生\n\n生物学主题\n    \n    神经科学\n    进化心理学\n\n德国科学家  威廉 冯特 |内省法  格式塔心理学家\n    \n    科学心理学和现代认知视角的建立\n    元素周期表  研究自然世界的科学方法  结构主义\n    纳克立方体","slug":"普通心理学笔记2","published":1,"updated":"2024-02-06T05:50:35.020Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv5h003opcocdhl9dnff","content":"<h1 id=\"现代心理学6个视角\"><a href=\"#现代心理学6个视角\" class=\"headerlink\" title=\"现代心理学6个视角\"></a>现代心理学6个视角</h1><pre><code>起源：古希腊哲学家 苏格拉底 柏拉图 亚里士多德 意识和疯癫的理解\n亚洲和非洲 瑜伽和佛教 探索意识 通过冥想控制意识\n天主教\n1.生物视角\n    \n    大脑、神经系统、内分泌系统（激素）和基因        笛卡尔\n\n2.认知视角\n\n    每个人有各自的知觉模式、解释、预期、信念和记忆   威廉。冯特 威廉詹姆斯     \n    \n3.行为视角\n    \n    环境的刺激和先前行为的结果                   约翰。华生 斯金纳\n\n4.全人视角                                   弗洛伊德 古希腊   \n    \n    心理动力：无意识心理的过程\n    人本主义\n    特质和气质：\n\n5.发展视角                                   安斯沃思\n\n    遗传和环境的交互作用，在毕生发展中塑造\n    \n6.社会文化视角                                津巴多\n    \n    环境的影响。社会和文化比其他因素更能决定行为\n</code></pre>\n<p>笛卡尔 精神和肉体是分离的  由此生物学视角诞生</p>\n<p>生物学主题</p>\n<pre><code>神经科学\n进化心理学\n</code></pre>\n<p>德国科学家  威廉 冯特 |内省法  格式塔心理学家</p>\n<pre><code>科学心理学和现代认知视角的建立\n元素周期表  研究自然世界的科学方法  结构主义\n纳克立方体\n</code></pre>\n","site":{"data":{}},"length":351,"excerpt":"","more":"<h1 id=\"现代心理学6个视角\"><a href=\"#现代心理学6个视角\" class=\"headerlink\" title=\"现代心理学6个视角\"></a>现代心理学6个视角</h1><pre><code>起源：古希腊哲学家 苏格拉底 柏拉图 亚里士多德 意识和疯癫的理解\n亚洲和非洲 瑜伽和佛教 探索意识 通过冥想控制意识\n天主教\n1.生物视角\n    \n    大脑、神经系统、内分泌系统（激素）和基因        笛卡尔\n\n2.认知视角\n\n    每个人有各自的知觉模式、解释、预期、信念和记忆   威廉。冯特 威廉詹姆斯     \n    \n3.行为视角\n    \n    环境的刺激和先前行为的结果                   约翰。华生 斯金纳\n\n4.全人视角                                   弗洛伊德 古希腊   \n    \n    心理动力：无意识心理的过程\n    人本主义\n    特质和气质：\n\n5.发展视角                                   安斯沃思\n\n    遗传和环境的交互作用，在毕生发展中塑造\n    \n6.社会文化视角                                津巴多\n    \n    环境的影响。社会和文化比其他因素更能决定行为\n</code></pre>\n<p>笛卡尔 精神和肉体是分离的  由此生物学视角诞生</p>\n<p>生物学主题</p>\n<pre><code>神经科学\n进化心理学\n</code></pre>\n<p>德国科学家  威廉 冯特 |内省法  格式塔心理学家</p>\n<pre><code>科学心理学和现代认知视角的建立\n元素周期表  研究自然世界的科学方法  结构主义\n纳克立方体\n</code></pre>\n"},{"title":"特殊的SQL语句","abbrlink":"ee8708d7","date":"2023-11-08T09:54:07.000Z","_content":"\n# 使用逗号分割拆分\n\n查询出field字段中有value的记录\nSELECT * FROM table WHERE FIND_IN_SET('value', field)>0\n    \n FIND_IN_SET('value', field)<font color=Red>>0</font>  查询的是字段中<font color=Red>包含了</font>查询字符value的\n FIND_IN_SET('value', field)<font color=Red>=0</font>   查询的是字段中<font color=Red>不包含</font>了查询字符value的\n \n \n \n# SUBSTRING_INDEX 函数\n \n \n \nstring：用于截取目标字符串的字符串。可为字段，表达式等。\n\nsep：分隔符，string存在且用于分割的字符，比如“，”、“.”等。\n\nnum：序号 <font color=Red>负数 从右边取   正数从左边取 取几个值</font>\n \n示例 field  a1,b2,c3  \nSUBSTRING_INDEX(field, ',', 1) 取值就是 a1\n<font color=Red>SUBSTRING_INDEX(field, ',', 2) 取值就是 a1,b2</font>\n\n<font color=Red>根据，分割拆分多条数据sql：</font>\n\n    SELECT SUBSTRING_INDEX(field, ',', 1) AS value1,\n        SUBSTRING_INDEX(SUBSTRING_INDEX(field, ',', 2), ',', -1) AS value2,\n        SUBSTRING_INDEX(SUBSTRING_INDEX(field, ',', 3), ',', -1) AS value3\n        SUBSTRING_INDEX(field, ',', -1) AS value4\n    FROM table\n \n## 根据，隔开字段 分组统计\n\n\n根据，隔开字段拆分成多行数据 多会拆分成3行了\n\nSELECT SUBSTRING_INDEX(SUBSTRING_INDEX(comInputField163, ',',numbers.n), ',', -1) AS tag ,numbers.n,a.*\n      #,COUNT(*) AS count\nFROM mida_gd_2023101116015948 a\nJOIN (\n  SELECT 1 AS n UNION ALL SELECT 2 UNION ALL SELECT 3                                   <font color=Red>#这边SELECT 数 根据，隔开最多项来，写到SELECT 5只有数据中只有2项它也要关联5个出来</font>\n) AS numbers\nWHERE CHAR_LENGTH(comInputField163) - CHAR_LENGTH(REPLACE(comInputField163, ',', '')) >= numbers.n-1  #通过这个来限制,<font color=Red>统计，数量</font> 判断需要几个\nGROUP BY tag;\n \n \n# 两表连接的SQL语句\n\n\nselect A.c1,A.c2,B.c1,B.c2\nfrom table1 A,table2 B\nwhere A.id=B.id\n\nselect A.c1,A.c2,B.c1,B.c2\nfrom table1 A join table2 B\non A.id=B.id\n\nselect A.c1,A.c2,B.c1,B.c2\nfrom table1 A inner join table2 B\non A.id=B.id\n\n\njoin on与inner join on是相同\n\n默认JOIN就是指的INNER JOIN\n\n内连接推荐 join 方式 通过where 的方式 性能较差\n有的数据库底层 认为是交叉 连接\n\n","source":"_posts/特殊的SQL语句.md","raw":"---\ntitle: 特殊的SQL语句\nabbrlink: ee8708d7\ncategories:\n  - mysql\ndate: 2023-11-08 17:54:07\ntags:\n---\n\n# 使用逗号分割拆分\n\n查询出field字段中有value的记录\nSELECT * FROM table WHERE FIND_IN_SET('value', field)>0\n    \n FIND_IN_SET('value', field)<font color=Red>>0</font>  查询的是字段中<font color=Red>包含了</font>查询字符value的\n FIND_IN_SET('value', field)<font color=Red>=0</font>   查询的是字段中<font color=Red>不包含</font>了查询字符value的\n \n \n \n# SUBSTRING_INDEX 函数\n \n \n \nstring：用于截取目标字符串的字符串。可为字段，表达式等。\n\nsep：分隔符，string存在且用于分割的字符，比如“，”、“.”等。\n\nnum：序号 <font color=Red>负数 从右边取   正数从左边取 取几个值</font>\n \n示例 field  a1,b2,c3  \nSUBSTRING_INDEX(field, ',', 1) 取值就是 a1\n<font color=Red>SUBSTRING_INDEX(field, ',', 2) 取值就是 a1,b2</font>\n\n<font color=Red>根据，分割拆分多条数据sql：</font>\n\n    SELECT SUBSTRING_INDEX(field, ',', 1) AS value1,\n        SUBSTRING_INDEX(SUBSTRING_INDEX(field, ',', 2), ',', -1) AS value2,\n        SUBSTRING_INDEX(SUBSTRING_INDEX(field, ',', 3), ',', -1) AS value3\n        SUBSTRING_INDEX(field, ',', -1) AS value4\n    FROM table\n \n## 根据，隔开字段 分组统计\n\n\n根据，隔开字段拆分成多行数据 多会拆分成3行了\n\nSELECT SUBSTRING_INDEX(SUBSTRING_INDEX(comInputField163, ',',numbers.n), ',', -1) AS tag ,numbers.n,a.*\n      #,COUNT(*) AS count\nFROM mida_gd_2023101116015948 a\nJOIN (\n  SELECT 1 AS n UNION ALL SELECT 2 UNION ALL SELECT 3                                   <font color=Red>#这边SELECT 数 根据，隔开最多项来，写到SELECT 5只有数据中只有2项它也要关联5个出来</font>\n) AS numbers\nWHERE CHAR_LENGTH(comInputField163) - CHAR_LENGTH(REPLACE(comInputField163, ',', '')) >= numbers.n-1  #通过这个来限制,<font color=Red>统计，数量</font> 判断需要几个\nGROUP BY tag;\n \n \n# 两表连接的SQL语句\n\n\nselect A.c1,A.c2,B.c1,B.c2\nfrom table1 A,table2 B\nwhere A.id=B.id\n\nselect A.c1,A.c2,B.c1,B.c2\nfrom table1 A join table2 B\non A.id=B.id\n\nselect A.c1,A.c2,B.c1,B.c2\nfrom table1 A inner join table2 B\non A.id=B.id\n\n\njoin on与inner join on是相同\n\n默认JOIN就是指的INNER JOIN\n\n内连接推荐 join 方式 通过where 的方式 性能较差\n有的数据库底层 认为是交叉 连接\n\n","slug":"特殊的SQL语句","published":1,"updated":"2024-11-25T11:29:42.641Z","_id":"clxb4gv5i003ppcocezx48n1z","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"使用逗号分割拆分\"><a href=\"#使用逗号分割拆分\" class=\"headerlink\" title=\"使用逗号分割拆分\"></a>使用逗号分割拆分</h1><p>查询出field字段中有value的记录<br>SELECT * FROM table WHERE FIND_IN_SET(‘value’, field)&gt;0</p>\n<p> FIND_IN_SET(‘value’, field)<font color=Red>&gt;0</font>  查询的是字段中<font color=Red>包含了</font>查询字符value的<br> FIND_IN_SET(‘value’, field)<font color=Red>=0</font>   查询的是字段中<font color=Red>不包含</font>了查询字符value的</p>\n<h1 id=\"SUBSTRING-INDEX-函数\"><a href=\"#SUBSTRING-INDEX-函数\" class=\"headerlink\" title=\"SUBSTRING_INDEX 函数\"></a>SUBSTRING_INDEX 函数</h1><p>string：用于截取目标字符串的字符串。可为字段，表达式等。</p>\n<p>sep：分隔符，string存在且用于分割的字符，比如“，”、“.”等。</p>\n<p>num：序号 <font color=Red>负数 从右边取   正数从左边取 取几个值</font></p>\n<p>示例 field  a1,b2,c3<br>SUBSTRING_INDEX(field, ‘,’, 1) 取值就是 a1<br><font color=Red>SUBSTRING_INDEX(field, ‘,’, 2) 取值就是 a1,b2</font></p>\n<p><font color=Red>根据，分割拆分多条数据sql：</font></p>\n<pre><code>SELECT SUBSTRING_INDEX(field, &#39;,&#39;, 1) AS value1,\n    SUBSTRING_INDEX(SUBSTRING_INDEX(field, &#39;,&#39;, 2), &#39;,&#39;, -1) AS value2,\n    SUBSTRING_INDEX(SUBSTRING_INDEX(field, &#39;,&#39;, 3), &#39;,&#39;, -1) AS value3\n    SUBSTRING_INDEX(field, &#39;,&#39;, -1) AS value4\nFROM table\n</code></pre>\n<h2 id=\"根据，隔开字段-分组统计\"><a href=\"#根据，隔开字段-分组统计\" class=\"headerlink\" title=\"根据，隔开字段 分组统计\"></a>根据，隔开字段 分组统计</h2><p>根据，隔开字段拆分成多行数据 多会拆分成3行了</p>\n<p>SELECT SUBSTRING_INDEX(SUBSTRING_INDEX(comInputField163, ‘,’,numbers.n), ‘,’, -1) AS tag ,numbers.n,a.*<br>      #,COUNT(*) AS count<br>FROM mida_gd_2023101116015948 a<br>JOIN (<br>  SELECT 1 AS n UNION ALL SELECT 2 UNION ALL SELECT 3                                   <font color=Red>#这边SELECT 数 根据，隔开最多项来，写到SELECT 5只有数据中只有2项它也要关联5个出来</font><br>) AS numbers<br>WHERE CHAR_LENGTH(comInputField163) - CHAR_LENGTH(REPLACE(comInputField163, ‘,’, ‘’)) &gt;= numbers.n-1  #通过这个来限制,<font color=Red>统计，数量</font> 判断需要几个<br>GROUP BY tag;</p>\n<h1 id=\"两表连接的SQL语句\"><a href=\"#两表连接的SQL语句\" class=\"headerlink\" title=\"两表连接的SQL语句\"></a>两表连接的SQL语句</h1><p>select A.c1,A.c2,B.c1,B.c2<br>from table1 A,table2 B<br>where A.id=B.id</p>\n<p>select A.c1,A.c2,B.c1,B.c2<br>from table1 A join table2 B<br>on A.id=B.id</p>\n<p>select A.c1,A.c2,B.c1,B.c2<br>from table1 A inner join table2 B<br>on A.id=B.id</p>\n<p>join on与inner join on是相同</p>\n<p>默认JOIN就是指的INNER JOIN</p>\n<p>内连接推荐 join 方式 通过where 的方式 性能较差<br>有的数据库底层 认为是交叉 连接</p>\n","site":{"data":{}},"length":1317,"excerpt":"","more":"<h1 id=\"使用逗号分割拆分\"><a href=\"#使用逗号分割拆分\" class=\"headerlink\" title=\"使用逗号分割拆分\"></a>使用逗号分割拆分</h1><p>查询出field字段中有value的记录<br>SELECT * FROM table WHERE FIND_IN_SET(‘value’, field)&gt;0</p>\n<p> FIND_IN_SET(‘value’, field)<font color=Red>&gt;0</font>  查询的是字段中<font color=Red>包含了</font>查询字符value的<br> FIND_IN_SET(‘value’, field)<font color=Red>=0</font>   查询的是字段中<font color=Red>不包含</font>了查询字符value的</p>\n<h1 id=\"SUBSTRING-INDEX-函数\"><a href=\"#SUBSTRING-INDEX-函数\" class=\"headerlink\" title=\"SUBSTRING_INDEX 函数\"></a>SUBSTRING_INDEX 函数</h1><p>string：用于截取目标字符串的字符串。可为字段，表达式等。</p>\n<p>sep：分隔符，string存在且用于分割的字符，比如“，”、“.”等。</p>\n<p>num：序号 <font color=Red>负数 从右边取   正数从左边取 取几个值</font></p>\n<p>示例 field  a1,b2,c3<br>SUBSTRING_INDEX(field, ‘,’, 1) 取值就是 a1<br><font color=Red>SUBSTRING_INDEX(field, ‘,’, 2) 取值就是 a1,b2</font></p>\n<p><font color=Red>根据，分割拆分多条数据sql：</font></p>\n<pre><code>SELECT SUBSTRING_INDEX(field, &#39;,&#39;, 1) AS value1,\n    SUBSTRING_INDEX(SUBSTRING_INDEX(field, &#39;,&#39;, 2), &#39;,&#39;, -1) AS value2,\n    SUBSTRING_INDEX(SUBSTRING_INDEX(field, &#39;,&#39;, 3), &#39;,&#39;, -1) AS value3\n    SUBSTRING_INDEX(field, &#39;,&#39;, -1) AS value4\nFROM table\n</code></pre>\n<h2 id=\"根据，隔开字段-分组统计\"><a href=\"#根据，隔开字段-分组统计\" class=\"headerlink\" title=\"根据，隔开字段 分组统计\"></a>根据，隔开字段 分组统计</h2><p>根据，隔开字段拆分成多行数据 多会拆分成3行了</p>\n<p>SELECT SUBSTRING_INDEX(SUBSTRING_INDEX(comInputField163, ‘,’,numbers.n), ‘,’, -1) AS tag ,numbers.n,a.*<br>      #,COUNT(*) AS count<br>FROM mida_gd_2023101116015948 a<br>JOIN (<br>  SELECT 1 AS n UNION ALL SELECT 2 UNION ALL SELECT 3                                   <font color=Red>#这边SELECT 数 根据，隔开最多项来，写到SELECT 5只有数据中只有2项它也要关联5个出来</font><br>) AS numbers<br>WHERE CHAR_LENGTH(comInputField163) - CHAR_LENGTH(REPLACE(comInputField163, ‘,’, ‘’)) &gt;= numbers.n-1  #通过这个来限制,<font color=Red>统计，数量</font> 判断需要几个<br>GROUP BY tag;</p>\n<h1 id=\"两表连接的SQL语句\"><a href=\"#两表连接的SQL语句\" class=\"headerlink\" title=\"两表连接的SQL语句\"></a>两表连接的SQL语句</h1><p>select A.c1,A.c2,B.c1,B.c2<br>from table1 A,table2 B<br>where A.id=B.id</p>\n<p>select A.c1,A.c2,B.c1,B.c2<br>from table1 A join table2 B<br>on A.id=B.id</p>\n<p>select A.c1,A.c2,B.c1,B.c2<br>from table1 A inner join table2 B<br>on A.id=B.id</p>\n<p>join on与inner join on是相同</p>\n<p>默认JOIN就是指的INNER JOIN</p>\n<p>内连接推荐 join 方式 通过where 的方式 性能较差<br>有的数据库底层 认为是交叉 连接</p>\n"},{"title":"vmvare-esxi虚拟机扩容","abbrlink":"a535b82c","date":"2023-08-28T06:55:16.000Z","_content":"\n# 一、虚拟机控制后台-修改硬盘大小\n\n    先虚拟机管理页面修改硬盘大小\n        注：不删除快照是 无法修改成功的\n   \n# 二、方案一【没法新建分区，就只能这么操作】\n扩展分区 最后一个分区\ngrowpart /dev/sda 4\n\n扩展 分区所在pv\npvresize /dev/sda4\n\n扩展 所在lv\nlvresize -l +100%FREE  /dev/centos/root\n\n\n扩展文件系统到新的磁盘空间。\n\n<font color=\"red\">ext3/ext4 文件系统</font>\n\nresize2fs /dev/centos/root\n\n<font color=\"red\">xfs文件系统</font>\nxfs_growfs  /dev/centos/root\n\n\n# 三、方案二\n \n分区  \n \n    fdisk /dev/sda    \n    n\n    p\n    默认确定\n    w\n\n\n手动同步磁盘到系统内核\n\n    partprobe\n    \n创建物理卷\n\n    pvcreate /dev/sda3          #【/dev/sda3 是根据fdisk来的】\n查看卷组\n\n    vgdisplay\n    \n添加物理卷（/dev/sda3）到卷组（centos）\n\n    vgextend centos /dev/sda3   #此处的centos根据vgdisplay查看得来\n    \n将空闲的空间都分配给root文件系统 \n  \n     lvextend -L +250G /dev/centos/root   【/dev/centos/root  就是要扩容的目录通过df 可查看】\n    \n对root文件系统执行扩容\n\n    xfs_growfs /dev/centos/root\n\n","source":"_posts/虚拟机扩容.md","raw":"---\ntitle: vmvare-esxi虚拟机扩容\ncategories:\n  - 服务器相关\nabbrlink: a535b82c\ndate: 2023-08-28 14:55:16\ntags:\n---\n\n# 一、虚拟机控制后台-修改硬盘大小\n\n    先虚拟机管理页面修改硬盘大小\n        注：不删除快照是 无法修改成功的\n   \n# 二、方案一【没法新建分区，就只能这么操作】\n扩展分区 最后一个分区\ngrowpart /dev/sda 4\n\n扩展 分区所在pv\npvresize /dev/sda4\n\n扩展 所在lv\nlvresize -l +100%FREE  /dev/centos/root\n\n\n扩展文件系统到新的磁盘空间。\n\n<font color=\"red\">ext3/ext4 文件系统</font>\n\nresize2fs /dev/centos/root\n\n<font color=\"red\">xfs文件系统</font>\nxfs_growfs  /dev/centos/root\n\n\n# 三、方案二\n \n分区  \n \n    fdisk /dev/sda    \n    n\n    p\n    默认确定\n    w\n\n\n手动同步磁盘到系统内核\n\n    partprobe\n    \n创建物理卷\n\n    pvcreate /dev/sda3          #【/dev/sda3 是根据fdisk来的】\n查看卷组\n\n    vgdisplay\n    \n添加物理卷（/dev/sda3）到卷组（centos）\n\n    vgextend centos /dev/sda3   #此处的centos根据vgdisplay查看得来\n    \n将空闲的空间都分配给root文件系统 \n  \n     lvextend -L +250G /dev/centos/root   【/dev/centos/root  就是要扩容的目录通过df 可查看】\n    \n对root文件系统执行扩容\n\n    xfs_growfs /dev/centos/root\n\n","slug":"虚拟机扩容","published":1,"updated":"2024-04-07T00:43:58.442Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv5i003rpcocg7l8bnz1","content":"<h1 id=\"一、虚拟机控制后台-修改硬盘大小\"><a href=\"#一、虚拟机控制后台-修改硬盘大小\" class=\"headerlink\" title=\"一、虚拟机控制后台-修改硬盘大小\"></a>一、虚拟机控制后台-修改硬盘大小</h1><pre><code>先虚拟机管理页面修改硬盘大小\n    注：不删除快照是 无法修改成功的\n</code></pre>\n<h1 id=\"二、方案一【没法新建分区，就只能这么操作】\"><a href=\"#二、方案一【没法新建分区，就只能这么操作】\" class=\"headerlink\" title=\"二、方案一【没法新建分区，就只能这么操作】\"></a>二、方案一【没法新建分区，就只能这么操作】</h1><p>扩展分区 最后一个分区<br>growpart /dev/sda 4</p>\n<p>扩展 分区所在pv<br>pvresize /dev/sda4</p>\n<p>扩展 所在lv<br>lvresize -l +100%FREE  /dev/centos/root</p>\n<p>扩展文件系统到新的磁盘空间。</p>\n<p><font color=\"red\">ext3/ext4 文件系统</font></p>\n<p>resize2fs /dev/centos/root</p>\n<p><font color=\"red\">xfs文件系统</font><br>xfs_growfs  /dev/centos/root</p>\n<h1 id=\"三、方案二\"><a href=\"#三、方案二\" class=\"headerlink\" title=\"三、方案二\"></a>三、方案二</h1><p>分区  </p>\n<pre><code>fdisk /dev/sda    \nn\np\n默认确定\nw\n</code></pre>\n<p>手动同步磁盘到系统内核</p>\n<pre><code>partprobe\n</code></pre>\n<p>创建物理卷</p>\n<pre><code>pvcreate /dev/sda3          #【/dev/sda3 是根据fdisk来的】\n</code></pre>\n<p>查看卷组</p>\n<pre><code>vgdisplay\n</code></pre>\n<p>添加物理卷（/dev/sda3）到卷组（centos）</p>\n<pre><code>vgextend centos /dev/sda3   #此处的centos根据vgdisplay查看得来\n</code></pre>\n<p>将空闲的空间都分配给root文件系统 </p>\n<pre><code> lvextend -L +250G /dev/centos/root   【/dev/centos/root  就是要扩容的目录通过df 可查看】\n</code></pre>\n<p>对root文件系统执行扩容</p>\n<pre><code>xfs_growfs /dev/centos/root\n</code></pre>\n","site":{"data":{}},"length":544,"excerpt":"","more":"<h1 id=\"一、虚拟机控制后台-修改硬盘大小\"><a href=\"#一、虚拟机控制后台-修改硬盘大小\" class=\"headerlink\" title=\"一、虚拟机控制后台-修改硬盘大小\"></a>一、虚拟机控制后台-修改硬盘大小</h1><pre><code>先虚拟机管理页面修改硬盘大小\n    注：不删除快照是 无法修改成功的\n</code></pre>\n<h1 id=\"二、方案一【没法新建分区，就只能这么操作】\"><a href=\"#二、方案一【没法新建分区，就只能这么操作】\" class=\"headerlink\" title=\"二、方案一【没法新建分区，就只能这么操作】\"></a>二、方案一【没法新建分区，就只能这么操作】</h1><p>扩展分区 最后一个分区<br>growpart /dev/sda 4</p>\n<p>扩展 分区所在pv<br>pvresize /dev/sda4</p>\n<p>扩展 所在lv<br>lvresize -l +100%FREE  /dev/centos/root</p>\n<p>扩展文件系统到新的磁盘空间。</p>\n<p><font color=\"red\">ext3/ext4 文件系统</font></p>\n<p>resize2fs /dev/centos/root</p>\n<p><font color=\"red\">xfs文件系统</font><br>xfs_growfs  /dev/centos/root</p>\n<h1 id=\"三、方案二\"><a href=\"#三、方案二\" class=\"headerlink\" title=\"三、方案二\"></a>三、方案二</h1><p>分区  </p>\n<pre><code>fdisk /dev/sda    \nn\np\n默认确定\nw\n</code></pre>\n<p>手动同步磁盘到系统内核</p>\n<pre><code>partprobe\n</code></pre>\n<p>创建物理卷</p>\n<pre><code>pvcreate /dev/sda3          #【/dev/sda3 是根据fdisk来的】\n</code></pre>\n<p>查看卷组</p>\n<pre><code>vgdisplay\n</code></pre>\n<p>添加物理卷（/dev/sda3）到卷组（centos）</p>\n<pre><code>vgextend centos /dev/sda3   #此处的centos根据vgdisplay查看得来\n</code></pre>\n<p>将空闲的空间都分配给root文件系统 </p>\n<pre><code> lvextend -L +250G /dev/centos/root   【/dev/centos/root  就是要扩容的目录通过df 可查看】\n</code></pre>\n<p>对root文件系统执行扩容</p>\n<pre><code>xfs_growfs /dev/centos/root\n</code></pre>\n"},{"title":"跨域问题总结","abbrlink":"54e89ac9","date":"2023-07-21T08:26:13.000Z","_content":"","source":"_posts/跨域问题总结.md","raw":"---\ntitle: 跨域问题总结\nabbrlink: 54e89ac9\ndate: 2023-07-21 16:26:13\ntags:\n---\n","slug":"跨域问题总结","published":1,"updated":"2024-02-06T05:50:35.021Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clxb4gv5j003tpcoc3b7cgpf7","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"DNS问题","abbrlink":"7052941e","date":"2024-05-25T05:35:34.000Z","_content":"\n# ubuntu 系统 \n\n## 传统方法\n   /etc/resolv.conf  可能被重置\n   \n   \n   查看是否启用systemd-resolved服务、NetworkManager服务\n   \n   systemctl status  systemd-resolved   用于提供本地DNS解析服务\n   \n   systemctl status  NetworkManager\n   \n   \n## 方案一\n   \n   永久修改DNS方法\n   \n   /etc/systemd/resolved.conf  \n\n   配置 指定 DNS 服务器，以空白分隔，支持 IPv4 或 IPv6 位置\n   DNS=114.114.114.114 8.8.8.8\n    \n   重启服务生效\n   systemctl restart systemd-resolved\n\n\n## 方案二\n    \n   /etc/netplan 目录下【00-installer-config.yaml、其他yaml 有可能覆盖】\n   \n   配置示例：\n   \n       # This is the network config written by 'subiquity'\n       network:\n         ethernets:\n           ens160:\n             dhcp4: false\n             addresses:\n               - 192.168.100.203/24\n             routes:\n               - to: default\n                 via: 192.168.100.1\n             nameservers:\n               addresses: [114.114.114.114、8.8.8.8]\n         version: 2\n    \n   配置完执行\n       sudo netplan apply\n       \n##  问题\n    \n    如果重启 不生效 重置\n    \n    检查 /etc/cloud/cloud.cfg 文件中的 reslv_conf 注释\n    \n    \n## 验证\n\n    resolvectl status\n    \n    nslookup            \n       \n# redhat/centos系统\n\n\n    /etc/resolv.conf\n\n\n    /etc/sysconfig/network-scripts/ifcfg-ens\n    \n    \n    验证\n    nslookup www.baidu.com","source":"_posts/记ubuntu-dns问题.md","raw":"---\ntitle: DNS问题\nabbrlink: 7052941e\ndate: 2024-05-25 13:35:34\ncategories:\n  - 服务器相关\ntags:\n - ubuntu\n---\n\n# ubuntu 系统 \n\n## 传统方法\n   /etc/resolv.conf  可能被重置\n   \n   \n   查看是否启用systemd-resolved服务、NetworkManager服务\n   \n   systemctl status  systemd-resolved   用于提供本地DNS解析服务\n   \n   systemctl status  NetworkManager\n   \n   \n## 方案一\n   \n   永久修改DNS方法\n   \n   /etc/systemd/resolved.conf  \n\n   配置 指定 DNS 服务器，以空白分隔，支持 IPv4 或 IPv6 位置\n   DNS=114.114.114.114 8.8.8.8\n    \n   重启服务生效\n   systemctl restart systemd-resolved\n\n\n## 方案二\n    \n   /etc/netplan 目录下【00-installer-config.yaml、其他yaml 有可能覆盖】\n   \n   配置示例：\n   \n       # This is the network config written by 'subiquity'\n       network:\n         ethernets:\n           ens160:\n             dhcp4: false\n             addresses:\n               - 192.168.100.203/24\n             routes:\n               - to: default\n                 via: 192.168.100.1\n             nameservers:\n               addresses: [114.114.114.114、8.8.8.8]\n         version: 2\n    \n   配置完执行\n       sudo netplan apply\n       \n##  问题\n    \n    如果重启 不生效 重置\n    \n    检查 /etc/cloud/cloud.cfg 文件中的 reslv_conf 注释\n    \n    \n## 验证\n\n    resolvectl status\n    \n    nslookup            \n       \n# redhat/centos系统\n\n\n    /etc/resolv.conf\n\n\n    /etc/sysconfig/network-scripts/ifcfg-ens\n    \n    \n    验证\n    nslookup www.baidu.com","slug":"记ubuntu-dns问题","published":1,"updated":"2024-11-25T11:32:55.497Z","_id":"clxb4gv5k003vpcoc8iyda74i","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"ubuntu-系统\"><a href=\"#ubuntu-系统\" class=\"headerlink\" title=\"ubuntu 系统\"></a>ubuntu 系统</h1><h2 id=\"传统方法\"><a href=\"#传统方法\" class=\"headerlink\" title=\"传统方法\"></a>传统方法</h2><p>   /etc/resolv.conf  可能被重置</p>\n<p>   查看是否启用systemd-resolved服务、NetworkManager服务</p>\n<p>   systemctl status  systemd-resolved   用于提供本地DNS解析服务</p>\n<p>   systemctl status  NetworkManager</p>\n<h2 id=\"方案一\"><a href=\"#方案一\" class=\"headerlink\" title=\"方案一\"></a>方案一</h2><p>   永久修改DNS方法</p>\n<p>   /etc/systemd/resolved.conf  </p>\n<p>   配置 指定 DNS 服务器，以空白分隔，支持 IPv4 或 IPv6 位置<br>   DNS=114.114.114.114 8.8.8.8</p>\n<p>   重启服务生效<br>   systemctl restart systemd-resolved</p>\n<h2 id=\"方案二\"><a href=\"#方案二\" class=\"headerlink\" title=\"方案二\"></a>方案二</h2><p>   /etc/netplan 目录下【00-installer-config.yaml、其他yaml 有可能覆盖】</p>\n<p>   配置示例：</p>\n<pre><code>   # This is the network config written by &#39;subiquity&#39;\n   network:\n     ethernets:\n       ens160:\n         dhcp4: false\n         addresses:\n           - 192.168.100.203/24\n         routes:\n           - to: default\n             via: 192.168.100.1\n         nameservers:\n           addresses: [114.114.114.114、8.8.8.8]\n     version: 2\n</code></pre>\n<p>   配置完执行<br>       sudo netplan apply</p>\n<h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><pre><code>如果重启 不生效 重置\n\n检查 /etc/cloud/cloud.cfg 文件中的 reslv_conf 注释\n</code></pre>\n<h2 id=\"验证\"><a href=\"#验证\" class=\"headerlink\" title=\"验证\"></a>验证</h2><pre><code>resolvectl status\n\nnslookup            \n   \n</code></pre>\n<h1 id=\"redhat-centos系统\"><a href=\"#redhat-centos系统\" class=\"headerlink\" title=\"redhat/centos系统\"></a>redhat/centos系统</h1><pre><code>/etc/resolv.conf\n\n\n/etc/sysconfig/network-scripts/ifcfg-ens\n\n\n验证\nnslookup www.baidu.com\n</code></pre>\n","site":{"data":{}},"length":737,"excerpt":"","more":"<h1 id=\"ubuntu-系统\"><a href=\"#ubuntu-系统\" class=\"headerlink\" title=\"ubuntu 系统\"></a>ubuntu 系统</h1><h2 id=\"传统方法\"><a href=\"#传统方法\" class=\"headerlink\" title=\"传统方法\"></a>传统方法</h2><p>   /etc/resolv.conf  可能被重置</p>\n<p>   查看是否启用systemd-resolved服务、NetworkManager服务</p>\n<p>   systemctl status  systemd-resolved   用于提供本地DNS解析服务</p>\n<p>   systemctl status  NetworkManager</p>\n<h2 id=\"方案一\"><a href=\"#方案一\" class=\"headerlink\" title=\"方案一\"></a>方案一</h2><p>   永久修改DNS方法</p>\n<p>   /etc/systemd/resolved.conf  </p>\n<p>   配置 指定 DNS 服务器，以空白分隔，支持 IPv4 或 IPv6 位置<br>   DNS=114.114.114.114 8.8.8.8</p>\n<p>   重启服务生效<br>   systemctl restart systemd-resolved</p>\n<h2 id=\"方案二\"><a href=\"#方案二\" class=\"headerlink\" title=\"方案二\"></a>方案二</h2><p>   /etc/netplan 目录下【00-installer-config.yaml、其他yaml 有可能覆盖】</p>\n<p>   配置示例：</p>\n<pre><code>   # This is the network config written by &#39;subiquity&#39;\n   network:\n     ethernets:\n       ens160:\n         dhcp4: false\n         addresses:\n           - 192.168.100.203/24\n         routes:\n           - to: default\n             via: 192.168.100.1\n         nameservers:\n           addresses: [114.114.114.114、8.8.8.8]\n     version: 2\n</code></pre>\n<p>   配置完执行<br>       sudo netplan apply</p>\n<h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><pre><code>如果重启 不生效 重置\n\n检查 /etc/cloud/cloud.cfg 文件中的 reslv_conf 注释\n</code></pre>\n<h2 id=\"验证\"><a href=\"#验证\" class=\"headerlink\" title=\"验证\"></a>验证</h2><pre><code>resolvectl status\n\nnslookup            \n   \n</code></pre>\n<h1 id=\"redhat-centos系统\"><a href=\"#redhat-centos系统\" class=\"headerlink\" title=\"redhat/centos系统\"></a>redhat/centos系统</h1><pre><code>/etc/resolv.conf\n\n\n/etc/sysconfig/network-scripts/ifcfg-ens\n\n\n验证\nnslookup www.baidu.com\n</code></pre>\n"},{"title":"php开发-Tcp连接","abbrlink":"680ac944","date":"2024-06-13T01:09:50.000Z","_content":"\n# 封装的连接类\n```php\n\n<?php\n\nnamespace SimpleSocket;\n\nset_error_handler(function ($errno, $errstr, $errfile, $errline) {\n  throw new \\ErrorException($errstr, $errno, 0, $errfile, $errline);\n});\n\nclass Connector\n{\n  private $_socket = null;\n\n  public function connectTcp(string $address, int $port, int $timeout = 30)\n  {\n    try {\n      $this->_socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);\n    } catch (\\Exception $e) {\n      throw new \\Exception($e->getMessage(), 10);\n    }\n\n    if ($timeout !== 30) {\n      try {\n        socket_set_option($this->_socket, SOL_SOCKET, SO_SNDTIMEO, ['sec' => $timeout, 'usec' => 0]);\n        socket_set_option($this->_socket, SOL_SOCKET, SO_RCVTIMEO, ['sec' => $timeout, 'usec' => 0]);\n      } catch (\\Exception $e) {\n        throw new \\Exception($e->getMessage(), 10);\n      }\n    }\n\n    try {\n      socket_connect($this->_socket, $address, $port);\n    } catch (\\Exception $e) {\n      throw new \\Exception($e->getMessage(), 10);\n    }\n\n    return $this;\n  }\n\n  public function read(int $length = 2048)\n  {\n    if ($this->_socket === null) {\n      throw new \\Exception('Didn\\'t define socket connection', 20);\n    }\n\n    return socket_read($this->_socket, $length);\n  }\n\n  public function write(string $buf)\n  {\n    if ($this->_socket === null) {\n      throw new \\Exception('Didn\\'t define socket connection', 20);\n    }\n\n    socket_write($this->_socket, $buf, strlen($buf));\n\n    return $this;\n  }\n\n  public function close()\n  {\n    if ($this->_socket === null) {\n      throw new \\Exception('Didn\\'t define socket connection', 20);\n    }\n\n    socket_close($this->_socket);\n    $this->_socket = null;\n\n    return $this;\n  }\n\n  public function then(callable $func)\n  {\n    if ($this->_socket === null) {\n      throw new \\Exception('Didn\\'t define socket connection', 20);\n    }\n\n    $func($this);\n\n    return $this;\n  }\n}\n\n\n```\n\n\n# 使用实例\n\n```php\n\n   /**\n     * 添加账号\n     * @param $account\n     * @throws \\Exception\n     */\n    public function add($account)\n    {\n        $msg = \"<xml><header><transcode>358001</transcode></header><body><actno>{$account}</actno><operType>0</operType></body></xml>\";\n        $msgStr = $this->getMsgStr($msg);\n        $conn = $this->connect();\n        Log::init(['type' => 'File', 'path' => ROOT_PATH . '/runtime/log/njbank/add']);\n        Log::write(\"发送:\" . $msgStr . \"\\n\");\n        $conn->write($msgStr);\n        $getstr = \"\";\n        // 解决 没有读完的问题\n        while ($resp = $conn->read()) {\n            $getstr .= $resp;\n            if (strpos($resp, \"<\\xml>\") === false) break;\n        }\n        $conn->close();\n        Log::write(\"结束:\" . $getstr . \"\\n\");\n        $resdata = self::decodeXml($getstr);\n        if ($resdata['header']['code'] == '000000') {\n            $data = [\n                'res' => true,\n                'message' => '成功'\n            ];\n        } else {\n            $data = [\n                'res' => false,\n                'message' => $resdata['header']['message']\n            ];\n        }\n        return $data;\n    }\n```","source":"_posts/php开发-Tcp连接.md","raw":"---\ntitle: php开发-Tcp连接\ntags: PHP开发\ncategories:\n  - PHP开发\nabbrlink: 680ac944\ndate: 2024-06-13 09:09:50\n---\n\n# 封装的连接类\n```php\n\n<?php\n\nnamespace SimpleSocket;\n\nset_error_handler(function ($errno, $errstr, $errfile, $errline) {\n  throw new \\ErrorException($errstr, $errno, 0, $errfile, $errline);\n});\n\nclass Connector\n{\n  private $_socket = null;\n\n  public function connectTcp(string $address, int $port, int $timeout = 30)\n  {\n    try {\n      $this->_socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);\n    } catch (\\Exception $e) {\n      throw new \\Exception($e->getMessage(), 10);\n    }\n\n    if ($timeout !== 30) {\n      try {\n        socket_set_option($this->_socket, SOL_SOCKET, SO_SNDTIMEO, ['sec' => $timeout, 'usec' => 0]);\n        socket_set_option($this->_socket, SOL_SOCKET, SO_RCVTIMEO, ['sec' => $timeout, 'usec' => 0]);\n      } catch (\\Exception $e) {\n        throw new \\Exception($e->getMessage(), 10);\n      }\n    }\n\n    try {\n      socket_connect($this->_socket, $address, $port);\n    } catch (\\Exception $e) {\n      throw new \\Exception($e->getMessage(), 10);\n    }\n\n    return $this;\n  }\n\n  public function read(int $length = 2048)\n  {\n    if ($this->_socket === null) {\n      throw new \\Exception('Didn\\'t define socket connection', 20);\n    }\n\n    return socket_read($this->_socket, $length);\n  }\n\n  public function write(string $buf)\n  {\n    if ($this->_socket === null) {\n      throw new \\Exception('Didn\\'t define socket connection', 20);\n    }\n\n    socket_write($this->_socket, $buf, strlen($buf));\n\n    return $this;\n  }\n\n  public function close()\n  {\n    if ($this->_socket === null) {\n      throw new \\Exception('Didn\\'t define socket connection', 20);\n    }\n\n    socket_close($this->_socket);\n    $this->_socket = null;\n\n    return $this;\n  }\n\n  public function then(callable $func)\n  {\n    if ($this->_socket === null) {\n      throw new \\Exception('Didn\\'t define socket connection', 20);\n    }\n\n    $func($this);\n\n    return $this;\n  }\n}\n\n\n```\n\n\n# 使用实例\n\n```php\n\n   /**\n     * 添加账号\n     * @param $account\n     * @throws \\Exception\n     */\n    public function add($account)\n    {\n        $msg = \"<xml><header><transcode>358001</transcode></header><body><actno>{$account}</actno><operType>0</operType></body></xml>\";\n        $msgStr = $this->getMsgStr($msg);\n        $conn = $this->connect();\n        Log::init(['type' => 'File', 'path' => ROOT_PATH . '/runtime/log/njbank/add']);\n        Log::write(\"发送:\" . $msgStr . \"\\n\");\n        $conn->write($msgStr);\n        $getstr = \"\";\n        // 解决 没有读完的问题\n        while ($resp = $conn->read()) {\n            $getstr .= $resp;\n            if (strpos($resp, \"<\\xml>\") === false) break;\n        }\n        $conn->close();\n        Log::write(\"结束:\" . $getstr . \"\\n\");\n        $resdata = self::decodeXml($getstr);\n        if ($resdata['header']['code'] == '000000') {\n            $data = [\n                'res' => true,\n                'message' => '成功'\n            ];\n        } else {\n            $data = [\n                'res' => false,\n                'message' => $resdata['header']['message']\n            ];\n        }\n        return $data;\n    }\n```","slug":"php开发-Tcp连接","published":1,"updated":"2024-08-20T02:17:42.679Z","_id":"clxsm9q1u000110oc790icdbb","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"封装的连接类\"><a href=\"#封装的连接类\" class=\"headerlink\" title=\"封装的连接类\"></a>封装的连接类</h1><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">SimpleSocket</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">set_error_handler(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"><span class=\"variable\">$errno</span>, <span class=\"variable\">$errstr</span>, <span class=\"variable\">$errfile</span>, <span class=\"variable\">$errline</span></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">ErrorException</span>(<span class=\"variable\">$errstr</span>, <span class=\"variable\">$errno</span>, <span class=\"number\">0</span>, <span class=\"variable\">$errfile</span>, <span class=\"variable\">$errline</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Connector</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"variable\">$_socket</span> = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">connectTcp</span>(<span class=\"params\"><span class=\"keyword\">string</span> <span class=\"variable\">$address</span>, <span class=\"keyword\">int</span> <span class=\"variable\">$port</span>, <span class=\"keyword\">int</span> <span class=\"variable\">$timeout</span> = <span class=\"number\">30</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">$this</span>-&gt;_socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (\\<span class=\"built_in\">Exception</span> <span class=\"variable\">$e</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"variable\">$e</span>-&gt;getMessage(), <span class=\"number\">10</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$timeout</span> !== <span class=\"number\">30</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        socket_set_option(<span class=\"keyword\">$this</span>-&gt;_socket, SOL_SOCKET, SO_SNDTIMEO, [<span class=\"string\">&#x27;sec&#x27;</span> =&gt; <span class=\"variable\">$timeout</span>, <span class=\"string\">&#x27;usec&#x27;</span> =&gt; <span class=\"number\">0</span>]);</span><br><span class=\"line\">        socket_set_option(<span class=\"keyword\">$this</span>-&gt;_socket, SOL_SOCKET, SO_RCVTIMEO, [<span class=\"string\">&#x27;sec&#x27;</span> =&gt; <span class=\"variable\">$timeout</span>, <span class=\"string\">&#x27;usec&#x27;</span> =&gt; <span class=\"number\">0</span>]);</span><br><span class=\"line\">      &#125; <span class=\"keyword\">catch</span> (\\<span class=\"built_in\">Exception</span> <span class=\"variable\">$e</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"variable\">$e</span>-&gt;getMessage(), <span class=\"number\">10</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      socket_connect(<span class=\"keyword\">$this</span>-&gt;_socket, <span class=\"variable\">$address</span>, <span class=\"variable\">$port</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (\\<span class=\"built_in\">Exception</span> <span class=\"variable\">$e</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"variable\">$e</span>-&gt;getMessage(), <span class=\"number\">10</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">read</span>(<span class=\"params\"><span class=\"keyword\">int</span> <span class=\"variable\">$length</span> = <span class=\"number\">2048</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">$this</span>-&gt;_socket === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"string\">&#x27;Didn\\&#x27;t define socket connection&#x27;</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> socket_read(<span class=\"keyword\">$this</span>-&gt;_socket, <span class=\"variable\">$length</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">write</span>(<span class=\"params\"><span class=\"keyword\">string</span> <span class=\"variable\">$buf</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">$this</span>-&gt;_socket === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"string\">&#x27;Didn\\&#x27;t define socket connection&#x27;</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    socket_write(<span class=\"keyword\">$this</span>-&gt;_socket, <span class=\"variable\">$buf</span>, strlen(<span class=\"variable\">$buf</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">close</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">$this</span>-&gt;_socket === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"string\">&#x27;Didn\\&#x27;t define socket connection&#x27;</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    socket_close(<span class=\"keyword\">$this</span>-&gt;_socket);</span><br><span class=\"line\">    <span class=\"keyword\">$this</span>-&gt;_socket = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">then</span>(<span class=\"params\"><span class=\"keyword\">callable</span> <span class=\"variable\">$func</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">$this</span>-&gt;_socket === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"string\">&#x27;Didn\\&#x27;t define socket connection&#x27;</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"variable\">$func</span>(<span class=\"keyword\">$this</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"使用实例\"><a href=\"#使用实例\" class=\"headerlink\" title=\"使用实例\"></a>使用实例</h1><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * 添加账号</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@param</span> $account</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@throws</span> \\Exception</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">add</span>(<span class=\"params\"><span class=\"variable\">$account</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"> </span>&#123;</span><br><span class=\"line\">     <span class=\"variable\">$msg</span> = <span class=\"string\">&quot;&lt;xml&gt;&lt;header&gt;&lt;transcode&gt;358001&lt;/transcode&gt;&lt;/header&gt;&lt;body&gt;&lt;actno&gt;<span class=\"subst\">&#123;$account&#125;</span>&lt;/actno&gt;&lt;operType&gt;0&lt;/operType&gt;&lt;/body&gt;&lt;/xml&gt;&quot;</span>;</span><br><span class=\"line\">     <span class=\"variable\">$msgStr</span> = <span class=\"keyword\">$this</span>-&gt;getMsgStr(<span class=\"variable\">$msg</span>);</span><br><span class=\"line\">     <span class=\"variable\">$conn</span> = <span class=\"keyword\">$this</span>-&gt;connect();</span><br><span class=\"line\">     Log::init([<span class=\"string\">&#x27;type&#x27;</span> =&gt; <span class=\"string\">&#x27;File&#x27;</span>, <span class=\"string\">&#x27;path&#x27;</span> =&gt; ROOT_PATH . <span class=\"string\">&#x27;/runtime/log/njbank/add&#x27;</span>]);</span><br><span class=\"line\">     Log::write(<span class=\"string\">&quot;发送:&quot;</span> . <span class=\"variable\">$msgStr</span> . <span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\">     <span class=\"variable\">$conn</span>-&gt;write(<span class=\"variable\">$msgStr</span>);</span><br><span class=\"line\">     <span class=\"variable\">$getstr</span> = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">     <span class=\"comment\">// 解决 没有读完的问题</span></span><br><span class=\"line\">     <span class=\"keyword\">while</span> (<span class=\"variable\">$resp</span> = <span class=\"variable\">$conn</span>-&gt;read()) &#123;</span><br><span class=\"line\">         <span class=\"variable\">$getstr</span> .= <span class=\"variable\">$resp</span>;</span><br><span class=\"line\">         <span class=\"keyword\">if</span> (strpos(<span class=\"variable\">$resp</span>, <span class=\"string\">&quot;&lt;\\xml&gt;&quot;</span>) === <span class=\"literal\">false</span>) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     <span class=\"variable\">$conn</span>-&gt;close();</span><br><span class=\"line\">     Log::write(<span class=\"string\">&quot;结束:&quot;</span> . <span class=\"variable\">$getstr</span> . <span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\">     <span class=\"variable\">$resdata</span> = <span class=\"built_in\">self</span>::decodeXml(<span class=\"variable\">$getstr</span>);</span><br><span class=\"line\">     <span class=\"keyword\">if</span> (<span class=\"variable\">$resdata</span>[<span class=\"string\">&#x27;header&#x27;</span>][<span class=\"string\">&#x27;code&#x27;</span>] == <span class=\"string\">&#x27;000000&#x27;</span>) &#123;</span><br><span class=\"line\">         <span class=\"variable\">$data</span> = [</span><br><span class=\"line\">             <span class=\"string\">&#x27;res&#x27;</span> =&gt; <span class=\"literal\">true</span>,</span><br><span class=\"line\">             <span class=\"string\">&#x27;message&#x27;</span> =&gt; <span class=\"string\">&#x27;成功&#x27;</span></span><br><span class=\"line\">         ];</span><br><span class=\"line\">     &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">         <span class=\"variable\">$data</span> = [</span><br><span class=\"line\">             <span class=\"string\">&#x27;res&#x27;</span> =&gt; <span class=\"literal\">false</span>,</span><br><span class=\"line\">             <span class=\"string\">&#x27;message&#x27;</span> =&gt; <span class=\"variable\">$resdata</span>[<span class=\"string\">&#x27;header&#x27;</span>][<span class=\"string\">&#x27;message&#x27;</span>]</span><br><span class=\"line\">         ];</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     <span class=\"keyword\">return</span> <span class=\"variable\">$data</span>;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"length":3062,"excerpt":"","more":"<h1 id=\"封装的连接类\"><a href=\"#封装的连接类\" class=\"headerlink\" title=\"封装的连接类\"></a>封装的连接类</h1><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">SimpleSocket</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">set_error_handler(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"><span class=\"variable\">$errno</span>, <span class=\"variable\">$errstr</span>, <span class=\"variable\">$errfile</span>, <span class=\"variable\">$errline</span></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">ErrorException</span>(<span class=\"variable\">$errstr</span>, <span class=\"variable\">$errno</span>, <span class=\"number\">0</span>, <span class=\"variable\">$errfile</span>, <span class=\"variable\">$errline</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Connector</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"variable\">$_socket</span> = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">connectTcp</span>(<span class=\"params\"><span class=\"keyword\">string</span> <span class=\"variable\">$address</span>, <span class=\"keyword\">int</span> <span class=\"variable\">$port</span>, <span class=\"keyword\">int</span> <span class=\"variable\">$timeout</span> = <span class=\"number\">30</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">$this</span>-&gt;_socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (\\<span class=\"built_in\">Exception</span> <span class=\"variable\">$e</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"variable\">$e</span>-&gt;getMessage(), <span class=\"number\">10</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$timeout</span> !== <span class=\"number\">30</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        socket_set_option(<span class=\"keyword\">$this</span>-&gt;_socket, SOL_SOCKET, SO_SNDTIMEO, [<span class=\"string\">&#x27;sec&#x27;</span> =&gt; <span class=\"variable\">$timeout</span>, <span class=\"string\">&#x27;usec&#x27;</span> =&gt; <span class=\"number\">0</span>]);</span><br><span class=\"line\">        socket_set_option(<span class=\"keyword\">$this</span>-&gt;_socket, SOL_SOCKET, SO_RCVTIMEO, [<span class=\"string\">&#x27;sec&#x27;</span> =&gt; <span class=\"variable\">$timeout</span>, <span class=\"string\">&#x27;usec&#x27;</span> =&gt; <span class=\"number\">0</span>]);</span><br><span class=\"line\">      &#125; <span class=\"keyword\">catch</span> (\\<span class=\"built_in\">Exception</span> <span class=\"variable\">$e</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"variable\">$e</span>-&gt;getMessage(), <span class=\"number\">10</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      socket_connect(<span class=\"keyword\">$this</span>-&gt;_socket, <span class=\"variable\">$address</span>, <span class=\"variable\">$port</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (\\<span class=\"built_in\">Exception</span> <span class=\"variable\">$e</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"variable\">$e</span>-&gt;getMessage(), <span class=\"number\">10</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">read</span>(<span class=\"params\"><span class=\"keyword\">int</span> <span class=\"variable\">$length</span> = <span class=\"number\">2048</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">$this</span>-&gt;_socket === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"string\">&#x27;Didn\\&#x27;t define socket connection&#x27;</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> socket_read(<span class=\"keyword\">$this</span>-&gt;_socket, <span class=\"variable\">$length</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">write</span>(<span class=\"params\"><span class=\"keyword\">string</span> <span class=\"variable\">$buf</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">$this</span>-&gt;_socket === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"string\">&#x27;Didn\\&#x27;t define socket connection&#x27;</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    socket_write(<span class=\"keyword\">$this</span>-&gt;_socket, <span class=\"variable\">$buf</span>, strlen(<span class=\"variable\">$buf</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">close</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">$this</span>-&gt;_socket === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"string\">&#x27;Didn\\&#x27;t define socket connection&#x27;</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    socket_close(<span class=\"keyword\">$this</span>-&gt;_socket);</span><br><span class=\"line\">    <span class=\"keyword\">$this</span>-&gt;_socket = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">then</span>(<span class=\"params\"><span class=\"keyword\">callable</span> <span class=\"variable\">$func</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">$this</span>-&gt;_socket === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> \\<span class=\"built_in\">Exception</span>(<span class=\"string\">&#x27;Didn\\&#x27;t define socket connection&#x27;</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"variable\">$func</span>(<span class=\"keyword\">$this</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"使用实例\"><a href=\"#使用实例\" class=\"headerlink\" title=\"使用实例\"></a>使用实例</h1><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * 添加账号</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@param</span> $account</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@throws</span> \\Exception</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">add</span>(<span class=\"params\"><span class=\"variable\">$account</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"> </span>&#123;</span><br><span class=\"line\">     <span class=\"variable\">$msg</span> = <span class=\"string\">&quot;&lt;xml&gt;&lt;header&gt;&lt;transcode&gt;358001&lt;/transcode&gt;&lt;/header&gt;&lt;body&gt;&lt;actno&gt;<span class=\"subst\">&#123;$account&#125;</span>&lt;/actno&gt;&lt;operType&gt;0&lt;/operType&gt;&lt;/body&gt;&lt;/xml&gt;&quot;</span>;</span><br><span class=\"line\">     <span class=\"variable\">$msgStr</span> = <span class=\"keyword\">$this</span>-&gt;getMsgStr(<span class=\"variable\">$msg</span>);</span><br><span class=\"line\">     <span class=\"variable\">$conn</span> = <span class=\"keyword\">$this</span>-&gt;connect();</span><br><span class=\"line\">     Log::init([<span class=\"string\">&#x27;type&#x27;</span> =&gt; <span class=\"string\">&#x27;File&#x27;</span>, <span class=\"string\">&#x27;path&#x27;</span> =&gt; ROOT_PATH . <span class=\"string\">&#x27;/runtime/log/njbank/add&#x27;</span>]);</span><br><span class=\"line\">     Log::write(<span class=\"string\">&quot;发送:&quot;</span> . <span class=\"variable\">$msgStr</span> . <span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\">     <span class=\"variable\">$conn</span>-&gt;write(<span class=\"variable\">$msgStr</span>);</span><br><span class=\"line\">     <span class=\"variable\">$getstr</span> = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">     <span class=\"comment\">// 解决 没有读完的问题</span></span><br><span class=\"line\">     <span class=\"keyword\">while</span> (<span class=\"variable\">$resp</span> = <span class=\"variable\">$conn</span>-&gt;read()) &#123;</span><br><span class=\"line\">         <span class=\"variable\">$getstr</span> .= <span class=\"variable\">$resp</span>;</span><br><span class=\"line\">         <span class=\"keyword\">if</span> (strpos(<span class=\"variable\">$resp</span>, <span class=\"string\">&quot;&lt;\\xml&gt;&quot;</span>) === <span class=\"literal\">false</span>) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     <span class=\"variable\">$conn</span>-&gt;close();</span><br><span class=\"line\">     Log::write(<span class=\"string\">&quot;结束:&quot;</span> . <span class=\"variable\">$getstr</span> . <span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\">     <span class=\"variable\">$resdata</span> = <span class=\"built_in\">self</span>::decodeXml(<span class=\"variable\">$getstr</span>);</span><br><span class=\"line\">     <span class=\"keyword\">if</span> (<span class=\"variable\">$resdata</span>[<span class=\"string\">&#x27;header&#x27;</span>][<span class=\"string\">&#x27;code&#x27;</span>] == <span class=\"string\">&#x27;000000&#x27;</span>) &#123;</span><br><span class=\"line\">         <span class=\"variable\">$data</span> = [</span><br><span class=\"line\">             <span class=\"string\">&#x27;res&#x27;</span> =&gt; <span class=\"literal\">true</span>,</span><br><span class=\"line\">             <span class=\"string\">&#x27;message&#x27;</span> =&gt; <span class=\"string\">&#x27;成功&#x27;</span></span><br><span class=\"line\">         ];</span><br><span class=\"line\">     &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">         <span class=\"variable\">$data</span> = [</span><br><span class=\"line\">             <span class=\"string\">&#x27;res&#x27;</span> =&gt; <span class=\"literal\">false</span>,</span><br><span class=\"line\">             <span class=\"string\">&#x27;message&#x27;</span> =&gt; <span class=\"variable\">$resdata</span>[<span class=\"string\">&#x27;header&#x27;</span>][<span class=\"string\">&#x27;message&#x27;</span>]</span><br><span class=\"line\">         ];</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     <span class=\"keyword\">return</span> <span class=\"variable\">$data</span>;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>"},{"title":"php开发-websocket","abbrlink":"cab3e457","date":"2024-06-13T01:10:14.000Z","_content":"","source":"_posts/php开发-websocket.md","raw":"---\ntitle: php开发-websocket\ntags: \n - php\ncategories:\n  - PHP开发\nabbrlink: cab3e457\ndate: 2024-06-13 09:10:14\n---\n","slug":"php开发-websocket","published":1,"updated":"2024-11-25T11:34:14.503Z","_id":"clxsm9q1v000210oc566badl8","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"php开发-php-fpm进程被占满","abbrlink":"9b3ce30d","date":"2024-06-24T06:47:51.000Z","_content":"","source":"_posts/php开发-php-fpm进程被占满.md","raw":"---\ntitle: php开发-php-fpm进程被占满\ntags: PHP开发\ncategories:\n  - PHP开发\nabbrlink: 9b3ce30d\ndate: 2024-06-24 14:47:51\n---\n","slug":"php开发-php-fpm进程被占满","published":1,"updated":"2024-06-24T06:48:41.647Z","_id":"clxsm9q1w000410oc5nkh9q4s","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"php开发-swoole框架","abbrlink":"ab7af144","date":"2024-06-13T01:11:33.000Z","_content":"","source":"_posts/php开发-swoole框架.md","raw":"---\ntitle: php开发-swoole框架\ntags: PHP开发\ncategories:\n  - PHP开发\nabbrlink: ab7af144\ndate: 2024-06-13 09:11:33\n---\n","slug":"php开发-swoole框架","published":1,"updated":"2024-06-24T06:48:41.649Z","_id":"clxsm9q1w000710ocdcguazm2","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"php开发-fastadmin按钮弹框传数据到列表","abbrlink":"6df754b5","date":"2024-06-28T14:13:59.000Z","_content":"# 一、实现效果\n点击按钮 弹出选项列表，选择列表通过table 实现的\n难点：\n     1.点击弹框url中传值 怎么传到列表请求中，因为table 数据是通过ajax 试下的，就麻烦了 \n     2.点击选择按钮的实现 数据的回传 接收处理\n     \n     \n![lena](../pic/dialogbox.png)\n# 二、按钮页面 js代码\n```js\n    $(\"#select-coupon-btn\").click(function () {\n                parent.Fast.api.open(\"wanlshop/street_coupon/select?select_use_type=2\", __('选择卡券'), {\n                    area: ['800px', '600px'],\n                    callback: (data)=> {\n                        if(data){\n                            $(\"#coupon-table tbody tr\").last().remove();\n                            $(\"#send_gift\").val(data.id);\n                            if (data.grant == -1) {\n                                data.grant = \"不限\";\n                            }\n                            $(\"#coupon-table tbody\").last().append(\"<tr><td>\"+data.name+\"</td><td>\"+data.type+\"</td><td>\"+data.grant+\"</td></tr>\");\n                        }\n                    }\n                });\n            });\n\n```\n\n# 三、弹框页面\n\n通过Fast.api.query('select_use_type'); 获取 然后加到ajax请求中\n\n弹框页面js代码\n```js\n\n    select: function () {\n        // 初始化表格参数配置\n        Table.api.init({\n            extend: {\n                index_url: 'wanlshop/street_coupon/select',\n            }\n        });\n        var urlArr = [];\n    \n        var table = $(\"#table\");\n    \n        // 多选的 操作\n        table.on('check.bs.table uncheck.bs.table check-all.bs.table uncheck-all.bs.table', function (e, row) {\n            if (e.type == 'check' || e.type == 'uncheck') {\n                row = [row];\n            } else {\n                urlArr = [];\n            }\n            $.each(row, function (i, j) {\n                if (e.type.indexOf(\"uncheck\") > -1) {\n                    var index = urlArr.indexOf(j.id);\n                    if (index > -1) {\n                        urlArr.splice(index, 1);\n                    }\n                } else {\n                    urlArr.indexOf(j.id) == -1 && urlArr.push(j.id);\n                }\n            });\n        });\n    \n        // 初始化表格\n        table.bootstrapTable({\n            url: $.fn.bootstrapTable.defaults.extend.index_url,\n            sortName: 'id',\n            showToggle: false,\n            showExport: false,\n    \n            //是否显示右上角的搜索框\n            search: false,\n            //控制显示列开关\n            showColumns:false,\n            //显示搜索字段框\n            searchFormVisible: false,\n            showExport: false,\n            columns: [\n                [\n                    {\n                        field: 'type',\n                        title: __('Type'),\n                        searchList: {\n                            \"reduction\": \"满减券\",\n                            \"discount\": \"折扣券\",\n                            \"daijin\": \"代金券\",\n                            \"stopcar\": \"停车券\",\n                            \"gift\": \"礼品券\"\n                        },\n                        formatter: Table.api.formatter.normal\n                    },\n                    {field: 'name', title: __('Name'), operate: 'LIKE'},\n                    {field: 'drawlimit', title: __('Drawlimit')},\n                    {field: 'grant', title: __('Grant'), operate: 'LIKE',formatter: Controller.api.formatter.grant},\n                    {\n                        field: 'operate', title: __('Operate'), events: {\n                            'click .btn-chooseone': function (e, value, row, index) {\n                                // var multiple = Backend.api.query('multiple');\n                                // multiple = multiple == 'true' ? true : false;\n                                Fast.api.close({\n                                    id: row.id,\n                                    name: row.name,\n                                    type: row.type_text,\n                                    drawlimit: row.drawlimit,\n                                    grant: row.grant\n                                });\n                            },\n                        }, formatter: function () {\n                            return '<a href=\"javascript:;\" class=\"btn btn-danger btn-chooseone btn-xs\"><i class=\"fa fa-check\"></i> ' + __('Choose') + '</a>';\n                        }\n                    }\n                ]\n            ],\n            queryParams: function(params){\n                var filter = JSON.parse(params.filter);\n                var op = JSON.parse(params.op);\n                var select_use_type = Fast.api.query('select_use_type');\n    \n                if (select_use_type != null){\n                    filter.use_type= select_use_type;\n                    op.use_type = \"=\";\n                }\n                params.filter = JSON.stringify(filter);\n                params.op = JSON.stringify(op);\n                return params;\n            }\n        });\n        // 为表格绑定事件\n        Table.api.bindevent(table);\n    },\n```\n\n后端代码 parent::index() 代码服务一份相应控制器就好了\n","source":"_posts/php开发-fastadmin按钮弹框传数据到列表.md","raw":"---\ntitle: php开发-fastadmin按钮弹框传数据到列表\ntags: fastadmin\ncategories:\n  - PHP开发\nabbrlink: 6df754b5\ndate: 2024-06-28 22:13:59\n---\n# 一、实现效果\n点击按钮 弹出选项列表，选择列表通过table 实现的\n难点：\n     1.点击弹框url中传值 怎么传到列表请求中，因为table 数据是通过ajax 试下的，就麻烦了 \n     2.点击选择按钮的实现 数据的回传 接收处理\n     \n     \n![lena](../pic/dialogbox.png)\n# 二、按钮页面 js代码\n```js\n    $(\"#select-coupon-btn\").click(function () {\n                parent.Fast.api.open(\"wanlshop/street_coupon/select?select_use_type=2\", __('选择卡券'), {\n                    area: ['800px', '600px'],\n                    callback: (data)=> {\n                        if(data){\n                            $(\"#coupon-table tbody tr\").last().remove();\n                            $(\"#send_gift\").val(data.id);\n                            if (data.grant == -1) {\n                                data.grant = \"不限\";\n                            }\n                            $(\"#coupon-table tbody\").last().append(\"<tr><td>\"+data.name+\"</td><td>\"+data.type+\"</td><td>\"+data.grant+\"</td></tr>\");\n                        }\n                    }\n                });\n            });\n\n```\n\n# 三、弹框页面\n\n通过Fast.api.query('select_use_type'); 获取 然后加到ajax请求中\n\n弹框页面js代码\n```js\n\n    select: function () {\n        // 初始化表格参数配置\n        Table.api.init({\n            extend: {\n                index_url: 'wanlshop/street_coupon/select',\n            }\n        });\n        var urlArr = [];\n    \n        var table = $(\"#table\");\n    \n        // 多选的 操作\n        table.on('check.bs.table uncheck.bs.table check-all.bs.table uncheck-all.bs.table', function (e, row) {\n            if (e.type == 'check' || e.type == 'uncheck') {\n                row = [row];\n            } else {\n                urlArr = [];\n            }\n            $.each(row, function (i, j) {\n                if (e.type.indexOf(\"uncheck\") > -1) {\n                    var index = urlArr.indexOf(j.id);\n                    if (index > -1) {\n                        urlArr.splice(index, 1);\n                    }\n                } else {\n                    urlArr.indexOf(j.id) == -1 && urlArr.push(j.id);\n                }\n            });\n        });\n    \n        // 初始化表格\n        table.bootstrapTable({\n            url: $.fn.bootstrapTable.defaults.extend.index_url,\n            sortName: 'id',\n            showToggle: false,\n            showExport: false,\n    \n            //是否显示右上角的搜索框\n            search: false,\n            //控制显示列开关\n            showColumns:false,\n            //显示搜索字段框\n            searchFormVisible: false,\n            showExport: false,\n            columns: [\n                [\n                    {\n                        field: 'type',\n                        title: __('Type'),\n                        searchList: {\n                            \"reduction\": \"满减券\",\n                            \"discount\": \"折扣券\",\n                            \"daijin\": \"代金券\",\n                            \"stopcar\": \"停车券\",\n                            \"gift\": \"礼品券\"\n                        },\n                        formatter: Table.api.formatter.normal\n                    },\n                    {field: 'name', title: __('Name'), operate: 'LIKE'},\n                    {field: 'drawlimit', title: __('Drawlimit')},\n                    {field: 'grant', title: __('Grant'), operate: 'LIKE',formatter: Controller.api.formatter.grant},\n                    {\n                        field: 'operate', title: __('Operate'), events: {\n                            'click .btn-chooseone': function (e, value, row, index) {\n                                // var multiple = Backend.api.query('multiple');\n                                // multiple = multiple == 'true' ? true : false;\n                                Fast.api.close({\n                                    id: row.id,\n                                    name: row.name,\n                                    type: row.type_text,\n                                    drawlimit: row.drawlimit,\n                                    grant: row.grant\n                                });\n                            },\n                        }, formatter: function () {\n                            return '<a href=\"javascript:;\" class=\"btn btn-danger btn-chooseone btn-xs\"><i class=\"fa fa-check\"></i> ' + __('Choose') + '</a>';\n                        }\n                    }\n                ]\n            ],\n            queryParams: function(params){\n                var filter = JSON.parse(params.filter);\n                var op = JSON.parse(params.op);\n                var select_use_type = Fast.api.query('select_use_type');\n    \n                if (select_use_type != null){\n                    filter.use_type= select_use_type;\n                    op.use_type = \"=\";\n                }\n                params.filter = JSON.stringify(filter);\n                params.op = JSON.stringify(op);\n                return params;\n            }\n        });\n        // 为表格绑定事件\n        Table.api.bindevent(table);\n    },\n```\n\n后端代码 parent::index() 代码服务一份相应控制器就好了\n","slug":"php开发-fastadmin按钮弹框传数据到列表","published":1,"updated":"2024-10-18T06:03:55.066Z","_id":"clxys1z570000s4b1h6w34t8n","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、实现效果\"><a href=\"#一、实现效果\" class=\"headerlink\" title=\"一、实现效果\"></a>一、实现效果</h1><p>点击按钮 弹出选项列表，选择列表通过table 实现的<br>难点：<br>     1.点击弹框url中传值 怎么传到列表请求中，因为table 数据是通过ajax 试下的，就麻烦了<br>     2.点击选择按钮的实现 数据的回传 接收处理</p>\n<p><img src=\"../pic/dialogbox.png\" alt=\"lena\"></p>\n<h1 id=\"二、按钮页面-js代码\"><a href=\"#二、按钮页面-js代码\" class=\"headerlink\" title=\"二、按钮页面 js代码\"></a>二、按钮页面 js代码</h1><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$(<span class=\"string\">&quot;#select-coupon-btn&quot;</span>).click(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            parent.Fast.api.open(<span class=\"string\">&quot;wanlshop/street_coupon/select?select_use_type=2&quot;</span>, __(<span class=\"string\">&#x27;选择卡券&#x27;</span>), &#123;</span><br><span class=\"line\">                <span class=\"attr\">area</span>: [<span class=\"string\">&#x27;800px&#x27;</span>, <span class=\"string\">&#x27;600px&#x27;</span>],</span><br><span class=\"line\">                <span class=\"attr\">callback</span>: <span class=\"function\">(<span class=\"params\">data</span>)=&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(data)&#123;</span><br><span class=\"line\">                        $(<span class=\"string\">&quot;#coupon-table tbody tr&quot;</span>).last().remove();</span><br><span class=\"line\">                        $(<span class=\"string\">&quot;#send_gift&quot;</span>).val(data.id);</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (data.grant == -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                            data.grant = <span class=\"string\">&quot;不限&quot;</span>;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        $(<span class=\"string\">&quot;#coupon-table tbody&quot;</span>).last().append(<span class=\"string\">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span>+data.name+<span class=\"string\">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>+data.type+<span class=\"string\">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>+data.grant+<span class=\"string\">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span>);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"三、弹框页面\"><a href=\"#三、弹框页面\" class=\"headerlink\" title=\"三、弹框页面\"></a>三、弹框页面</h1><p>通过Fast.api.query(‘select_use_type’); 获取 然后加到ajax请求中</p>\n<p>弹框页面js代码</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">select</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化表格参数配置</span></span><br><span class=\"line\">    Table.api.init(&#123;</span><br><span class=\"line\">        <span class=\"attr\">extend</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">index_url</span>: <span class=\"string\">&#x27;wanlshop/street_coupon/select&#x27;</span>,</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> urlArr = [];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> table = $(<span class=\"string\">&quot;#table&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 多选的 操作</span></span><br><span class=\"line\">    table.on(<span class=\"string\">&#x27;check.bs.table uncheck.bs.table check-all.bs.table uncheck-all.bs.table&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">e, row</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (e.type == <span class=\"string\">&#x27;check&#x27;</span> || e.type == <span class=\"string\">&#x27;uncheck&#x27;</span>) &#123;</span><br><span class=\"line\">            row = [row];</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            urlArr = [];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        $.each(row, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">i, j</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (e.type.indexOf(<span class=\"string\">&quot;uncheck&quot;</span>) &gt; -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> index = urlArr.indexOf(j.id);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (index &gt; -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                    urlArr.splice(index, <span class=\"number\">1</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                urlArr.indexOf(j.id) == -<span class=\"number\">1</span> &amp;&amp; urlArr.push(j.id);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 初始化表格</span></span><br><span class=\"line\">    table.bootstrapTable(&#123;</span><br><span class=\"line\">        <span class=\"attr\">url</span>: $.fn.bootstrapTable.defaults.extend.index_url,</span><br><span class=\"line\">        <span class=\"attr\">sortName</span>: <span class=\"string\">&#x27;id&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">showToggle</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"attr\">showExport</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//是否显示右上角的搜索框</span></span><br><span class=\"line\">        <span class=\"attr\">search</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"comment\">//控制显示列开关</span></span><br><span class=\"line\">        <span class=\"attr\">showColumns</span>:<span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"comment\">//显示搜索字段框</span></span><br><span class=\"line\">        <span class=\"attr\">searchFormVisible</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"attr\">showExport</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"attr\">columns</span>: [</span><br><span class=\"line\">            [</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"attr\">field</span>: <span class=\"string\">&#x27;type&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Type&#x27;</span>),</span><br><span class=\"line\">                    <span class=\"attr\">searchList</span>: &#123;</span><br><span class=\"line\">                        <span class=\"string\">&quot;reduction&quot;</span>: <span class=\"string\">&quot;满减券&quot;</span>,</span><br><span class=\"line\">                        <span class=\"string\">&quot;discount&quot;</span>: <span class=\"string\">&quot;折扣券&quot;</span>,</span><br><span class=\"line\">                        <span class=\"string\">&quot;daijin&quot;</span>: <span class=\"string\">&quot;代金券&quot;</span>,</span><br><span class=\"line\">                        <span class=\"string\">&quot;stopcar&quot;</span>: <span class=\"string\">&quot;停车券&quot;</span>,</span><br><span class=\"line\">                        <span class=\"string\">&quot;gift&quot;</span>: <span class=\"string\">&quot;礼品券&quot;</span></span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    <span class=\"attr\">formatter</span>: Table.api.formatter.normal</span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">                &#123;<span class=\"attr\">field</span>: <span class=\"string\">&#x27;name&#x27;</span>, <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Name&#x27;</span>), <span class=\"attr\">operate</span>: <span class=\"string\">&#x27;LIKE&#x27;</span>&#125;,</span><br><span class=\"line\">                &#123;<span class=\"attr\">field</span>: <span class=\"string\">&#x27;drawlimit&#x27;</span>, <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Drawlimit&#x27;</span>)&#125;,</span><br><span class=\"line\">                &#123;<span class=\"attr\">field</span>: <span class=\"string\">&#x27;grant&#x27;</span>, <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Grant&#x27;</span>), <span class=\"attr\">operate</span>: <span class=\"string\">&#x27;LIKE&#x27;</span>,<span class=\"attr\">formatter</span>: Controller.api.formatter.grant&#125;,</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"attr\">field</span>: <span class=\"string\">&#x27;operate&#x27;</span>, <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Operate&#x27;</span>), <span class=\"attr\">events</span>: &#123;</span><br><span class=\"line\">                        <span class=\"string\">&#x27;click .btn-chooseone&#x27;</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">e, value, row, index</span>) </span>&#123;</span><br><span class=\"line\">                            <span class=\"comment\">// var multiple = Backend.api.query(&#x27;multiple&#x27;);</span></span><br><span class=\"line\">                            <span class=\"comment\">// multiple = multiple == &#x27;true&#x27; ? true : false;</span></span><br><span class=\"line\">                            Fast.api.close(&#123;</span><br><span class=\"line\">                                <span class=\"attr\">id</span>: row.id,</span><br><span class=\"line\">                                <span class=\"attr\">name</span>: row.name,</span><br><span class=\"line\">                                <span class=\"attr\">type</span>: row.type_text,</span><br><span class=\"line\">                                <span class=\"attr\">drawlimit</span>: row.drawlimit,</span><br><span class=\"line\">                                <span class=\"attr\">grant</span>: row.grant</span><br><span class=\"line\">                            &#125;);</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                    &#125;, <span class=\"attr\">formatter</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">                        <span class=\"keyword\">return</span> <span class=\"string\">&#x27;&lt;a href=&quot;javascript:;&quot; class=&quot;btn btn-danger btn-chooseone btn-xs&quot;&gt;&lt;i class=&quot;fa fa-check&quot;&gt;&lt;/i&gt; &#x27;</span> + __(<span class=\"string\">&#x27;Choose&#x27;</span>) + <span class=\"string\">&#x27;&lt;/a&gt;&#x27;</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">        ],</span><br><span class=\"line\">        <span class=\"attr\">queryParams</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">params</span>)</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> filter = <span class=\"built_in\">JSON</span>.parse(params.filter);</span><br><span class=\"line\">            <span class=\"keyword\">var</span> op = <span class=\"built_in\">JSON</span>.parse(params.op);</span><br><span class=\"line\">            <span class=\"keyword\">var</span> select_use_type = Fast.api.query(<span class=\"string\">&#x27;select_use_type&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (select_use_type != <span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">                filter.use_type= select_use_type;</span><br><span class=\"line\">                op.use_type = <span class=\"string\">&quot;=&quot;</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            params.filter = <span class=\"built_in\">JSON</span>.stringify(filter);</span><br><span class=\"line\">            params.op = <span class=\"built_in\">JSON</span>.stringify(op);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> params;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"comment\">// 为表格绑定事件</span></span><br><span class=\"line\">    Table.api.bindevent(table);</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n\n<p>后端代码 parent::index() 代码服务一份相应控制器就好了</p>\n","site":{"data":{}},"length":3553,"excerpt":"","more":"<h1 id=\"一、实现效果\"><a href=\"#一、实现效果\" class=\"headerlink\" title=\"一、实现效果\"></a>一、实现效果</h1><p>点击按钮 弹出选项列表，选择列表通过table 实现的<br>难点：<br>     1.点击弹框url中传值 怎么传到列表请求中，因为table 数据是通过ajax 试下的，就麻烦了<br>     2.点击选择按钮的实现 数据的回传 接收处理</p>\n<p><img src=\"../pic/dialogbox.png\" alt=\"lena\"></p>\n<h1 id=\"二、按钮页面-js代码\"><a href=\"#二、按钮页面-js代码\" class=\"headerlink\" title=\"二、按钮页面 js代码\"></a>二、按钮页面 js代码</h1><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$(<span class=\"string\">&quot;#select-coupon-btn&quot;</span>).click(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            parent.Fast.api.open(<span class=\"string\">&quot;wanlshop/street_coupon/select?select_use_type=2&quot;</span>, __(<span class=\"string\">&#x27;选择卡券&#x27;</span>), &#123;</span><br><span class=\"line\">                <span class=\"attr\">area</span>: [<span class=\"string\">&#x27;800px&#x27;</span>, <span class=\"string\">&#x27;600px&#x27;</span>],</span><br><span class=\"line\">                <span class=\"attr\">callback</span>: <span class=\"function\">(<span class=\"params\">data</span>)=&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(data)&#123;</span><br><span class=\"line\">                        $(<span class=\"string\">&quot;#coupon-table tbody tr&quot;</span>).last().remove();</span><br><span class=\"line\">                        $(<span class=\"string\">&quot;#send_gift&quot;</span>).val(data.id);</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (data.grant == -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                            data.grant = <span class=\"string\">&quot;不限&quot;</span>;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        $(<span class=\"string\">&quot;#coupon-table tbody&quot;</span>).last().append(<span class=\"string\">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span>+data.name+<span class=\"string\">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>+data.type+<span class=\"string\">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>+data.grant+<span class=\"string\">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span>);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"三、弹框页面\"><a href=\"#三、弹框页面\" class=\"headerlink\" title=\"三、弹框页面\"></a>三、弹框页面</h1><p>通过Fast.api.query(‘select_use_type’); 获取 然后加到ajax请求中</p>\n<p>弹框页面js代码</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">select</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化表格参数配置</span></span><br><span class=\"line\">    Table.api.init(&#123;</span><br><span class=\"line\">        <span class=\"attr\">extend</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">index_url</span>: <span class=\"string\">&#x27;wanlshop/street_coupon/select&#x27;</span>,</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> urlArr = [];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> table = $(<span class=\"string\">&quot;#table&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 多选的 操作</span></span><br><span class=\"line\">    table.on(<span class=\"string\">&#x27;check.bs.table uncheck.bs.table check-all.bs.table uncheck-all.bs.table&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">e, row</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (e.type == <span class=\"string\">&#x27;check&#x27;</span> || e.type == <span class=\"string\">&#x27;uncheck&#x27;</span>) &#123;</span><br><span class=\"line\">            row = [row];</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            urlArr = [];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        $.each(row, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">i, j</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (e.type.indexOf(<span class=\"string\">&quot;uncheck&quot;</span>) &gt; -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> index = urlArr.indexOf(j.id);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (index &gt; -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                    urlArr.splice(index, <span class=\"number\">1</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                urlArr.indexOf(j.id) == -<span class=\"number\">1</span> &amp;&amp; urlArr.push(j.id);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 初始化表格</span></span><br><span class=\"line\">    table.bootstrapTable(&#123;</span><br><span class=\"line\">        <span class=\"attr\">url</span>: $.fn.bootstrapTable.defaults.extend.index_url,</span><br><span class=\"line\">        <span class=\"attr\">sortName</span>: <span class=\"string\">&#x27;id&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">showToggle</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"attr\">showExport</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//是否显示右上角的搜索框</span></span><br><span class=\"line\">        <span class=\"attr\">search</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"comment\">//控制显示列开关</span></span><br><span class=\"line\">        <span class=\"attr\">showColumns</span>:<span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"comment\">//显示搜索字段框</span></span><br><span class=\"line\">        <span class=\"attr\">searchFormVisible</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"attr\">showExport</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"attr\">columns</span>: [</span><br><span class=\"line\">            [</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"attr\">field</span>: <span class=\"string\">&#x27;type&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Type&#x27;</span>),</span><br><span class=\"line\">                    <span class=\"attr\">searchList</span>: &#123;</span><br><span class=\"line\">                        <span class=\"string\">&quot;reduction&quot;</span>: <span class=\"string\">&quot;满减券&quot;</span>,</span><br><span class=\"line\">                        <span class=\"string\">&quot;discount&quot;</span>: <span class=\"string\">&quot;折扣券&quot;</span>,</span><br><span class=\"line\">                        <span class=\"string\">&quot;daijin&quot;</span>: <span class=\"string\">&quot;代金券&quot;</span>,</span><br><span class=\"line\">                        <span class=\"string\">&quot;stopcar&quot;</span>: <span class=\"string\">&quot;停车券&quot;</span>,</span><br><span class=\"line\">                        <span class=\"string\">&quot;gift&quot;</span>: <span class=\"string\">&quot;礼品券&quot;</span></span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    <span class=\"attr\">formatter</span>: Table.api.formatter.normal</span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">                &#123;<span class=\"attr\">field</span>: <span class=\"string\">&#x27;name&#x27;</span>, <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Name&#x27;</span>), <span class=\"attr\">operate</span>: <span class=\"string\">&#x27;LIKE&#x27;</span>&#125;,</span><br><span class=\"line\">                &#123;<span class=\"attr\">field</span>: <span class=\"string\">&#x27;drawlimit&#x27;</span>, <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Drawlimit&#x27;</span>)&#125;,</span><br><span class=\"line\">                &#123;<span class=\"attr\">field</span>: <span class=\"string\">&#x27;grant&#x27;</span>, <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Grant&#x27;</span>), <span class=\"attr\">operate</span>: <span class=\"string\">&#x27;LIKE&#x27;</span>,<span class=\"attr\">formatter</span>: Controller.api.formatter.grant&#125;,</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"attr\">field</span>: <span class=\"string\">&#x27;operate&#x27;</span>, <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Operate&#x27;</span>), <span class=\"attr\">events</span>: &#123;</span><br><span class=\"line\">                        <span class=\"string\">&#x27;click .btn-chooseone&#x27;</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">e, value, row, index</span>) </span>&#123;</span><br><span class=\"line\">                            <span class=\"comment\">// var multiple = Backend.api.query(&#x27;multiple&#x27;);</span></span><br><span class=\"line\">                            <span class=\"comment\">// multiple = multiple == &#x27;true&#x27; ? true : false;</span></span><br><span class=\"line\">                            Fast.api.close(&#123;</span><br><span class=\"line\">                                <span class=\"attr\">id</span>: row.id,</span><br><span class=\"line\">                                <span class=\"attr\">name</span>: row.name,</span><br><span class=\"line\">                                <span class=\"attr\">type</span>: row.type_text,</span><br><span class=\"line\">                                <span class=\"attr\">drawlimit</span>: row.drawlimit,</span><br><span class=\"line\">                                <span class=\"attr\">grant</span>: row.grant</span><br><span class=\"line\">                            &#125;);</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                    &#125;, <span class=\"attr\">formatter</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">                        <span class=\"keyword\">return</span> <span class=\"string\">&#x27;&lt;a href=&quot;javascript:;&quot; class=&quot;btn btn-danger btn-chooseone btn-xs&quot;&gt;&lt;i class=&quot;fa fa-check&quot;&gt;&lt;/i&gt; &#x27;</span> + __(<span class=\"string\">&#x27;Choose&#x27;</span>) + <span class=\"string\">&#x27;&lt;/a&gt;&#x27;</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">        ],</span><br><span class=\"line\">        <span class=\"attr\">queryParams</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">params</span>)</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> filter = <span class=\"built_in\">JSON</span>.parse(params.filter);</span><br><span class=\"line\">            <span class=\"keyword\">var</span> op = <span class=\"built_in\">JSON</span>.parse(params.op);</span><br><span class=\"line\">            <span class=\"keyword\">var</span> select_use_type = Fast.api.query(<span class=\"string\">&#x27;select_use_type&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (select_use_type != <span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">                filter.use_type= select_use_type;</span><br><span class=\"line\">                op.use_type = <span class=\"string\">&quot;=&quot;</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            params.filter = <span class=\"built_in\">JSON</span>.stringify(filter);</span><br><span class=\"line\">            params.op = <span class=\"built_in\">JSON</span>.stringify(op);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> params;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"comment\">// 为表格绑定事件</span></span><br><span class=\"line\">    Table.api.bindevent(table);</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n\n<p>后端代码 parent::index() 代码服务一份相应控制器就好了</p>\n"},{"title":"gitlab备份恢复","abbrlink":"6551734d","date":"2024-06-28T14:14:05.000Z","_content":"\n# gitlab 备份命令\n\n## 通过源码安装-备份命令\n\nbundle exec rake gitlab:backup:create RAILS_ENV=production\n\n    注   bundle exec 是一个用于执行 Rails 或其他 Ruby 项目的命令\n    \n         bundle exec rake  是一个用于执行 Ruby on Rails 项目中的 Rake 任务的命令。\n         Rake 是 Ruby 中一个构建工具，用于自动化任务、数据库迁移、部署等操作\n         \n         bundle exec rails s\n         这会在 Rails 项目中启动一个本地服务器\n         \n         \n         \n## 有gitlab-rake 命令工具\n\ngitlab-rake gitlab:backup:create\n\n\n## 安装在docker中 可以用\n    \n后台运行   \nsudo docker exec -d a51fe5f513bc bundle exec rake gitlab:backup:create RAILS_ENV=production\n\n\nsudo docker exec a51fe5f513bc  /bin/bash -c \"bundle exec rake gitlab:backup:create RAILS_ENV=production\"\n\n\n\n# 备份所在目录\n\n通常在/var/opt/gitlab/backups目录下\n\n在gitlab 目录下 config/gitlab.yml 有个\n\nbackup:\n    path: \"/home/git/data/backups\" \n    \n    \n# 恢复备份\n\n\n    ","source":"_posts/gitlab备份恢复.md","raw":"---\ntitle: gitlab备份恢复\nabbrlink: 6551734d\ndate: 2024-06-28 22:14:05\ntags:\n -gitlab\ncategories:\n  - 服务器相关  \n---\n\n# gitlab 备份命令\n\n## 通过源码安装-备份命令\n\nbundle exec rake gitlab:backup:create RAILS_ENV=production\n\n    注   bundle exec 是一个用于执行 Rails 或其他 Ruby 项目的命令\n    \n         bundle exec rake  是一个用于执行 Ruby on Rails 项目中的 Rake 任务的命令。\n         Rake 是 Ruby 中一个构建工具，用于自动化任务、数据库迁移、部署等操作\n         \n         bundle exec rails s\n         这会在 Rails 项目中启动一个本地服务器\n         \n         \n         \n## 有gitlab-rake 命令工具\n\ngitlab-rake gitlab:backup:create\n\n\n## 安装在docker中 可以用\n    \n后台运行   \nsudo docker exec -d a51fe5f513bc bundle exec rake gitlab:backup:create RAILS_ENV=production\n\n\nsudo docker exec a51fe5f513bc  /bin/bash -c \"bundle exec rake gitlab:backup:create RAILS_ENV=production\"\n\n\n\n# 备份所在目录\n\n通常在/var/opt/gitlab/backups目录下\n\n在gitlab 目录下 config/gitlab.yml 有个\n\nbackup:\n    path: \"/home/git/data/backups\" \n    \n    \n# 恢复备份\n\n\n    ","slug":"gitlab备份恢复","published":1,"updated":"2024-11-25T11:37:34.429Z","_id":"clxys3eci0000ubb18aijcc5m","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"gitlab-备份命令\"><a href=\"#gitlab-备份命令\" class=\"headerlink\" title=\"gitlab 备份命令\"></a>gitlab 备份命令</h1><h2 id=\"通过源码安装-备份命令\"><a href=\"#通过源码安装-备份命令\" class=\"headerlink\" title=\"通过源码安装-备份命令\"></a>通过源码安装-备份命令</h2><p>bundle exec rake gitlab:backup:create RAILS_ENV=production</p>\n<pre><code>注   bundle exec 是一个用于执行 Rails 或其他 Ruby 项目的命令\n\n     bundle exec rake  是一个用于执行 Ruby on Rails 项目中的 Rake 任务的命令。\n     Rake 是 Ruby 中一个构建工具，用于自动化任务、数据库迁移、部署等操作\n     \n     bundle exec rails s\n     这会在 Rails 项目中启动一个本地服务器\n     \n     \n     \n</code></pre>\n<h2 id=\"有gitlab-rake-命令工具\"><a href=\"#有gitlab-rake-命令工具\" class=\"headerlink\" title=\"有gitlab-rake 命令工具\"></a>有gitlab-rake 命令工具</h2><p>gitlab-rake gitlab:backup:create</p>\n<h2 id=\"安装在docker中-可以用\"><a href=\"#安装在docker中-可以用\" class=\"headerlink\" title=\"安装在docker中 可以用\"></a>安装在docker中 可以用</h2><p>后台运行<br>sudo docker exec -d a51fe5f513bc bundle exec rake gitlab:backup:create RAILS_ENV=production</p>\n<p>sudo docker exec a51fe5f513bc  /bin/bash -c “bundle exec rake gitlab:backup:create RAILS_ENV=production”</p>\n<h1 id=\"备份所在目录\"><a href=\"#备份所在目录\" class=\"headerlink\" title=\"备份所在目录\"></a>备份所在目录</h1><p>通常在/var/opt/gitlab/backups目录下</p>\n<p>在gitlab 目录下 config/gitlab.yml 有个</p>\n<p>backup:<br>    path: “/home/git/data/backups” </p>\n<h1 id=\"恢复备份\"><a href=\"#恢复备份\" class=\"headerlink\" title=\"恢复备份\"></a>恢复备份</h1>","site":{"data":{}},"length":571,"excerpt":"","more":"<h1 id=\"gitlab-备份命令\"><a href=\"#gitlab-备份命令\" class=\"headerlink\" title=\"gitlab 备份命令\"></a>gitlab 备份命令</h1><h2 id=\"通过源码安装-备份命令\"><a href=\"#通过源码安装-备份命令\" class=\"headerlink\" title=\"通过源码安装-备份命令\"></a>通过源码安装-备份命令</h2><p>bundle exec rake gitlab:backup:create RAILS_ENV=production</p>\n<pre><code>注   bundle exec 是一个用于执行 Rails 或其他 Ruby 项目的命令\n\n     bundle exec rake  是一个用于执行 Ruby on Rails 项目中的 Rake 任务的命令。\n     Rake 是 Ruby 中一个构建工具，用于自动化任务、数据库迁移、部署等操作\n     \n     bundle exec rails s\n     这会在 Rails 项目中启动一个本地服务器\n     \n     \n     \n</code></pre>\n<h2 id=\"有gitlab-rake-命令工具\"><a href=\"#有gitlab-rake-命令工具\" class=\"headerlink\" title=\"有gitlab-rake 命令工具\"></a>有gitlab-rake 命令工具</h2><p>gitlab-rake gitlab:backup:create</p>\n<h2 id=\"安装在docker中-可以用\"><a href=\"#安装在docker中-可以用\" class=\"headerlink\" title=\"安装在docker中 可以用\"></a>安装在docker中 可以用</h2><p>后台运行<br>sudo docker exec -d a51fe5f513bc bundle exec rake gitlab:backup:create RAILS_ENV=production</p>\n<p>sudo docker exec a51fe5f513bc  /bin/bash -c “bundle exec rake gitlab:backup:create RAILS_ENV=production”</p>\n<h1 id=\"备份所在目录\"><a href=\"#备份所在目录\" class=\"headerlink\" title=\"备份所在目录\"></a>备份所在目录</h1><p>通常在/var/opt/gitlab/backups目录下</p>\n<p>在gitlab 目录下 config/gitlab.yml 有个</p>\n<p>backup:<br>    path: “/home/git/data/backups” </p>\n<h1 id=\"恢复备份\"><a href=\"#恢复备份\" class=\"headerlink\" title=\"恢复备份\"></a>恢复备份</h1>"},{"title":"php开发-微信登录","abbrlink":"77054df3","date":"2024-07-04T11:52:39.000Z","_content":"","source":"_posts/php开发-微信登录.md","raw":"---\ntitle: php开发-微信登录\nabbrlink: 77054df3\ndate: 2024-07-04 19:52:39\ntags:\ncategories:\n  - PHP开发\n---\n","slug":"php开发-微信登录","published":1,"updated":"2024-11-25T11:34:30.005Z","_id":"cly77ll0b00005kocczqi3ftg","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"mysql-主从数据库","abbrlink":"585d050b","date":"2024-07-23T02:33:22.000Z","_content":"\n\n# mysql主从的应用\n\n\n## 用来数据迁移\n\n    开启主从同步，将数据导入主节点，让从节点同步；\n    \n    将数据分别导入主从节点，让主从节点数据一致后，建立连接，开启同步\n    \n## 数据备份\n\n\n##  读写分离\n    \n    \n# 配置\n\n## 主节点配置\n\n### 主节点 my.cnf配置\n    my.cnf  mysqld    \n    \n    # 开启日志\n    general_log = 1\n    general_log_file = mysql.log\n    # 主从复制配置\n    server-id = 1\n    # binlog日志格式，mysql默认采用statement，建议使用mixed\n    # STATEMENT模式（SBR）\n    # 每一条会修改数据的sql语句会记录到binlog中。优点是并不需要记录每一条sql语句和每一行的数据变化，减少了binlog日志量，节约IO，提高性能。缺点是在某些情况下会导致master-slave中的数据不一致(如sleep()函数， last_insert_id()，以及user-defined functions(udf)等会出现问题)\n    # ROW模式（RBR）\n    # 不记录每条sql语句的上下文信息，仅需记录哪条数据被修改了，修改成什么样了。而且不会出现某些特定情况下的存储过程、或function、或trigger的调用和触发无法被正确复制的问题。缺点是会产生大量的日志，尤其是alter table的时候会让日志暴涨。\n    # MIXED模式（MBR）\n    # 以上两种模式的混合使用，一般的复制使用STATEMENT模式保存binlog，对于STATEMENT模式无法复制的操作使用ROW模式保存binlog，MySQL会根据执行的SQL语句选择日志保存方式。\n    binlog_format= MIXED\n    # binlog日志文件\n    log-bin=mysql-bin\n    # 是否只读，1 代表只读，0代表读写，主数据库需要读写，设置0\n    read-only=0\n    # binlog过期清理时间\n    expire_logs_days=7\n    # binlog每个日志文件大小\n    max_binlog_size= 100m\n    # binlog缓存大小\n    binlog_cache_size= 4m\n    # 最大binlog缓存大小\n    max_binlog_cache_size= 512m\n### 相关sql操作\n\n    ## 创建dd用户 授权只能ip 192.168.227.134 访问 密码设置为123456\n    CREATE USER 'dd'@'192.168.227.134' IDENTIFIED BY '123456';\n    \n    ## 设置一个从服务器（slave）来复制主服务器（master）的数据权限\n    GRANT REPLICATION SLAVE ON *.* TO 'dd'@'192.168.227.134';\n\n    show master status \n    \n    \n### 从节点 my.cnf配置    \n\n    server-id=2\n    #它指定了从服务器（slave）用于存储从中继日志（relay logs）\n    #中读取并准备应用于本地数据库的事件的文件的路径和名称模式。\n    relay-log=mysql-relay-bin\n    \n    \n    sql\n    //配置并启动主从复制\n    change master to\n        -> master_host='192.168.227.133',\t\t#主的ip地址\n        -> master_user='dd',\t\t\t\t\t#创建的用户名\n        -> master_password='123456',\t\t\t#创建的密码\n        -> master_log_file='mysql-bin.000001',\t#日志文件\n        -> master_log_pos=328;\t\t\t\t\t#数据的最新位置\n\n    //开启奴隶模式\n    start slave;\t\n    \n    show slave status ","source":"_posts/mysql-主从数据库.md","raw":"---\ntitle: mysql-主从数据库\nabbrlink: 585d050b\ndate: 2024-07-23 10:33:22\ncategories:\n - mysql\ntags:\n - mysql\n---\n\n\n# mysql主从的应用\n\n\n## 用来数据迁移\n\n    开启主从同步，将数据导入主节点，让从节点同步；\n    \n    将数据分别导入主从节点，让主从节点数据一致后，建立连接，开启同步\n    \n## 数据备份\n\n\n##  读写分离\n    \n    \n# 配置\n\n## 主节点配置\n\n### 主节点 my.cnf配置\n    my.cnf  mysqld    \n    \n    # 开启日志\n    general_log = 1\n    general_log_file = mysql.log\n    # 主从复制配置\n    server-id = 1\n    # binlog日志格式，mysql默认采用statement，建议使用mixed\n    # STATEMENT模式（SBR）\n    # 每一条会修改数据的sql语句会记录到binlog中。优点是并不需要记录每一条sql语句和每一行的数据变化，减少了binlog日志量，节约IO，提高性能。缺点是在某些情况下会导致master-slave中的数据不一致(如sleep()函数， last_insert_id()，以及user-defined functions(udf)等会出现问题)\n    # ROW模式（RBR）\n    # 不记录每条sql语句的上下文信息，仅需记录哪条数据被修改了，修改成什么样了。而且不会出现某些特定情况下的存储过程、或function、或trigger的调用和触发无法被正确复制的问题。缺点是会产生大量的日志，尤其是alter table的时候会让日志暴涨。\n    # MIXED模式（MBR）\n    # 以上两种模式的混合使用，一般的复制使用STATEMENT模式保存binlog，对于STATEMENT模式无法复制的操作使用ROW模式保存binlog，MySQL会根据执行的SQL语句选择日志保存方式。\n    binlog_format= MIXED\n    # binlog日志文件\n    log-bin=mysql-bin\n    # 是否只读，1 代表只读，0代表读写，主数据库需要读写，设置0\n    read-only=0\n    # binlog过期清理时间\n    expire_logs_days=7\n    # binlog每个日志文件大小\n    max_binlog_size= 100m\n    # binlog缓存大小\n    binlog_cache_size= 4m\n    # 最大binlog缓存大小\n    max_binlog_cache_size= 512m\n### 相关sql操作\n\n    ## 创建dd用户 授权只能ip 192.168.227.134 访问 密码设置为123456\n    CREATE USER 'dd'@'192.168.227.134' IDENTIFIED BY '123456';\n    \n    ## 设置一个从服务器（slave）来复制主服务器（master）的数据权限\n    GRANT REPLICATION SLAVE ON *.* TO 'dd'@'192.168.227.134';\n\n    show master status \n    \n    \n### 从节点 my.cnf配置    \n\n    server-id=2\n    #它指定了从服务器（slave）用于存储从中继日志（relay logs）\n    #中读取并准备应用于本地数据库的事件的文件的路径和名称模式。\n    relay-log=mysql-relay-bin\n    \n    \n    sql\n    //配置并启动主从复制\n    change master to\n        -> master_host='192.168.227.133',\t\t#主的ip地址\n        -> master_user='dd',\t\t\t\t\t#创建的用户名\n        -> master_password='123456',\t\t\t#创建的密码\n        -> master_log_file='mysql-bin.000001',\t#日志文件\n        -> master_log_pos=328;\t\t\t\t\t#数据的最新位置\n\n    //开启奴隶模式\n    start slave;\t\n    \n    show slave status ","slug":"mysql-主从数据库","published":1,"updated":"2024-11-25T11:21:02.790Z","_id":"clyye6e9g0000f0ocb5b5heao","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"mysql主从的应用\"><a href=\"#mysql主从的应用\" class=\"headerlink\" title=\"mysql主从的应用\"></a>mysql主从的应用</h1><h2 id=\"用来数据迁移\"><a href=\"#用来数据迁移\" class=\"headerlink\" title=\"用来数据迁移\"></a>用来数据迁移</h2><pre><code>开启主从同步，将数据导入主节点，让从节点同步；\n\n将数据分别导入主从节点，让主从节点数据一致后，建立连接，开启同步\n</code></pre>\n<h2 id=\"数据备份\"><a href=\"#数据备份\" class=\"headerlink\" title=\"数据备份\"></a>数据备份</h2><h2 id=\"读写分离\"><a href=\"#读写分离\" class=\"headerlink\" title=\"读写分离\"></a>读写分离</h2><h1 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h1><h2 id=\"主节点配置\"><a href=\"#主节点配置\" class=\"headerlink\" title=\"主节点配置\"></a>主节点配置</h2><h3 id=\"主节点-my-cnf配置\"><a href=\"#主节点-my-cnf配置\" class=\"headerlink\" title=\"主节点 my.cnf配置\"></a>主节点 my.cnf配置</h3><pre><code>my.cnf  mysqld    \n\n# 开启日志\ngeneral_log = 1\ngeneral_log_file = mysql.log\n# 主从复制配置\nserver-id = 1\n# binlog日志格式，mysql默认采用statement，建议使用mixed\n# STATEMENT模式（SBR）\n# 每一条会修改数据的sql语句会记录到binlog中。优点是并不需要记录每一条sql语句和每一行的数据变化，减少了binlog日志量，节约IO，提高性能。缺点是在某些情况下会导致master-slave中的数据不一致(如sleep()函数， last_insert_id()，以及user-defined functions(udf)等会出现问题)\n# ROW模式（RBR）\n# 不记录每条sql语句的上下文信息，仅需记录哪条数据被修改了，修改成什么样了。而且不会出现某些特定情况下的存储过程、或function、或trigger的调用和触发无法被正确复制的问题。缺点是会产生大量的日志，尤其是alter table的时候会让日志暴涨。\n# MIXED模式（MBR）\n# 以上两种模式的混合使用，一般的复制使用STATEMENT模式保存binlog，对于STATEMENT模式无法复制的操作使用ROW模式保存binlog，MySQL会根据执行的SQL语句选择日志保存方式。\nbinlog_format= MIXED\n# binlog日志文件\nlog-bin=mysql-bin\n# 是否只读，1 代表只读，0代表读写，主数据库需要读写，设置0\nread-only=0\n# binlog过期清理时间\nexpire_logs_days=7\n# binlog每个日志文件大小\nmax_binlog_size= 100m\n# binlog缓存大小\nbinlog_cache_size= 4m\n# 最大binlog缓存大小\nmax_binlog_cache_size= 512m\n</code></pre>\n<h3 id=\"相关sql操作\"><a href=\"#相关sql操作\" class=\"headerlink\" title=\"相关sql操作\"></a>相关sql操作</h3><pre><code>## 创建dd用户 授权只能ip 192.168.227.134 访问 密码设置为123456\nCREATE USER &#39;dd&#39;@&#39;192.168.227.134&#39; IDENTIFIED BY &#39;123456&#39;;\n\n## 设置一个从服务器（slave）来复制主服务器（master）的数据权限\nGRANT REPLICATION SLAVE ON *.* TO &#39;dd&#39;@&#39;192.168.227.134&#39;;\n\nshow master status \n</code></pre>\n<h3 id=\"从节点-my-cnf配置\"><a href=\"#从节点-my-cnf配置\" class=\"headerlink\" title=\"从节点 my.cnf配置\"></a>从节点 my.cnf配置</h3><pre><code>server-id=2\n#它指定了从服务器（slave）用于存储从中继日志（relay logs）\n#中读取并准备应用于本地数据库的事件的文件的路径和名称模式。\nrelay-log=mysql-relay-bin\n\n\nsql\n//配置并启动主从复制\nchange master to\n    -&gt; master_host=&#39;192.168.227.133&#39;,        #主的ip地址\n    -&gt; master_user=&#39;dd&#39;,                    #创建的用户名\n    -&gt; master_password=&#39;123456&#39;,            #创建的密码\n    -&gt; master_log_file=&#39;mysql-bin.000001&#39;,    #日志文件\n    -&gt; master_log_pos=328;                    #数据的最新位置\n\n//开启奴隶模式\nstart slave;    \n\nshow slave status \n</code></pre>\n","site":{"data":{}},"length":1514,"excerpt":"","more":"<h1 id=\"mysql主从的应用\"><a href=\"#mysql主从的应用\" class=\"headerlink\" title=\"mysql主从的应用\"></a>mysql主从的应用</h1><h2 id=\"用来数据迁移\"><a href=\"#用来数据迁移\" class=\"headerlink\" title=\"用来数据迁移\"></a>用来数据迁移</h2><pre><code>开启主从同步，将数据导入主节点，让从节点同步；\n\n将数据分别导入主从节点，让主从节点数据一致后，建立连接，开启同步\n</code></pre>\n<h2 id=\"数据备份\"><a href=\"#数据备份\" class=\"headerlink\" title=\"数据备份\"></a>数据备份</h2><h2 id=\"读写分离\"><a href=\"#读写分离\" class=\"headerlink\" title=\"读写分离\"></a>读写分离</h2><h1 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h1><h2 id=\"主节点配置\"><a href=\"#主节点配置\" class=\"headerlink\" title=\"主节点配置\"></a>主节点配置</h2><h3 id=\"主节点-my-cnf配置\"><a href=\"#主节点-my-cnf配置\" class=\"headerlink\" title=\"主节点 my.cnf配置\"></a>主节点 my.cnf配置</h3><pre><code>my.cnf  mysqld    \n\n# 开启日志\ngeneral_log = 1\ngeneral_log_file = mysql.log\n# 主从复制配置\nserver-id = 1\n# binlog日志格式，mysql默认采用statement，建议使用mixed\n# STATEMENT模式（SBR）\n# 每一条会修改数据的sql语句会记录到binlog中。优点是并不需要记录每一条sql语句和每一行的数据变化，减少了binlog日志量，节约IO，提高性能。缺点是在某些情况下会导致master-slave中的数据不一致(如sleep()函数， last_insert_id()，以及user-defined functions(udf)等会出现问题)\n# ROW模式（RBR）\n# 不记录每条sql语句的上下文信息，仅需记录哪条数据被修改了，修改成什么样了。而且不会出现某些特定情况下的存储过程、或function、或trigger的调用和触发无法被正确复制的问题。缺点是会产生大量的日志，尤其是alter table的时候会让日志暴涨。\n# MIXED模式（MBR）\n# 以上两种模式的混合使用，一般的复制使用STATEMENT模式保存binlog，对于STATEMENT模式无法复制的操作使用ROW模式保存binlog，MySQL会根据执行的SQL语句选择日志保存方式。\nbinlog_format= MIXED\n# binlog日志文件\nlog-bin=mysql-bin\n# 是否只读，1 代表只读，0代表读写，主数据库需要读写，设置0\nread-only=0\n# binlog过期清理时间\nexpire_logs_days=7\n# binlog每个日志文件大小\nmax_binlog_size= 100m\n# binlog缓存大小\nbinlog_cache_size= 4m\n# 最大binlog缓存大小\nmax_binlog_cache_size= 512m\n</code></pre>\n<h3 id=\"相关sql操作\"><a href=\"#相关sql操作\" class=\"headerlink\" title=\"相关sql操作\"></a>相关sql操作</h3><pre><code>## 创建dd用户 授权只能ip 192.168.227.134 访问 密码设置为123456\nCREATE USER &#39;dd&#39;@&#39;192.168.227.134&#39; IDENTIFIED BY &#39;123456&#39;;\n\n## 设置一个从服务器（slave）来复制主服务器（master）的数据权限\nGRANT REPLICATION SLAVE ON *.* TO &#39;dd&#39;@&#39;192.168.227.134&#39;;\n\nshow master status \n</code></pre>\n<h3 id=\"从节点-my-cnf配置\"><a href=\"#从节点-my-cnf配置\" class=\"headerlink\" title=\"从节点 my.cnf配置\"></a>从节点 my.cnf配置</h3><pre><code>server-id=2\n#它指定了从服务器（slave）用于存储从中继日志（relay logs）\n#中读取并准备应用于本地数据库的事件的文件的路径和名称模式。\nrelay-log=mysql-relay-bin\n\n\nsql\n//配置并启动主从复制\nchange master to\n    -&gt; master_host=&#39;192.168.227.133&#39;,        #主的ip地址\n    -&gt; master_user=&#39;dd&#39;,                    #创建的用户名\n    -&gt; master_password=&#39;123456&#39;,            #创建的密码\n    -&gt; master_log_file=&#39;mysql-bin.000001&#39;,    #日志文件\n    -&gt; master_log_pos=328;                    #数据的最新位置\n\n//开启奴隶模式\nstart slave;    \n\nshow slave status \n</code></pre>\n"},{"title":"php开发-fastadmin表格操作列自定义按钮","abbrlink":"5f9fc809","date":"2024-08-08T12:30:54.000Z","_content":"\n# 自定义弹框效果按钮\n\nclassname字段控制 btn-dialog\n\n```js\n     {\n        name: 'changerecord',\n        text: '动账记录查询',\n        icon: 'fa fa-search',\n        classname: 'btn btn-info btn-xs btn-dialog',\n        url: 'cms/bank/changeRecord'\n     },\n```\n\n# 需要确认后再处理\n\nvisible 字段可根据数据判断 是否显示按钮\n\n```js\n         {\n            name: 'jy',\n            text: '解约',\n            icon: 'fa fa-search',\n            classname: 'btn btn-info btn-xs btn-danger btn-ajax',\n            url: 'cms/bank/unwind',\n            visible: function (row) {\n                if (row.status == 0) {\n                    return true;\n                } else {\n                    return false;\n                }\n            },\n            confirm: '确定要解约吗?',\n            success: function (data, ret) {\n                $(\"a.btn-refresh\").trigger(\"click\");\n                layer.alert(ret.msg);\n\n                //如果需要阻止成功提示，则必须使用return false;\n                //return false;\n            },\n            error: function (data, ret) {\n                console.log(data, ret);\n                layer.alert(ret.msg);\n                return false;\n            }\n         }\n```    \n\n# 控制字段的显示\n\nformatter字段中处理\n\n```js \n {\n    field: 'status', title: '状态',operate: false, formatter: function (value) {\n        if (value == 0) {\n            return \"已签约\";\n        } else if (value == 1) {\n            return \"未签约\";\n        }\n    }\n}\n```\n```js\n  {field: 'grant', title: __('Grant'), operate: 'LIKE',formatter: Controller.api.formatter.grant}\n```\n\n# 自定义编辑删除按钮\n\n```js\n   {\n        name: 'edit',\n        icon: 'fa fa-pencil',\n        title: __('Edit'),\n        extend: 'data-toggle=\"tooltip\"',\n        classname: 'btn btn-xs btn-success btn-editone',\n        visible: function (row) {\n            return row.status === 0;\n        }\n    },\n   {\n        name: 'del',\n        icon: 'fa fa-trash',\n        title: __('Del'),\n        extend: 'data-toggle=\"tooltip\"',\n        classname: 'btn btn-xs btn-danger btn-delone',\n        visible: function (row) {\n            return row.status === 0;\n        }\n   }\n```\n\n# 自定义提交处理\n\n```js\n  add: function () {\n            Controller.api.selectcoupon();\n            Controller.api.selectusers();\n            \n            Form.api.bindevent($(\"form[role=form]\"), function(data, ret){\n                //如果我们需要在提交表单成功后做跳转，可以在此使用location.href=\"链接\";进行跳转\n            }, function(data, ret){\n                // 错误处理\n                Fast.api.close();\n            }, function(success, error){\n                //bindevent的第三个参数为提交前的回调\n                //如果我们需要在表单提交前做一些数据处理，则可以在此方法处理\n                //注意如果我们需要阻止表单，可以在此使用return false;即可\n                //如果我们处理完成需要再次提交表单则可以使用submit提交,如下\n                if(!$(\"#user_ids\").val()){\n                    Toastr.error(\"请选择发放用户\");\n                    return false;\n                }\n                if(!$(\"#couponid\").val()){\n                    Toastr.error(\"请选择发放卡券\");\n                    return false;\n                }\n            });\n\n      }\n```\n\n# 完整 示例代码\n    \n    \n```html\n    columns: [\n                    [\n                        {checkbox: true},\n                        {field: 'id', title: \"ID\",operate: false},\n                        {field: 'account', title: \"账号\", operate: 'like'},\n                        {field: 'school.school_name', title: \"学校\", operate: 'like'},\n                        {field: 'balance', title: \"余额/元\", operate: false},\n                        {\n                            field: 'status', title: '状态',operate: false, formatter: function (value) {\n                                if (value == 0) {\n                                    return \"已签约\";\n                                } else if (value == 1) {\n                                    return \"未签约\";\n                                }\n                            }\n                        },\n                        {\n                            field: 'operate', title: __('Operate'), table: table,\n                            events: Table.api.events.operate,\n                            buttons: [\n                                {\n                                    name: 'changerecord',\n                                    text: '动账记录查询',\n                                    icon: 'fa fa-search',\n                                    classname: 'btn btn-info btn-xs btn-dialog',\n                                    url: 'cms/bank/changeRecord'\n                                },\n                                {\n                                    name: 'freezerecord',\n                                    text: '冻结/解冻记录',\n                                    icon: 'fa fa-search',\n                                    classname: 'btn btn-info btn-xs btn-detail btn-dialog',\n                                    url: 'cms/bank/freezeRecord',\n                                },\n                                {\n                                    name: 'balance',\n                                    text: '查询余额',\n                                    icon: 'fa fa-search',\n                                    classname: 'btn btn-info btn-xs btn-balance',\n                                },\n                                {\n                                    name: 'qy',\n                                    text: '签约',\n                                    icon: 'fa fa-search',\n                                    classname: 'btn btn-info btn-xs btn-success btn-ajax',\n                                    url: 'cms/bank/sign',\n                                    visible: function (row) {\n                                        if (row.status == 1) {\n                                            return true;\n                                        } else {\n                                            return false;\n                                        }\n                                    },\n                                    success: function (data, ret) {\n                                        $(\"a.btn-refresh\").trigger(\"click\");\n                                        layer.alert(ret.msg);\n                                        //如果需要阻止成功提示，则必须使用return false;\n                                        //return false;\n                                    },\n                                    error: function (data, ret) {\n                                        console.log(data, ret);\n                                        layer.alert(ret.msg);\n                                        return false;\n                                    }\n                                },\n                                {\n                                    name: 'jy',\n                                    text: '解约',\n                                    icon: 'fa fa-search',\n                                    classname: 'btn btn-info btn-xs btn-danger btn-ajax',\n                                    url: 'cms/bank/unwind',\n                                    visible: function (row) {\n                                        if (row.status == 0) {\n                                            return true;\n                                        } else {\n                                            return false;\n                                        }\n                                    },\n                                    confirm: '确定要解约吗?',\n                                    success: function (data, ret) {\n                                        $(\"a.btn-refresh\").trigger(\"click\");\n                                        layer.alert(ret.msg);\n\n                                        //如果需要阻止成功提示，则必须使用return false;\n                                        //return false;\n                                    },\n                                    error: function (data, ret) {\n                                        console.log(data, ret);\n                                        layer.alert(ret.msg);\n                                        return false;\n                                    }\n\n                                },\n                                {\n                                    name: 'dj',\n                                    text: '冻结',\n                                    icon: 'fa fa-search',\n                                    classname: 'btn btn-info btn-xs btn-danger btn-ajax',\n                                    url: 'cms/bank/frozen',\n                                    confirm: '确定要冻结吗?',\n                                    success: function (data, ret) {\n                                        $(\"a.btn-refresh\").trigger(\"click\");\n                                        layer.alert(ret.msg);\n\n                                        //如果需要阻止成功提示，则必须使用return false;\n                                        //return false;\n                                    },\n                                    error: function (data, ret) {\n                                        console.log(data, ret);\n                                        layer.alert(ret.msg);\n                                        return false;\n                                    }\n\n                                },\n                             {\n                                name: 'edit',\n                                icon: 'fa fa-pencil',\n                                title: __('Edit'),\n                                extend: 'data-toggle=\"tooltip\"',\n                                classname: 'btn btn-xs btn-success btn-editone',\n                                visible: function (row) {\n                                    return row.status === 0;\n                                }\n                            },\n                            {\n                                name: 'del',\n                                icon: 'fa fa-trash',\n                                title: __('Del'),\n                                extend: 'data-toggle=\"tooltip\"',\n                                classname: 'btn btn-xs btn-danger btn-delone',\n                                visible: function (row) {\n                                    return row.status === 0;\n                                }\n                            }\n                        ], formatter: Table.api.formatter.operate}\n                        }\n\n                    ]\n                ]\n```","source":"_posts/php开发-fastadmin表格操作列自定义按钮.md","raw":"---\ntitle: php开发-fastadmin表格操作列自定义按钮\nabbrlink: 5f9fc809\ndate: 2024-08-08 20:30:54\ntags: fastadmin\n---\n\n# 自定义弹框效果按钮\n\nclassname字段控制 btn-dialog\n\n```js\n     {\n        name: 'changerecord',\n        text: '动账记录查询',\n        icon: 'fa fa-search',\n        classname: 'btn btn-info btn-xs btn-dialog',\n        url: 'cms/bank/changeRecord'\n     },\n```\n\n# 需要确认后再处理\n\nvisible 字段可根据数据判断 是否显示按钮\n\n```js\n         {\n            name: 'jy',\n            text: '解约',\n            icon: 'fa fa-search',\n            classname: 'btn btn-info btn-xs btn-danger btn-ajax',\n            url: 'cms/bank/unwind',\n            visible: function (row) {\n                if (row.status == 0) {\n                    return true;\n                } else {\n                    return false;\n                }\n            },\n            confirm: '确定要解约吗?',\n            success: function (data, ret) {\n                $(\"a.btn-refresh\").trigger(\"click\");\n                layer.alert(ret.msg);\n\n                //如果需要阻止成功提示，则必须使用return false;\n                //return false;\n            },\n            error: function (data, ret) {\n                console.log(data, ret);\n                layer.alert(ret.msg);\n                return false;\n            }\n         }\n```    \n\n# 控制字段的显示\n\nformatter字段中处理\n\n```js \n {\n    field: 'status', title: '状态',operate: false, formatter: function (value) {\n        if (value == 0) {\n            return \"已签约\";\n        } else if (value == 1) {\n            return \"未签约\";\n        }\n    }\n}\n```\n```js\n  {field: 'grant', title: __('Grant'), operate: 'LIKE',formatter: Controller.api.formatter.grant}\n```\n\n# 自定义编辑删除按钮\n\n```js\n   {\n        name: 'edit',\n        icon: 'fa fa-pencil',\n        title: __('Edit'),\n        extend: 'data-toggle=\"tooltip\"',\n        classname: 'btn btn-xs btn-success btn-editone',\n        visible: function (row) {\n            return row.status === 0;\n        }\n    },\n   {\n        name: 'del',\n        icon: 'fa fa-trash',\n        title: __('Del'),\n        extend: 'data-toggle=\"tooltip\"',\n        classname: 'btn btn-xs btn-danger btn-delone',\n        visible: function (row) {\n            return row.status === 0;\n        }\n   }\n```\n\n# 自定义提交处理\n\n```js\n  add: function () {\n            Controller.api.selectcoupon();\n            Controller.api.selectusers();\n            \n            Form.api.bindevent($(\"form[role=form]\"), function(data, ret){\n                //如果我们需要在提交表单成功后做跳转，可以在此使用location.href=\"链接\";进行跳转\n            }, function(data, ret){\n                // 错误处理\n                Fast.api.close();\n            }, function(success, error){\n                //bindevent的第三个参数为提交前的回调\n                //如果我们需要在表单提交前做一些数据处理，则可以在此方法处理\n                //注意如果我们需要阻止表单，可以在此使用return false;即可\n                //如果我们处理完成需要再次提交表单则可以使用submit提交,如下\n                if(!$(\"#user_ids\").val()){\n                    Toastr.error(\"请选择发放用户\");\n                    return false;\n                }\n                if(!$(\"#couponid\").val()){\n                    Toastr.error(\"请选择发放卡券\");\n                    return false;\n                }\n            });\n\n      }\n```\n\n# 完整 示例代码\n    \n    \n```html\n    columns: [\n                    [\n                        {checkbox: true},\n                        {field: 'id', title: \"ID\",operate: false},\n                        {field: 'account', title: \"账号\", operate: 'like'},\n                        {field: 'school.school_name', title: \"学校\", operate: 'like'},\n                        {field: 'balance', title: \"余额/元\", operate: false},\n                        {\n                            field: 'status', title: '状态',operate: false, formatter: function (value) {\n                                if (value == 0) {\n                                    return \"已签约\";\n                                } else if (value == 1) {\n                                    return \"未签约\";\n                                }\n                            }\n                        },\n                        {\n                            field: 'operate', title: __('Operate'), table: table,\n                            events: Table.api.events.operate,\n                            buttons: [\n                                {\n                                    name: 'changerecord',\n                                    text: '动账记录查询',\n                                    icon: 'fa fa-search',\n                                    classname: 'btn btn-info btn-xs btn-dialog',\n                                    url: 'cms/bank/changeRecord'\n                                },\n                                {\n                                    name: 'freezerecord',\n                                    text: '冻结/解冻记录',\n                                    icon: 'fa fa-search',\n                                    classname: 'btn btn-info btn-xs btn-detail btn-dialog',\n                                    url: 'cms/bank/freezeRecord',\n                                },\n                                {\n                                    name: 'balance',\n                                    text: '查询余额',\n                                    icon: 'fa fa-search',\n                                    classname: 'btn btn-info btn-xs btn-balance',\n                                },\n                                {\n                                    name: 'qy',\n                                    text: '签约',\n                                    icon: 'fa fa-search',\n                                    classname: 'btn btn-info btn-xs btn-success btn-ajax',\n                                    url: 'cms/bank/sign',\n                                    visible: function (row) {\n                                        if (row.status == 1) {\n                                            return true;\n                                        } else {\n                                            return false;\n                                        }\n                                    },\n                                    success: function (data, ret) {\n                                        $(\"a.btn-refresh\").trigger(\"click\");\n                                        layer.alert(ret.msg);\n                                        //如果需要阻止成功提示，则必须使用return false;\n                                        //return false;\n                                    },\n                                    error: function (data, ret) {\n                                        console.log(data, ret);\n                                        layer.alert(ret.msg);\n                                        return false;\n                                    }\n                                },\n                                {\n                                    name: 'jy',\n                                    text: '解约',\n                                    icon: 'fa fa-search',\n                                    classname: 'btn btn-info btn-xs btn-danger btn-ajax',\n                                    url: 'cms/bank/unwind',\n                                    visible: function (row) {\n                                        if (row.status == 0) {\n                                            return true;\n                                        } else {\n                                            return false;\n                                        }\n                                    },\n                                    confirm: '确定要解约吗?',\n                                    success: function (data, ret) {\n                                        $(\"a.btn-refresh\").trigger(\"click\");\n                                        layer.alert(ret.msg);\n\n                                        //如果需要阻止成功提示，则必须使用return false;\n                                        //return false;\n                                    },\n                                    error: function (data, ret) {\n                                        console.log(data, ret);\n                                        layer.alert(ret.msg);\n                                        return false;\n                                    }\n\n                                },\n                                {\n                                    name: 'dj',\n                                    text: '冻结',\n                                    icon: 'fa fa-search',\n                                    classname: 'btn btn-info btn-xs btn-danger btn-ajax',\n                                    url: 'cms/bank/frozen',\n                                    confirm: '确定要冻结吗?',\n                                    success: function (data, ret) {\n                                        $(\"a.btn-refresh\").trigger(\"click\");\n                                        layer.alert(ret.msg);\n\n                                        //如果需要阻止成功提示，则必须使用return false;\n                                        //return false;\n                                    },\n                                    error: function (data, ret) {\n                                        console.log(data, ret);\n                                        layer.alert(ret.msg);\n                                        return false;\n                                    }\n\n                                },\n                             {\n                                name: 'edit',\n                                icon: 'fa fa-pencil',\n                                title: __('Edit'),\n                                extend: 'data-toggle=\"tooltip\"',\n                                classname: 'btn btn-xs btn-success btn-editone',\n                                visible: function (row) {\n                                    return row.status === 0;\n                                }\n                            },\n                            {\n                                name: 'del',\n                                icon: 'fa fa-trash',\n                                title: __('Del'),\n                                extend: 'data-toggle=\"tooltip\"',\n                                classname: 'btn btn-xs btn-danger btn-delone',\n                                visible: function (row) {\n                                    return row.status === 0;\n                                }\n                            }\n                        ], formatter: Table.api.formatter.operate}\n                        }\n\n                    ]\n                ]\n```","slug":"php开发-fastadmin表格操作列自定义按钮","published":1,"updated":"2024-10-18T06:03:59.671Z","_id":"clzl9bjix0000cwoc3o8phlov","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"自定义弹框效果按钮\"><a href=\"#自定义弹框效果按钮\" class=\"headerlink\" title=\"自定义弹框效果按钮\"></a>自定义弹框效果按钮</h1><p>classname字段控制 btn-dialog</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">   <span class=\"attr\">name</span>: <span class=\"string\">&#x27;changerecord&#x27;</span>,</span><br><span class=\"line\">   <span class=\"attr\">text</span>: <span class=\"string\">&#x27;动账记录查询&#x27;</span>,</span><br><span class=\"line\">   <span class=\"attr\">icon</span>: <span class=\"string\">&#x27;fa fa-search&#x27;</span>,</span><br><span class=\"line\">   <span class=\"attr\">classname</span>: <span class=\"string\">&#x27;btn btn-info btn-xs btn-dialog&#x27;</span>,</span><br><span class=\"line\">   <span class=\"attr\">url</span>: <span class=\"string\">&#x27;cms/bank/changeRecord&#x27;</span></span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"需要确认后再处理\"><a href=\"#需要确认后再处理\" class=\"headerlink\" title=\"需要确认后再处理\"></a>需要确认后再处理</h1><p>visible 字段可根据数据判断 是否显示按钮</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">         &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;jy&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">text</span>: <span class=\"string\">&#x27;解约&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">icon</span>: <span class=\"string\">&#x27;fa fa-search&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">classname</span>: <span class=\"string\">&#x27;btn btn-info btn-xs btn-danger btn-ajax&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">url</span>: <span class=\"string\">&#x27;cms/bank/unwind&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">visible</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">row</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (row.status == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            <span class=\"attr\">confirm</span>: <span class=\"string\">&#x27;确定要解约吗?&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">success</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data, ret</span>) </span>&#123;</span><br><span class=\"line\">                $(<span class=\"string\">&quot;a.btn-refresh&quot;</span>).trigger(<span class=\"string\">&quot;click&quot;</span>);</span><br><span class=\"line\">                layer.alert(ret.msg);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">//如果需要阻止成功提示，则必须使用return false;</span></span><br><span class=\"line\">                <span class=\"comment\">//return false;</span></span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            <span class=\"attr\">error</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data, ret</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"built_in\">console</span>.log(data, ret);</span><br><span class=\"line\">                layer.alert(ret.msg);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\"><span class=\"string\">``</span><span class=\"string\">`    </span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\"># 控制字段的显示</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">formatter字段中处理</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">`</span><span class=\"string\">``</span>js </span><br><span class=\"line\"> &#123;</span><br><span class=\"line\">    <span class=\"attr\">field</span>: <span class=\"string\">&#x27;status&#x27;</span>, <span class=\"attr\">title</span>: <span class=\"string\">&#x27;状态&#x27;</span>,<span class=\"attr\">operate</span>: <span class=\"literal\">false</span>, <span class=\"attr\">formatter</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">value</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (value == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&quot;已签约&quot;</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (value == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&quot;未签约&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"attr\">field</span>: <span class=\"string\">&#x27;grant&#x27;</span>, <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Grant&#x27;</span>), <span class=\"attr\">operate</span>: <span class=\"string\">&#x27;LIKE&#x27;</span>,<span class=\"attr\">formatter</span>: Controller.api.formatter.grant&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"自定义编辑删除按钮\"><a href=\"#自定义编辑删除按钮\" class=\"headerlink\" title=\"自定义编辑删除按钮\"></a>自定义编辑删除按钮</h1><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">     <span class=\"attr\">name</span>: <span class=\"string\">&#x27;edit&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">icon</span>: <span class=\"string\">&#x27;fa fa-pencil&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Edit&#x27;</span>),</span><br><span class=\"line\">     <span class=\"attr\">extend</span>: <span class=\"string\">&#x27;data-toggle=&quot;tooltip&quot;&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">classname</span>: <span class=\"string\">&#x27;btn btn-xs btn-success btn-editone&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">visible</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">row</span>) </span>&#123;</span><br><span class=\"line\">         <span class=\"keyword\">return</span> row.status === <span class=\"number\">0</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> &#125;,</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">     <span class=\"attr\">name</span>: <span class=\"string\">&#x27;del&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">icon</span>: <span class=\"string\">&#x27;fa fa-trash&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Del&#x27;</span>),</span><br><span class=\"line\">     <span class=\"attr\">extend</span>: <span class=\"string\">&#x27;data-toggle=&quot;tooltip&quot;&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">classname</span>: <span class=\"string\">&#x27;btn btn-xs btn-danger btn-delone&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">visible</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">row</span>) </span>&#123;</span><br><span class=\"line\">         <span class=\"keyword\">return</span> row.status === <span class=\"number\">0</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"自定义提交处理\"><a href=\"#自定义提交处理\" class=\"headerlink\" title=\"自定义提交处理\"></a>自定义提交处理</h1><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">          Controller.api.selectcoupon();</span><br><span class=\"line\">          Controller.api.selectusers();</span><br><span class=\"line\">          </span><br><span class=\"line\">          Form.api.bindevent($(<span class=\"string\">&quot;form[role=form]&quot;</span>), <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data, ret</span>)</span>&#123;</span><br><span class=\"line\">              <span class=\"comment\">//如果我们需要在提交表单成功后做跳转，可以在此使用location.href=&quot;链接&quot;;进行跳转</span></span><br><span class=\"line\">          &#125;, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data, ret</span>)</span>&#123;</span><br><span class=\"line\">              <span class=\"comment\">// 错误处理</span></span><br><span class=\"line\">              Fast.api.close();</span><br><span class=\"line\">          &#125;, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">success, error</span>)</span>&#123;</span><br><span class=\"line\">              <span class=\"comment\">//bindevent的第三个参数为提交前的回调</span></span><br><span class=\"line\">              <span class=\"comment\">//如果我们需要在表单提交前做一些数据处理，则可以在此方法处理</span></span><br><span class=\"line\">              <span class=\"comment\">//注意如果我们需要阻止表单，可以在此使用return false;即可</span></span><br><span class=\"line\">              <span class=\"comment\">//如果我们处理完成需要再次提交表单则可以使用submit提交,如下</span></span><br><span class=\"line\">              <span class=\"keyword\">if</span>(!$(<span class=\"string\">&quot;#user_ids&quot;</span>).val())&#123;</span><br><span class=\"line\">                  Toastr.error(<span class=\"string\">&quot;请选择发放用户&quot;</span>);</span><br><span class=\"line\">                  <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">if</span>(!$(<span class=\"string\">&quot;#couponid&quot;</span>).val())&#123;</span><br><span class=\"line\">                  Toastr.error(<span class=\"string\">&quot;请选择发放卡券&quot;</span>);</span><br><span class=\"line\">                  <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"完整-示例代码\"><a href=\"#完整-示例代码\" class=\"headerlink\" title=\"完整 示例代码\"></a>完整 示例代码</h1><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">columns: [</span><br><span class=\"line\">                [</span><br><span class=\"line\">                    &#123;checkbox: true&#125;,</span><br><span class=\"line\">                    &#123;field: &#x27;id&#x27;, title: &quot;ID&quot;,operate: false&#125;,</span><br><span class=\"line\">                    &#123;field: &#x27;account&#x27;, title: &quot;账号&quot;, operate: &#x27;like&#x27;&#125;,</span><br><span class=\"line\">                    &#123;field: &#x27;school.school_name&#x27;, title: &quot;学校&quot;, operate: &#x27;like&#x27;&#125;,</span><br><span class=\"line\">                    &#123;field: &#x27;balance&#x27;, title: &quot;余额/元&quot;, operate: false&#125;,</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        field: &#x27;status&#x27;, title: &#x27;状态&#x27;,operate: false, formatter: function (value) &#123;</span><br><span class=\"line\">                            if (value == 0) &#123;</span><br><span class=\"line\">                                return &quot;已签约&quot;;</span><br><span class=\"line\">                            &#125; else if (value == 1) &#123;</span><br><span class=\"line\">                                return &quot;未签约&quot;;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        field: &#x27;operate&#x27;, title: __(&#x27;Operate&#x27;), table: table,</span><br><span class=\"line\">                        events: Table.api.events.operate,</span><br><span class=\"line\">                        buttons: [</span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                name: &#x27;changerecord&#x27;,</span><br><span class=\"line\">                                text: &#x27;动账记录查询&#x27;,</span><br><span class=\"line\">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class=\"line\">                                classname: &#x27;btn btn-info btn-xs btn-dialog&#x27;,</span><br><span class=\"line\">                                url: &#x27;cms/bank/changeRecord&#x27;</span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                name: &#x27;freezerecord&#x27;,</span><br><span class=\"line\">                                text: &#x27;冻结/解冻记录&#x27;,</span><br><span class=\"line\">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class=\"line\">                                classname: &#x27;btn btn-info btn-xs btn-detail btn-dialog&#x27;,</span><br><span class=\"line\">                                url: &#x27;cms/bank/freezeRecord&#x27;,</span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                name: &#x27;balance&#x27;,</span><br><span class=\"line\">                                text: &#x27;查询余额&#x27;,</span><br><span class=\"line\">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class=\"line\">                                classname: &#x27;btn btn-info btn-xs btn-balance&#x27;,</span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                name: &#x27;qy&#x27;,</span><br><span class=\"line\">                                text: &#x27;签约&#x27;,</span><br><span class=\"line\">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class=\"line\">                                classname: &#x27;btn btn-info btn-xs btn-success btn-ajax&#x27;,</span><br><span class=\"line\">                                url: &#x27;cms/bank/sign&#x27;,</span><br><span class=\"line\">                                visible: function (row) &#123;</span><br><span class=\"line\">                                    if (row.status == 1) &#123;</span><br><span class=\"line\">                                        return true;</span><br><span class=\"line\">                                    &#125; else &#123;</span><br><span class=\"line\">                                        return false;</span><br><span class=\"line\">                                    &#125;</span><br><span class=\"line\">                                &#125;,</span><br><span class=\"line\">                                success: function (data, ret) &#123;</span><br><span class=\"line\">                                    $(&quot;a.btn-refresh&quot;).trigger(&quot;click&quot;);</span><br><span class=\"line\">                                    layer.alert(ret.msg);</span><br><span class=\"line\">                                    //如果需要阻止成功提示，则必须使用return false;</span><br><span class=\"line\">                                    //return false;</span><br><span class=\"line\">                                &#125;,</span><br><span class=\"line\">                                error: function (data, ret) &#123;</span><br><span class=\"line\">                                    console.log(data, ret);</span><br><span class=\"line\">                                    layer.alert(ret.msg);</span><br><span class=\"line\">                                    return false;</span><br><span class=\"line\">                                &#125;</span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                name: &#x27;jy&#x27;,</span><br><span class=\"line\">                                text: &#x27;解约&#x27;,</span><br><span class=\"line\">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class=\"line\">                                classname: &#x27;btn btn-info btn-xs btn-danger btn-ajax&#x27;,</span><br><span class=\"line\">                                url: &#x27;cms/bank/unwind&#x27;,</span><br><span class=\"line\">                                visible: function (row) &#123;</span><br><span class=\"line\">                                    if (row.status == 0) &#123;</span><br><span class=\"line\">                                        return true;</span><br><span class=\"line\">                                    &#125; else &#123;</span><br><span class=\"line\">                                        return false;</span><br><span class=\"line\">                                    &#125;</span><br><span class=\"line\">                                &#125;,</span><br><span class=\"line\">                                confirm: &#x27;确定要解约吗?&#x27;,</span><br><span class=\"line\">                                success: function (data, ret) &#123;</span><br><span class=\"line\">                                    $(&quot;a.btn-refresh&quot;).trigger(&quot;click&quot;);</span><br><span class=\"line\">                                    layer.alert(ret.msg);</span><br><span class=\"line\"></span><br><span class=\"line\">                                    //如果需要阻止成功提示，则必须使用return false;</span><br><span class=\"line\">                                    //return false;</span><br><span class=\"line\">                                &#125;,</span><br><span class=\"line\">                                error: function (data, ret) &#123;</span><br><span class=\"line\">                                    console.log(data, ret);</span><br><span class=\"line\">                                    layer.alert(ret.msg);</span><br><span class=\"line\">                                    return false;</span><br><span class=\"line\">                                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                name: &#x27;dj&#x27;,</span><br><span class=\"line\">                                text: &#x27;冻结&#x27;,</span><br><span class=\"line\">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class=\"line\">                                classname: &#x27;btn btn-info btn-xs btn-danger btn-ajax&#x27;,</span><br><span class=\"line\">                                url: &#x27;cms/bank/frozen&#x27;,</span><br><span class=\"line\">                                confirm: &#x27;确定要冻结吗?&#x27;,</span><br><span class=\"line\">                                success: function (data, ret) &#123;</span><br><span class=\"line\">                                    $(&quot;a.btn-refresh&quot;).trigger(&quot;click&quot;);</span><br><span class=\"line\">                                    layer.alert(ret.msg);</span><br><span class=\"line\"></span><br><span class=\"line\">                                    //如果需要阻止成功提示，则必须使用return false;</span><br><span class=\"line\">                                    //return false;</span><br><span class=\"line\">                                &#125;,</span><br><span class=\"line\">                                error: function (data, ret) &#123;</span><br><span class=\"line\">                                    console.log(data, ret);</span><br><span class=\"line\">                                    layer.alert(ret.msg);</span><br><span class=\"line\">                                    return false;</span><br><span class=\"line\">                                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                         &#123;</span><br><span class=\"line\">                            name: &#x27;edit&#x27;,</span><br><span class=\"line\">                            icon: &#x27;fa fa-pencil&#x27;,</span><br><span class=\"line\">                            title: __(&#x27;Edit&#x27;),</span><br><span class=\"line\">                            extend: &#x27;data-toggle=&quot;tooltip&quot;&#x27;,</span><br><span class=\"line\">                            classname: &#x27;btn btn-xs btn-success btn-editone&#x27;,</span><br><span class=\"line\">                            visible: function (row) &#123;</span><br><span class=\"line\">                                return row.status === 0;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            name: &#x27;del&#x27;,</span><br><span class=\"line\">                            icon: &#x27;fa fa-trash&#x27;,</span><br><span class=\"line\">                            title: __(&#x27;Del&#x27;),</span><br><span class=\"line\">                            extend: &#x27;data-toggle=&quot;tooltip&quot;&#x27;,</span><br><span class=\"line\">                            classname: &#x27;btn btn-xs btn-danger btn-delone&#x27;,</span><br><span class=\"line\">                            visible: function (row) &#123;</span><br><span class=\"line\">                                return row.status === 0;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    ], formatter: Table.api.formatter.operate&#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                ]</span><br><span class=\"line\">            ]</span><br></pre></td></tr></table></figure>","site":{"data":{}},"length":6041,"excerpt":"","more":"<h1 id=\"自定义弹框效果按钮\"><a href=\"#自定义弹框效果按钮\" class=\"headerlink\" title=\"自定义弹框效果按钮\"></a>自定义弹框效果按钮</h1><p>classname字段控制 btn-dialog</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">   <span class=\"attr\">name</span>: <span class=\"string\">&#x27;changerecord&#x27;</span>,</span><br><span class=\"line\">   <span class=\"attr\">text</span>: <span class=\"string\">&#x27;动账记录查询&#x27;</span>,</span><br><span class=\"line\">   <span class=\"attr\">icon</span>: <span class=\"string\">&#x27;fa fa-search&#x27;</span>,</span><br><span class=\"line\">   <span class=\"attr\">classname</span>: <span class=\"string\">&#x27;btn btn-info btn-xs btn-dialog&#x27;</span>,</span><br><span class=\"line\">   <span class=\"attr\">url</span>: <span class=\"string\">&#x27;cms/bank/changeRecord&#x27;</span></span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"需要确认后再处理\"><a href=\"#需要确认后再处理\" class=\"headerlink\" title=\"需要确认后再处理\"></a>需要确认后再处理</h1><p>visible 字段可根据数据判断 是否显示按钮</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">         &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;jy&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">text</span>: <span class=\"string\">&#x27;解约&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">icon</span>: <span class=\"string\">&#x27;fa fa-search&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">classname</span>: <span class=\"string\">&#x27;btn btn-info btn-xs btn-danger btn-ajax&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">url</span>: <span class=\"string\">&#x27;cms/bank/unwind&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">visible</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">row</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (row.status == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            <span class=\"attr\">confirm</span>: <span class=\"string\">&#x27;确定要解约吗?&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">success</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data, ret</span>) </span>&#123;</span><br><span class=\"line\">                $(<span class=\"string\">&quot;a.btn-refresh&quot;</span>).trigger(<span class=\"string\">&quot;click&quot;</span>);</span><br><span class=\"line\">                layer.alert(ret.msg);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">//如果需要阻止成功提示，则必须使用return false;</span></span><br><span class=\"line\">                <span class=\"comment\">//return false;</span></span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            <span class=\"attr\">error</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data, ret</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"built_in\">console</span>.log(data, ret);</span><br><span class=\"line\">                layer.alert(ret.msg);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\"><span class=\"string\">``</span><span class=\"string\">`    </span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\"># 控制字段的显示</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">formatter字段中处理</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">`</span><span class=\"string\">``</span>js </span><br><span class=\"line\"> &#123;</span><br><span class=\"line\">    <span class=\"attr\">field</span>: <span class=\"string\">&#x27;status&#x27;</span>, <span class=\"attr\">title</span>: <span class=\"string\">&#x27;状态&#x27;</span>,<span class=\"attr\">operate</span>: <span class=\"literal\">false</span>, <span class=\"attr\">formatter</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">value</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (value == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&quot;已签约&quot;</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (value == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&quot;未签约&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"attr\">field</span>: <span class=\"string\">&#x27;grant&#x27;</span>, <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Grant&#x27;</span>), <span class=\"attr\">operate</span>: <span class=\"string\">&#x27;LIKE&#x27;</span>,<span class=\"attr\">formatter</span>: Controller.api.formatter.grant&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"自定义编辑删除按钮\"><a href=\"#自定义编辑删除按钮\" class=\"headerlink\" title=\"自定义编辑删除按钮\"></a>自定义编辑删除按钮</h1><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">     <span class=\"attr\">name</span>: <span class=\"string\">&#x27;edit&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">icon</span>: <span class=\"string\">&#x27;fa fa-pencil&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Edit&#x27;</span>),</span><br><span class=\"line\">     <span class=\"attr\">extend</span>: <span class=\"string\">&#x27;data-toggle=&quot;tooltip&quot;&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">classname</span>: <span class=\"string\">&#x27;btn btn-xs btn-success btn-editone&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">visible</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">row</span>) </span>&#123;</span><br><span class=\"line\">         <span class=\"keyword\">return</span> row.status === <span class=\"number\">0</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> &#125;,</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">     <span class=\"attr\">name</span>: <span class=\"string\">&#x27;del&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">icon</span>: <span class=\"string\">&#x27;fa fa-trash&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">title</span>: __(<span class=\"string\">&#x27;Del&#x27;</span>),</span><br><span class=\"line\">     <span class=\"attr\">extend</span>: <span class=\"string\">&#x27;data-toggle=&quot;tooltip&quot;&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">classname</span>: <span class=\"string\">&#x27;btn btn-xs btn-danger btn-delone&#x27;</span>,</span><br><span class=\"line\">     <span class=\"attr\">visible</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">row</span>) </span>&#123;</span><br><span class=\"line\">         <span class=\"keyword\">return</span> row.status === <span class=\"number\">0</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"自定义提交处理\"><a href=\"#自定义提交处理\" class=\"headerlink\" title=\"自定义提交处理\"></a>自定义提交处理</h1><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">          Controller.api.selectcoupon();</span><br><span class=\"line\">          Controller.api.selectusers();</span><br><span class=\"line\">          </span><br><span class=\"line\">          Form.api.bindevent($(<span class=\"string\">&quot;form[role=form]&quot;</span>), <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data, ret</span>)</span>&#123;</span><br><span class=\"line\">              <span class=\"comment\">//如果我们需要在提交表单成功后做跳转，可以在此使用location.href=&quot;链接&quot;;进行跳转</span></span><br><span class=\"line\">          &#125;, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data, ret</span>)</span>&#123;</span><br><span class=\"line\">              <span class=\"comment\">// 错误处理</span></span><br><span class=\"line\">              Fast.api.close();</span><br><span class=\"line\">          &#125;, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">success, error</span>)</span>&#123;</span><br><span class=\"line\">              <span class=\"comment\">//bindevent的第三个参数为提交前的回调</span></span><br><span class=\"line\">              <span class=\"comment\">//如果我们需要在表单提交前做一些数据处理，则可以在此方法处理</span></span><br><span class=\"line\">              <span class=\"comment\">//注意如果我们需要阻止表单，可以在此使用return false;即可</span></span><br><span class=\"line\">              <span class=\"comment\">//如果我们处理完成需要再次提交表单则可以使用submit提交,如下</span></span><br><span class=\"line\">              <span class=\"keyword\">if</span>(!$(<span class=\"string\">&quot;#user_ids&quot;</span>).val())&#123;</span><br><span class=\"line\">                  Toastr.error(<span class=\"string\">&quot;请选择发放用户&quot;</span>);</span><br><span class=\"line\">                  <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">if</span>(!$(<span class=\"string\">&quot;#couponid&quot;</span>).val())&#123;</span><br><span class=\"line\">                  Toastr.error(<span class=\"string\">&quot;请选择发放卡券&quot;</span>);</span><br><span class=\"line\">                  <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"完整-示例代码\"><a href=\"#完整-示例代码\" class=\"headerlink\" title=\"完整 示例代码\"></a>完整 示例代码</h1><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">columns: [</span><br><span class=\"line\">                [</span><br><span class=\"line\">                    &#123;checkbox: true&#125;,</span><br><span class=\"line\">                    &#123;field: &#x27;id&#x27;, title: &quot;ID&quot;,operate: false&#125;,</span><br><span class=\"line\">                    &#123;field: &#x27;account&#x27;, title: &quot;账号&quot;, operate: &#x27;like&#x27;&#125;,</span><br><span class=\"line\">                    &#123;field: &#x27;school.school_name&#x27;, title: &quot;学校&quot;, operate: &#x27;like&#x27;&#125;,</span><br><span class=\"line\">                    &#123;field: &#x27;balance&#x27;, title: &quot;余额/元&quot;, operate: false&#125;,</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        field: &#x27;status&#x27;, title: &#x27;状态&#x27;,operate: false, formatter: function (value) &#123;</span><br><span class=\"line\">                            if (value == 0) &#123;</span><br><span class=\"line\">                                return &quot;已签约&quot;;</span><br><span class=\"line\">                            &#125; else if (value == 1) &#123;</span><br><span class=\"line\">                                return &quot;未签约&quot;;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        field: &#x27;operate&#x27;, title: __(&#x27;Operate&#x27;), table: table,</span><br><span class=\"line\">                        events: Table.api.events.operate,</span><br><span class=\"line\">                        buttons: [</span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                name: &#x27;changerecord&#x27;,</span><br><span class=\"line\">                                text: &#x27;动账记录查询&#x27;,</span><br><span class=\"line\">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class=\"line\">                                classname: &#x27;btn btn-info btn-xs btn-dialog&#x27;,</span><br><span class=\"line\">                                url: &#x27;cms/bank/changeRecord&#x27;</span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                name: &#x27;freezerecord&#x27;,</span><br><span class=\"line\">                                text: &#x27;冻结/解冻记录&#x27;,</span><br><span class=\"line\">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class=\"line\">                                classname: &#x27;btn btn-info btn-xs btn-detail btn-dialog&#x27;,</span><br><span class=\"line\">                                url: &#x27;cms/bank/freezeRecord&#x27;,</span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                name: &#x27;balance&#x27;,</span><br><span class=\"line\">                                text: &#x27;查询余额&#x27;,</span><br><span class=\"line\">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class=\"line\">                                classname: &#x27;btn btn-info btn-xs btn-balance&#x27;,</span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                name: &#x27;qy&#x27;,</span><br><span class=\"line\">                                text: &#x27;签约&#x27;,</span><br><span class=\"line\">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class=\"line\">                                classname: &#x27;btn btn-info btn-xs btn-success btn-ajax&#x27;,</span><br><span class=\"line\">                                url: &#x27;cms/bank/sign&#x27;,</span><br><span class=\"line\">                                visible: function (row) &#123;</span><br><span class=\"line\">                                    if (row.status == 1) &#123;</span><br><span class=\"line\">                                        return true;</span><br><span class=\"line\">                                    &#125; else &#123;</span><br><span class=\"line\">                                        return false;</span><br><span class=\"line\">                                    &#125;</span><br><span class=\"line\">                                &#125;,</span><br><span class=\"line\">                                success: function (data, ret) &#123;</span><br><span class=\"line\">                                    $(&quot;a.btn-refresh&quot;).trigger(&quot;click&quot;);</span><br><span class=\"line\">                                    layer.alert(ret.msg);</span><br><span class=\"line\">                                    //如果需要阻止成功提示，则必须使用return false;</span><br><span class=\"line\">                                    //return false;</span><br><span class=\"line\">                                &#125;,</span><br><span class=\"line\">                                error: function (data, ret) &#123;</span><br><span class=\"line\">                                    console.log(data, ret);</span><br><span class=\"line\">                                    layer.alert(ret.msg);</span><br><span class=\"line\">                                    return false;</span><br><span class=\"line\">                                &#125;</span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                name: &#x27;jy&#x27;,</span><br><span class=\"line\">                                text: &#x27;解约&#x27;,</span><br><span class=\"line\">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class=\"line\">                                classname: &#x27;btn btn-info btn-xs btn-danger btn-ajax&#x27;,</span><br><span class=\"line\">                                url: &#x27;cms/bank/unwind&#x27;,</span><br><span class=\"line\">                                visible: function (row) &#123;</span><br><span class=\"line\">                                    if (row.status == 0) &#123;</span><br><span class=\"line\">                                        return true;</span><br><span class=\"line\">                                    &#125; else &#123;</span><br><span class=\"line\">                                        return false;</span><br><span class=\"line\">                                    &#125;</span><br><span class=\"line\">                                &#125;,</span><br><span class=\"line\">                                confirm: &#x27;确定要解约吗?&#x27;,</span><br><span class=\"line\">                                success: function (data, ret) &#123;</span><br><span class=\"line\">                                    $(&quot;a.btn-refresh&quot;).trigger(&quot;click&quot;);</span><br><span class=\"line\">                                    layer.alert(ret.msg);</span><br><span class=\"line\"></span><br><span class=\"line\">                                    //如果需要阻止成功提示，则必须使用return false;</span><br><span class=\"line\">                                    //return false;</span><br><span class=\"line\">                                &#125;,</span><br><span class=\"line\">                                error: function (data, ret) &#123;</span><br><span class=\"line\">                                    console.log(data, ret);</span><br><span class=\"line\">                                    layer.alert(ret.msg);</span><br><span class=\"line\">                                    return false;</span><br><span class=\"line\">                                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                name: &#x27;dj&#x27;,</span><br><span class=\"line\">                                text: &#x27;冻结&#x27;,</span><br><span class=\"line\">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class=\"line\">                                classname: &#x27;btn btn-info btn-xs btn-danger btn-ajax&#x27;,</span><br><span class=\"line\">                                url: &#x27;cms/bank/frozen&#x27;,</span><br><span class=\"line\">                                confirm: &#x27;确定要冻结吗?&#x27;,</span><br><span class=\"line\">                                success: function (data, ret) &#123;</span><br><span class=\"line\">                                    $(&quot;a.btn-refresh&quot;).trigger(&quot;click&quot;);</span><br><span class=\"line\">                                    layer.alert(ret.msg);</span><br><span class=\"line\"></span><br><span class=\"line\">                                    //如果需要阻止成功提示，则必须使用return false;</span><br><span class=\"line\">                                    //return false;</span><br><span class=\"line\">                                &#125;,</span><br><span class=\"line\">                                error: function (data, ret) &#123;</span><br><span class=\"line\">                                    console.log(data, ret);</span><br><span class=\"line\">                                    layer.alert(ret.msg);</span><br><span class=\"line\">                                    return false;</span><br><span class=\"line\">                                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                         &#123;</span><br><span class=\"line\">                            name: &#x27;edit&#x27;,</span><br><span class=\"line\">                            icon: &#x27;fa fa-pencil&#x27;,</span><br><span class=\"line\">                            title: __(&#x27;Edit&#x27;),</span><br><span class=\"line\">                            extend: &#x27;data-toggle=&quot;tooltip&quot;&#x27;,</span><br><span class=\"line\">                            classname: &#x27;btn btn-xs btn-success btn-editone&#x27;,</span><br><span class=\"line\">                            visible: function (row) &#123;</span><br><span class=\"line\">                                return row.status === 0;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            name: &#x27;del&#x27;,</span><br><span class=\"line\">                            icon: &#x27;fa fa-trash&#x27;,</span><br><span class=\"line\">                            title: __(&#x27;Del&#x27;),</span><br><span class=\"line\">                            extend: &#x27;data-toggle=&quot;tooltip&quot;&#x27;,</span><br><span class=\"line\">                            classname: &#x27;btn btn-xs btn-danger btn-delone&#x27;,</span><br><span class=\"line\">                            visible: function (row) &#123;</span><br><span class=\"line\">                                return row.status === 0;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    ], formatter: Table.api.formatter.operate&#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                ]</span><br><span class=\"line\">            ]</span><br></pre></td></tr></table></figure>"},{"title":"php开发-fastadmin中input自定义验证方法","abbrlink":"ae0c2972","date":"2024-01-25T03:12:26.000Z","_content":"\n# 一、常用设置\n\n## 1.1 通用搜索栏设置\n```\n       // 初始化表格\n        table.bootstrapTable({\n            url: $.fn.bootstrapTable.defaults.extend.index_url,\n            pk: 'id',\n            sortName: 'id',\n            fixedColumns: true,\n            fixedRightNumber: 1,\n            //切换列表显示样式开关\n            showToggle: false,\n            //是否显示右上角的搜索框\n            search: false,\n            //控制显示列开关\n            showColumns:false,\n            showExport: false,\n            //显示搜索字段框\n            searchFormVisible: true,\n            //导出开关            \n            showExport: true,\n            //设置导出  格式\n            exportTypes: ['json', 'xml', 'csv', 'txt', 'doc', 'excel'],\n         })\n```\n## 1.2 input 常用设置\n\ndata-rule 设置 检查规则 可以自定义验证方法 checksite JS并相关设置\ndata-source select 可以设置数据源\n设置弹框大小 'extend': 'data-area=\\'[\"95%\",\"95%\"]\\''\n示例\n```\n//input设置\n\n<input id=\"c-site_id\" data-rule=\"checksite\" data-source=\"hj212/pollutionsite/index\" data-field=\"site_name\" class=\"form-control selectpage\" name=\"row[site_id]\" type=\"text\" value=\"\">\n\n\n//js中设置\n\nvar Controller = {\n        index: function () {\n            // 初始化表格参数配置\n            Table.api.init({\n                ...\n            });\n\n            var table = $(\"#table\");\n\n            // 初始化表格\n            table.bootstrapTable({\n                url: $.fn.bootstrapTable.defaults.extend.index_url,\n                pk: 'id',\n                sortName: 'id',\n\n                columns: [\n                    [\n                        {checkbox: true},\n                        {field: 'id', title: __('Id'),operate:false},\n                  \n                        {field: 'operate', title: __('Operate'), table: table, events: Table.api.events.operate, formatter: Table.api.formatter.operate,\n                                 buttons:[\n                                     {\n                                      'name':'bindsite',\n                                      'title':function(row){\n                                          return '更换站点[ '+row.device_code+']';\n                                      },\n                                      'icon':'fa fa-pencil',\n                                      'text':'更换站点',\n                                      'classname': 'btn btn-xs btn-info btn-dialog',\n                                      'url':'hj212/device/bindsite/deviceId/{ids}',\n                                      'extend': 'data-area=\\'[\"95%\",\"95%\"]\\''\n                                     },\n                                     {\n                                      'name':'siteInfo',\n                                      'title':function(row){\n                                          return '站点信息[ '+row.site+']';\n                                      },\n                                      'text':'站点信息',\n                                      'classname': 'btn btn-xs btn-primary btn-dialog',\n                                      'url':function(row){\n                                          return 'hj212/pollutionsite/siteinfo/site_id/'+row.site_id;\n                                       },\n                                      'extend': 'data-area=\\'[\"95%\",\"95%\"]\\''\n                                     },\n                                 ]}\n                    ]\n                ],\n                exportTypes: [ 'excel'],\n            });\n\n            // 为表格绑定事件\n            Table.api.bindevent(table);\n        },\n        add: function () {\n            Controller.api.bindevent();\n        },\n        edit: function () {\n            Controller.api.bindevent();\n        },\n        bindsite:function(){\n            Controller.api.bindevent();\n        },\n        api: {\n            bindevent: function () {\n\t                $.validator.config({\n\t                \n                    rules: {\n                        checksite: function (element) {\n                            return $.ajax({\n                                url: 'hj212/device/checksite',\n                                type: 'POST',\n                                data: {\n                                    site_id: $(\"#c-site_id\").val(),\n                                    id:$(\"#c-id\").val()\n                                },\n                                dataType: 'json'\n                            });\n                        },\n                    }\n                });\n                Form.api.bindevent($(\"form[role=form]\"));\n            }\n        }\n    };\n\n```\n    \n\n# 二、数据库操作\n\n# 三、redis相关操作\n\n# 四、消息队列设置\n\n# 五、命令行开发\n\n\n","source":"_posts/php开发-fastadmin中input自定义验证方法.md","raw":"---\ntitle: php开发-fastadmin中input自定义验证方法\ntags: fastadmin\ncategories:\n  - PHP开发\nabbrlink: ae0c2972\ndate: 2024-01-25 11:12:26\n---\n\n# 一、常用设置\n\n## 1.1 通用搜索栏设置\n```\n       // 初始化表格\n        table.bootstrapTable({\n            url: $.fn.bootstrapTable.defaults.extend.index_url,\n            pk: 'id',\n            sortName: 'id',\n            fixedColumns: true,\n            fixedRightNumber: 1,\n            //切换列表显示样式开关\n            showToggle: false,\n            //是否显示右上角的搜索框\n            search: false,\n            //控制显示列开关\n            showColumns:false,\n            showExport: false,\n            //显示搜索字段框\n            searchFormVisible: true,\n            //导出开关            \n            showExport: true,\n            //设置导出  格式\n            exportTypes: ['json', 'xml', 'csv', 'txt', 'doc', 'excel'],\n         })\n```\n## 1.2 input 常用设置\n\ndata-rule 设置 检查规则 可以自定义验证方法 checksite JS并相关设置\ndata-source select 可以设置数据源\n设置弹框大小 'extend': 'data-area=\\'[\"95%\",\"95%\"]\\''\n示例\n```\n//input设置\n\n<input id=\"c-site_id\" data-rule=\"checksite\" data-source=\"hj212/pollutionsite/index\" data-field=\"site_name\" class=\"form-control selectpage\" name=\"row[site_id]\" type=\"text\" value=\"\">\n\n\n//js中设置\n\nvar Controller = {\n        index: function () {\n            // 初始化表格参数配置\n            Table.api.init({\n                ...\n            });\n\n            var table = $(\"#table\");\n\n            // 初始化表格\n            table.bootstrapTable({\n                url: $.fn.bootstrapTable.defaults.extend.index_url,\n                pk: 'id',\n                sortName: 'id',\n\n                columns: [\n                    [\n                        {checkbox: true},\n                        {field: 'id', title: __('Id'),operate:false},\n                  \n                        {field: 'operate', title: __('Operate'), table: table, events: Table.api.events.operate, formatter: Table.api.formatter.operate,\n                                 buttons:[\n                                     {\n                                      'name':'bindsite',\n                                      'title':function(row){\n                                          return '更换站点[ '+row.device_code+']';\n                                      },\n                                      'icon':'fa fa-pencil',\n                                      'text':'更换站点',\n                                      'classname': 'btn btn-xs btn-info btn-dialog',\n                                      'url':'hj212/device/bindsite/deviceId/{ids}',\n                                      'extend': 'data-area=\\'[\"95%\",\"95%\"]\\''\n                                     },\n                                     {\n                                      'name':'siteInfo',\n                                      'title':function(row){\n                                          return '站点信息[ '+row.site+']';\n                                      },\n                                      'text':'站点信息',\n                                      'classname': 'btn btn-xs btn-primary btn-dialog',\n                                      'url':function(row){\n                                          return 'hj212/pollutionsite/siteinfo/site_id/'+row.site_id;\n                                       },\n                                      'extend': 'data-area=\\'[\"95%\",\"95%\"]\\''\n                                     },\n                                 ]}\n                    ]\n                ],\n                exportTypes: [ 'excel'],\n            });\n\n            // 为表格绑定事件\n            Table.api.bindevent(table);\n        },\n        add: function () {\n            Controller.api.bindevent();\n        },\n        edit: function () {\n            Controller.api.bindevent();\n        },\n        bindsite:function(){\n            Controller.api.bindevent();\n        },\n        api: {\n            bindevent: function () {\n\t                $.validator.config({\n\t                \n                    rules: {\n                        checksite: function (element) {\n                            return $.ajax({\n                                url: 'hj212/device/checksite',\n                                type: 'POST',\n                                data: {\n                                    site_id: $(\"#c-site_id\").val(),\n                                    id:$(\"#c-id\").val()\n                                },\n                                dataType: 'json'\n                            });\n                        },\n                    }\n                });\n                Form.api.bindevent($(\"form[role=form]\"));\n            }\n        }\n    };\n\n```\n    \n\n# 二、数据库操作\n\n# 三、redis相关操作\n\n# 四、消息队列设置\n\n# 五、命令行开发\n\n\n","slug":"php开发-fastadmin中input自定义验证方法","published":1,"updated":"2024-10-18T06:03:40.634Z","_id":"clzl9c9dk000018oc7ivk5sap","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、常用设置\"><a href=\"#一、常用设置\" class=\"headerlink\" title=\"一、常用设置\"></a>一、常用设置</h1><h2 id=\"1-1-通用搜索栏设置\"><a href=\"#1-1-通用搜索栏设置\" class=\"headerlink\" title=\"1.1 通用搜索栏设置\"></a>1.1 通用搜索栏设置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 初始化表格</span><br><span class=\"line\"> table.bootstrapTable(&#123;</span><br><span class=\"line\">     url: $.fn.bootstrapTable.defaults.extend.index_url,</span><br><span class=\"line\">     pk: &#x27;id&#x27;,</span><br><span class=\"line\">     sortName: &#x27;id&#x27;,</span><br><span class=\"line\">     fixedColumns: true,</span><br><span class=\"line\">     fixedRightNumber: 1,</span><br><span class=\"line\">     //切换列表显示样式开关</span><br><span class=\"line\">     showToggle: false,</span><br><span class=\"line\">     //是否显示右上角的搜索框</span><br><span class=\"line\">     search: false,</span><br><span class=\"line\">     //控制显示列开关</span><br><span class=\"line\">     showColumns:false,</span><br><span class=\"line\">     showExport: false,</span><br><span class=\"line\">     //显示搜索字段框</span><br><span class=\"line\">     searchFormVisible: true,</span><br><span class=\"line\">     //导出开关            </span><br><span class=\"line\">     showExport: true,</span><br><span class=\"line\">     //设置导出  格式</span><br><span class=\"line\">     exportTypes: [&#x27;json&#x27;, &#x27;xml&#x27;, &#x27;csv&#x27;, &#x27;txt&#x27;, &#x27;doc&#x27;, &#x27;excel&#x27;],</span><br><span class=\"line\">  &#125;)</span><br></pre></td></tr></table></figure>\n<h2 id=\"1-2-input-常用设置\"><a href=\"#1-2-input-常用设置\" class=\"headerlink\" title=\"1.2 input 常用设置\"></a>1.2 input 常用设置</h2><p>data-rule 设置 检查规则 可以自定义验证方法 checksite JS并相关设置<br>data-source select 可以设置数据源<br>设置弹框大小 ‘extend’: ‘data-area=&#39;[“95%”,”95%”]&#39;‘<br>示例</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//input设置</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;input id=&quot;c-site_id&quot; data-rule=&quot;checksite&quot; data-source=&quot;hj212/pollutionsite/index&quot; data-field=&quot;site_name&quot; class=&quot;form-control selectpage&quot; name=&quot;row[site_id]&quot; type=&quot;text&quot; value=&quot;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">//js中设置</span><br><span class=\"line\"></span><br><span class=\"line\">var Controller = &#123;</span><br><span class=\"line\">        index: function () &#123;</span><br><span class=\"line\">            // 初始化表格参数配置</span><br><span class=\"line\">            Table.api.init(&#123;</span><br><span class=\"line\">                ...</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            var table = $(&quot;#table&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">            // 初始化表格</span><br><span class=\"line\">            table.bootstrapTable(&#123;</span><br><span class=\"line\">                url: $.fn.bootstrapTable.defaults.extend.index_url,</span><br><span class=\"line\">                pk: &#x27;id&#x27;,</span><br><span class=\"line\">                sortName: &#x27;id&#x27;,</span><br><span class=\"line\"></span><br><span class=\"line\">                columns: [</span><br><span class=\"line\">                    [</span><br><span class=\"line\">                        &#123;checkbox: true&#125;,</span><br><span class=\"line\">                        &#123;field: &#x27;id&#x27;, title: __(&#x27;Id&#x27;),operate:false&#125;,</span><br><span class=\"line\">                  </span><br><span class=\"line\">                        &#123;field: &#x27;operate&#x27;, title: __(&#x27;Operate&#x27;), table: table, events: Table.api.events.operate, formatter: Table.api.formatter.operate,</span><br><span class=\"line\">                                 buttons:[</span><br><span class=\"line\">                                     &#123;</span><br><span class=\"line\">                                      &#x27;name&#x27;:&#x27;bindsite&#x27;,</span><br><span class=\"line\">                                      &#x27;title&#x27;:function(row)&#123;</span><br><span class=\"line\">                                          return &#x27;更换站点[ &#x27;+row.device_code+&#x27;]&#x27;;</span><br><span class=\"line\">                                      &#125;,</span><br><span class=\"line\">                                      &#x27;icon&#x27;:&#x27;fa fa-pencil&#x27;,</span><br><span class=\"line\">                                      &#x27;text&#x27;:&#x27;更换站点&#x27;,</span><br><span class=\"line\">                                      &#x27;classname&#x27;: &#x27;btn btn-xs btn-info btn-dialog&#x27;,</span><br><span class=\"line\">                                      &#x27;url&#x27;:&#x27;hj212/device/bindsite/deviceId/&#123;ids&#125;&#x27;,</span><br><span class=\"line\">                                      &#x27;extend&#x27;: &#x27;data-area=\\&#x27;[&quot;95%&quot;,&quot;95%&quot;]\\&#x27;&#x27;</span><br><span class=\"line\">                                     &#125;,</span><br><span class=\"line\">                                     &#123;</span><br><span class=\"line\">                                      &#x27;name&#x27;:&#x27;siteInfo&#x27;,</span><br><span class=\"line\">                                      &#x27;title&#x27;:function(row)&#123;</span><br><span class=\"line\">                                          return &#x27;站点信息[ &#x27;+row.site+&#x27;]&#x27;;</span><br><span class=\"line\">                                      &#125;,</span><br><span class=\"line\">                                      &#x27;text&#x27;:&#x27;站点信息&#x27;,</span><br><span class=\"line\">                                      &#x27;classname&#x27;: &#x27;btn btn-xs btn-primary btn-dialog&#x27;,</span><br><span class=\"line\">                                      &#x27;url&#x27;:function(row)&#123;</span><br><span class=\"line\">                                          return &#x27;hj212/pollutionsite/siteinfo/site_id/&#x27;+row.site_id;</span><br><span class=\"line\">                                       &#125;,</span><br><span class=\"line\">                                      &#x27;extend&#x27;: &#x27;data-area=\\&#x27;[&quot;95%&quot;,&quot;95%&quot;]\\&#x27;&#x27;</span><br><span class=\"line\">                                     &#125;,</span><br><span class=\"line\">                                 ]&#125;</span><br><span class=\"line\">                    ]</span><br><span class=\"line\">                ],</span><br><span class=\"line\">                exportTypes: [ &#x27;excel&#x27;],</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            // 为表格绑定事件</span><br><span class=\"line\">            Table.api.bindevent(table);</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        add: function () &#123;</span><br><span class=\"line\">            Controller.api.bindevent();</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        edit: function () &#123;</span><br><span class=\"line\">            Controller.api.bindevent();</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        bindsite:function()&#123;</span><br><span class=\"line\">            Controller.api.bindevent();</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        api: &#123;</span><br><span class=\"line\">            bindevent: function () &#123;</span><br><span class=\"line\">\t                $.validator.config(&#123;</span><br><span class=\"line\">\t                </span><br><span class=\"line\">                    rules: &#123;</span><br><span class=\"line\">                        checksite: function (element) &#123;</span><br><span class=\"line\">                            return $.ajax(&#123;</span><br><span class=\"line\">                                url: &#x27;hj212/device/checksite&#x27;,</span><br><span class=\"line\">                                type: &#x27;POST&#x27;,</span><br><span class=\"line\">                                data: &#123;</span><br><span class=\"line\">                                    site_id: $(&quot;#c-site_id&quot;).val(),</span><br><span class=\"line\">                                    id:$(&quot;#c-id&quot;).val()</span><br><span class=\"line\">                                &#125;,</span><br><span class=\"line\">                                dataType: &#x27;json&#x27;</span><br><span class=\"line\">                            &#125;);</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">                Form.api.bindevent($(&quot;form[role=form]&quot;));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"二、数据库操作\"><a href=\"#二、数据库操作\" class=\"headerlink\" title=\"二、数据库操作\"></a>二、数据库操作</h1><h1 id=\"三、redis相关操作\"><a href=\"#三、redis相关操作\" class=\"headerlink\" title=\"三、redis相关操作\"></a>三、redis相关操作</h1><h1 id=\"四、消息队列设置\"><a href=\"#四、消息队列设置\" class=\"headerlink\" title=\"四、消息队列设置\"></a>四、消息队列设置</h1><h1 id=\"五、命令行开发\"><a href=\"#五、命令行开发\" class=\"headerlink\" title=\"五、命令行开发\"></a>五、命令行开发</h1>","site":{"data":{}},"length":3153,"excerpt":"","more":"<h1 id=\"一、常用设置\"><a href=\"#一、常用设置\" class=\"headerlink\" title=\"一、常用设置\"></a>一、常用设置</h1><h2 id=\"1-1-通用搜索栏设置\"><a href=\"#1-1-通用搜索栏设置\" class=\"headerlink\" title=\"1.1 通用搜索栏设置\"></a>1.1 通用搜索栏设置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 初始化表格</span><br><span class=\"line\"> table.bootstrapTable(&#123;</span><br><span class=\"line\">     url: $.fn.bootstrapTable.defaults.extend.index_url,</span><br><span class=\"line\">     pk: &#x27;id&#x27;,</span><br><span class=\"line\">     sortName: &#x27;id&#x27;,</span><br><span class=\"line\">     fixedColumns: true,</span><br><span class=\"line\">     fixedRightNumber: 1,</span><br><span class=\"line\">     //切换列表显示样式开关</span><br><span class=\"line\">     showToggle: false,</span><br><span class=\"line\">     //是否显示右上角的搜索框</span><br><span class=\"line\">     search: false,</span><br><span class=\"line\">     //控制显示列开关</span><br><span class=\"line\">     showColumns:false,</span><br><span class=\"line\">     showExport: false,</span><br><span class=\"line\">     //显示搜索字段框</span><br><span class=\"line\">     searchFormVisible: true,</span><br><span class=\"line\">     //导出开关            </span><br><span class=\"line\">     showExport: true,</span><br><span class=\"line\">     //设置导出  格式</span><br><span class=\"line\">     exportTypes: [&#x27;json&#x27;, &#x27;xml&#x27;, &#x27;csv&#x27;, &#x27;txt&#x27;, &#x27;doc&#x27;, &#x27;excel&#x27;],</span><br><span class=\"line\">  &#125;)</span><br></pre></td></tr></table></figure>\n<h2 id=\"1-2-input-常用设置\"><a href=\"#1-2-input-常用设置\" class=\"headerlink\" title=\"1.2 input 常用设置\"></a>1.2 input 常用设置</h2><p>data-rule 设置 检查规则 可以自定义验证方法 checksite JS并相关设置<br>data-source select 可以设置数据源<br>设置弹框大小 ‘extend’: ‘data-area=&#39;[“95%”,”95%”]&#39;‘<br>示例</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//input设置</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;input id=&quot;c-site_id&quot; data-rule=&quot;checksite&quot; data-source=&quot;hj212/pollutionsite/index&quot; data-field=&quot;site_name&quot; class=&quot;form-control selectpage&quot; name=&quot;row[site_id]&quot; type=&quot;text&quot; value=&quot;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">//js中设置</span><br><span class=\"line\"></span><br><span class=\"line\">var Controller = &#123;</span><br><span class=\"line\">        index: function () &#123;</span><br><span class=\"line\">            // 初始化表格参数配置</span><br><span class=\"line\">            Table.api.init(&#123;</span><br><span class=\"line\">                ...</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            var table = $(&quot;#table&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">            // 初始化表格</span><br><span class=\"line\">            table.bootstrapTable(&#123;</span><br><span class=\"line\">                url: $.fn.bootstrapTable.defaults.extend.index_url,</span><br><span class=\"line\">                pk: &#x27;id&#x27;,</span><br><span class=\"line\">                sortName: &#x27;id&#x27;,</span><br><span class=\"line\"></span><br><span class=\"line\">                columns: [</span><br><span class=\"line\">                    [</span><br><span class=\"line\">                        &#123;checkbox: true&#125;,</span><br><span class=\"line\">                        &#123;field: &#x27;id&#x27;, title: __(&#x27;Id&#x27;),operate:false&#125;,</span><br><span class=\"line\">                  </span><br><span class=\"line\">                        &#123;field: &#x27;operate&#x27;, title: __(&#x27;Operate&#x27;), table: table, events: Table.api.events.operate, formatter: Table.api.formatter.operate,</span><br><span class=\"line\">                                 buttons:[</span><br><span class=\"line\">                                     &#123;</span><br><span class=\"line\">                                      &#x27;name&#x27;:&#x27;bindsite&#x27;,</span><br><span class=\"line\">                                      &#x27;title&#x27;:function(row)&#123;</span><br><span class=\"line\">                                          return &#x27;更换站点[ &#x27;+row.device_code+&#x27;]&#x27;;</span><br><span class=\"line\">                                      &#125;,</span><br><span class=\"line\">                                      &#x27;icon&#x27;:&#x27;fa fa-pencil&#x27;,</span><br><span class=\"line\">                                      &#x27;text&#x27;:&#x27;更换站点&#x27;,</span><br><span class=\"line\">                                      &#x27;classname&#x27;: &#x27;btn btn-xs btn-info btn-dialog&#x27;,</span><br><span class=\"line\">                                      &#x27;url&#x27;:&#x27;hj212/device/bindsite/deviceId/&#123;ids&#125;&#x27;,</span><br><span class=\"line\">                                      &#x27;extend&#x27;: &#x27;data-area=\\&#x27;[&quot;95%&quot;,&quot;95%&quot;]\\&#x27;&#x27;</span><br><span class=\"line\">                                     &#125;,</span><br><span class=\"line\">                                     &#123;</span><br><span class=\"line\">                                      &#x27;name&#x27;:&#x27;siteInfo&#x27;,</span><br><span class=\"line\">                                      &#x27;title&#x27;:function(row)&#123;</span><br><span class=\"line\">                                          return &#x27;站点信息[ &#x27;+row.site+&#x27;]&#x27;;</span><br><span class=\"line\">                                      &#125;,</span><br><span class=\"line\">                                      &#x27;text&#x27;:&#x27;站点信息&#x27;,</span><br><span class=\"line\">                                      &#x27;classname&#x27;: &#x27;btn btn-xs btn-primary btn-dialog&#x27;,</span><br><span class=\"line\">                                      &#x27;url&#x27;:function(row)&#123;</span><br><span class=\"line\">                                          return &#x27;hj212/pollutionsite/siteinfo/site_id/&#x27;+row.site_id;</span><br><span class=\"line\">                                       &#125;,</span><br><span class=\"line\">                                      &#x27;extend&#x27;: &#x27;data-area=\\&#x27;[&quot;95%&quot;,&quot;95%&quot;]\\&#x27;&#x27;</span><br><span class=\"line\">                                     &#125;,</span><br><span class=\"line\">                                 ]&#125;</span><br><span class=\"line\">                    ]</span><br><span class=\"line\">                ],</span><br><span class=\"line\">                exportTypes: [ &#x27;excel&#x27;],</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            // 为表格绑定事件</span><br><span class=\"line\">            Table.api.bindevent(table);</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        add: function () &#123;</span><br><span class=\"line\">            Controller.api.bindevent();</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        edit: function () &#123;</span><br><span class=\"line\">            Controller.api.bindevent();</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        bindsite:function()&#123;</span><br><span class=\"line\">            Controller.api.bindevent();</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        api: &#123;</span><br><span class=\"line\">            bindevent: function () &#123;</span><br><span class=\"line\">\t                $.validator.config(&#123;</span><br><span class=\"line\">\t                </span><br><span class=\"line\">                    rules: &#123;</span><br><span class=\"line\">                        checksite: function (element) &#123;</span><br><span class=\"line\">                            return $.ajax(&#123;</span><br><span class=\"line\">                                url: &#x27;hj212/device/checksite&#x27;,</span><br><span class=\"line\">                                type: &#x27;POST&#x27;,</span><br><span class=\"line\">                                data: &#123;</span><br><span class=\"line\">                                    site_id: $(&quot;#c-site_id&quot;).val(),</span><br><span class=\"line\">                                    id:$(&quot;#c-id&quot;).val()</span><br><span class=\"line\">                                &#125;,</span><br><span class=\"line\">                                dataType: &#x27;json&#x27;</span><br><span class=\"line\">                            &#125;);</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">                Form.api.bindevent($(&quot;form[role=form]&quot;));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"二、数据库操作\"><a href=\"#二、数据库操作\" class=\"headerlink\" title=\"二、数据库操作\"></a>二、数据库操作</h1><h1 id=\"三、redis相关操作\"><a href=\"#三、redis相关操作\" class=\"headerlink\" title=\"三、redis相关操作\"></a>三、redis相关操作</h1><h1 id=\"四、消息队列设置\"><a href=\"#四、消息队列设置\" class=\"headerlink\" title=\"四、消息队列设置\"></a>四、消息队列设置</h1><h1 id=\"五、命令行开发\"><a href=\"#五、命令行开发\" class=\"headerlink\" title=\"五、命令行开发\"></a>五、命令行开发</h1>"},{"title":"php开发-fastadmin高德地图点位展示效果","abbrlink":"fa30932c","date":"2024-02-01T10:53:51.000Z","_content":"\n\n```html\n<!DOCTYPE html>\n<html lang=\"{$config.language}\">\n<head>\n    {include file=\"common/meta\" /}\n</head>\n\n<body>\n<div id=\"container\"></div>\n</body>\n{include file=\"common/script\" /}\n</html>\n\n```\n\n\n```js\ndefine(['gdmap'], function f() {\n    var Controller = {\n        index: function () {\n            // 初始化表格参数配置\n            var map = new AMap.Map('container', {\n                resizeEnable: true,\n                center: [119, 33],\n                zoom: 13\n            });\n\n            function createInfoWindow(title, content) {\n                var info = document.createElement(\"div\");\n                info.className = \"custom-info input-card content-window-card\";\n\n                //可以通过下面的方式修改自定义窗体的宽高\n                info.style.width = \"250px\";\n                // 定义顶部标题\n                var top = document.createElement(\"div\");\n                var titleD = document.createElement(\"div\");\n                var closeX = document.createElement(\"img\");\n                top.className = \"info-top\";\n                titleD.innerHTML = title;\n                closeX.src = \"https://webapi.amap.com/images/close2.gif\";\n                closeX.onclick = closeInfoWindow;\n\n                top.appendChild(titleD);\n                top.appendChild(closeX);\n                info.appendChild(top);\n\n                // 定义中部内容\n                var middle = document.createElement(\"div\");\n                middle.className = \"info-middle\";\n                middle.style.backgroundColor = 'white';\n                middle.innerHTML = content;\n                info.appendChild(middle);\n\n                // 定义底部内容\n                var bottom = document.createElement(\"div\");\n                bottom.className = \"info-bottom\";\n                bottom.style.position = 'relative';\n                bottom.style.top = '0px';\n                bottom.style.margin = '0 auto';\n                var sharp = document.createElement(\"img\");\n                sharp.src = \"https://webapi.amap.com/images/sharp.png\";\n                bottom.appendChild(sharp);\n                info.appendChild(bottom);\n                return info;\n            }\n\n            //关闭信息窗体\n            function closeInfoWindow() {\n                map.clearInfoWindow();\n            }\n\n            map.clearMap();  // 清除地图覆盖物\n\n\n            var markers = JSON.parse(Config.list);\n\n            //添加一些分布不均的点到地图上,地图上添加三个点标记，作为参照\n            markers.forEach(function (marker) {\n\n                var point = new AMap.Marker({\n                    map: map,\n                    icon: marker.icon,\n                    position: [marker.lon, marker.lat],\n                    offset: new AMap.Pixel(-13, -30)\n                });\n                point.on('click', function () {\n                    infoWindow.open(map, point.getPosition());\n                });\n\n                // 设置鼠标划过点标记显示的文字提示\n                point.setTitle('marker.site_name');\n\n                // 设置label标签\n                // label默认蓝框白底左上角显示，样式className为：amap-marker-label\n                point.setLabel({\n                    direction: 'right',\n                    offset: new AMap.Pixel(0, 0),  //设置文本标注偏移量\n                    content: \"<div style='font-weight: bold'>\" + marker.site_name + \"</div>\", //设置文本标注内容\n                });\n                //实例化信息窗体\n                var title = marker.site_name,\n                    content = [];\n                content.push(\"所属于区县:\" + marker.address);\n                content.push(\"所属于园区:\" + marker.industrial_park);\n\n                if (marker.data) {\n                    content.push(\"-------------------------------------------------\");\n                    content.push(\"检测时间:\" + marker.data.cp_datatime_text);\n                    for (let i in  marker.data.pollution) {\n                        if (marker.data.pollution[i].name) {\n                            content.push(  marker.data.pollution[i].name+\"&nbsp：&nbsp\" + marker.data.pollution[i].min + '~' + marker.data.pollution[i].max);\n                        }\n                    }\n                }\n                var infoWindow = new AMap.InfoWindow({\n                    isCustom: true,  //使用自定义窗体\n                    content: createInfoWindow(title, content.join(\"<br/>\")),\n                    offset: new AMap.Pixel(16, -45)\n                });\n\n            });\n            var center = map.getCenter();\n            map.setFitView();\n        },\n    };\n    return Controller;\n})\n```\n\n\n```php\n<?php\nnamespace app\\admin\\controller\\hj212;\n\n\nuse app\\common\\controller\\Backend;\nuse app\\admin\\model\\hj212\\Data;\nuse app\\admin\\model\\hj212\\Device;\n\nclass Pointmap extends Backend\n{\n    public function _initialize()\n    {\n        $this->layout = \"\";\n        parent::_initialize();\n        $this->model = new \\app\\admin\\model\\hj212\\PollutionSite;\n    }\n\n\n    public function index()\n    {\n        $data = $this->model->all();\n        $list = collection($data)->toArray();\n        $list = array_map(function ($val) {\n            $device = Device::where('site_id', $val['id'])->find();\n            $data = [];\n            if ($device->device_code) {\n                $data = Data::where('mn', $device->device_code)\n                    ->order('created_at','desc')\n                    ->find();\n            }\n            if ($data) {\n                $pollution = \\app\\admin\\model\\hj212\\Pollution::with('PollutionCode')\n                    ->where('data_id', $data->id)->select();\n                $pollution = array_map(function ($val) {\n                    $val['name'] = $val['PollutionCode']['name'];\n                    unset($val['PollutionCode']);\n                    return $val;\n                }, $pollution);\n                $data['pollution'] = $pollution;\n            }\n            $val['data'] = $data;\n            return $val;\n        }, $list);\n        $this->assignconfig('list', json_encode($list));\n        return $this->view->fetch();\n    }\n}\n\n```","source":"_posts/php开发-fastadmin高德地图点位展示效果.md","raw":"---\ntitle: php开发-fastadmin高德地图点位展示效果\nabbrlink: fa30932c\ncategories:\n  - 前端\ndate: 2024-02-01 18:53:51\ntags: fastadmin\n---\n\n\n```html\n<!DOCTYPE html>\n<html lang=\"{$config.language}\">\n<head>\n    {include file=\"common/meta\" /}\n</head>\n\n<body>\n<div id=\"container\"></div>\n</body>\n{include file=\"common/script\" /}\n</html>\n\n```\n\n\n```js\ndefine(['gdmap'], function f() {\n    var Controller = {\n        index: function () {\n            // 初始化表格参数配置\n            var map = new AMap.Map('container', {\n                resizeEnable: true,\n                center: [119, 33],\n                zoom: 13\n            });\n\n            function createInfoWindow(title, content) {\n                var info = document.createElement(\"div\");\n                info.className = \"custom-info input-card content-window-card\";\n\n                //可以通过下面的方式修改自定义窗体的宽高\n                info.style.width = \"250px\";\n                // 定义顶部标题\n                var top = document.createElement(\"div\");\n                var titleD = document.createElement(\"div\");\n                var closeX = document.createElement(\"img\");\n                top.className = \"info-top\";\n                titleD.innerHTML = title;\n                closeX.src = \"https://webapi.amap.com/images/close2.gif\";\n                closeX.onclick = closeInfoWindow;\n\n                top.appendChild(titleD);\n                top.appendChild(closeX);\n                info.appendChild(top);\n\n                // 定义中部内容\n                var middle = document.createElement(\"div\");\n                middle.className = \"info-middle\";\n                middle.style.backgroundColor = 'white';\n                middle.innerHTML = content;\n                info.appendChild(middle);\n\n                // 定义底部内容\n                var bottom = document.createElement(\"div\");\n                bottom.className = \"info-bottom\";\n                bottom.style.position = 'relative';\n                bottom.style.top = '0px';\n                bottom.style.margin = '0 auto';\n                var sharp = document.createElement(\"img\");\n                sharp.src = \"https://webapi.amap.com/images/sharp.png\";\n                bottom.appendChild(sharp);\n                info.appendChild(bottom);\n                return info;\n            }\n\n            //关闭信息窗体\n            function closeInfoWindow() {\n                map.clearInfoWindow();\n            }\n\n            map.clearMap();  // 清除地图覆盖物\n\n\n            var markers = JSON.parse(Config.list);\n\n            //添加一些分布不均的点到地图上,地图上添加三个点标记，作为参照\n            markers.forEach(function (marker) {\n\n                var point = new AMap.Marker({\n                    map: map,\n                    icon: marker.icon,\n                    position: [marker.lon, marker.lat],\n                    offset: new AMap.Pixel(-13, -30)\n                });\n                point.on('click', function () {\n                    infoWindow.open(map, point.getPosition());\n                });\n\n                // 设置鼠标划过点标记显示的文字提示\n                point.setTitle('marker.site_name');\n\n                // 设置label标签\n                // label默认蓝框白底左上角显示，样式className为：amap-marker-label\n                point.setLabel({\n                    direction: 'right',\n                    offset: new AMap.Pixel(0, 0),  //设置文本标注偏移量\n                    content: \"<div style='font-weight: bold'>\" + marker.site_name + \"</div>\", //设置文本标注内容\n                });\n                //实例化信息窗体\n                var title = marker.site_name,\n                    content = [];\n                content.push(\"所属于区县:\" + marker.address);\n                content.push(\"所属于园区:\" + marker.industrial_park);\n\n                if (marker.data) {\n                    content.push(\"-------------------------------------------------\");\n                    content.push(\"检测时间:\" + marker.data.cp_datatime_text);\n                    for (let i in  marker.data.pollution) {\n                        if (marker.data.pollution[i].name) {\n                            content.push(  marker.data.pollution[i].name+\"&nbsp：&nbsp\" + marker.data.pollution[i].min + '~' + marker.data.pollution[i].max);\n                        }\n                    }\n                }\n                var infoWindow = new AMap.InfoWindow({\n                    isCustom: true,  //使用自定义窗体\n                    content: createInfoWindow(title, content.join(\"<br/>\")),\n                    offset: new AMap.Pixel(16, -45)\n                });\n\n            });\n            var center = map.getCenter();\n            map.setFitView();\n        },\n    };\n    return Controller;\n})\n```\n\n\n```php\n<?php\nnamespace app\\admin\\controller\\hj212;\n\n\nuse app\\common\\controller\\Backend;\nuse app\\admin\\model\\hj212\\Data;\nuse app\\admin\\model\\hj212\\Device;\n\nclass Pointmap extends Backend\n{\n    public function _initialize()\n    {\n        $this->layout = \"\";\n        parent::_initialize();\n        $this->model = new \\app\\admin\\model\\hj212\\PollutionSite;\n    }\n\n\n    public function index()\n    {\n        $data = $this->model->all();\n        $list = collection($data)->toArray();\n        $list = array_map(function ($val) {\n            $device = Device::where('site_id', $val['id'])->find();\n            $data = [];\n            if ($device->device_code) {\n                $data = Data::where('mn', $device->device_code)\n                    ->order('created_at','desc')\n                    ->find();\n            }\n            if ($data) {\n                $pollution = \\app\\admin\\model\\hj212\\Pollution::with('PollutionCode')\n                    ->where('data_id', $data->id)->select();\n                $pollution = array_map(function ($val) {\n                    $val['name'] = $val['PollutionCode']['name'];\n                    unset($val['PollutionCode']);\n                    return $val;\n                }, $pollution);\n                $data['pollution'] = $pollution;\n            }\n            $val['data'] = $data;\n            return $val;\n        }, $list);\n        $this->assignconfig('list', json_encode($list));\n        return $this->view->fetch();\n    }\n}\n\n```","slug":"php开发-fastadmin高德地图点位展示效果","published":1,"updated":"2024-10-18T06:04:06.532Z","_id":"clzqfyf10000148oc75bj7qhp","comments":1,"layout":"post","photos":[],"link":"","content":"<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"meta-keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;&#123;$config.language&#125;&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    &#123;include file=&quot;common/meta&quot; /&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;container&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">&#123;include file=&quot;common/script&quot; /&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">define([<span class=\"string\">&#x27;gdmap&#x27;</span>], <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">f</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> Controller = &#123;</span><br><span class=\"line\">        <span class=\"attr\">index</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 初始化表格参数配置</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> map = <span class=\"keyword\">new</span> AMap.Map(<span class=\"string\">&#x27;container&#x27;</span>, &#123;</span><br><span class=\"line\">                <span class=\"attr\">resizeEnable</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">                <span class=\"attr\">center</span>: [<span class=\"number\">119</span>, <span class=\"number\">33</span>],</span><br><span class=\"line\">                <span class=\"attr\">zoom</span>: <span class=\"number\">13</span></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">createInfoWindow</span>(<span class=\"params\">title, content</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> info = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;div&quot;</span>);</span><br><span class=\"line\">                info.className = <span class=\"string\">&quot;custom-info input-card content-window-card&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">//可以通过下面的方式修改自定义窗体的宽高</span></span><br><span class=\"line\">                info.style.width = <span class=\"string\">&quot;250px&quot;</span>;</span><br><span class=\"line\">                <span class=\"comment\">// 定义顶部标题</span></span><br><span class=\"line\">                <span class=\"keyword\">var</span> top = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;div&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">var</span> titleD = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;div&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">var</span> closeX = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;img&quot;</span>);</span><br><span class=\"line\">                top.className = <span class=\"string\">&quot;info-top&quot;</span>;</span><br><span class=\"line\">                titleD.innerHTML = title;</span><br><span class=\"line\">                closeX.src = <span class=\"string\">&quot;https://webapi.amap.com/images/close2.gif&quot;</span>;</span><br><span class=\"line\">                closeX.onclick = closeInfoWindow;</span><br><span class=\"line\"></span><br><span class=\"line\">                top.appendChild(titleD);</span><br><span class=\"line\">                top.appendChild(closeX);</span><br><span class=\"line\">                info.appendChild(top);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 定义中部内容</span></span><br><span class=\"line\">                <span class=\"keyword\">var</span> middle = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;div&quot;</span>);</span><br><span class=\"line\">                middle.className = <span class=\"string\">&quot;info-middle&quot;</span>;</span><br><span class=\"line\">                middle.style.backgroundColor = <span class=\"string\">&#x27;white&#x27;</span>;</span><br><span class=\"line\">                middle.innerHTML = content;</span><br><span class=\"line\">                info.appendChild(middle);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 定义底部内容</span></span><br><span class=\"line\">                <span class=\"keyword\">var</span> bottom = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;div&quot;</span>);</span><br><span class=\"line\">                bottom.className = <span class=\"string\">&quot;info-bottom&quot;</span>;</span><br><span class=\"line\">                bottom.style.position = <span class=\"string\">&#x27;relative&#x27;</span>;</span><br><span class=\"line\">                bottom.style.top = <span class=\"string\">&#x27;0px&#x27;</span>;</span><br><span class=\"line\">                bottom.style.margin = <span class=\"string\">&#x27;0 auto&#x27;</span>;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> sharp = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;img&quot;</span>);</span><br><span class=\"line\">                sharp.src = <span class=\"string\">&quot;https://webapi.amap.com/images/sharp.png&quot;</span>;</span><br><span class=\"line\">                bottom.appendChild(sharp);</span><br><span class=\"line\">                info.appendChild(bottom);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> info;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//关闭信息窗体</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">closeInfoWindow</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">                map.clearInfoWindow();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            map.clearMap();  <span class=\"comment\">// 清除地图覆盖物</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">var</span> markers = <span class=\"built_in\">JSON</span>.parse(Config.list);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//添加一些分布不均的点到地图上,地图上添加三个点标记，作为参照</span></span><br><span class=\"line\">            markers.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">marker</span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">var</span> point = <span class=\"keyword\">new</span> AMap.Marker(&#123;</span><br><span class=\"line\">                    <span class=\"attr\">map</span>: map,</span><br><span class=\"line\">                    <span class=\"attr\">icon</span>: marker.icon,</span><br><span class=\"line\">                    <span class=\"attr\">position</span>: [marker.lon, marker.lat],</span><br><span class=\"line\">                    <span class=\"attr\">offset</span>: <span class=\"keyword\">new</span> AMap.Pixel(-<span class=\"number\">13</span>, -<span class=\"number\">30</span>)</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">                point.on(<span class=\"string\">&#x27;click&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">                    infoWindow.open(map, point.getPosition());</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 设置鼠标划过点标记显示的文字提示</span></span><br><span class=\"line\">                point.setTitle(<span class=\"string\">&#x27;marker.site_name&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 设置label标签</span></span><br><span class=\"line\">                <span class=\"comment\">// label默认蓝框白底左上角显示，样式className为：amap-marker-label</span></span><br><span class=\"line\">                point.setLabel(&#123;</span><br><span class=\"line\">                    <span class=\"attr\">direction</span>: <span class=\"string\">&#x27;right&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">offset</span>: <span class=\"keyword\">new</span> AMap.Pixel(<span class=\"number\">0</span>, <span class=\"number\">0</span>),  <span class=\"comment\">//设置文本标注偏移量</span></span><br><span class=\"line\">                    <span class=\"attr\">content</span>: <span class=\"string\">&quot;&lt;div style=&#x27;font-weight: bold&#x27;&gt;&quot;</span> + marker.site_name + <span class=\"string\">&quot;&lt;/div&gt;&quot;</span>, <span class=\"comment\">//设置文本标注内容</span></span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">                <span class=\"comment\">//实例化信息窗体</span></span><br><span class=\"line\">                <span class=\"keyword\">var</span> title = marker.site_name,</span><br><span class=\"line\">                    content = [];</span><br><span class=\"line\">                content.push(<span class=\"string\">&quot;所属于区县:&quot;</span> + marker.address);</span><br><span class=\"line\">                content.push(<span class=\"string\">&quot;所属于园区:&quot;</span> + marker.industrial_park);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (marker.data) &#123;</span><br><span class=\"line\">                    content.push(<span class=\"string\">&quot;-------------------------------------------------&quot;</span>);</span><br><span class=\"line\">                    content.push(<span class=\"string\">&quot;检测时间:&quot;</span> + marker.data.cp_datatime_text);</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span>  marker.data.pollution) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (marker.data.pollution[i].name) &#123;</span><br><span class=\"line\">                            content.push(  marker.data.pollution[i].name+<span class=\"string\">&quot;&amp;nbsp：&amp;nbsp&quot;</span> + marker.data.pollution[i].min + <span class=\"string\">&#x27;~&#x27;</span> + marker.data.pollution[i].max);</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> infoWindow = <span class=\"keyword\">new</span> AMap.InfoWindow(&#123;</span><br><span class=\"line\">                    <span class=\"attr\">isCustom</span>: <span class=\"literal\">true</span>,  <span class=\"comment\">//使用自定义窗体</span></span><br><span class=\"line\">                    <span class=\"attr\">content</span>: createInfoWindow(title, content.join(<span class=\"string\">&quot;&lt;br/&gt;&quot;</span>)),</span><br><span class=\"line\">                    <span class=\"attr\">offset</span>: <span class=\"keyword\">new</span> AMap.Pixel(<span class=\"number\">16</span>, -<span class=\"number\">45</span>)</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"keyword\">var</span> center = map.getCenter();</span><br><span class=\"line\">            map.setFitView();</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> Controller;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">app</span>\\<span class=\"title\">admin</span>\\<span class=\"title\">controller</span>\\<span class=\"title\">hj212</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">app</span>\\<span class=\"title\">common</span>\\<span class=\"title\">controller</span>\\<span class=\"title\">Backend</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">app</span>\\<span class=\"title\">admin</span>\\<span class=\"title\">model</span>\\<span class=\"title\">hj212</span>\\<span class=\"title\">Data</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">app</span>\\<span class=\"title\">admin</span>\\<span class=\"title\">model</span>\\<span class=\"title\">hj212</span>\\<span class=\"title\">Device</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Pointmap</span> <span class=\"keyword\">extends</span> <span class=\"title\">Backend</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">_initialize</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;layout = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">        <span class=\"built_in\">parent</span>::_initialize();</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;model = <span class=\"keyword\">new</span> \\app\\admin\\model\\hj212\\PollutionSite;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">index</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$data</span> = <span class=\"keyword\">$this</span>-&gt;model-&gt;all();</span><br><span class=\"line\">        <span class=\"variable\">$list</span> = collection(<span class=\"variable\">$data</span>)-&gt;toArray();</span><br><span class=\"line\">        <span class=\"variable\">$list</span> = array_map(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"><span class=\"variable\">$val</span></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"variable\">$device</span> = Device::where(<span class=\"string\">&#x27;site_id&#x27;</span>, <span class=\"variable\">$val</span>[<span class=\"string\">&#x27;id&#x27;</span>])-&gt;find();</span><br><span class=\"line\">            <span class=\"variable\">$data</span> = [];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"variable\">$device</span>-&gt;device_code) &#123;</span><br><span class=\"line\">                <span class=\"variable\">$data</span> = Data::where(<span class=\"string\">&#x27;mn&#x27;</span>, <span class=\"variable\">$device</span>-&gt;device_code)</span><br><span class=\"line\">                    -&gt;order(<span class=\"string\">&#x27;created_at&#x27;</span>,<span class=\"string\">&#x27;desc&#x27;</span>)</span><br><span class=\"line\">                    -&gt;find();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"variable\">$data</span>) &#123;</span><br><span class=\"line\">                <span class=\"variable\">$pollution</span> = \\app\\admin\\model\\hj212\\Pollution::with(<span class=\"string\">&#x27;PollutionCode&#x27;</span>)</span><br><span class=\"line\">                    -&gt;where(<span class=\"string\">&#x27;data_id&#x27;</span>, <span class=\"variable\">$data</span>-&gt;id)-&gt;select();</span><br><span class=\"line\">                <span class=\"variable\">$pollution</span> = array_map(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"><span class=\"variable\">$val</span></span>) </span>&#123;</span><br><span class=\"line\">                    <span class=\"variable\">$val</span>[<span class=\"string\">&#x27;name&#x27;</span>] = <span class=\"variable\">$val</span>[<span class=\"string\">&#x27;PollutionCode&#x27;</span>][<span class=\"string\">&#x27;name&#x27;</span>];</span><br><span class=\"line\">                    <span class=\"keyword\">unset</span>(<span class=\"variable\">$val</span>[<span class=\"string\">&#x27;PollutionCode&#x27;</span>]);</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"variable\">$val</span>;</span><br><span class=\"line\">                &#125;, <span class=\"variable\">$pollution</span>);</span><br><span class=\"line\">                <span class=\"variable\">$data</span>[<span class=\"string\">&#x27;pollution&#x27;</span>] = <span class=\"variable\">$pollution</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"variable\">$val</span>[<span class=\"string\">&#x27;data&#x27;</span>] = <span class=\"variable\">$data</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable\">$val</span>;</span><br><span class=\"line\">        &#125;, <span class=\"variable\">$list</span>);</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;assignconfig(<span class=\"string\">&#x27;list&#x27;</span>, json_encode(<span class=\"variable\">$list</span>));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>-&gt;view-&gt;fetch();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>","site":{"data":{}},"length":4775,"excerpt":"","more":"<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"meta-keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;&#123;$config.language&#125;&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    &#123;include file=&quot;common/meta&quot; /&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;container&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">&#123;include file=&quot;common/script&quot; /&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">define([<span class=\"string\">&#x27;gdmap&#x27;</span>], <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">f</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> Controller = &#123;</span><br><span class=\"line\">        <span class=\"attr\">index</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 初始化表格参数配置</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> map = <span class=\"keyword\">new</span> AMap.Map(<span class=\"string\">&#x27;container&#x27;</span>, &#123;</span><br><span class=\"line\">                <span class=\"attr\">resizeEnable</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">                <span class=\"attr\">center</span>: [<span class=\"number\">119</span>, <span class=\"number\">33</span>],</span><br><span class=\"line\">                <span class=\"attr\">zoom</span>: <span class=\"number\">13</span></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">createInfoWindow</span>(<span class=\"params\">title, content</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> info = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;div&quot;</span>);</span><br><span class=\"line\">                info.className = <span class=\"string\">&quot;custom-info input-card content-window-card&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">//可以通过下面的方式修改自定义窗体的宽高</span></span><br><span class=\"line\">                info.style.width = <span class=\"string\">&quot;250px&quot;</span>;</span><br><span class=\"line\">                <span class=\"comment\">// 定义顶部标题</span></span><br><span class=\"line\">                <span class=\"keyword\">var</span> top = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;div&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">var</span> titleD = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;div&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">var</span> closeX = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;img&quot;</span>);</span><br><span class=\"line\">                top.className = <span class=\"string\">&quot;info-top&quot;</span>;</span><br><span class=\"line\">                titleD.innerHTML = title;</span><br><span class=\"line\">                closeX.src = <span class=\"string\">&quot;https://webapi.amap.com/images/close2.gif&quot;</span>;</span><br><span class=\"line\">                closeX.onclick = closeInfoWindow;</span><br><span class=\"line\"></span><br><span class=\"line\">                top.appendChild(titleD);</span><br><span class=\"line\">                top.appendChild(closeX);</span><br><span class=\"line\">                info.appendChild(top);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 定义中部内容</span></span><br><span class=\"line\">                <span class=\"keyword\">var</span> middle = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;div&quot;</span>);</span><br><span class=\"line\">                middle.className = <span class=\"string\">&quot;info-middle&quot;</span>;</span><br><span class=\"line\">                middle.style.backgroundColor = <span class=\"string\">&#x27;white&#x27;</span>;</span><br><span class=\"line\">                middle.innerHTML = content;</span><br><span class=\"line\">                info.appendChild(middle);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 定义底部内容</span></span><br><span class=\"line\">                <span class=\"keyword\">var</span> bottom = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;div&quot;</span>);</span><br><span class=\"line\">                bottom.className = <span class=\"string\">&quot;info-bottom&quot;</span>;</span><br><span class=\"line\">                bottom.style.position = <span class=\"string\">&#x27;relative&#x27;</span>;</span><br><span class=\"line\">                bottom.style.top = <span class=\"string\">&#x27;0px&#x27;</span>;</span><br><span class=\"line\">                bottom.style.margin = <span class=\"string\">&#x27;0 auto&#x27;</span>;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> sharp = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;img&quot;</span>);</span><br><span class=\"line\">                sharp.src = <span class=\"string\">&quot;https://webapi.amap.com/images/sharp.png&quot;</span>;</span><br><span class=\"line\">                bottom.appendChild(sharp);</span><br><span class=\"line\">                info.appendChild(bottom);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> info;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//关闭信息窗体</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">closeInfoWindow</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">                map.clearInfoWindow();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            map.clearMap();  <span class=\"comment\">// 清除地图覆盖物</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">var</span> markers = <span class=\"built_in\">JSON</span>.parse(Config.list);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//添加一些分布不均的点到地图上,地图上添加三个点标记，作为参照</span></span><br><span class=\"line\">            markers.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">marker</span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">var</span> point = <span class=\"keyword\">new</span> AMap.Marker(&#123;</span><br><span class=\"line\">                    <span class=\"attr\">map</span>: map,</span><br><span class=\"line\">                    <span class=\"attr\">icon</span>: marker.icon,</span><br><span class=\"line\">                    <span class=\"attr\">position</span>: [marker.lon, marker.lat],</span><br><span class=\"line\">                    <span class=\"attr\">offset</span>: <span class=\"keyword\">new</span> AMap.Pixel(-<span class=\"number\">13</span>, -<span class=\"number\">30</span>)</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">                point.on(<span class=\"string\">&#x27;click&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">                    infoWindow.open(map, point.getPosition());</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 设置鼠标划过点标记显示的文字提示</span></span><br><span class=\"line\">                point.setTitle(<span class=\"string\">&#x27;marker.site_name&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 设置label标签</span></span><br><span class=\"line\">                <span class=\"comment\">// label默认蓝框白底左上角显示，样式className为：amap-marker-label</span></span><br><span class=\"line\">                point.setLabel(&#123;</span><br><span class=\"line\">                    <span class=\"attr\">direction</span>: <span class=\"string\">&#x27;right&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">offset</span>: <span class=\"keyword\">new</span> AMap.Pixel(<span class=\"number\">0</span>, <span class=\"number\">0</span>),  <span class=\"comment\">//设置文本标注偏移量</span></span><br><span class=\"line\">                    <span class=\"attr\">content</span>: <span class=\"string\">&quot;&lt;div style=&#x27;font-weight: bold&#x27;&gt;&quot;</span> + marker.site_name + <span class=\"string\">&quot;&lt;/div&gt;&quot;</span>, <span class=\"comment\">//设置文本标注内容</span></span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">                <span class=\"comment\">//实例化信息窗体</span></span><br><span class=\"line\">                <span class=\"keyword\">var</span> title = marker.site_name,</span><br><span class=\"line\">                    content = [];</span><br><span class=\"line\">                content.push(<span class=\"string\">&quot;所属于区县:&quot;</span> + marker.address);</span><br><span class=\"line\">                content.push(<span class=\"string\">&quot;所属于园区:&quot;</span> + marker.industrial_park);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (marker.data) &#123;</span><br><span class=\"line\">                    content.push(<span class=\"string\">&quot;-------------------------------------------------&quot;</span>);</span><br><span class=\"line\">                    content.push(<span class=\"string\">&quot;检测时间:&quot;</span> + marker.data.cp_datatime_text);</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span>  marker.data.pollution) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (marker.data.pollution[i].name) &#123;</span><br><span class=\"line\">                            content.push(  marker.data.pollution[i].name+<span class=\"string\">&quot;&amp;nbsp：&amp;nbsp&quot;</span> + marker.data.pollution[i].min + <span class=\"string\">&#x27;~&#x27;</span> + marker.data.pollution[i].max);</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> infoWindow = <span class=\"keyword\">new</span> AMap.InfoWindow(&#123;</span><br><span class=\"line\">                    <span class=\"attr\">isCustom</span>: <span class=\"literal\">true</span>,  <span class=\"comment\">//使用自定义窗体</span></span><br><span class=\"line\">                    <span class=\"attr\">content</span>: createInfoWindow(title, content.join(<span class=\"string\">&quot;&lt;br/&gt;&quot;</span>)),</span><br><span class=\"line\">                    <span class=\"attr\">offset</span>: <span class=\"keyword\">new</span> AMap.Pixel(<span class=\"number\">16</span>, -<span class=\"number\">45</span>)</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"keyword\">var</span> center = map.getCenter();</span><br><span class=\"line\">            map.setFitView();</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> Controller;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">app</span>\\<span class=\"title\">admin</span>\\<span class=\"title\">controller</span>\\<span class=\"title\">hj212</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">app</span>\\<span class=\"title\">common</span>\\<span class=\"title\">controller</span>\\<span class=\"title\">Backend</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">app</span>\\<span class=\"title\">admin</span>\\<span class=\"title\">model</span>\\<span class=\"title\">hj212</span>\\<span class=\"title\">Data</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">app</span>\\<span class=\"title\">admin</span>\\<span class=\"title\">model</span>\\<span class=\"title\">hj212</span>\\<span class=\"title\">Device</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Pointmap</span> <span class=\"keyword\">extends</span> <span class=\"title\">Backend</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">_initialize</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;layout = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">        <span class=\"built_in\">parent</span>::_initialize();</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;model = <span class=\"keyword\">new</span> \\app\\admin\\model\\hj212\\PollutionSite;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">index</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$data</span> = <span class=\"keyword\">$this</span>-&gt;model-&gt;all();</span><br><span class=\"line\">        <span class=\"variable\">$list</span> = collection(<span class=\"variable\">$data</span>)-&gt;toArray();</span><br><span class=\"line\">        <span class=\"variable\">$list</span> = array_map(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"><span class=\"variable\">$val</span></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"variable\">$device</span> = Device::where(<span class=\"string\">&#x27;site_id&#x27;</span>, <span class=\"variable\">$val</span>[<span class=\"string\">&#x27;id&#x27;</span>])-&gt;find();</span><br><span class=\"line\">            <span class=\"variable\">$data</span> = [];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"variable\">$device</span>-&gt;device_code) &#123;</span><br><span class=\"line\">                <span class=\"variable\">$data</span> = Data::where(<span class=\"string\">&#x27;mn&#x27;</span>, <span class=\"variable\">$device</span>-&gt;device_code)</span><br><span class=\"line\">                    -&gt;order(<span class=\"string\">&#x27;created_at&#x27;</span>,<span class=\"string\">&#x27;desc&#x27;</span>)</span><br><span class=\"line\">                    -&gt;find();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"variable\">$data</span>) &#123;</span><br><span class=\"line\">                <span class=\"variable\">$pollution</span> = \\app\\admin\\model\\hj212\\Pollution::with(<span class=\"string\">&#x27;PollutionCode&#x27;</span>)</span><br><span class=\"line\">                    -&gt;where(<span class=\"string\">&#x27;data_id&#x27;</span>, <span class=\"variable\">$data</span>-&gt;id)-&gt;select();</span><br><span class=\"line\">                <span class=\"variable\">$pollution</span> = array_map(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"><span class=\"variable\">$val</span></span>) </span>&#123;</span><br><span class=\"line\">                    <span class=\"variable\">$val</span>[<span class=\"string\">&#x27;name&#x27;</span>] = <span class=\"variable\">$val</span>[<span class=\"string\">&#x27;PollutionCode&#x27;</span>][<span class=\"string\">&#x27;name&#x27;</span>];</span><br><span class=\"line\">                    <span class=\"keyword\">unset</span>(<span class=\"variable\">$val</span>[<span class=\"string\">&#x27;PollutionCode&#x27;</span>]);</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"variable\">$val</span>;</span><br><span class=\"line\">                &#125;, <span class=\"variable\">$pollution</span>);</span><br><span class=\"line\">                <span class=\"variable\">$data</span>[<span class=\"string\">&#x27;pollution&#x27;</span>] = <span class=\"variable\">$pollution</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"variable\">$val</span>[<span class=\"string\">&#x27;data&#x27;</span>] = <span class=\"variable\">$data</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable\">$val</span>;</span><br><span class=\"line\">        &#125;, <span class=\"variable\">$list</span>);</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;assignconfig(<span class=\"string\">&#x27;list&#x27;</span>, json_encode(<span class=\"variable\">$list</span>));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>-&gt;view-&gt;fetch();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>"},{"title":"商城开发-拼团功能开发设计","abbrlink":"701fec33","date":"2024-08-12T07:24:12.000Z","_content":"# 功能需求描述\n\n    \n# 数据库表设计\n\n\nfa_wanlshop_groups  拼团表\n\nid\tint\t10\t0\t0\t0\t-1\t0\t\t\t\tID\t\t\t\t\t0\t0\t0\t0\t-1\t-1\t0\ngroup_no\tvarchar\t32\t0\t0\t0\t0\t0\t\t\t\t拼团号\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nuser_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t团长ID\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nshop_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t所属商家\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ngoods_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t所属商品\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ngroup_type\tenum\t0\t0\t0\t0\t0\t0\t\t'alone','group','ladder'\t\t拼团类型:alone=直购,group=拼团,ladder=阶梯拼团\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nis_ladder\ttinyint\t1\t0\t0\t0\t0\t0\t\t\t0\t是否阶梯拼团\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nladder_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t阶梯ID\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\npeople_num\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t成团人数\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\njoin_num\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t参团人数\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nstate\tenum\t0\t0\t0\t0\t0\t0\t\t'ready','start','success','fail','auto'\t'ready'\t拼团状态:ready=准备中,start=拼团中,success=已成团,fail=拼团失败,auto=自动成团\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ncreatetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t开团时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ngrouptime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t成团时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nvaliditytime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t有效时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nupdatetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t更新时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ndeletetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t删除时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nstatus\tenum\t0\t0\t-1\t0\t0\t0\t\t'normal','hidden'\t'normal'\t状态\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\n\n\nfa_wanlshop_groups_goods 拼团商品表\n\nid\tint\t10\t0\t0\t0\t-1\t0\t\t\t\tID\t\t\t\t\t0\t0\t0\t0\t-1\t-1\t0\nshop_id\tint\t10\t0\t-1\t0\t0\t0\t\t\t0\t店铺ID\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nshop_category_id\tvarchar\t100\t0\t-1\t0\t0\t0\t\t\t\t店铺内类目\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ncategory_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t商品类目\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nbrand_id\tint\t10\t0\t-1\t0\t0\t0\t\t\t0\t品牌ID\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\ncategory_attribute\tlongtext\t0\t0\t-1\t0\t0\t0\t\t\t\t类目属性\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ntitle\tvarchar\t100\t0\t0\t0\t0\t0\t\t\t\t商品标题\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nimage\tvarchar\t100\t0\t0\t0\t0\t0\t\t\t\t商品主图\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nimages\tvarchar\t1500\t0\t0\t0\t0\t0\t\t\t\t产品相册\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ndescription\tvarchar\t255\t0\t0\t0\t0\t0\t\t\t\t商品描述\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nis_alone\ttinyint\t1\t0\t0\t0\t0\t0\t\t\t1\t是否显示单购是:0=否,1=是\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\npeople_num\tint\t3\t0\t-1\t0\t0\t0\t\t\t0\t组团人数\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ngroups_num\tint\t3\t0\t-1\t0\t0\t0\t\t\t0\t成团人数\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nis_ladder\ttinyint\t1\t0\t0\t0\t0\t0\t\t\t0\t开启阶梯团:0=否,1=是\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ngroup_hour\tint\t10\t0\t0\t0\t0\t0\t\t\t24\t组团限时(小时)\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\npurchase_limit\tint\t6\t0\t0\t0\t0\t0\t\t\t0\t个人购买次数限制，默认是0，没有次数限制\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nis_discount\ttinyint\t1\t0\t0\t0\t0\t0\t\t\t0\t是否显示团长优惠是:0=否,1=是\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ndiscount_type\ttinyint\t1\t0\t0\t0\t0\t0\t\t\t0\t团长优惠类型:0=金额,1=百分百\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ndiscount\tfloat\t10\t2\t-1\t0\t0\t0\t\t\t0.00\t优惠金额/折扣\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nflag\tset\t0\t0\t0\t0\t0\t0\t\t'hot','index','recommend'\t\t标志(多选):hot=热门,index=首页,recommend=推荐\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nstock\tenum\t0\t0\t0\t0\t0\t0\t\t'porder','payment'\t'porder'\t库存计算方式:porder=下单减库存,payment=付款减库存\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ncontent\tlongtext\t0\t0\t0\t0\t0\t0\t\t\t\t商品详情\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nfreight_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t运费模板\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\ngrounding\ttinyint\t1\t0\t0\t0\t0\t0\t\t\t0\t上架状态\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nspecs\tenum\t0\t0\t0\t0\t0\t0\t\t'single','multi'\t'single'\t商品规格:single=单规格,multi=多规格\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ndistribution\tenum\t0\t0\t0\t0\t0\t0\t\t'true','false'\t'false'\t是否独立分销:true=开启,false=关闭\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nactivity\tenum\t0\t0\t0\t0\t0\t0\t\t'true','false'\t'false'\t是否活动中:true=是,false=否\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nviews\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t点击\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nprice\tdecimal\t10\t2\t-1\t0\t0\t0\t\t\t0.00\t产品价格\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nsales\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t销量\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\npayment\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t付款人数\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\ncomment\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t评论\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\npraise\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t好评\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nmoderate\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t中评\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nnegative\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t差评\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nlike\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t收藏\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nweigh\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t权重\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ncreatetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t创建时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nupdatetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t更新时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ndeletetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t删除时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nstatus\tenum\t0\t0\t-1\t0\t0\t0\t\t'normal','hidden'\t'normal'\t状态\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\n\n\nfa_wanlshop_groups_team  拼团记录表\n\nid\tint\t10\t0\t0\t0\t-1\t0\t\t\t\tID\t\t\t\t\t0\t0\t0\t0\t-1\t-1\t0\ngroup_no\tvarchar\t32\t0\t0\t0\t0\t0\t\t\t\t拼团号\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nuser_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t用户ID\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nshop_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t所属商家ID\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\norder_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t订单ID\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\norder_goods_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t订单商品ID\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nusername\tvarchar\t32\t0\t-1\t0\t0\t0\t\t\t\t快递号\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nnickname\tvarchar\t50\t0\t-1\t0\t0\t0\t\t\t\t快递号\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\navatar\tvarchar\t255\t0\t-1\t0\t0\t0\t\t\t\t快递号\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ncreatetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t参团时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nupdatetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t更新时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ndeletetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t删除时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\n","source":"_posts/商城开发-拼团功能开发设计.md","raw":"---\ntitle: 商城开发-拼团功能开发设计\nabbrlink: 701fec33\ndate: 2024-08-12 15:24:12\ntags:\n---\n# 功能需求描述\n\n    \n# 数据库表设计\n\n\nfa_wanlshop_groups  拼团表\n\nid\tint\t10\t0\t0\t0\t-1\t0\t\t\t\tID\t\t\t\t\t0\t0\t0\t0\t-1\t-1\t0\ngroup_no\tvarchar\t32\t0\t0\t0\t0\t0\t\t\t\t拼团号\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nuser_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t团长ID\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nshop_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t所属商家\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ngoods_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t所属商品\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ngroup_type\tenum\t0\t0\t0\t0\t0\t0\t\t'alone','group','ladder'\t\t拼团类型:alone=直购,group=拼团,ladder=阶梯拼团\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nis_ladder\ttinyint\t1\t0\t0\t0\t0\t0\t\t\t0\t是否阶梯拼团\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nladder_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t阶梯ID\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\npeople_num\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t成团人数\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\njoin_num\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t参团人数\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nstate\tenum\t0\t0\t0\t0\t0\t0\t\t'ready','start','success','fail','auto'\t'ready'\t拼团状态:ready=准备中,start=拼团中,success=已成团,fail=拼团失败,auto=自动成团\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ncreatetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t开团时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ngrouptime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t成团时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nvaliditytime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t有效时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nupdatetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t更新时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ndeletetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t删除时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nstatus\tenum\t0\t0\t-1\t0\t0\t0\t\t'normal','hidden'\t'normal'\t状态\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\n\n\nfa_wanlshop_groups_goods 拼团商品表\n\nid\tint\t10\t0\t0\t0\t-1\t0\t\t\t\tID\t\t\t\t\t0\t0\t0\t0\t-1\t-1\t0\nshop_id\tint\t10\t0\t-1\t0\t0\t0\t\t\t0\t店铺ID\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nshop_category_id\tvarchar\t100\t0\t-1\t0\t0\t0\t\t\t\t店铺内类目\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ncategory_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t商品类目\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nbrand_id\tint\t10\t0\t-1\t0\t0\t0\t\t\t0\t品牌ID\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\ncategory_attribute\tlongtext\t0\t0\t-1\t0\t0\t0\t\t\t\t类目属性\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ntitle\tvarchar\t100\t0\t0\t0\t0\t0\t\t\t\t商品标题\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nimage\tvarchar\t100\t0\t0\t0\t0\t0\t\t\t\t商品主图\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nimages\tvarchar\t1500\t0\t0\t0\t0\t0\t\t\t\t产品相册\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ndescription\tvarchar\t255\t0\t0\t0\t0\t0\t\t\t\t商品描述\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nis_alone\ttinyint\t1\t0\t0\t0\t0\t0\t\t\t1\t是否显示单购是:0=否,1=是\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\npeople_num\tint\t3\t0\t-1\t0\t0\t0\t\t\t0\t组团人数\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ngroups_num\tint\t3\t0\t-1\t0\t0\t0\t\t\t0\t成团人数\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nis_ladder\ttinyint\t1\t0\t0\t0\t0\t0\t\t\t0\t开启阶梯团:0=否,1=是\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ngroup_hour\tint\t10\t0\t0\t0\t0\t0\t\t\t24\t组团限时(小时)\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\npurchase_limit\tint\t6\t0\t0\t0\t0\t0\t\t\t0\t个人购买次数限制，默认是0，没有次数限制\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nis_discount\ttinyint\t1\t0\t0\t0\t0\t0\t\t\t0\t是否显示团长优惠是:0=否,1=是\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ndiscount_type\ttinyint\t1\t0\t0\t0\t0\t0\t\t\t0\t团长优惠类型:0=金额,1=百分百\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ndiscount\tfloat\t10\t2\t-1\t0\t0\t0\t\t\t0.00\t优惠金额/折扣\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nflag\tset\t0\t0\t0\t0\t0\t0\t\t'hot','index','recommend'\t\t标志(多选):hot=热门,index=首页,recommend=推荐\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nstock\tenum\t0\t0\t0\t0\t0\t0\t\t'porder','payment'\t'porder'\t库存计算方式:porder=下单减库存,payment=付款减库存\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ncontent\tlongtext\t0\t0\t0\t0\t0\t0\t\t\t\t商品详情\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nfreight_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t运费模板\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\ngrounding\ttinyint\t1\t0\t0\t0\t0\t0\t\t\t0\t上架状态\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nspecs\tenum\t0\t0\t0\t0\t0\t0\t\t'single','multi'\t'single'\t商品规格:single=单规格,multi=多规格\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ndistribution\tenum\t0\t0\t0\t0\t0\t0\t\t'true','false'\t'false'\t是否独立分销:true=开启,false=关闭\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nactivity\tenum\t0\t0\t0\t0\t0\t0\t\t'true','false'\t'false'\t是否活动中:true=是,false=否\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nviews\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t点击\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nprice\tdecimal\t10\t2\t-1\t0\t0\t0\t\t\t0.00\t产品价格\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nsales\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t销量\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\npayment\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t付款人数\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\ncomment\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t评论\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\npraise\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t好评\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nmoderate\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t中评\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nnegative\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t差评\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nlike\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t收藏\t\t\t\t\t0\t0\t0\t0\t0\t-1\t0\nweigh\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t权重\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ncreatetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t创建时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nupdatetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t更新时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ndeletetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t删除时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nstatus\tenum\t0\t0\t-1\t0\t0\t0\t\t'normal','hidden'\t'normal'\t状态\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\n\n\nfa_wanlshop_groups_team  拼团记录表\n\nid\tint\t10\t0\t0\t0\t-1\t0\t\t\t\tID\t\t\t\t\t0\t0\t0\t0\t-1\t-1\t0\ngroup_no\tvarchar\t32\t0\t0\t0\t0\t0\t\t\t\t拼团号\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nuser_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t用户ID\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nshop_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t所属商家ID\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\norder_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t订单ID\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\norder_goods_id\tint\t10\t0\t0\t0\t0\t0\t\t\t0\t订单商品ID\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nusername\tvarchar\t32\t0\t-1\t0\t0\t0\t\t\t\t快递号\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\nnickname\tvarchar\t50\t0\t-1\t0\t0\t0\t\t\t\t快递号\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\navatar\tvarchar\t255\t0\t-1\t0\t0\t0\t\t\t\t快递号\t\t\tutf8mb4\tutf8mb4_unicode_ci\t0\t0\t0\t0\t0\t0\t0\ncreatetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t参团时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\nupdatetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t更新时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\ndeletetime\tint\t10\t0\t-1\t0\t0\t0\t\t\t\t删除时间\t\t\t\t\t0\t0\t0\t0\t0\t0\t0\n","slug":"商城开发-拼团功能开发设计","published":1,"updated":"2024-08-12T07:42:56.263Z","_id":"clzqos7zz0000f4oc0lfdhxbw","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"功能需求描述\"><a href=\"#功能需求描述\" class=\"headerlink\" title=\"功能需求描述\"></a>功能需求描述</h1><h1 id=\"数据库表设计\"><a href=\"#数据库表设计\" class=\"headerlink\" title=\"数据库表设计\"></a>数据库表设计</h1><p>fa_wanlshop_groups  拼团表</p>\n<p>id    int    10    0    0    0    -1    0                ID                    0    0    0    0    -1    -1    0<br>group_no    varchar    32    0    0    0    0    0                拼团号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>user_id    int    10    0    0    0    0    0            0    团长ID                    0    0    0    0    0    0    0<br>shop_id    int    10    0    0    0    0    0            0    所属商家                    0    0    0    0    0    0    0<br>goods_id    int    10    0    0    0    0    0            0    所属商品                    0    0    0    0    0    0    0<br>group_type    enum    0    0    0    0    0    0        ‘alone’,’group’,’ladder’        拼团类型:alone=直购,group=拼团,ladder=阶梯拼团            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>is_ladder    tinyint    1    0    0    0    0    0            0    是否阶梯拼团                    0    0    0    0    0    0    0<br>ladder_id    int    10    0    0    0    0    0            0    阶梯ID                    0    0    0    0    0    0    0<br>people_num    int    10    0    0    0    0    0            0    成团人数                    0    0    0    0    0    0    0<br>join_num    int    10    0    0    0    0    0            0    参团人数                    0    0    0    0    0    0    0<br>state    enum    0    0    0    0    0    0        ‘ready’,’start’,’success’,’fail’,’auto’    ‘ready’    拼团状态:ready=准备中,start=拼团中,success=已成团,fail=拼团失败,auto=自动成团            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>createtime    int    10    0    -1    0    0    0                开团时间                    0    0    0    0    0    0    0<br>grouptime    int    10    0    -1    0    0    0                成团时间                    0    0    0    0    0    0    0<br>validitytime    int    10    0    -1    0    0    0                有效时间                    0    0    0    0    0    0    0<br>updatetime    int    10    0    -1    0    0    0                更新时间                    0    0    0    0    0    0    0<br>deletetime    int    10    0    -1    0    0    0                删除时间                    0    0    0    0    0    0    0<br>status    enum    0    0    -1    0    0    0        ‘normal’,’hidden’    ‘normal’    状态            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0</p>\n<p>fa_wanlshop_groups_goods 拼团商品表</p>\n<p>id    int    10    0    0    0    -1    0                ID                    0    0    0    0    -1    -1    0<br>shop_id    int    10    0    -1    0    0    0            0    店铺ID                    0    0    0    0    0    -1    0<br>shop_category_id    varchar    100    0    -1    0    0    0                店铺内类目            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>category_id    int    10    0    0    0    0    0            0    商品类目                    0    0    0    0    0    -1    0<br>brand_id    int    10    0    -1    0    0    0            0    品牌ID                    0    0    0    0    0    -1    0<br>category_attribute    longtext    0    0    -1    0    0    0                类目属性            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>title    varchar    100    0    0    0    0    0                商品标题            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>image    varchar    100    0    0    0    0    0                商品主图            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>images    varchar    1500    0    0    0    0    0                产品相册            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>description    varchar    255    0    0    0    0    0                商品描述            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>is_alone    tinyint    1    0    0    0    0    0            1    是否显示单购是:0=否,1=是                    0    0    0    0    0    0    0<br>people_num    int    3    0    -1    0    0    0            0    组团人数                    0    0    0    0    0    0    0<br>groups_num    int    3    0    -1    0    0    0            0    成团人数                    0    0    0    0    0    0    0<br>is_ladder    tinyint    1    0    0    0    0    0            0    开启阶梯团:0=否,1=是                    0    0    0    0    0    0    0<br>group_hour    int    10    0    0    0    0    0            24    组团限时(小时)                    0    0    0    0    0    0    0<br>purchase_limit    int    6    0    0    0    0    0            0    个人购买次数限制，默认是0，没有次数限制                    0    0    0    0    0    0    0<br>is_discount    tinyint    1    0    0    0    0    0            0    是否显示团长优惠是:0=否,1=是                    0    0    0    0    0    0    0<br>discount_type    tinyint    1    0    0    0    0    0            0    团长优惠类型:0=金额,1=百分百                    0    0    0    0    0    0    0<br>discount    float    10    2    -1    0    0    0            0.00    优惠金额/折扣                    0    0    0    0    0    0    0<br>flag    set    0    0    0    0    0    0        ‘hot’,’index’,’recommend’        标志(多选):hot=热门,index=首页,recommend=推荐            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>stock    enum    0    0    0    0    0    0        ‘porder’,’payment’    ‘porder’    库存计算方式:porder=下单减库存,payment=付款减库存            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>content    longtext    0    0    0    0    0    0                商品详情            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>freight_id    int    10    0    0    0    0    0            0    运费模板                    0    0    0    0    0    -1    0<br>grounding    tinyint    1    0    0    0    0    0            0    上架状态                    0    0    0    0    0    0    0<br>specs    enum    0    0    0    0    0    0        ‘single’,’multi’    ‘single’    商品规格:single=单规格,multi=多规格            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>distribution    enum    0    0    0    0    0    0        ‘true’,’false’    ‘false’    是否独立分销:true=开启,false=关闭            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>activity    enum    0    0    0    0    0    0        ‘true’,’false’    ‘false’    是否活动中:true=是,false=否            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>views    int    10    0    0    0    0    0            0    点击                    0    0    0    0    0    -1    0<br>price    decimal    10    2    -1    0    0    0            0.00    产品价格                    0    0    0    0    0    0    0<br>sales    int    10    0    0    0    0    0            0    销量                    0    0    0    0    0    -1    0<br>payment    int    10    0    0    0    0    0            0    付款人数                    0    0    0    0    0    -1    0<br>comment    int    10    0    0    0    0    0            0    评论                    0    0    0    0    0    -1    0<br>praise    int    10    0    0    0    0    0            0    好评                    0    0    0    0    0    -1    0<br>moderate    int    10    0    0    0    0    0            0    中评                    0    0    0    0    0    -1    0<br>negative    int    10    0    0    0    0    0            0    差评                    0    0    0    0    0    -1    0<br>like    int    10    0    0    0    0    0            0    收藏                    0    0    0    0    0    -1    0<br>weigh    int    10    0    0    0    0    0            0    权重                    0    0    0    0    0    0    0<br>createtime    int    10    0    -1    0    0    0                创建时间                    0    0    0    0    0    0    0<br>updatetime    int    10    0    -1    0    0    0                更新时间                    0    0    0    0    0    0    0<br>deletetime    int    10    0    -1    0    0    0                删除时间                    0    0    0    0    0    0    0<br>status    enum    0    0    -1    0    0    0        ‘normal’,’hidden’    ‘normal’    状态            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0</p>\n<p>fa_wanlshop_groups_team  拼团记录表</p>\n<p>id    int    10    0    0    0    -1    0                ID                    0    0    0    0    -1    -1    0<br>group_no    varchar    32    0    0    0    0    0                拼团号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>user_id    int    10    0    0    0    0    0            0    用户ID                    0    0    0    0    0    0    0<br>shop_id    int    10    0    0    0    0    0            0    所属商家ID                    0    0    0    0    0    0    0<br>order_id    int    10    0    0    0    0    0            0    订单ID                    0    0    0    0    0    0    0<br>order_goods_id    int    10    0    0    0    0    0            0    订单商品ID                    0    0    0    0    0    0    0<br>username    varchar    32    0    -1    0    0    0                快递号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>nickname    varchar    50    0    -1    0    0    0                快递号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>avatar    varchar    255    0    -1    0    0    0                快递号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>createtime    int    10    0    -1    0    0    0                参团时间                    0    0    0    0    0    0    0<br>updatetime    int    10    0    -1    0    0    0                更新时间                    0    0    0    0    0    0    0<br>deletetime    int    10    0    -1    0    0    0                删除时间                    0    0    0    0    0    0    0</p>\n","site":{"data":{}},"length":3303,"excerpt":"","more":"<h1 id=\"功能需求描述\"><a href=\"#功能需求描述\" class=\"headerlink\" title=\"功能需求描述\"></a>功能需求描述</h1><h1 id=\"数据库表设计\"><a href=\"#数据库表设计\" class=\"headerlink\" title=\"数据库表设计\"></a>数据库表设计</h1><p>fa_wanlshop_groups  拼团表</p>\n<p>id    int    10    0    0    0    -1    0                ID                    0    0    0    0    -1    -1    0<br>group_no    varchar    32    0    0    0    0    0                拼团号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>user_id    int    10    0    0    0    0    0            0    团长ID                    0    0    0    0    0    0    0<br>shop_id    int    10    0    0    0    0    0            0    所属商家                    0    0    0    0    0    0    0<br>goods_id    int    10    0    0    0    0    0            0    所属商品                    0    0    0    0    0    0    0<br>group_type    enum    0    0    0    0    0    0        ‘alone’,’group’,’ladder’        拼团类型:alone=直购,group=拼团,ladder=阶梯拼团            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>is_ladder    tinyint    1    0    0    0    0    0            0    是否阶梯拼团                    0    0    0    0    0    0    0<br>ladder_id    int    10    0    0    0    0    0            0    阶梯ID                    0    0    0    0    0    0    0<br>people_num    int    10    0    0    0    0    0            0    成团人数                    0    0    0    0    0    0    0<br>join_num    int    10    0    0    0    0    0            0    参团人数                    0    0    0    0    0    0    0<br>state    enum    0    0    0    0    0    0        ‘ready’,’start’,’success’,’fail’,’auto’    ‘ready’    拼团状态:ready=准备中,start=拼团中,success=已成团,fail=拼团失败,auto=自动成团            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>createtime    int    10    0    -1    0    0    0                开团时间                    0    0    0    0    0    0    0<br>grouptime    int    10    0    -1    0    0    0                成团时间                    0    0    0    0    0    0    0<br>validitytime    int    10    0    -1    0    0    0                有效时间                    0    0    0    0    0    0    0<br>updatetime    int    10    0    -1    0    0    0                更新时间                    0    0    0    0    0    0    0<br>deletetime    int    10    0    -1    0    0    0                删除时间                    0    0    0    0    0    0    0<br>status    enum    0    0    -1    0    0    0        ‘normal’,’hidden’    ‘normal’    状态            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0</p>\n<p>fa_wanlshop_groups_goods 拼团商品表</p>\n<p>id    int    10    0    0    0    -1    0                ID                    0    0    0    0    -1    -1    0<br>shop_id    int    10    0    -1    0    0    0            0    店铺ID                    0    0    0    0    0    -1    0<br>shop_category_id    varchar    100    0    -1    0    0    0                店铺内类目            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>category_id    int    10    0    0    0    0    0            0    商品类目                    0    0    0    0    0    -1    0<br>brand_id    int    10    0    -1    0    0    0            0    品牌ID                    0    0    0    0    0    -1    0<br>category_attribute    longtext    0    0    -1    0    0    0                类目属性            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>title    varchar    100    0    0    0    0    0                商品标题            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>image    varchar    100    0    0    0    0    0                商品主图            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>images    varchar    1500    0    0    0    0    0                产品相册            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>description    varchar    255    0    0    0    0    0                商品描述            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>is_alone    tinyint    1    0    0    0    0    0            1    是否显示单购是:0=否,1=是                    0    0    0    0    0    0    0<br>people_num    int    3    0    -1    0    0    0            0    组团人数                    0    0    0    0    0    0    0<br>groups_num    int    3    0    -1    0    0    0            0    成团人数                    0    0    0    0    0    0    0<br>is_ladder    tinyint    1    0    0    0    0    0            0    开启阶梯团:0=否,1=是                    0    0    0    0    0    0    0<br>group_hour    int    10    0    0    0    0    0            24    组团限时(小时)                    0    0    0    0    0    0    0<br>purchase_limit    int    6    0    0    0    0    0            0    个人购买次数限制，默认是0，没有次数限制                    0    0    0    0    0    0    0<br>is_discount    tinyint    1    0    0    0    0    0            0    是否显示团长优惠是:0=否,1=是                    0    0    0    0    0    0    0<br>discount_type    tinyint    1    0    0    0    0    0            0    团长优惠类型:0=金额,1=百分百                    0    0    0    0    0    0    0<br>discount    float    10    2    -1    0    0    0            0.00    优惠金额/折扣                    0    0    0    0    0    0    0<br>flag    set    0    0    0    0    0    0        ‘hot’,’index’,’recommend’        标志(多选):hot=热门,index=首页,recommend=推荐            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>stock    enum    0    0    0    0    0    0        ‘porder’,’payment’    ‘porder’    库存计算方式:porder=下单减库存,payment=付款减库存            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>content    longtext    0    0    0    0    0    0                商品详情            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>freight_id    int    10    0    0    0    0    0            0    运费模板                    0    0    0    0    0    -1    0<br>grounding    tinyint    1    0    0    0    0    0            0    上架状态                    0    0    0    0    0    0    0<br>specs    enum    0    0    0    0    0    0        ‘single’,’multi’    ‘single’    商品规格:single=单规格,multi=多规格            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>distribution    enum    0    0    0    0    0    0        ‘true’,’false’    ‘false’    是否独立分销:true=开启,false=关闭            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>activity    enum    0    0    0    0    0    0        ‘true’,’false’    ‘false’    是否活动中:true=是,false=否            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>views    int    10    0    0    0    0    0            0    点击                    0    0    0    0    0    -1    0<br>price    decimal    10    2    -1    0    0    0            0.00    产品价格                    0    0    0    0    0    0    0<br>sales    int    10    0    0    0    0    0            0    销量                    0    0    0    0    0    -1    0<br>payment    int    10    0    0    0    0    0            0    付款人数                    0    0    0    0    0    -1    0<br>comment    int    10    0    0    0    0    0            0    评论                    0    0    0    0    0    -1    0<br>praise    int    10    0    0    0    0    0            0    好评                    0    0    0    0    0    -1    0<br>moderate    int    10    0    0    0    0    0            0    中评                    0    0    0    0    0    -1    0<br>negative    int    10    0    0    0    0    0            0    差评                    0    0    0    0    0    -1    0<br>like    int    10    0    0    0    0    0            0    收藏                    0    0    0    0    0    -1    0<br>weigh    int    10    0    0    0    0    0            0    权重                    0    0    0    0    0    0    0<br>createtime    int    10    0    -1    0    0    0                创建时间                    0    0    0    0    0    0    0<br>updatetime    int    10    0    -1    0    0    0                更新时间                    0    0    0    0    0    0    0<br>deletetime    int    10    0    -1    0    0    0                删除时间                    0    0    0    0    0    0    0<br>status    enum    0    0    -1    0    0    0        ‘normal’,’hidden’    ‘normal’    状态            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0</p>\n<p>fa_wanlshop_groups_team  拼团记录表</p>\n<p>id    int    10    0    0    0    -1    0                ID                    0    0    0    0    -1    -1    0<br>group_no    varchar    32    0    0    0    0    0                拼团号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>user_id    int    10    0    0    0    0    0            0    用户ID                    0    0    0    0    0    0    0<br>shop_id    int    10    0    0    0    0    0            0    所属商家ID                    0    0    0    0    0    0    0<br>order_id    int    10    0    0    0    0    0            0    订单ID                    0    0    0    0    0    0    0<br>order_goods_id    int    10    0    0    0    0    0            0    订单商品ID                    0    0    0    0    0    0    0<br>username    varchar    32    0    -1    0    0    0                快递号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>nickname    varchar    50    0    -1    0    0    0                快递号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>avatar    varchar    255    0    -1    0    0    0                快递号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>createtime    int    10    0    -1    0    0    0                参团时间                    0    0    0    0    0    0    0<br>updatetime    int    10    0    -1    0    0    0                更新时间                    0    0    0    0    0    0    0<br>deletetime    int    10    0    -1    0    0    0                删除时间                    0    0    0    0    0    0    0</p>\n"},{"title":"商城开发-SPU和SKU数据结构设计","abbrlink":"ce3caa74","date":"2024-08-12T06:24:31.000Z","_content":"\n# 一、SPU和SKU\n\nSPU：Standard Product Unit （标准产品单位） ，一组具有共同属性的商品集\n\n示例 如奶茶商品中的 容量  大 、中 、小 杯\n     如奶茶商品中   甜度  少糖 标准  加糖\n\n\nSKU：Stock Keeping Unit（库存量单位），SPU商品集因具体特性不同而细分的每个商品\n\n示例 如奶茶商品中 【就是 容量 与 甜度 的排列组合】\n        \n        大杯  少糖\n        中杯  少糖\n        小杯  少糖\n        大杯  标准\n        中杯  标准\n        小杯  标准\n        。。。\n\n# 二、数据库设计\n    \n## 2.1 spu表\n\n| 字段 | 类型 |\t描述 |\n|:--------| :---------:|--------:|\n| id | int | ID |\n| goods_id | int| 商品ID |\n| name | varchar | 规格名称 |\n| item | text | 规格 |\n| status | tinty | 状态 |\n| createtime | int | 创建时间 |\n| updatetime | int | 更新时间 |\n\n6\t2\t口味\t微辣,中辣,特辣\t1723441719\t1723441719\t\t0\n\n\n## 2.2sku 表\n\n| 字段 | 类型 |\t描述 |\n|:--------| :---------:|--------:|\n| id | int | ID |\n| goods_id | int| 商品ID |\n| thumbnail | text | 缩略图 |\n| difference | text | 规格 |\n| price | decimal(10,2) | 价格 |\n| stock | int | 库存 |\n| sn | varchar(200) | 商品标号 |   \n| createtime | int | 创建时间 |\n| updatetime | int | 更新时间 |\n\n\n2\t2\t\t微辣,小份\t1\t11\t11\t1\t11\t0\t1\t1723441530\t1723441600\t\tnormal","source":"_posts/商城开发-SPU和SKU数据结构设计.md","raw":"---\ntitle: 商城开发-SPU和SKU数据结构设计\nabbrlink: ce3caa74\ndate: 2024-08-12 14:24:31\ntags:\n---\n\n# 一、SPU和SKU\n\nSPU：Standard Product Unit （标准产品单位） ，一组具有共同属性的商品集\n\n示例 如奶茶商品中的 容量  大 、中 、小 杯\n     如奶茶商品中   甜度  少糖 标准  加糖\n\n\nSKU：Stock Keeping Unit（库存量单位），SPU商品集因具体特性不同而细分的每个商品\n\n示例 如奶茶商品中 【就是 容量 与 甜度 的排列组合】\n        \n        大杯  少糖\n        中杯  少糖\n        小杯  少糖\n        大杯  标准\n        中杯  标准\n        小杯  标准\n        。。。\n\n# 二、数据库设计\n    \n## 2.1 spu表\n\n| 字段 | 类型 |\t描述 |\n|:--------| :---------:|--------:|\n| id | int | ID |\n| goods_id | int| 商品ID |\n| name | varchar | 规格名称 |\n| item | text | 规格 |\n| status | tinty | 状态 |\n| createtime | int | 创建时间 |\n| updatetime | int | 更新时间 |\n\n6\t2\t口味\t微辣,中辣,特辣\t1723441719\t1723441719\t\t0\n\n\n## 2.2sku 表\n\n| 字段 | 类型 |\t描述 |\n|:--------| :---------:|--------:|\n| id | int | ID |\n| goods_id | int| 商品ID |\n| thumbnail | text | 缩略图 |\n| difference | text | 规格 |\n| price | decimal(10,2) | 价格 |\n| stock | int | 库存 |\n| sn | varchar(200) | 商品标号 |   \n| createtime | int | 创建时间 |\n| updatetime | int | 更新时间 |\n\n\n2\t2\t\t微辣,小份\t1\t11\t11\t1\t11\t0\t1\t1723441530\t1723441600\t\tnormal","slug":"商城开发-SPU和SKU数据结构设计","published":1,"updated":"2024-08-12T07:25:41.240Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clzqos8030001f4ocel3n2sfx","content":"<h1 id=\"一、SPU和SKU\"><a href=\"#一、SPU和SKU\" class=\"headerlink\" title=\"一、SPU和SKU\"></a>一、SPU和SKU</h1><p>SPU：Standard Product Unit （标准产品单位） ，一组具有共同属性的商品集</p>\n<p>示例 如奶茶商品中的 容量  大 、中 、小 杯<br>     如奶茶商品中   甜度  少糖 标准  加糖</p>\n<p>SKU：Stock Keeping Unit（库存量单位），SPU商品集因具体特性不同而细分的每个商品</p>\n<p>示例 如奶茶商品中 【就是 容量 与 甜度 的排列组合】</p>\n<pre><code>    大杯  少糖\n    中杯  少糖\n    小杯  少糖\n    大杯  标准\n    中杯  标准\n    小杯  标准\n    。。。\n</code></pre>\n<h1 id=\"二、数据库设计\"><a href=\"#二、数据库设计\" class=\"headerlink\" title=\"二、数据库设计\"></a>二、数据库设计</h1><h2 id=\"2-1-spu表\"><a href=\"#2-1-spu表\" class=\"headerlink\" title=\"2.1 spu表\"></a>2.1 spu表</h2><table>\n<thead>\n<tr>\n<th align=\"left\">字段</th>\n<th align=\"center\">类型</th>\n<th align=\"right\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">id</td>\n<td align=\"center\">int</td>\n<td align=\"right\">ID</td>\n</tr>\n<tr>\n<td align=\"left\">goods_id</td>\n<td align=\"center\">int</td>\n<td align=\"right\">商品ID</td>\n</tr>\n<tr>\n<td align=\"left\">name</td>\n<td align=\"center\">varchar</td>\n<td align=\"right\">规格名称</td>\n</tr>\n<tr>\n<td align=\"left\">item</td>\n<td align=\"center\">text</td>\n<td align=\"right\">规格</td>\n</tr>\n<tr>\n<td align=\"left\">status</td>\n<td align=\"center\">tinty</td>\n<td align=\"right\">状态</td>\n</tr>\n<tr>\n<td align=\"left\">createtime</td>\n<td align=\"center\">int</td>\n<td align=\"right\">创建时间</td>\n</tr>\n<tr>\n<td align=\"left\">updatetime</td>\n<td align=\"center\">int</td>\n<td align=\"right\">更新时间</td>\n</tr>\n</tbody></table>\n<p>6    2    口味    微辣,中辣,特辣    1723441719    1723441719        0</p>\n<h2 id=\"2-2sku-表\"><a href=\"#2-2sku-表\" class=\"headerlink\" title=\"2.2sku 表\"></a>2.2sku 表</h2><table>\n<thead>\n<tr>\n<th align=\"left\">字段</th>\n<th align=\"center\">类型</th>\n<th align=\"right\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">id</td>\n<td align=\"center\">int</td>\n<td align=\"right\">ID</td>\n</tr>\n<tr>\n<td align=\"left\">goods_id</td>\n<td align=\"center\">int</td>\n<td align=\"right\">商品ID</td>\n</tr>\n<tr>\n<td align=\"left\">thumbnail</td>\n<td align=\"center\">text</td>\n<td align=\"right\">缩略图</td>\n</tr>\n<tr>\n<td align=\"left\">difference</td>\n<td align=\"center\">text</td>\n<td align=\"right\">规格</td>\n</tr>\n<tr>\n<td align=\"left\">price</td>\n<td align=\"center\">decimal(10,2)</td>\n<td align=\"right\">价格</td>\n</tr>\n<tr>\n<td align=\"left\">stock</td>\n<td align=\"center\">int</td>\n<td align=\"right\">库存</td>\n</tr>\n<tr>\n<td align=\"left\">sn</td>\n<td align=\"center\">varchar(200)</td>\n<td align=\"right\">商品标号</td>\n</tr>\n<tr>\n<td align=\"left\">createtime</td>\n<td align=\"center\">int</td>\n<td align=\"right\">创建时间</td>\n</tr>\n<tr>\n<td align=\"left\">updatetime</td>\n<td align=\"center\">int</td>\n<td align=\"right\">更新时间</td>\n</tr>\n</tbody></table>\n<p>2    2        微辣,小份    1    11    11    1    11    0    1    1723441530    1723441600        normal</p>\n","site":{"data":{}},"length":521,"excerpt":"","more":"<h1 id=\"一、SPU和SKU\"><a href=\"#一、SPU和SKU\" class=\"headerlink\" title=\"一、SPU和SKU\"></a>一、SPU和SKU</h1><p>SPU：Standard Product Unit （标准产品单位） ，一组具有共同属性的商品集</p>\n<p>示例 如奶茶商品中的 容量  大 、中 、小 杯<br>     如奶茶商品中   甜度  少糖 标准  加糖</p>\n<p>SKU：Stock Keeping Unit（库存量单位），SPU商品集因具体特性不同而细分的每个商品</p>\n<p>示例 如奶茶商品中 【就是 容量 与 甜度 的排列组合】</p>\n<pre><code>    大杯  少糖\n    中杯  少糖\n    小杯  少糖\n    大杯  标准\n    中杯  标准\n    小杯  标准\n    。。。\n</code></pre>\n<h1 id=\"二、数据库设计\"><a href=\"#二、数据库设计\" class=\"headerlink\" title=\"二、数据库设计\"></a>二、数据库设计</h1><h2 id=\"2-1-spu表\"><a href=\"#2-1-spu表\" class=\"headerlink\" title=\"2.1 spu表\"></a>2.1 spu表</h2><table>\n<thead>\n<tr>\n<th align=\"left\">字段</th>\n<th align=\"center\">类型</th>\n<th align=\"right\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">id</td>\n<td align=\"center\">int</td>\n<td align=\"right\">ID</td>\n</tr>\n<tr>\n<td align=\"left\">goods_id</td>\n<td align=\"center\">int</td>\n<td align=\"right\">商品ID</td>\n</tr>\n<tr>\n<td align=\"left\">name</td>\n<td align=\"center\">varchar</td>\n<td align=\"right\">规格名称</td>\n</tr>\n<tr>\n<td align=\"left\">item</td>\n<td align=\"center\">text</td>\n<td align=\"right\">规格</td>\n</tr>\n<tr>\n<td align=\"left\">status</td>\n<td align=\"center\">tinty</td>\n<td align=\"right\">状态</td>\n</tr>\n<tr>\n<td align=\"left\">createtime</td>\n<td align=\"center\">int</td>\n<td align=\"right\">创建时间</td>\n</tr>\n<tr>\n<td align=\"left\">updatetime</td>\n<td align=\"center\">int</td>\n<td align=\"right\">更新时间</td>\n</tr>\n</tbody></table>\n<p>6    2    口味    微辣,中辣,特辣    1723441719    1723441719        0</p>\n<h2 id=\"2-2sku-表\"><a href=\"#2-2sku-表\" class=\"headerlink\" title=\"2.2sku 表\"></a>2.2sku 表</h2><table>\n<thead>\n<tr>\n<th align=\"left\">字段</th>\n<th align=\"center\">类型</th>\n<th align=\"right\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">id</td>\n<td align=\"center\">int</td>\n<td align=\"right\">ID</td>\n</tr>\n<tr>\n<td align=\"left\">goods_id</td>\n<td align=\"center\">int</td>\n<td align=\"right\">商品ID</td>\n</tr>\n<tr>\n<td align=\"left\">thumbnail</td>\n<td align=\"center\">text</td>\n<td align=\"right\">缩略图</td>\n</tr>\n<tr>\n<td align=\"left\">difference</td>\n<td align=\"center\">text</td>\n<td align=\"right\">规格</td>\n</tr>\n<tr>\n<td align=\"left\">price</td>\n<td align=\"center\">decimal(10,2)</td>\n<td align=\"right\">价格</td>\n</tr>\n<tr>\n<td align=\"left\">stock</td>\n<td align=\"center\">int</td>\n<td align=\"right\">库存</td>\n</tr>\n<tr>\n<td align=\"left\">sn</td>\n<td align=\"center\">varchar(200)</td>\n<td align=\"right\">商品标号</td>\n</tr>\n<tr>\n<td align=\"left\">createtime</td>\n<td align=\"center\">int</td>\n<td align=\"right\">创建时间</td>\n</tr>\n<tr>\n<td align=\"left\">updatetime</td>\n<td align=\"center\">int</td>\n<td align=\"right\">更新时间</td>\n</tr>\n</tbody></table>\n<p>2    2        微辣,小份    1    11    11    1    11    0    1    1723441530    1723441600        normal</p>\n"},{"title":"php开发-工行支付接口对接","abbrlink":"11955b14","date":"2024-08-15T11:10:02.000Z","_content":"","source":"_posts/php开发-工行支付接口对接.md","raw":"---\ntitle: php开发-工行支付接口对接\nabbrlink: 11955b14\ndate: 2024-08-15 19:10:02\ntags:\ncategories:\n  - PHP开发\n---\n","slug":"php开发-工行支付接口对接","published":1,"updated":"2024-11-25T11:34:48.619Z","_id":"clzwc5go60000nkocc2k52xpv","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"php开发-根据设置的概率抽奖","abbrlink":"84d7639f","date":"2024-08-15T10:48:19.000Z","_content":"","source":"_posts/php开发-根据设置的概率抽奖.md","raw":"---\ntitle: php开发-根据设置的概率抽奖\nabbrlink: 84d7639f\ndate: 2024-08-15 18:48:19\ntags:\ncategories:\n  - PHP开发\n---\n","slug":"php开发-根据设置的概率抽奖","published":1,"updated":"2024-11-25T11:34:35.911Z","_id":"clzwc5go90001nkoc4n00c7l5","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"php开发-海康视频接口对接","abbrlink":"cc90e6c9","date":"2024-08-15T11:09:37.000Z","_content":"","source":"_posts/php开发-海康视频接口对接.md","raw":"---\ntitle: php开发-海康视频接口对接\nabbrlink: cc90e6c9\ndate: 2024-08-15 19:09:37\ntags:\ncategories:\n  - PHP开发\n---\n","slug":"php开发-海康视频接口对接","published":1,"updated":"2024-11-25T11:34:23.084Z","_id":"clzwc5gob0003nkocez9xcsop","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"php开发-多进程应用","abbrlink":"fef50030","date":"2024-08-16T06:46:15.000Z","_content":"","source":"_posts/php开发-多进程应用.md","raw":"---\ntitle: php开发-多进程应用\nabbrlink: fef50030\ndate: 2024-08-16 14:46:15\ntags:\ncategories:\n  - PHP开发\n---\n","slug":"php开发-多进程应用","published":1,"updated":"2024-11-25T11:34:42.175Z","_id":"clzwdjjq900003cocbmc053hx","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"java开发-springboot学习","abbrlink":"8a82885c","date":"2023-08-01T12:20:47.000Z","_content":"\n## 创建基于springboot 项目\n\n## 1.maven方式\n    pom.xml文件加入\n    \n      <parent>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-parent</artifactId>\n            <version>2.5.6</version>\n       </parent>\n       \n       \n       <dependencies>\n           <!-- Web 依赖 -->\n           <dependency>\n               <groupId>org.springframework.boot</groupId>\n               <artifactId>spring-boot-starter-web</artifactId>\n           </dependency>\n           <!-- Web 依赖 -->\n       </dependencies>\n\n    更新库就可以\n    \n ## 2. 通过官网的spring initializr安装\n \n    https://start.spring.io/  \n \n ## 3.idea旗舰版 新建时 可以选\n \n \n \n \n \n ## Spring Boot 应用启动类，\n \n 在package创建类加上@SpringBootApplication\n \n    package com.zysstudy;\n    \n    import org.springframework.boot.SpringApplication;\n    import org.springframework.boot.autoconfigure.SpringBootApplication;\n    \n    @SpringBootApplication\n    public class StartApplication {\n        public static void main(String[] args) {\n            SpringApplication.run(StartApplication.class,args);\n        }\n    \n    }\n\n ","source":"_posts/java开发-springboot学习.md","raw":"---\ntitle: java开发-springboot学习\nabbrlink: 8a82885c\ncategories:\n  - JAVA开发\ndate: 2023-08-01 20:20:47\ntags:\n---\n\n## 创建基于springboot 项目\n\n## 1.maven方式\n    pom.xml文件加入\n    \n      <parent>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-parent</artifactId>\n            <version>2.5.6</version>\n       </parent>\n       \n       \n       <dependencies>\n           <!-- Web 依赖 -->\n           <dependency>\n               <groupId>org.springframework.boot</groupId>\n               <artifactId>spring-boot-starter-web</artifactId>\n           </dependency>\n           <!-- Web 依赖 -->\n       </dependencies>\n\n    更新库就可以\n    \n ## 2. 通过官网的spring initializr安装\n \n    https://start.spring.io/  \n \n ## 3.idea旗舰版 新建时 可以选\n \n \n \n \n \n ## Spring Boot 应用启动类，\n \n 在package创建类加上@SpringBootApplication\n \n    package com.zysstudy;\n    \n    import org.springframework.boot.SpringApplication;\n    import org.springframework.boot.autoconfigure.SpringBootApplication;\n    \n    @SpringBootApplication\n    public class StartApplication {\n        public static void main(String[] args) {\n            SpringApplication.run(StartApplication.class,args);\n        }\n    \n    }\n\n ","slug":"java开发-springboot学习","published":1,"updated":"2024-08-20T01:59:30.778Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm04ukh5p00004koccz7dd3ie","content":"<h2 id=\"创建基于springboot-项目\"><a href=\"#创建基于springboot-项目\" class=\"headerlink\" title=\"创建基于springboot 项目\"></a>创建基于springboot 项目</h2><h2 id=\"1-maven方式\"><a href=\"#1-maven方式\" class=\"headerlink\" title=\"1.maven方式\"></a>1.maven方式</h2><pre><code>pom.xml文件加入\n\n  &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.5.6&lt;/version&gt;\n   &lt;/parent&gt;\n   \n   \n   &lt;dependencies&gt;\n       &lt;!-- Web 依赖 --&gt;\n       &lt;dependency&gt;\n           &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n           &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n       &lt;/dependency&gt;\n       &lt;!-- Web 依赖 --&gt;\n   &lt;/dependencies&gt;\n\n更新库就可以\n</code></pre>\n<h2 id=\"2-通过官网的spring-initializr安装\"><a href=\"#2-通过官网的spring-initializr安装\" class=\"headerlink\" title=\"2. 通过官网的spring initializr安装\"></a>2. 通过官网的spring initializr安装</h2><pre><code>https://start.spring.io/  \n</code></pre>\n<h2 id=\"3-idea旗舰版-新建时-可以选\"><a href=\"#3-idea旗舰版-新建时-可以选\" class=\"headerlink\" title=\"3.idea旗舰版 新建时 可以选\"></a>3.idea旗舰版 新建时 可以选</h2><h2 id=\"Spring-Boot-应用启动类，\"><a href=\"#Spring-Boot-应用启动类，\" class=\"headerlink\" title=\"Spring Boot 应用启动类，\"></a>Spring Boot 应用启动类，</h2><p> 在package创建类加上@SpringBootApplication</p>\n<pre><code>package com.zysstudy;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class StartApplication &#123;\n    public static void main(String[] args) &#123;\n        SpringApplication.run(StartApplication.class,args);\n    &#125;\n\n&#125;\n</code></pre>\n","site":{"data":{}},"length":863,"excerpt":"","more":"<h2 id=\"创建基于springboot-项目\"><a href=\"#创建基于springboot-项目\" class=\"headerlink\" title=\"创建基于springboot 项目\"></a>创建基于springboot 项目</h2><h2 id=\"1-maven方式\"><a href=\"#1-maven方式\" class=\"headerlink\" title=\"1.maven方式\"></a>1.maven方式</h2><pre><code>pom.xml文件加入\n\n  &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.5.6&lt;/version&gt;\n   &lt;/parent&gt;\n   \n   \n   &lt;dependencies&gt;\n       &lt;!-- Web 依赖 --&gt;\n       &lt;dependency&gt;\n           &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n           &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n       &lt;/dependency&gt;\n       &lt;!-- Web 依赖 --&gt;\n   &lt;/dependencies&gt;\n\n更新库就可以\n</code></pre>\n<h2 id=\"2-通过官网的spring-initializr安装\"><a href=\"#2-通过官网的spring-initializr安装\" class=\"headerlink\" title=\"2. 通过官网的spring initializr安装\"></a>2. 通过官网的spring initializr安装</h2><pre><code>https://start.spring.io/  \n</code></pre>\n<h2 id=\"3-idea旗舰版-新建时-可以选\"><a href=\"#3-idea旗舰版-新建时-可以选\" class=\"headerlink\" title=\"3.idea旗舰版 新建时 可以选\"></a>3.idea旗舰版 新建时 可以选</h2><h2 id=\"Spring-Boot-应用启动类，\"><a href=\"#Spring-Boot-应用启动类，\" class=\"headerlink\" title=\"Spring Boot 应用启动类，\"></a>Spring Boot 应用启动类，</h2><p> 在package创建类加上@SpringBootApplication</p>\n<pre><code>package com.zysstudy;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class StartApplication &#123;\n    public static void main(String[] args) &#123;\n        SpringApplication.run(StartApplication.class,args);\n    &#125;\n\n&#125;\n</code></pre>\n"},{"title":"java开发-Servlet及HttpSeverlet","abbrlink":"e9f2e524","date":"2024-04-10T07:17:32.000Z","_content":"\n# 一、Servlet\n\n## 1.1基础知识\n\nServlet是什么呢？Servlet就是一个服务端的小组件，这个小组件可以接受客户端发过来的信息，然后对其进行处理。\n\nServlet是一个抽象类，它的各种方法要由它的继承类和接口来实现。\n\n## 1.2继承关系\n javax.servlet.Servlet接口\n\n​ javax.servlet.GenericsServlet 抽象类\n\n​ javax.servletHttpServlet\n\n## 1.3Servlet有下面三种方法：\n   init （初始化方法）启动servlet 容器执行一次\n   service（服务方法）\n   destory（销毁方法）关闭servlet 容器 执行\n   \n## 1.3示例代码   \n```java\n\npackage com.study;\nimport javax.servlet.*;\nimport java.io.IOException;\nimport java.io.PrintWriter;\npublic class MyFirstServlet implements Servlet {\n    public void init(ServletConfig config) throws ServletException {\n        System.out.println(\"Init\");\n    }\n    public void service(ServletRequest request, ServletResponse response)\n            throws ServletException, IOException {\n        System.out.println(\"From service\");\n        PrintWriter out = response.getWriter();\n        out.println(\"Hello, Java Web.\");\n    }\n    public void destroy() {\n        System.out.println(\"Destroy\");\n    }\n    public String getServletInfo() {\n        return null;\n    }\n    public ServletConfig getServletConfig() {\n        return null;\n    }\n}\n\n```\n\n# 二、HttpServlet\n\n## 1.1基础知识\n\nHttpServlet 实现了 Servlet \nHttpServlet可以理解为专门处理Http文件的服务器组件Servlet\n<font color=\"red\">如果客户端有信息发过来的话，HttpServlet会被调用的只有Servlet方法，\n然后Servlet方法就会去判断对面发过来的请求是什么，调用doGet 还是doPost等等</font>\n## 2.1HttpServlet有的方法：\ninit()\nservice()  每次收到路径匹配的请求都要调用一次。\ndestory()\ndoGet(),\ndoPost(),\ndoPut/doDelete/doOption\n## 2.2 HttpServletRequest\n## 2.3HttpServletResponse\n## 2.4 示例代码\n\n```java\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n@WebServlet(\"/hello\")\npublic class HelloServlet extends HttpServlet {\n \n    @Override\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        resp.setContentType(\"text/html;charset=utf8\");\n        resp.getWriter().write(\"这是一个doGet方法\");\n    }\n \n    @Override\n    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        resp.getWriter().write(\"这是一个doPost方法\");\n    }\n \n    @Override\n    protected void doPut(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        resp.getWriter().write(\"这是一个doPut\");\n    }\n \n    @Override\n    protected void doDelete(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        resp.getWriter().write(\"这是一个doDelete方法\");\n    }\n}\n```","source":"_posts/java开发-Servlet及HttpSeverlet.md","raw":"---\ntitle: java开发-Servlet及HttpSeverlet\nabbrlink: e9f2e524\ndate: 2024-04-10 15:17:32\ntags:\n---\n\n# 一、Servlet\n\n## 1.1基础知识\n\nServlet是什么呢？Servlet就是一个服务端的小组件，这个小组件可以接受客户端发过来的信息，然后对其进行处理。\n\nServlet是一个抽象类，它的各种方法要由它的继承类和接口来实现。\n\n## 1.2继承关系\n javax.servlet.Servlet接口\n\n​ javax.servlet.GenericsServlet 抽象类\n\n​ javax.servletHttpServlet\n\n## 1.3Servlet有下面三种方法：\n   init （初始化方法）启动servlet 容器执行一次\n   service（服务方法）\n   destory（销毁方法）关闭servlet 容器 执行\n   \n## 1.3示例代码   \n```java\n\npackage com.study;\nimport javax.servlet.*;\nimport java.io.IOException;\nimport java.io.PrintWriter;\npublic class MyFirstServlet implements Servlet {\n    public void init(ServletConfig config) throws ServletException {\n        System.out.println(\"Init\");\n    }\n    public void service(ServletRequest request, ServletResponse response)\n            throws ServletException, IOException {\n        System.out.println(\"From service\");\n        PrintWriter out = response.getWriter();\n        out.println(\"Hello, Java Web.\");\n    }\n    public void destroy() {\n        System.out.println(\"Destroy\");\n    }\n    public String getServletInfo() {\n        return null;\n    }\n    public ServletConfig getServletConfig() {\n        return null;\n    }\n}\n\n```\n\n# 二、HttpServlet\n\n## 1.1基础知识\n\nHttpServlet 实现了 Servlet \nHttpServlet可以理解为专门处理Http文件的服务器组件Servlet\n<font color=\"red\">如果客户端有信息发过来的话，HttpServlet会被调用的只有Servlet方法，\n然后Servlet方法就会去判断对面发过来的请求是什么，调用doGet 还是doPost等等</font>\n## 2.1HttpServlet有的方法：\ninit()\nservice()  每次收到路径匹配的请求都要调用一次。\ndestory()\ndoGet(),\ndoPost(),\ndoPut/doDelete/doOption\n## 2.2 HttpServletRequest\n## 2.3HttpServletResponse\n## 2.4 示例代码\n\n```java\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n@WebServlet(\"/hello\")\npublic class HelloServlet extends HttpServlet {\n \n    @Override\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        resp.setContentType(\"text/html;charset=utf8\");\n        resp.getWriter().write(\"这是一个doGet方法\");\n    }\n \n    @Override\n    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        resp.getWriter().write(\"这是一个doPost方法\");\n    }\n \n    @Override\n    protected void doPut(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        resp.getWriter().write(\"这是一个doPut\");\n    }\n \n    @Override\n    protected void doDelete(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        resp.getWriter().write(\"这是一个doDelete方法\");\n    }\n}\n```","slug":"java开发-Servlet及HttpSeverlet","published":1,"updated":"2024-08-20T01:58:00.710Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm04ukh6600014koc3u2xgzo1","content":"<h1 id=\"一、Servlet\"><a href=\"#一、Servlet\" class=\"headerlink\" title=\"一、Servlet\"></a>一、Servlet</h1><h2 id=\"1-1基础知识\"><a href=\"#1-1基础知识\" class=\"headerlink\" title=\"1.1基础知识\"></a>1.1基础知识</h2><p>Servlet是什么呢？Servlet就是一个服务端的小组件，这个小组件可以接受客户端发过来的信息，然后对其进行处理。</p>\n<p>Servlet是一个抽象类，它的各种方法要由它的继承类和接口来实现。</p>\n<h2 id=\"1-2继承关系\"><a href=\"#1-2继承关系\" class=\"headerlink\" title=\"1.2继承关系\"></a>1.2继承关系</h2><p> javax.servlet.Servlet接口</p>\n<p>​ javax.servlet.GenericsServlet 抽象类</p>\n<p>​ javax.servletHttpServlet</p>\n<h2 id=\"1-3Servlet有下面三种方法：\"><a href=\"#1-3Servlet有下面三种方法：\" class=\"headerlink\" title=\"1.3Servlet有下面三种方法：\"></a>1.3Servlet有下面三种方法：</h2><p>   init （初始化方法）启动servlet 容器执行一次<br>   service（服务方法）<br>   destory（销毁方法）关闭servlet 容器 执行</p>\n<h2 id=\"1-3示例代码\"><a href=\"#1-3示例代码\" class=\"headerlink\" title=\"1.3示例代码\"></a>1.3示例代码</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">package</span> com.study;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.PrintWriter;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyFirstServlet</span> <span class=\"keyword\">implements</span> <span class=\"title\">Servlet</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(ServletConfig config)</span> <span class=\"keyword\">throws</span> ServletException </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Init&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">service</span><span class=\"params\">(ServletRequest request, ServletResponse response)</span></span></span><br><span class=\"line\"><span class=\"function\">            <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;From service&quot;</span>);</span><br><span class=\"line\">        PrintWriter out = response.getWriter();</span><br><span class=\"line\">        out.println(<span class=\"string\">&quot;Hello, Java Web.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">destroy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Destroy&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getServletInfo</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ServletConfig <span class=\"title\">getServletConfig</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"二、HttpServlet\"><a href=\"#二、HttpServlet\" class=\"headerlink\" title=\"二、HttpServlet\"></a>二、HttpServlet</h1><h2 id=\"1-1基础知识-1\"><a href=\"#1-1基础知识-1\" class=\"headerlink\" title=\"1.1基础知识\"></a>1.1基础知识</h2><p>HttpServlet 实现了 Servlet<br>HttpServlet可以理解为专门处理Http文件的服务器组件Servlet<br><font color=\"red\">如果客户端有信息发过来的话，HttpServlet会被调用的只有Servlet方法，<br>然后Servlet方法就会去判断对面发过来的请求是什么，调用doGet 还是doPost等等</font></p>\n<h2 id=\"2-1HttpServlet有的方法：\"><a href=\"#2-1HttpServlet有的方法：\" class=\"headerlink\" title=\"2.1HttpServlet有的方法：\"></a>2.1HttpServlet有的方法：</h2><p>init()<br>service()  每次收到路径匹配的请求都要调用一次。<br>destory()<br>doGet(),<br>doPost(),<br>doPut/doDelete/doOption</p>\n<h2 id=\"2-2-HttpServletRequest\"><a href=\"#2-2-HttpServletRequest\" class=\"headerlink\" title=\"2.2 HttpServletRequest\"></a>2.2 HttpServletRequest</h2><h2 id=\"2-3HttpServletResponse\"><a href=\"#2-3HttpServletResponse\" class=\"headerlink\" title=\"2.3HttpServletResponse\"></a>2.3HttpServletResponse</h2><h2 id=\"2-4-示例代码\"><a href=\"#2-4-示例代码\" class=\"headerlink\" title=\"2.4 示例代码\"></a>2.4 示例代码</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.ServletException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.annotation.WebServlet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.http.HttpServlet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"meta\">@WebServlet(&quot;/hello&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HelloServlet</span> <span class=\"keyword\">extends</span> <span class=\"title\">HttpServlet</span> </span>&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">doGet</span><span class=\"params\">(HttpServletRequest req, HttpServletResponse resp)</span> <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\">        resp.setContentType(<span class=\"string\">&quot;text/html;charset=utf8&quot;</span>);</span><br><span class=\"line\">        resp.getWriter().write(<span class=\"string\">&quot;这是一个doGet方法&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">doPost</span><span class=\"params\">(HttpServletRequest req, HttpServletResponse resp)</span> <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\">        resp.getWriter().write(<span class=\"string\">&quot;这是一个doPost方法&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">doPut</span><span class=\"params\">(HttpServletRequest req, HttpServletResponse resp)</span> <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\">        resp.getWriter().write(<span class=\"string\">&quot;这是一个doPut&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">doDelete</span><span class=\"params\">(HttpServletRequest req, HttpServletResponse resp)</span> <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\">        resp.getWriter().write(<span class=\"string\">&quot;这是一个doDelete方法&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"length":2411,"excerpt":"","more":"<h1 id=\"一、Servlet\"><a href=\"#一、Servlet\" class=\"headerlink\" title=\"一、Servlet\"></a>一、Servlet</h1><h2 id=\"1-1基础知识\"><a href=\"#1-1基础知识\" class=\"headerlink\" title=\"1.1基础知识\"></a>1.1基础知识</h2><p>Servlet是什么呢？Servlet就是一个服务端的小组件，这个小组件可以接受客户端发过来的信息，然后对其进行处理。</p>\n<p>Servlet是一个抽象类，它的各种方法要由它的继承类和接口来实现。</p>\n<h2 id=\"1-2继承关系\"><a href=\"#1-2继承关系\" class=\"headerlink\" title=\"1.2继承关系\"></a>1.2继承关系</h2><p> javax.servlet.Servlet接口</p>\n<p>​ javax.servlet.GenericsServlet 抽象类</p>\n<p>​ javax.servletHttpServlet</p>\n<h2 id=\"1-3Servlet有下面三种方法：\"><a href=\"#1-3Servlet有下面三种方法：\" class=\"headerlink\" title=\"1.3Servlet有下面三种方法：\"></a>1.3Servlet有下面三种方法：</h2><p>   init （初始化方法）启动servlet 容器执行一次<br>   service（服务方法）<br>   destory（销毁方法）关闭servlet 容器 执行</p>\n<h2 id=\"1-3示例代码\"><a href=\"#1-3示例代码\" class=\"headerlink\" title=\"1.3示例代码\"></a>1.3示例代码</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">package</span> com.study;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.PrintWriter;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyFirstServlet</span> <span class=\"keyword\">implements</span> <span class=\"title\">Servlet</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(ServletConfig config)</span> <span class=\"keyword\">throws</span> ServletException </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Init&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">service</span><span class=\"params\">(ServletRequest request, ServletResponse response)</span></span></span><br><span class=\"line\"><span class=\"function\">            <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;From service&quot;</span>);</span><br><span class=\"line\">        PrintWriter out = response.getWriter();</span><br><span class=\"line\">        out.println(<span class=\"string\">&quot;Hello, Java Web.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">destroy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Destroy&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getServletInfo</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ServletConfig <span class=\"title\">getServletConfig</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"二、HttpServlet\"><a href=\"#二、HttpServlet\" class=\"headerlink\" title=\"二、HttpServlet\"></a>二、HttpServlet</h1><h2 id=\"1-1基础知识-1\"><a href=\"#1-1基础知识-1\" class=\"headerlink\" title=\"1.1基础知识\"></a>1.1基础知识</h2><p>HttpServlet 实现了 Servlet<br>HttpServlet可以理解为专门处理Http文件的服务器组件Servlet<br><font color=\"red\">如果客户端有信息发过来的话，HttpServlet会被调用的只有Servlet方法，<br>然后Servlet方法就会去判断对面发过来的请求是什么，调用doGet 还是doPost等等</font></p>\n<h2 id=\"2-1HttpServlet有的方法：\"><a href=\"#2-1HttpServlet有的方法：\" class=\"headerlink\" title=\"2.1HttpServlet有的方法：\"></a>2.1HttpServlet有的方法：</h2><p>init()<br>service()  每次收到路径匹配的请求都要调用一次。<br>destory()<br>doGet(),<br>doPost(),<br>doPut/doDelete/doOption</p>\n<h2 id=\"2-2-HttpServletRequest\"><a href=\"#2-2-HttpServletRequest\" class=\"headerlink\" title=\"2.2 HttpServletRequest\"></a>2.2 HttpServletRequest</h2><h2 id=\"2-3HttpServletResponse\"><a href=\"#2-3HttpServletResponse\" class=\"headerlink\" title=\"2.3HttpServletResponse\"></a>2.3HttpServletResponse</h2><h2 id=\"2-4-示例代码\"><a href=\"#2-4-示例代码\" class=\"headerlink\" title=\"2.4 示例代码\"></a>2.4 示例代码</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.ServletException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.annotation.WebServlet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.http.HttpServlet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"meta\">@WebServlet(&quot;/hello&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HelloServlet</span> <span class=\"keyword\">extends</span> <span class=\"title\">HttpServlet</span> </span>&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">doGet</span><span class=\"params\">(HttpServletRequest req, HttpServletResponse resp)</span> <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\">        resp.setContentType(<span class=\"string\">&quot;text/html;charset=utf8&quot;</span>);</span><br><span class=\"line\">        resp.getWriter().write(<span class=\"string\">&quot;这是一个doGet方法&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">doPost</span><span class=\"params\">(HttpServletRequest req, HttpServletResponse resp)</span> <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\">        resp.getWriter().write(<span class=\"string\">&quot;这是一个doPost方法&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">doPut</span><span class=\"params\">(HttpServletRequest req, HttpServletResponse resp)</span> <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\">        resp.getWriter().write(<span class=\"string\">&quot;这是一个doPut&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">doDelete</span><span class=\"params\">(HttpServletRequest req, HttpServletResponse resp)</span> <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\">        resp.getWriter().write(<span class=\"string\">&quot;这是一个doDelete方法&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"java开发-层级类","abbrlink":"4a58ed40","date":"2024-06-03T06:16:17.000Z","_content":"\n\n# 数据层\n\n## entity\n\n  entity = 实体\n  \n  严格和数据库相对应，数据库中有什么字段，entity包中的类就有什么字段。因此当操作表时，操作这个类即可。\n  \n  比如user表中有name、id、age，则entity包中对应的同名类也只有这三个同名属性\n  \n  如果是严格对数据库表操作，就用entity\n  \n  \n\n## model  （概念实体模型）实体类和模型\n\n  当用model当包名时，一般里面存的是实体类的模型，是用来给后端用的。\n\n  比如user表中有name、id、age，出于安全原因，我们需要把用户的密码定义在另一表中，即user_passwd表，\n  但进行相关操作时，我们往往需要将两个表关联使用，每次定义都很麻烦。\n\n  因此可以在model层中定义user_model类，将user表中的信息与user_passwd表中的信息整合成一张综合表，\n  这样在进行操作时只需调用综合表，就可以完成对两个表的关联操作\n\n  如果想显示某个几个表的综合信息，就用model，注意model包一般放在service层\n\n## DTO （Data Transfer Object）数据传输对象\n\n   Data Transfer Object数据传输对象的简称，多用于多个系统之间，网络通信，数据库存取等。\n   将调用或返回的数据保存在DTO中从而减少调用负载。它不包含业务逻辑处理，但可以有数据整合性的校验。\n   DTO需要注意的是必须序列化，即implements Serializable，\n   一般用于接口间调用参数的传递，或访问DAO层传递条件参数使用。\n   \n   一般来说，DTO是用于在不同层之间传输数据的一个普通Java类。\n   它通常用于封装从数据库查询结果中提取的数据，或者用于在应用程序的不同模块之间传递数据。\n   \n\n   \n  <font color=\"red\"> \n\n  一般在 前端（Web） \n   \n   对控制层（Controller）进行数据传输时使用，说白了就是\n   \n   前端向后台\n   提交数据。\n   \n   xxxDTO，xxx为业务领域相关的名称\n   </font>\n\n   \n\n## VO （View Object）视图模型\n\n   Value Object值对象的简称，主要体现在视图的对象，\n   对于一个WEB页面将整个页面的属性封装成一个对象，然后用一个VO对象在控制层与视图层进行传输交换，\n   比如页面要显示100个字段，而实体只有10个，就可以封装一个VO返回。\n<font color=\"red\">   \n   一般用在业务逻辑层（Service） \n   \n   对前端（Web） 的 视图模型效果控制的展示上，说白了就是\n   \n   后台向前端\n   传输数据。\n   \n   xxxVO，xxx一般为网页名称\n</font>   \n   \n## Form\n\n   主要用于接收页面表单中的数据或者页面显示用数据的存储，\n   包含校验Validate方法,一般用于controller层用来接收前端传过来的参数   \n   \n   \n## domain\n  domain = 域\n  \n  域是一个大范围，如简历域包括工作经验表、项目经验表、简历基本信息表。 \n  在domain包中，就可以定义一个大的简历对象，将三个表的内容整合在一个对象中，作为整体操作。  \n  \n  如果想对几个表综合操作，就用domain\n   \n \n  \n# 数据访问层  \n\n\n## DAO （Data Access Object）数据访问对象\n   \n   DAO(Data Access Object)是一个数据访问接口，数据访问：顾名思义就是与数据库打交道。\n   夹在业务逻辑与数据库资源中间。\n<font color=\"red\">  \n   一般在 业务逻辑层（Service） \n\n  对\n\n  数据库（SQL） 的访问时使用，一般能对SQL进行操作。\n\n  xxxDAO，xxx即为实体类名（Entity实体）   \n</font>    \n\n\n## Mapper","source":"_posts/java开发-层级类.md","raw":"---\ntitle: java开发-层级类\nabbrlink: 4a58ed40\ndate: 2024-06-03 14:16:17\ntags:\n---\n\n\n# 数据层\n\n## entity\n\n  entity = 实体\n  \n  严格和数据库相对应，数据库中有什么字段，entity包中的类就有什么字段。因此当操作表时，操作这个类即可。\n  \n  比如user表中有name、id、age，则entity包中对应的同名类也只有这三个同名属性\n  \n  如果是严格对数据库表操作，就用entity\n  \n  \n\n## model  （概念实体模型）实体类和模型\n\n  当用model当包名时，一般里面存的是实体类的模型，是用来给后端用的。\n\n  比如user表中有name、id、age，出于安全原因，我们需要把用户的密码定义在另一表中，即user_passwd表，\n  但进行相关操作时，我们往往需要将两个表关联使用，每次定义都很麻烦。\n\n  因此可以在model层中定义user_model类，将user表中的信息与user_passwd表中的信息整合成一张综合表，\n  这样在进行操作时只需调用综合表，就可以完成对两个表的关联操作\n\n  如果想显示某个几个表的综合信息，就用model，注意model包一般放在service层\n\n## DTO （Data Transfer Object）数据传输对象\n\n   Data Transfer Object数据传输对象的简称，多用于多个系统之间，网络通信，数据库存取等。\n   将调用或返回的数据保存在DTO中从而减少调用负载。它不包含业务逻辑处理，但可以有数据整合性的校验。\n   DTO需要注意的是必须序列化，即implements Serializable，\n   一般用于接口间调用参数的传递，或访问DAO层传递条件参数使用。\n   \n   一般来说，DTO是用于在不同层之间传输数据的一个普通Java类。\n   它通常用于封装从数据库查询结果中提取的数据，或者用于在应用程序的不同模块之间传递数据。\n   \n\n   \n  <font color=\"red\"> \n\n  一般在 前端（Web） \n   \n   对控制层（Controller）进行数据传输时使用，说白了就是\n   \n   前端向后台\n   提交数据。\n   \n   xxxDTO，xxx为业务领域相关的名称\n   </font>\n\n   \n\n## VO （View Object）视图模型\n\n   Value Object值对象的简称，主要体现在视图的对象，\n   对于一个WEB页面将整个页面的属性封装成一个对象，然后用一个VO对象在控制层与视图层进行传输交换，\n   比如页面要显示100个字段，而实体只有10个，就可以封装一个VO返回。\n<font color=\"red\">   \n   一般用在业务逻辑层（Service） \n   \n   对前端（Web） 的 视图模型效果控制的展示上，说白了就是\n   \n   后台向前端\n   传输数据。\n   \n   xxxVO，xxx一般为网页名称\n</font>   \n   \n## Form\n\n   主要用于接收页面表单中的数据或者页面显示用数据的存储，\n   包含校验Validate方法,一般用于controller层用来接收前端传过来的参数   \n   \n   \n## domain\n  domain = 域\n  \n  域是一个大范围，如简历域包括工作经验表、项目经验表、简历基本信息表。 \n  在domain包中，就可以定义一个大的简历对象，将三个表的内容整合在一个对象中，作为整体操作。  \n  \n  如果想对几个表综合操作，就用domain\n   \n \n  \n# 数据访问层  \n\n\n## DAO （Data Access Object）数据访问对象\n   \n   DAO(Data Access Object)是一个数据访问接口，数据访问：顾名思义就是与数据库打交道。\n   夹在业务逻辑与数据库资源中间。\n<font color=\"red\">  \n   一般在 业务逻辑层（Service） \n\n  对\n\n  数据库（SQL） 的访问时使用，一般能对SQL进行操作。\n\n  xxxDAO，xxx即为实体类名（Entity实体）   \n</font>    \n\n\n## Mapper","slug":"java开发-层级类","published":1,"updated":"2024-08-20T01:57:51.732Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm04ukh6a00024kocdjuafn8r","content":"<h1 id=\"数据层\"><a href=\"#数据层\" class=\"headerlink\" title=\"数据层\"></a>数据层</h1><h2 id=\"entity\"><a href=\"#entity\" class=\"headerlink\" title=\"entity\"></a>entity</h2><p>  entity = 实体</p>\n<p>  严格和数据库相对应，数据库中有什么字段，entity包中的类就有什么字段。因此当操作表时，操作这个类即可。</p>\n<p>  比如user表中有name、id、age，则entity包中对应的同名类也只有这三个同名属性</p>\n<p>  如果是严格对数据库表操作，就用entity</p>\n<h2 id=\"model-（概念实体模型）实体类和模型\"><a href=\"#model-（概念实体模型）实体类和模型\" class=\"headerlink\" title=\"model  （概念实体模型）实体类和模型\"></a>model  （概念实体模型）实体类和模型</h2><p>  当用model当包名时，一般里面存的是实体类的模型，是用来给后端用的。</p>\n<p>  比如user表中有name、id、age，出于安全原因，我们需要把用户的密码定义在另一表中，即user_passwd表，<br>  但进行相关操作时，我们往往需要将两个表关联使用，每次定义都很麻烦。</p>\n<p>  因此可以在model层中定义user_model类，将user表中的信息与user_passwd表中的信息整合成一张综合表，<br>  这样在进行操作时只需调用综合表，就可以完成对两个表的关联操作</p>\n<p>  如果想显示某个几个表的综合信息，就用model，注意model包一般放在service层</p>\n<h2 id=\"DTO-（Data-Transfer-Object）数据传输对象\"><a href=\"#DTO-（Data-Transfer-Object）数据传输对象\" class=\"headerlink\" title=\"DTO （Data Transfer Object）数据传输对象\"></a>DTO （Data Transfer Object）数据传输对象</h2><p>   Data Transfer Object数据传输对象的简称，多用于多个系统之间，网络通信，数据库存取等。<br>   将调用或返回的数据保存在DTO中从而减少调用负载。它不包含业务逻辑处理，但可以有数据整合性的校验。<br>   DTO需要注意的是必须序列化，即implements Serializable，<br>   一般用于接口间调用参数的传递，或访问DAO层传递条件参数使用。</p>\n<p>   一般来说，DTO是用于在不同层之间传输数据的一个普通Java类。<br>   它通常用于封装从数据库查询结果中提取的数据，或者用于在应用程序的不同模块之间传递数据。</p>\n  <font color=\"red\"> \n\n<p>  一般在 前端（Web） </p>\n<p>   对控制层（Controller）进行数据传输时使用，说白了就是</p>\n<p>   前端向后台<br>   提交数据。</p>\n<p>   xxxDTO，xxx为业务领域相关的名称<br>   </font></p>\n<h2 id=\"VO-（View-Object）视图模型\"><a href=\"#VO-（View-Object）视图模型\" class=\"headerlink\" title=\"VO （View Object）视图模型\"></a>VO （View Object）视图模型</h2><p>   Value Object值对象的简称，主要体现在视图的对象，<br>   对于一个WEB页面将整个页面的属性封装成一个对象，然后用一个VO对象在控制层与视图层进行传输交换，<br>   比如页面要显示100个字段，而实体只有10个，就可以封装一个VO返回。<br><font color=\"red\"><br>   一般用在业务逻辑层（Service） </p>\n<p>   对前端（Web） 的 视图模型效果控制的展示上，说白了就是</p>\n<p>   后台向前端<br>   传输数据。</p>\n<p>   xxxVO，xxx一般为网页名称<br></font>   </p>\n<h2 id=\"Form\"><a href=\"#Form\" class=\"headerlink\" title=\"Form\"></a>Form</h2><p>   主要用于接收页面表单中的数据或者页面显示用数据的存储，<br>   包含校验Validate方法,一般用于controller层用来接收前端传过来的参数   </p>\n<h2 id=\"domain\"><a href=\"#domain\" class=\"headerlink\" title=\"domain\"></a>domain</h2><p>  domain = 域</p>\n<p>  域是一个大范围，如简历域包括工作经验表、项目经验表、简历基本信息表。<br>  在domain包中，就可以定义一个大的简历对象，将三个表的内容整合在一个对象中，作为整体操作。  </p>\n<p>  如果想对几个表综合操作，就用domain</p>\n<h1 id=\"数据访问层\"><a href=\"#数据访问层\" class=\"headerlink\" title=\"数据访问层\"></a>数据访问层</h1><h2 id=\"DAO-（Data-Access-Object）数据访问对象\"><a href=\"#DAO-（Data-Access-Object）数据访问对象\" class=\"headerlink\" title=\"DAO （Data Access Object）数据访问对象\"></a>DAO （Data Access Object）数据访问对象</h2><p>   DAO(Data Access Object)是一个数据访问接口，数据访问：顾名思义就是与数据库打交道。<br>   夹在业务逻辑与数据库资源中间。<br><font color=\"red\"><br>   一般在 业务逻辑层（Service） </p>\n<p>  对</p>\n<p>  数据库（SQL） 的访问时使用，一般能对SQL进行操作。</p>\n<p>  xxxDAO，xxx即为实体类名（Entity实体）<br></font>    </p>\n<h2 id=\"Mapper\"><a href=\"#Mapper\" class=\"headerlink\" title=\"Mapper\"></a>Mapper</h2>","site":{"data":{}},"length":1329,"excerpt":"","more":"<h1 id=\"数据层\"><a href=\"#数据层\" class=\"headerlink\" title=\"数据层\"></a>数据层</h1><h2 id=\"entity\"><a href=\"#entity\" class=\"headerlink\" title=\"entity\"></a>entity</h2><p>  entity = 实体</p>\n<p>  严格和数据库相对应，数据库中有什么字段，entity包中的类就有什么字段。因此当操作表时，操作这个类即可。</p>\n<p>  比如user表中有name、id、age，则entity包中对应的同名类也只有这三个同名属性</p>\n<p>  如果是严格对数据库表操作，就用entity</p>\n<h2 id=\"model-（概念实体模型）实体类和模型\"><a href=\"#model-（概念实体模型）实体类和模型\" class=\"headerlink\" title=\"model  （概念实体模型）实体类和模型\"></a>model  （概念实体模型）实体类和模型</h2><p>  当用model当包名时，一般里面存的是实体类的模型，是用来给后端用的。</p>\n<p>  比如user表中有name、id、age，出于安全原因，我们需要把用户的密码定义在另一表中，即user_passwd表，<br>  但进行相关操作时，我们往往需要将两个表关联使用，每次定义都很麻烦。</p>\n<p>  因此可以在model层中定义user_model类，将user表中的信息与user_passwd表中的信息整合成一张综合表，<br>  这样在进行操作时只需调用综合表，就可以完成对两个表的关联操作</p>\n<p>  如果想显示某个几个表的综合信息，就用model，注意model包一般放在service层</p>\n<h2 id=\"DTO-（Data-Transfer-Object）数据传输对象\"><a href=\"#DTO-（Data-Transfer-Object）数据传输对象\" class=\"headerlink\" title=\"DTO （Data Transfer Object）数据传输对象\"></a>DTO （Data Transfer Object）数据传输对象</h2><p>   Data Transfer Object数据传输对象的简称，多用于多个系统之间，网络通信，数据库存取等。<br>   将调用或返回的数据保存在DTO中从而减少调用负载。它不包含业务逻辑处理，但可以有数据整合性的校验。<br>   DTO需要注意的是必须序列化，即implements Serializable，<br>   一般用于接口间调用参数的传递，或访问DAO层传递条件参数使用。</p>\n<p>   一般来说，DTO是用于在不同层之间传输数据的一个普通Java类。<br>   它通常用于封装从数据库查询结果中提取的数据，或者用于在应用程序的不同模块之间传递数据。</p>\n  <font color=\"red\"> \n\n<p>  一般在 前端（Web） </p>\n<p>   对控制层（Controller）进行数据传输时使用，说白了就是</p>\n<p>   前端向后台<br>   提交数据。</p>\n<p>   xxxDTO，xxx为业务领域相关的名称<br>   </font></p>\n<h2 id=\"VO-（View-Object）视图模型\"><a href=\"#VO-（View-Object）视图模型\" class=\"headerlink\" title=\"VO （View Object）视图模型\"></a>VO （View Object）视图模型</h2><p>   Value Object值对象的简称，主要体现在视图的对象，<br>   对于一个WEB页面将整个页面的属性封装成一个对象，然后用一个VO对象在控制层与视图层进行传输交换，<br>   比如页面要显示100个字段，而实体只有10个，就可以封装一个VO返回。<br><font color=\"red\"><br>   一般用在业务逻辑层（Service） </p>\n<p>   对前端（Web） 的 视图模型效果控制的展示上，说白了就是</p>\n<p>   后台向前端<br>   传输数据。</p>\n<p>   xxxVO，xxx一般为网页名称<br></font>   </p>\n<h2 id=\"Form\"><a href=\"#Form\" class=\"headerlink\" title=\"Form\"></a>Form</h2><p>   主要用于接收页面表单中的数据或者页面显示用数据的存储，<br>   包含校验Validate方法,一般用于controller层用来接收前端传过来的参数   </p>\n<h2 id=\"domain\"><a href=\"#domain\" class=\"headerlink\" title=\"domain\"></a>domain</h2><p>  domain = 域</p>\n<p>  域是一个大范围，如简历域包括工作经验表、项目经验表、简历基本信息表。<br>  在domain包中，就可以定义一个大的简历对象，将三个表的内容整合在一个对象中，作为整体操作。  </p>\n<p>  如果想对几个表综合操作，就用domain</p>\n<h1 id=\"数据访问层\"><a href=\"#数据访问层\" class=\"headerlink\" title=\"数据访问层\"></a>数据访问层</h1><h2 id=\"DAO-（Data-Access-Object）数据访问对象\"><a href=\"#DAO-（Data-Access-Object）数据访问对象\" class=\"headerlink\" title=\"DAO （Data Access Object）数据访问对象\"></a>DAO （Data Access Object）数据访问对象</h2><p>   DAO(Data Access Object)是一个数据访问接口，数据访问：顾名思义就是与数据库打交道。<br>   夹在业务逻辑与数据库资源中间。<br><font color=\"red\"><br>   一般在 业务逻辑层（Service） </p>\n<p>  对</p>\n<p>  数据库（SQL） 的访问时使用，一般能对SQL进行操作。</p>\n<p>  xxxDAO，xxx即为实体类名（Entity实体）<br></font>    </p>\n<h2 id=\"Mapper\"><a href=\"#Mapper\" class=\"headerlink\" title=\"Mapper\"></a>Mapper</h2>"},{"title":"java开发-相关概念","abbrlink":"1f1744f1","date":"2023-02-08T03:39:50.000Z","_content":"# 一、基本概念\n    \n1.JavaEE 全称 Java Platform, Enterprise Edition，\n    \n    它是对 JavaSE(Java Platform, Standard Edition) 的扩展\n    加入了面向企业开发（实际上就是网络和 Web 有关开发）的支持，包括 Servlet，WebSocket，EL，EJB 等\n    \n2.Servlet 和 Servlet Container\n\n    Servlet\n    \n    Servlet 是一套用于处理 HTTP 请求的 API 标准\n    JavaEE 当中只提供了 Servlet 的标准，\n    要真正运行 Servlet，需要使用 Servlet Container\n    \n    Servlet Container\n    \n    如果 Servlet 是电器，Servlet Container 就是电源插座\n    这层抽象让 Servlet 可以跑在任何一个 Container 当中，隔绝了对 Runtime 环境的依赖\n    比较常用支持 Servlet Container 的 Server 软件有 Apache Tomcat，Glassfish，JBoss，Jetty 等等。\n    \n    \n    Servlet 是 Java Web 开发的事实标准，不过也不代表所有 Java Web 框架都一定要使用或者兼容 Servlet。\n    不使用 Servlet 也可以进行 Java Web 开发，例如 Play Framework，就是完全自立门户的一个框架。\n    \n3.EJB 和 EJB Container\n\n    EJB 全称 Enterprise JavaBean，和 Servlet 一样，也是 JavaEE 当中的一个组件，面向更加复杂的企业业务开发\n    有一个概念需要明确，和 Servlet 类似，运行 EJB 也需要专门的 EJB Container\n    Apache Tomcat 不支持 EJB，而 JBoss 提供了对 EJB 的支持。\n    \n    \n4.JVM：java虚拟机，加载.class文件字节码文件并运行.class字节码文件    \n    \n    \n    \n# 二、在系统跑Java程序必要软件\n\nJava Development Kit (JDK) 是Java开发工具包,用于开发和编译和调试Java程序\n\n    编译器（javac）：将Java源代码编译成字节码文件（.class文件），以便能够在Java虚拟机（JVM）上执行\n    JDK提供了一些调试工具，用于帮助开发人员在开发和测试Java程序时进行调试。\n    JDK用于开发和编译和调试Java程序\n    \nJava Runtime Environment (JRE)：JRE包含了运行Java程序所需的运行时环境。 用于运行Java程序\n    \n    JRE：java 程序运行时环境，包括JVM虚拟机（java.exe等）和基本的类库（rt.jar等）。\n    只包含Java虚拟机（JVM）和Java标准类库，用于执行Java程序\n    JRE则用于运行Java程序。\n# 三、JavaEE Servlet 应用\n\n     package，然后在 package 上右键，创建一个 Java Class\n     \n     Servlet API 是包含在 JavaEE 当中的。为了方便，我们直接使用 Tomcat 附带的 servlet-api.jar 包。\n     \n     \n## 3.1 Servlet接口\n\n    import javax.servlet.*;\n    public class MyFirstServlet implements Servlet{\n    \n        public void init(ServletConfig config) throws ServletException {\n            System.out.println(\"Init\");\n        }\n        \n        public void service(ServletRequest request, ServletResponse response)\n                throws ServletException, IOException {\n            System.out.println(\"From service\");\n            PrintWriter out = response.getWriter();\n            out.println(\"Hello, Java Web.\");\n        }\n        \n        public void destroy() {\n            System.out.println(\"Destroy\");\n        }\n        public String getServletInfo() {\n            return null;\n        }\n        \n        public ServletConfig getServletConfig() {\n            return null;\n        }\n    \n    \n    }\n\n## 3.2 GenericServlet抽象类\n\nGenericServlet使编写Servlet变得更容易。\n它提生命周期方法init和destroy的简单实现，要编写一般的Servlet，只需要重写service方法即可。\n\n    import javax.servlet.GenericServlet;\n    public class classname extends GenericServlet{\n    }     \n\n## 3.2 HttpServlet类  \n   \n    \nHttpServlet是在继承GenericServlet的基础上进一步的扩展。 \n提供将要被子类化以创建适用于Web站点的HTTP servlet的抽象类    \n要重写doGet和doPost方法\n\n\nHTTPServlet的子类至少必须重写一个方法，该方法通常是：\n\ndoGet()：用于HTTP GET请求\n\ndoPost()：用于HTTP POST请求\n\ndoPut()：用于HTTP PUT请求\n\ndoDelete()：用于HTTP DELETE请求\n\n\n    import javax.servlet.http.HttpServlet; \n    public class classname extends HttpServlet{\n    \n    }   \n \n\n\n    \n    \n\n","source":"_posts/java开发-相关概念.md","raw":"---\ntitle: java开发-相关概念\nabbrlink: 1f1744f1\ndate: 2023-02-08 11:39:50\ntags:\n---\n# 一、基本概念\n    \n1.JavaEE 全称 Java Platform, Enterprise Edition，\n    \n    它是对 JavaSE(Java Platform, Standard Edition) 的扩展\n    加入了面向企业开发（实际上就是网络和 Web 有关开发）的支持，包括 Servlet，WebSocket，EL，EJB 等\n    \n2.Servlet 和 Servlet Container\n\n    Servlet\n    \n    Servlet 是一套用于处理 HTTP 请求的 API 标准\n    JavaEE 当中只提供了 Servlet 的标准，\n    要真正运行 Servlet，需要使用 Servlet Container\n    \n    Servlet Container\n    \n    如果 Servlet 是电器，Servlet Container 就是电源插座\n    这层抽象让 Servlet 可以跑在任何一个 Container 当中，隔绝了对 Runtime 环境的依赖\n    比较常用支持 Servlet Container 的 Server 软件有 Apache Tomcat，Glassfish，JBoss，Jetty 等等。\n    \n    \n    Servlet 是 Java Web 开发的事实标准，不过也不代表所有 Java Web 框架都一定要使用或者兼容 Servlet。\n    不使用 Servlet 也可以进行 Java Web 开发，例如 Play Framework，就是完全自立门户的一个框架。\n    \n3.EJB 和 EJB Container\n\n    EJB 全称 Enterprise JavaBean，和 Servlet 一样，也是 JavaEE 当中的一个组件，面向更加复杂的企业业务开发\n    有一个概念需要明确，和 Servlet 类似，运行 EJB 也需要专门的 EJB Container\n    Apache Tomcat 不支持 EJB，而 JBoss 提供了对 EJB 的支持。\n    \n    \n4.JVM：java虚拟机，加载.class文件字节码文件并运行.class字节码文件    \n    \n    \n    \n# 二、在系统跑Java程序必要软件\n\nJava Development Kit (JDK) 是Java开发工具包,用于开发和编译和调试Java程序\n\n    编译器（javac）：将Java源代码编译成字节码文件（.class文件），以便能够在Java虚拟机（JVM）上执行\n    JDK提供了一些调试工具，用于帮助开发人员在开发和测试Java程序时进行调试。\n    JDK用于开发和编译和调试Java程序\n    \nJava Runtime Environment (JRE)：JRE包含了运行Java程序所需的运行时环境。 用于运行Java程序\n    \n    JRE：java 程序运行时环境，包括JVM虚拟机（java.exe等）和基本的类库（rt.jar等）。\n    只包含Java虚拟机（JVM）和Java标准类库，用于执行Java程序\n    JRE则用于运行Java程序。\n# 三、JavaEE Servlet 应用\n\n     package，然后在 package 上右键，创建一个 Java Class\n     \n     Servlet API 是包含在 JavaEE 当中的。为了方便，我们直接使用 Tomcat 附带的 servlet-api.jar 包。\n     \n     \n## 3.1 Servlet接口\n\n    import javax.servlet.*;\n    public class MyFirstServlet implements Servlet{\n    \n        public void init(ServletConfig config) throws ServletException {\n            System.out.println(\"Init\");\n        }\n        \n        public void service(ServletRequest request, ServletResponse response)\n                throws ServletException, IOException {\n            System.out.println(\"From service\");\n            PrintWriter out = response.getWriter();\n            out.println(\"Hello, Java Web.\");\n        }\n        \n        public void destroy() {\n            System.out.println(\"Destroy\");\n        }\n        public String getServletInfo() {\n            return null;\n        }\n        \n        public ServletConfig getServletConfig() {\n            return null;\n        }\n    \n    \n    }\n\n## 3.2 GenericServlet抽象类\n\nGenericServlet使编写Servlet变得更容易。\n它提生命周期方法init和destroy的简单实现，要编写一般的Servlet，只需要重写service方法即可。\n\n    import javax.servlet.GenericServlet;\n    public class classname extends GenericServlet{\n    }     \n\n## 3.2 HttpServlet类  \n   \n    \nHttpServlet是在继承GenericServlet的基础上进一步的扩展。 \n提供将要被子类化以创建适用于Web站点的HTTP servlet的抽象类    \n要重写doGet和doPost方法\n\n\nHTTPServlet的子类至少必须重写一个方法，该方法通常是：\n\ndoGet()：用于HTTP GET请求\n\ndoPost()：用于HTTP POST请求\n\ndoPut()：用于HTTP PUT请求\n\ndoDelete()：用于HTTP DELETE请求\n\n\n    import javax.servlet.http.HttpServlet; \n    public class classname extends HttpServlet{\n    \n    }   \n \n\n\n    \n    \n\n","slug":"java开发-相关概念","published":1,"updated":"2024-08-20T01:57:42.192Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm04ukh6c00034koc3eym2yur","content":"<h1 id=\"一、基本概念\"><a href=\"#一、基本概念\" class=\"headerlink\" title=\"一、基本概念\"></a>一、基本概念</h1><p>1.JavaEE 全称 Java Platform, Enterprise Edition，</p>\n<pre><code>它是对 JavaSE(Java Platform, Standard Edition) 的扩展\n加入了面向企业开发（实际上就是网络和 Web 有关开发）的支持，包括 Servlet，WebSocket，EL，EJB 等\n</code></pre>\n<p>2.Servlet 和 Servlet Container</p>\n<pre><code>Servlet\n\nServlet 是一套用于处理 HTTP 请求的 API 标准\nJavaEE 当中只提供了 Servlet 的标准，\n要真正运行 Servlet，需要使用 Servlet Container\n\nServlet Container\n\n如果 Servlet 是电器，Servlet Container 就是电源插座\n这层抽象让 Servlet 可以跑在任何一个 Container 当中，隔绝了对 Runtime 环境的依赖\n比较常用支持 Servlet Container 的 Server 软件有 Apache Tomcat，Glassfish，JBoss，Jetty 等等。\n\n\nServlet 是 Java Web 开发的事实标准，不过也不代表所有 Java Web 框架都一定要使用或者兼容 Servlet。\n不使用 Servlet 也可以进行 Java Web 开发，例如 Play Framework，就是完全自立门户的一个框架。\n</code></pre>\n<p>3.EJB 和 EJB Container</p>\n<pre><code>EJB 全称 Enterprise JavaBean，和 Servlet 一样，也是 JavaEE 当中的一个组件，面向更加复杂的企业业务开发\n有一个概念需要明确，和 Servlet 类似，运行 EJB 也需要专门的 EJB Container\nApache Tomcat 不支持 EJB，而 JBoss 提供了对 EJB 的支持。\n</code></pre>\n<p>4.JVM：java虚拟机，加载.class文件字节码文件并运行.class字节码文件    </p>\n<h1 id=\"二、在系统跑Java程序必要软件\"><a href=\"#二、在系统跑Java程序必要软件\" class=\"headerlink\" title=\"二、在系统跑Java程序必要软件\"></a>二、在系统跑Java程序必要软件</h1><p>Java Development Kit (JDK) 是Java开发工具包,用于开发和编译和调试Java程序</p>\n<pre><code>编译器（javac）：将Java源代码编译成字节码文件（.class文件），以便能够在Java虚拟机（JVM）上执行\nJDK提供了一些调试工具，用于帮助开发人员在开发和测试Java程序时进行调试。\nJDK用于开发和编译和调试Java程序\n</code></pre>\n<p>Java Runtime Environment (JRE)：JRE包含了运行Java程序所需的运行时环境。 用于运行Java程序</p>\n<pre><code>JRE：java 程序运行时环境，包括JVM虚拟机（java.exe等）和基本的类库（rt.jar等）。\n只包含Java虚拟机（JVM）和Java标准类库，用于执行Java程序\nJRE则用于运行Java程序。\n</code></pre>\n<h1 id=\"三、JavaEE-Servlet-应用\"><a href=\"#三、JavaEE-Servlet-应用\" class=\"headerlink\" title=\"三、JavaEE Servlet 应用\"></a>三、JavaEE Servlet 应用</h1><pre><code> package，然后在 package 上右键，创建一个 Java Class\n \n Servlet API 是包含在 JavaEE 当中的。为了方便，我们直接使用 Tomcat 附带的 servlet-api.jar 包。\n \n \n</code></pre>\n<h2 id=\"3-1-Servlet接口\"><a href=\"#3-1-Servlet接口\" class=\"headerlink\" title=\"3.1 Servlet接口\"></a>3.1 Servlet接口</h2><pre><code>import javax.servlet.*;\npublic class MyFirstServlet implements Servlet&#123;\n\n    public void init(ServletConfig config) throws ServletException &#123;\n        System.out.println(&quot;Init&quot;);\n    &#125;\n    \n    public void service(ServletRequest request, ServletResponse response)\n            throws ServletException, IOException &#123;\n        System.out.println(&quot;From service&quot;);\n        PrintWriter out = response.getWriter();\n        out.println(&quot;Hello, Java Web.&quot;);\n    &#125;\n    \n    public void destroy() &#123;\n        System.out.println(&quot;Destroy&quot;);\n    &#125;\n    public String getServletInfo() &#123;\n        return null;\n    &#125;\n    \n    public ServletConfig getServletConfig() &#123;\n        return null;\n    &#125;\n\n\n&#125;\n</code></pre>\n<h2 id=\"3-2-GenericServlet抽象类\"><a href=\"#3-2-GenericServlet抽象类\" class=\"headerlink\" title=\"3.2 GenericServlet抽象类\"></a>3.2 GenericServlet抽象类</h2><p>GenericServlet使编写Servlet变得更容易。<br>它提生命周期方法init和destroy的简单实现，要编写一般的Servlet，只需要重写service方法即可。</p>\n<pre><code>import javax.servlet.GenericServlet;\npublic class classname extends GenericServlet&#123;\n&#125;     \n</code></pre>\n<h2 id=\"3-2-HttpServlet类\"><a href=\"#3-2-HttpServlet类\" class=\"headerlink\" title=\"3.2 HttpServlet类\"></a>3.2 HttpServlet类</h2><p>HttpServlet是在继承GenericServlet的基础上进一步的扩展。<br>提供将要被子类化以创建适用于Web站点的HTTP servlet的抽象类<br>要重写doGet和doPost方法</p>\n<p>HTTPServlet的子类至少必须重写一个方法，该方法通常是：</p>\n<p>doGet()：用于HTTP GET请求</p>\n<p>doPost()：用于HTTP POST请求</p>\n<p>doPut()：用于HTTP PUT请求</p>\n<p>doDelete()：用于HTTP DELETE请求</p>\n<pre><code>import javax.servlet.http.HttpServlet; \npublic class classname extends HttpServlet&#123;\n\n&#125;   \n</code></pre>\n","site":{"data":{}},"length":2315,"excerpt":"","more":"<h1 id=\"一、基本概念\"><a href=\"#一、基本概念\" class=\"headerlink\" title=\"一、基本概念\"></a>一、基本概念</h1><p>1.JavaEE 全称 Java Platform, Enterprise Edition，</p>\n<pre><code>它是对 JavaSE(Java Platform, Standard Edition) 的扩展\n加入了面向企业开发（实际上就是网络和 Web 有关开发）的支持，包括 Servlet，WebSocket，EL，EJB 等\n</code></pre>\n<p>2.Servlet 和 Servlet Container</p>\n<pre><code>Servlet\n\nServlet 是一套用于处理 HTTP 请求的 API 标准\nJavaEE 当中只提供了 Servlet 的标准，\n要真正运行 Servlet，需要使用 Servlet Container\n\nServlet Container\n\n如果 Servlet 是电器，Servlet Container 就是电源插座\n这层抽象让 Servlet 可以跑在任何一个 Container 当中，隔绝了对 Runtime 环境的依赖\n比较常用支持 Servlet Container 的 Server 软件有 Apache Tomcat，Glassfish，JBoss，Jetty 等等。\n\n\nServlet 是 Java Web 开发的事实标准，不过也不代表所有 Java Web 框架都一定要使用或者兼容 Servlet。\n不使用 Servlet 也可以进行 Java Web 开发，例如 Play Framework，就是完全自立门户的一个框架。\n</code></pre>\n<p>3.EJB 和 EJB Container</p>\n<pre><code>EJB 全称 Enterprise JavaBean，和 Servlet 一样，也是 JavaEE 当中的一个组件，面向更加复杂的企业业务开发\n有一个概念需要明确，和 Servlet 类似，运行 EJB 也需要专门的 EJB Container\nApache Tomcat 不支持 EJB，而 JBoss 提供了对 EJB 的支持。\n</code></pre>\n<p>4.JVM：java虚拟机，加载.class文件字节码文件并运行.class字节码文件    </p>\n<h1 id=\"二、在系统跑Java程序必要软件\"><a href=\"#二、在系统跑Java程序必要软件\" class=\"headerlink\" title=\"二、在系统跑Java程序必要软件\"></a>二、在系统跑Java程序必要软件</h1><p>Java Development Kit (JDK) 是Java开发工具包,用于开发和编译和调试Java程序</p>\n<pre><code>编译器（javac）：将Java源代码编译成字节码文件（.class文件），以便能够在Java虚拟机（JVM）上执行\nJDK提供了一些调试工具，用于帮助开发人员在开发和测试Java程序时进行调试。\nJDK用于开发和编译和调试Java程序\n</code></pre>\n<p>Java Runtime Environment (JRE)：JRE包含了运行Java程序所需的运行时环境。 用于运行Java程序</p>\n<pre><code>JRE：java 程序运行时环境，包括JVM虚拟机（java.exe等）和基本的类库（rt.jar等）。\n只包含Java虚拟机（JVM）和Java标准类库，用于执行Java程序\nJRE则用于运行Java程序。\n</code></pre>\n<h1 id=\"三、JavaEE-Servlet-应用\"><a href=\"#三、JavaEE-Servlet-应用\" class=\"headerlink\" title=\"三、JavaEE Servlet 应用\"></a>三、JavaEE Servlet 应用</h1><pre><code> package，然后在 package 上右键，创建一个 Java Class\n \n Servlet API 是包含在 JavaEE 当中的。为了方便，我们直接使用 Tomcat 附带的 servlet-api.jar 包。\n \n \n</code></pre>\n<h2 id=\"3-1-Servlet接口\"><a href=\"#3-1-Servlet接口\" class=\"headerlink\" title=\"3.1 Servlet接口\"></a>3.1 Servlet接口</h2><pre><code>import javax.servlet.*;\npublic class MyFirstServlet implements Servlet&#123;\n\n    public void init(ServletConfig config) throws ServletException &#123;\n        System.out.println(&quot;Init&quot;);\n    &#125;\n    \n    public void service(ServletRequest request, ServletResponse response)\n            throws ServletException, IOException &#123;\n        System.out.println(&quot;From service&quot;);\n        PrintWriter out = response.getWriter();\n        out.println(&quot;Hello, Java Web.&quot;);\n    &#125;\n    \n    public void destroy() &#123;\n        System.out.println(&quot;Destroy&quot;);\n    &#125;\n    public String getServletInfo() &#123;\n        return null;\n    &#125;\n    \n    public ServletConfig getServletConfig() &#123;\n        return null;\n    &#125;\n\n\n&#125;\n</code></pre>\n<h2 id=\"3-2-GenericServlet抽象类\"><a href=\"#3-2-GenericServlet抽象类\" class=\"headerlink\" title=\"3.2 GenericServlet抽象类\"></a>3.2 GenericServlet抽象类</h2><p>GenericServlet使编写Servlet变得更容易。<br>它提生命周期方法init和destroy的简单实现，要编写一般的Servlet，只需要重写service方法即可。</p>\n<pre><code>import javax.servlet.GenericServlet;\npublic class classname extends GenericServlet&#123;\n&#125;     \n</code></pre>\n<h2 id=\"3-2-HttpServlet类\"><a href=\"#3-2-HttpServlet类\" class=\"headerlink\" title=\"3.2 HttpServlet类\"></a>3.2 HttpServlet类</h2><p>HttpServlet是在继承GenericServlet的基础上进一步的扩展。<br>提供将要被子类化以创建适用于Web站点的HTTP servlet的抽象类<br>要重写doGet和doPost方法</p>\n<p>HTTPServlet的子类至少必须重写一个方法，该方法通常是：</p>\n<p>doGet()：用于HTTP GET请求</p>\n<p>doPost()：用于HTTP POST请求</p>\n<p>doPut()：用于HTTP PUT请求</p>\n<p>doDelete()：用于HTTP DELETE请求</p>\n<pre><code>import javax.servlet.http.HttpServlet; \npublic class classname extends HttpServlet&#123;\n\n&#125;   \n</code></pre>\n"},{"title":"linux-fail2ban软件使用","abbrlink":"f44631de","date":"2023-07-09T06:19:39.000Z","_content":"# 简介\n    \n    CentOS 中使用fail2ban和firewalld限制IP拦截cc攻击\n    \n# 安装\n\n    yum -y install fail2ban\n    \n    \n# 新建规则\n    \n    /etc/fail2ban/filter.d/  编写过滤规则的目录 \n\n    vi /etc/fail2ban/filter.d/nginx-cc.conf\n    \n    [Definition]\n    #failregex = <HOST>-.*-.*HTTP/1.*(404|301|503).*$\n    failregex = ^<HOST> -.*\"(GET|POST).* HTTP\\/.*$\n    ignoreregex =\n\n# 正则规则检查\n\n    fail2ban-regex /var/log/nginx/access.log \"<HOST> -.*- .*HTTP/1.* .* .*$\"  \n    \n# 根据配置文件检查\n\n    fail2ban-regex /var/log/nginx/access.log /etc/fail2ban/filter.d/nginx-cc.conf  \n\n# 控制规则配置文件\n\n    [DEFAULT]\n    ignoreip = 127.0.0.1/8  117.89.130.84 117.89.134.183/16  218.2.244.241/16 49.82.132.215/16 122.195.252.237/16 114.238.64.157/16 180.110.114.152/16\n    #放行的ip 可以带网段\n    ignorecommand =\n    bantime  = 60\n    #屏蔽时间，-1是永久屏蔽\n    findtime  = 60\n    #设置限定时间内超过 最大尝试次数 限制次数即被封锁\n    maxretry = 5\n    #最大尝试次数\n    backend = auto\n    #日志修改后检测机制\n    usedns = warn\n    #ssh链接加速\n    logencoding = auto\n    enabled = false\n    [sshd]\n    ## 分类设置（基于 SSHD 服务的防护） \n    enabled = true\n    ## 是否开启防护，false 为关闭 \n    filter = sshd\n    ## 过滤规则 filter 名称，对应 filter.d 目录下的 sshd.conf  action   = iptables[name=SSH, port=22, protocol=tcp] \n    #《###action = iptables[name=SSH, port=ssh, protocol=tcp] ## 动作参数\n    #sendmail-whois[name=SSH, dest=you@example.com, sender=fail2ban@example.com,   sendername=\"Fail2Ban\"]\n    ## 邮件通知参数\n    ## 收件人地址           ## 发件人地址####》   这是个例子 \n    logpath = /var/log/secure\n    ## 检测系统登陆日志文件 \n    maxretry = 3\n    ## 最大尝试次数\n    banaction=iptables-allports\n    bantime = 3600\n    [nginx-cc] \n    #过滤规则名称 下方就是 规律规则 相关 限制条件\n    enabled = true\n    port=http,https\n    filter = nginx-cc\n    findtime = 1\n    #1秒钟检查一次\n    maxretry = 100\n    #最多100个\n    bantime = 3600\n    #封锁ip的时间\n    banaction=iptables-multiport\n    #匹配的哪些日志文件\n    logpath = /var/log/nginx/*access.log\n              /var/log/nginx/access.log\n\n# 常用命令\n\n    #启动\n    systemctl start fail2ban\n    #停止\n    systemctl stop fail2ban\n    \n    #查看具体规则限制了哪些ip\n    fail2ban-client status 规则名称\n    示例：   fail2ban-client status nginx-cc\n    \n    #解封某条过滤规则封锁的ip\n    fail2ban-client set nginx-cc unbanip  112.84.237.102\n    ","source":"_posts/linux-fail2ban软件使用.md","raw":"---\ntitle: linux-fail2ban软件使用\nabbrlink: f44631de\ncategories:\n  - 服务器相关\ndate: 2023-07-09 14:19:39\ntags:\n  - linux\n---\n# 简介\n    \n    CentOS 中使用fail2ban和firewalld限制IP拦截cc攻击\n    \n# 安装\n\n    yum -y install fail2ban\n    \n    \n# 新建规则\n    \n    /etc/fail2ban/filter.d/  编写过滤规则的目录 \n\n    vi /etc/fail2ban/filter.d/nginx-cc.conf\n    \n    [Definition]\n    #failregex = <HOST>-.*-.*HTTP/1.*(404|301|503).*$\n    failregex = ^<HOST> -.*\"(GET|POST).* HTTP\\/.*$\n    ignoreregex =\n\n# 正则规则检查\n\n    fail2ban-regex /var/log/nginx/access.log \"<HOST> -.*- .*HTTP/1.* .* .*$\"  \n    \n# 根据配置文件检查\n\n    fail2ban-regex /var/log/nginx/access.log /etc/fail2ban/filter.d/nginx-cc.conf  \n\n# 控制规则配置文件\n\n    [DEFAULT]\n    ignoreip = 127.0.0.1/8  117.89.130.84 117.89.134.183/16  218.2.244.241/16 49.82.132.215/16 122.195.252.237/16 114.238.64.157/16 180.110.114.152/16\n    #放行的ip 可以带网段\n    ignorecommand =\n    bantime  = 60\n    #屏蔽时间，-1是永久屏蔽\n    findtime  = 60\n    #设置限定时间内超过 最大尝试次数 限制次数即被封锁\n    maxretry = 5\n    #最大尝试次数\n    backend = auto\n    #日志修改后检测机制\n    usedns = warn\n    #ssh链接加速\n    logencoding = auto\n    enabled = false\n    [sshd]\n    ## 分类设置（基于 SSHD 服务的防护） \n    enabled = true\n    ## 是否开启防护，false 为关闭 \n    filter = sshd\n    ## 过滤规则 filter 名称，对应 filter.d 目录下的 sshd.conf  action   = iptables[name=SSH, port=22, protocol=tcp] \n    #《###action = iptables[name=SSH, port=ssh, protocol=tcp] ## 动作参数\n    #sendmail-whois[name=SSH, dest=you@example.com, sender=fail2ban@example.com,   sendername=\"Fail2Ban\"]\n    ## 邮件通知参数\n    ## 收件人地址           ## 发件人地址####》   这是个例子 \n    logpath = /var/log/secure\n    ## 检测系统登陆日志文件 \n    maxretry = 3\n    ## 最大尝试次数\n    banaction=iptables-allports\n    bantime = 3600\n    [nginx-cc] \n    #过滤规则名称 下方就是 规律规则 相关 限制条件\n    enabled = true\n    port=http,https\n    filter = nginx-cc\n    findtime = 1\n    #1秒钟检查一次\n    maxretry = 100\n    #最多100个\n    bantime = 3600\n    #封锁ip的时间\n    banaction=iptables-multiport\n    #匹配的哪些日志文件\n    logpath = /var/log/nginx/*access.log\n              /var/log/nginx/access.log\n\n# 常用命令\n\n    #启动\n    systemctl start fail2ban\n    #停止\n    systemctl stop fail2ban\n    \n    #查看具体规则限制了哪些ip\n    fail2ban-client status 规则名称\n    示例：   fail2ban-client status nginx-cc\n    \n    #解封某条过滤规则封锁的ip\n    fail2ban-client set nginx-cc unbanip  112.84.237.102\n    ","slug":"linux-fail2ban软件使用","published":1,"updated":"2024-11-25T11:15:20.538Z","_id":"cm04ukh6g00074koc74dt6708","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><pre><code>CentOS 中使用fail2ban和firewalld限制IP拦截cc攻击\n</code></pre>\n<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><pre><code>yum -y install fail2ban\n</code></pre>\n<h1 id=\"新建规则\"><a href=\"#新建规则\" class=\"headerlink\" title=\"新建规则\"></a>新建规则</h1><pre><code>/etc/fail2ban/filter.d/  编写过滤规则的目录 \n\nvi /etc/fail2ban/filter.d/nginx-cc.conf\n\n[Definition]\n#failregex = &lt;HOST&gt;-.*-.*HTTP/1.*(404|301|503).*$\nfailregex = ^&lt;HOST&gt; -.*&quot;(GET|POST).* HTTP\\/.*$\nignoreregex =\n</code></pre>\n<h1 id=\"正则规则检查\"><a href=\"#正则规则检查\" class=\"headerlink\" title=\"正则规则检查\"></a>正则规则检查</h1><pre><code>fail2ban-regex /var/log/nginx/access.log &quot;&lt;HOST&gt; -.*- .*HTTP/1.* .* .*$&quot;  \n</code></pre>\n<h1 id=\"根据配置文件检查\"><a href=\"#根据配置文件检查\" class=\"headerlink\" title=\"根据配置文件检查\"></a>根据配置文件检查</h1><pre><code>fail2ban-regex /var/log/nginx/access.log /etc/fail2ban/filter.d/nginx-cc.conf  \n</code></pre>\n<h1 id=\"控制规则配置文件\"><a href=\"#控制规则配置文件\" class=\"headerlink\" title=\"控制规则配置文件\"></a>控制规则配置文件</h1><pre><code>[DEFAULT]\nignoreip = 127.0.0.1/8  117.89.130.84 117.89.134.183/16  218.2.244.241/16 49.82.132.215/16 122.195.252.237/16 114.238.64.157/16 180.110.114.152/16\n#放行的ip 可以带网段\nignorecommand =\nbantime  = 60\n#屏蔽时间，-1是永久屏蔽\nfindtime  = 60\n#设置限定时间内超过 最大尝试次数 限制次数即被封锁\nmaxretry = 5\n#最大尝试次数\nbackend = auto\n#日志修改后检测机制\nusedns = warn\n#ssh链接加速\nlogencoding = auto\nenabled = false\n[sshd]\n## 分类设置（基于 SSHD 服务的防护） \nenabled = true\n## 是否开启防护，false 为关闭 \nfilter = sshd\n## 过滤规则 filter 名称，对应 filter.d 目录下的 sshd.conf  action   = iptables[name=SSH, port=22, protocol=tcp] \n#《###action = iptables[name=SSH, port=ssh, protocol=tcp] ## 动作参数\n#sendmail-whois[name=SSH, dest=you@example.com, sender=fail2ban@example.com,   sendername=&quot;Fail2Ban&quot;]\n## 邮件通知参数\n## 收件人地址           ## 发件人地址####》   这是个例子 \nlogpath = /var/log/secure\n## 检测系统登陆日志文件 \nmaxretry = 3\n## 最大尝试次数\nbanaction=iptables-allports\nbantime = 3600\n[nginx-cc] \n#过滤规则名称 下方就是 规律规则 相关 限制条件\nenabled = true\nport=http,https\nfilter = nginx-cc\nfindtime = 1\n#1秒钟检查一次\nmaxretry = 100\n#最多100个\nbantime = 3600\n#封锁ip的时间\nbanaction=iptables-multiport\n#匹配的哪些日志文件\nlogpath = /var/log/nginx/*access.log\n          /var/log/nginx/access.log\n</code></pre>\n<h1 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h1><pre><code>#启动\nsystemctl start fail2ban\n#停止\nsystemctl stop fail2ban\n\n#查看具体规则限制了哪些ip\nfail2ban-client status 规则名称\n示例：   fail2ban-client status nginx-cc\n\n#解封某条过滤规则封锁的ip\nfail2ban-client set nginx-cc unbanip  112.84.237.102\n</code></pre>\n","site":{"data":{}},"length":1607,"excerpt":"","more":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><pre><code>CentOS 中使用fail2ban和firewalld限制IP拦截cc攻击\n</code></pre>\n<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><pre><code>yum -y install fail2ban\n</code></pre>\n<h1 id=\"新建规则\"><a href=\"#新建规则\" class=\"headerlink\" title=\"新建规则\"></a>新建规则</h1><pre><code>/etc/fail2ban/filter.d/  编写过滤规则的目录 \n\nvi /etc/fail2ban/filter.d/nginx-cc.conf\n\n[Definition]\n#failregex = &lt;HOST&gt;-.*-.*HTTP/1.*(404|301|503).*$\nfailregex = ^&lt;HOST&gt; -.*&quot;(GET|POST).* HTTP\\/.*$\nignoreregex =\n</code></pre>\n<h1 id=\"正则规则检查\"><a href=\"#正则规则检查\" class=\"headerlink\" title=\"正则规则检查\"></a>正则规则检查</h1><pre><code>fail2ban-regex /var/log/nginx/access.log &quot;&lt;HOST&gt; -.*- .*HTTP/1.* .* .*$&quot;  \n</code></pre>\n<h1 id=\"根据配置文件检查\"><a href=\"#根据配置文件检查\" class=\"headerlink\" title=\"根据配置文件检查\"></a>根据配置文件检查</h1><pre><code>fail2ban-regex /var/log/nginx/access.log /etc/fail2ban/filter.d/nginx-cc.conf  \n</code></pre>\n<h1 id=\"控制规则配置文件\"><a href=\"#控制规则配置文件\" class=\"headerlink\" title=\"控制规则配置文件\"></a>控制规则配置文件</h1><pre><code>[DEFAULT]\nignoreip = 127.0.0.1/8  117.89.130.84 117.89.134.183/16  218.2.244.241/16 49.82.132.215/16 122.195.252.237/16 114.238.64.157/16 180.110.114.152/16\n#放行的ip 可以带网段\nignorecommand =\nbantime  = 60\n#屏蔽时间，-1是永久屏蔽\nfindtime  = 60\n#设置限定时间内超过 最大尝试次数 限制次数即被封锁\nmaxretry = 5\n#最大尝试次数\nbackend = auto\n#日志修改后检测机制\nusedns = warn\n#ssh链接加速\nlogencoding = auto\nenabled = false\n[sshd]\n## 分类设置（基于 SSHD 服务的防护） \nenabled = true\n## 是否开启防护，false 为关闭 \nfilter = sshd\n## 过滤规则 filter 名称，对应 filter.d 目录下的 sshd.conf  action   = iptables[name=SSH, port=22, protocol=tcp] \n#《###action = iptables[name=SSH, port=ssh, protocol=tcp] ## 动作参数\n#sendmail-whois[name=SSH, dest=you@example.com, sender=fail2ban@example.com,   sendername=&quot;Fail2Ban&quot;]\n## 邮件通知参数\n## 收件人地址           ## 发件人地址####》   这是个例子 \nlogpath = /var/log/secure\n## 检测系统登陆日志文件 \nmaxretry = 3\n## 最大尝试次数\nbanaction=iptables-allports\nbantime = 3600\n[nginx-cc] \n#过滤规则名称 下方就是 规律规则 相关 限制条件\nenabled = true\nport=http,https\nfilter = nginx-cc\nfindtime = 1\n#1秒钟检查一次\nmaxretry = 100\n#最多100个\nbantime = 3600\n#封锁ip的时间\nbanaction=iptables-multiport\n#匹配的哪些日志文件\nlogpath = /var/log/nginx/*access.log\n          /var/log/nginx/access.log\n</code></pre>\n<h1 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h1><pre><code>#启动\nsystemctl start fail2ban\n#停止\nsystemctl stop fail2ban\n\n#查看具体规则限制了哪些ip\nfail2ban-client status 规则名称\n示例：   fail2ban-client status nginx-cc\n\n#解封某条过滤规则封锁的ip\nfail2ban-client set nginx-cc unbanip  112.84.237.102\n</code></pre>\n"},{"title":"linux-logrotate日志切割","abbrlink":"a61dc71f","date":"2023-07-19T01:14:27.000Z","_content":"# 一、logrotate介绍\n    \nlogrotate是centos自带命令，其他linux操作系统可能需要自行安装，用来进行日志切割和定期删除，\n\n简单来说就是将某个日志文件按照时间或大小分割成多份，删除时间久远的日志。\n\n# 一、安装\n\n    yum install -y logrotate     #centos 系统\n    \n    apt install -y logrotate    #ubuntu 系统\n    \n    \n# 二、配置  \n\n/etc/logrotate.conf是全局配置\n\n    #指定日志文件保留几个副本\n    rotate 4\n    \n    # 指定当发生滚动后，创建一个新的空日志文件（权限不变）\n    create\n    \n    # 指定滚动文件的后缀是当前的日期\n    dateext  \n    \n    # 指定是否对滚动日志进行压缩\n    #compress\n    \n    # 加载子配置\n    include /etc/logrotate.d\n    \n    # 指定对特定文件的滚动规则\n    /var/log/wtmp {\n        monthly\n        create 0664 root utmp\n        minsize 1M  #指定文件小于1m就不滚动\n        rotate 1\n    }\n    \n    /var/log/btmp {\n        missingok\n        monthly\n        create 0600 root utmp\n        rotate 1\n    }\n\n/etc/logrotate.d/*（子配置）\n\n\n\n# 三、执行\n\n方案一\n    通过 /etc/cron.daily/logrotate 配置\n方案二\n    crontab -e写入，内容为“  59 23 * * * /usr/sbin/logrotate -f /home/zmq/daily_logrotate  \n\n\n# 四、具体的配置文件\n\n    /var/log/nginx/*.log {\n              daily\n              missingok\n              rotate 52\n              compress\n              delaycompress\n              notifempty\n              create 640 nginx adm\n              sharedscripts\n              postrotate\n                     if [ -f /var/run/nginx.pid ]; then\n                             kill -USR1 `cat /var/run/nginx.pid`\n                     fi\n              endscript\n     }\n     \n     \n     \n     /var/opt/remi/php71/log/php-fpm/*log {\n            missingok\n            notifempty\n            sharedscripts\n            delaycompress\n            postrotate\n                /bin/kill -SIGUSR1 `cat /var/opt/remi/php71/run/php-fpm/php-fpm.pid 2>/dev/null` 2>/dev/null ||     true\n            endscript\n      }\n","source":"_posts/linux-logrotate日志切割.md","raw":"---\ntitle: linux-logrotate日志切割\nabbrlink: a61dc71f\ncategories:\n  - 服务器相关\ndate: 2023-07-19 09:14:27\ntags:\n  - linux\n---\n# 一、logrotate介绍\n    \nlogrotate是centos自带命令，其他linux操作系统可能需要自行安装，用来进行日志切割和定期删除，\n\n简单来说就是将某个日志文件按照时间或大小分割成多份，删除时间久远的日志。\n\n# 一、安装\n\n    yum install -y logrotate     #centos 系统\n    \n    apt install -y logrotate    #ubuntu 系统\n    \n    \n# 二、配置  \n\n/etc/logrotate.conf是全局配置\n\n    #指定日志文件保留几个副本\n    rotate 4\n    \n    # 指定当发生滚动后，创建一个新的空日志文件（权限不变）\n    create\n    \n    # 指定滚动文件的后缀是当前的日期\n    dateext  \n    \n    # 指定是否对滚动日志进行压缩\n    #compress\n    \n    # 加载子配置\n    include /etc/logrotate.d\n    \n    # 指定对特定文件的滚动规则\n    /var/log/wtmp {\n        monthly\n        create 0664 root utmp\n        minsize 1M  #指定文件小于1m就不滚动\n        rotate 1\n    }\n    \n    /var/log/btmp {\n        missingok\n        monthly\n        create 0600 root utmp\n        rotate 1\n    }\n\n/etc/logrotate.d/*（子配置）\n\n\n\n# 三、执行\n\n方案一\n    通过 /etc/cron.daily/logrotate 配置\n方案二\n    crontab -e写入，内容为“  59 23 * * * /usr/sbin/logrotate -f /home/zmq/daily_logrotate  \n\n\n# 四、具体的配置文件\n\n    /var/log/nginx/*.log {\n              daily\n              missingok\n              rotate 52\n              compress\n              delaycompress\n              notifempty\n              create 640 nginx adm\n              sharedscripts\n              postrotate\n                     if [ -f /var/run/nginx.pid ]; then\n                             kill -USR1 `cat /var/run/nginx.pid`\n                     fi\n              endscript\n     }\n     \n     \n     \n     /var/opt/remi/php71/log/php-fpm/*log {\n            missingok\n            notifempty\n            sharedscripts\n            delaycompress\n            postrotate\n                /bin/kill -SIGUSR1 `cat /var/opt/remi/php71/run/php-fpm/php-fpm.pid 2>/dev/null` 2>/dev/null ||     true\n            endscript\n      }\n","slug":"linux-logrotate日志切割","published":1,"updated":"2024-11-25T11:15:44.649Z","_id":"cm04ukh6i00094kocemjuhft4","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、logrotate介绍\"><a href=\"#一、logrotate介绍\" class=\"headerlink\" title=\"一、logrotate介绍\"></a>一、logrotate介绍</h1><p>logrotate是centos自带命令，其他linux操作系统可能需要自行安装，用来进行日志切割和定期删除，</p>\n<p>简单来说就是将某个日志文件按照时间或大小分割成多份，删除时间久远的日志。</p>\n<h1 id=\"一、安装\"><a href=\"#一、安装\" class=\"headerlink\" title=\"一、安装\"></a>一、安装</h1><pre><code>yum install -y logrotate     #centos 系统\n\napt install -y logrotate    #ubuntu 系统\n</code></pre>\n<h1 id=\"二、配置\"><a href=\"#二、配置\" class=\"headerlink\" title=\"二、配置\"></a>二、配置</h1><p>/etc/logrotate.conf是全局配置</p>\n<pre><code>#指定日志文件保留几个副本\nrotate 4\n\n# 指定当发生滚动后，创建一个新的空日志文件（权限不变）\ncreate\n\n# 指定滚动文件的后缀是当前的日期\ndateext  \n\n# 指定是否对滚动日志进行压缩\n#compress\n\n# 加载子配置\ninclude /etc/logrotate.d\n\n# 指定对特定文件的滚动规则\n/var/log/wtmp &#123;\n    monthly\n    create 0664 root utmp\n    minsize 1M  #指定文件小于1m就不滚动\n    rotate 1\n&#125;\n\n/var/log/btmp &#123;\n    missingok\n    monthly\n    create 0600 root utmp\n    rotate 1\n&#125;\n</code></pre>\n<p>/etc/logrotate.d/*（子配置）</p>\n<h1 id=\"三、执行\"><a href=\"#三、执行\" class=\"headerlink\" title=\"三、执行\"></a>三、执行</h1><p>方案一<br>    通过 /etc/cron.daily/logrotate 配置<br>方案二<br>    crontab -e写入，内容为“  59 23 * * * /usr/sbin/logrotate -f /home/zmq/daily_logrotate  </p>\n<h1 id=\"四、具体的配置文件\"><a href=\"#四、具体的配置文件\" class=\"headerlink\" title=\"四、具体的配置文件\"></a>四、具体的配置文件</h1><pre><code>/var/log/nginx/*.log &#123;\n          daily\n          missingok\n          rotate 52\n          compress\n          delaycompress\n          notifempty\n          create 640 nginx adm\n          sharedscripts\n          postrotate\n                 if [ -f /var/run/nginx.pid ]; then\n                         kill -USR1 `cat /var/run/nginx.pid`\n                 fi\n          endscript\n &#125;\n \n \n \n /var/opt/remi/php71/log/php-fpm/*log &#123;\n        missingok\n        notifempty\n        sharedscripts\n        delaycompress\n        postrotate\n            /bin/kill -SIGUSR1 `cat /var/opt/remi/php71/run/php-fpm/php-fpm.pid 2&gt;/dev/null` 2&gt;/dev/null ||     true\n        endscript\n  &#125;\n</code></pre>\n","site":{"data":{}},"length":1030,"excerpt":"","more":"<h1 id=\"一、logrotate介绍\"><a href=\"#一、logrotate介绍\" class=\"headerlink\" title=\"一、logrotate介绍\"></a>一、logrotate介绍</h1><p>logrotate是centos自带命令，其他linux操作系统可能需要自行安装，用来进行日志切割和定期删除，</p>\n<p>简单来说就是将某个日志文件按照时间或大小分割成多份，删除时间久远的日志。</p>\n<h1 id=\"一、安装\"><a href=\"#一、安装\" class=\"headerlink\" title=\"一、安装\"></a>一、安装</h1><pre><code>yum install -y logrotate     #centos 系统\n\napt install -y logrotate    #ubuntu 系统\n</code></pre>\n<h1 id=\"二、配置\"><a href=\"#二、配置\" class=\"headerlink\" title=\"二、配置\"></a>二、配置</h1><p>/etc/logrotate.conf是全局配置</p>\n<pre><code>#指定日志文件保留几个副本\nrotate 4\n\n# 指定当发生滚动后，创建一个新的空日志文件（权限不变）\ncreate\n\n# 指定滚动文件的后缀是当前的日期\ndateext  \n\n# 指定是否对滚动日志进行压缩\n#compress\n\n# 加载子配置\ninclude /etc/logrotate.d\n\n# 指定对特定文件的滚动规则\n/var/log/wtmp &#123;\n    monthly\n    create 0664 root utmp\n    minsize 1M  #指定文件小于1m就不滚动\n    rotate 1\n&#125;\n\n/var/log/btmp &#123;\n    missingok\n    monthly\n    create 0600 root utmp\n    rotate 1\n&#125;\n</code></pre>\n<p>/etc/logrotate.d/*（子配置）</p>\n<h1 id=\"三、执行\"><a href=\"#三、执行\" class=\"headerlink\" title=\"三、执行\"></a>三、执行</h1><p>方案一<br>    通过 /etc/cron.daily/logrotate 配置<br>方案二<br>    crontab -e写入，内容为“  59 23 * * * /usr/sbin/logrotate -f /home/zmq/daily_logrotate  </p>\n<h1 id=\"四、具体的配置文件\"><a href=\"#四、具体的配置文件\" class=\"headerlink\" title=\"四、具体的配置文件\"></a>四、具体的配置文件</h1><pre><code>/var/log/nginx/*.log &#123;\n          daily\n          missingok\n          rotate 52\n          compress\n          delaycompress\n          notifempty\n          create 640 nginx adm\n          sharedscripts\n          postrotate\n                 if [ -f /var/run/nginx.pid ]; then\n                         kill -USR1 `cat /var/run/nginx.pid`\n                 fi\n          endscript\n &#125;\n \n \n \n /var/opt/remi/php71/log/php-fpm/*log &#123;\n        missingok\n        notifempty\n        sharedscripts\n        delaycompress\n        postrotate\n            /bin/kill -SIGUSR1 `cat /var/opt/remi/php71/run/php-fpm/php-fpm.pid 2&gt;/dev/null` 2&gt;/dev/null ||     true\n        endscript\n  &#125;\n</code></pre>\n"},{"title":"搭建 nginx_server","abbrlink":"fa953e4f","date":"2022-04-17T14:53:07.000Z","_content":"\n# 安装nginx\n\n## 1.yum 安装（默认情况下使用yum安装的nginx包含ssl模块）\n        \n        官方 yum 源链接 http://nginx.org/en/linux_packages.html#RHEL-CentOS\n        \n        vim /etc/yum.repos.d/nginx.repo\n        ```\n        [nginx-stable]\n        name=nginx stable repo\n        baseurl=http://nginx.org/packages/centos/$releasever/$basearch/\n        gpgcheck=1\n        enabled=1\n        gpgkey=https://nginx.org/keys/nginx_signing.key\n        module_hotfixes=true\n        \n        [nginx-mainline]\n        name=nginx mainline repo\n        baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/\n        gpgcheck=1\n        enabled=0\n        gpgkey=https://nginx.org/keys/nginx_signing.key\n        module_hotfixes=true\n        ```\n        \n        yum-config-manager --enable nginx-stable\n        \n        yum install nginx\n\n\n## 2.源码编译安装\n\n    下载源码包  http://nginx.org/en/download.html  下载稳定版本\n    \n    Mainline version：Mainline 是 Nginx 目前主力在做的版本，可以说是开发版\n    Stable version：最新稳定版，生产环境上建议使用的版本\n    Legacy versions：遗留的老版本的稳定版\n    \n    下载命令\n    wget http://nginx.org/download/nginx-1.22.0.tar.gz\n    \n    解压缩\n    tar -zxvf nginx-1.22.0.tar.gz\n        \n     ./configure --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-pcre\n     \n     make && make install\n     \n     ln -s /usr/local/nginx/conf  /etc/nginx\n     \n     \n     \n# 配置服务\n\n    vim /lib/systemd/system/nginx.service     \n         \n     ```\n    [Unit]\n    Description=nginx\n    After=network.target\n    \n    [Service]\n    Type=forking\n    ExecStart=/usr/local/nginx/sbin/nginx\n    ExecReload=/usr/local/nginx/sbin/nginx -s reload\n    ExecStop=/usr/local/nginx/sbin/nginx -s quit\n    PrivateTmp=true\n    \n    [Install]\n    WantedBy=multi-user.target\n    ```\n    \n    软连接etc目录\n    ln -s /usr/local/nginx/conf /etc/nginx   \n    \n    systemctl status nginx\n    systemctl reload nginx\n    systemctl start nginx\n    \n    开机启动\n    systemctl enable nginx\n    \n    添加用户\n    groupadd www\n    useradd -g www -s /sbin/nologin www  \n    \n# 配置文件  \n###### /etc/nginx/nginx.conf \n       \n ```\n    user  www;\n    #cpu 几核 这进程就多少\n    worker_processes  2;\n    worker_cpu_affinity 01 10;\n    \n    worker_rlimit_nofile 65535;  # 一般等于ulimit -n系统值\n    \n    #error_log  logs/error.log;\n    #error_log  logs/error.log  notice;\n    #error_log  logs/error.log  info;\n    \n    #pid        logs/nginx.pid;\n    \n    \n    events {\n        worker_connections  10240;\n        use epoll;\n    }\n    \n    \n    http {\n        include       mime.types;\n        default_type  application/octet-stream;\n        server_tokens off;\n    \n        #log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n        #                  '$status $body_bytes_sent \"$http_referer\" '\n        #                  '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n    \n        #access_log  logs/access.log  main;\n    \n        sendfile        on;\n        #tcp_nopush     on;\n    \n        #keepalive_timeout  0;\n        keepalive_timeout  65;\n    \n        gzip on;       #表示开启压缩功能\n        gzip_min_length  1k; #表示允许压缩的页面最小字节数，页面字节数从header头的Content-Length中获取。默认值是0，表示不管页面多大都进行压缩，建议设置成大于1K。如果小于1K可能会>越压越大\n        gzip_buffers     4 32k; #压缩缓存区大小\n        gzip_http_version 1.1; #压缩版本\n        gzip_comp_level 6; #压缩比率， 一般选择4-6，为了性能\n        gzip_types text/css text/xml application/javascript;\n        #指定压缩的类型 gzip_vary on;　#vary header支持\n    \n    \n        #配置空主机头 404\n        server {\n            listen 80 default;\n            server_name _;\n            root html;\n            location / { return 404;}\n            location ~ /.ht { deny all; }\n    \n        }\n        include vhost/*.conf;\n    }\n```  \n \n    \n###### vhost/*.conf   \n\n    server{\n        listen 80;\n        server_name tp.webstudy.cc;\n        set $wwwroot /home/www/htdocs/tp.webstudy.cc;\n        root $wwwroot;\n        access_log  logs/ai.access.log;\n        error_log logs/ai.error.log debug;\n\n        #ssl_certificate     /usr/local/nginx/conf/ssl/jinju.utooo.com/Nginx/1_jinju.utooo.com_bundle.crt;\n        #ssl_certificate_key /usr/local/nginx/conf/ssl/jinju.utooo.com/Nginx/2_jinju.utooo.com.key;\n        #ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n        location / {\n            index  index.php index.html index.htm;\n            # 这里使用try_files进行url重写，不用rewrite了\n            # try_files $uri $uri/ /index.php?$query_string;\n        }\n\n       #error_page   500 502 503 504  /50x.html;\n       location = /50x.html {\n            root   html;\n        }\n        location ~ .*\\.php{\n                include fastcgi_params;\n                fastcgi_param SCRIPT_FILENAME   $document_root$fastcgi_script_name;\n                fastcgi_pass 127.0.0.1:9000;\n                fastcgi_index index.php;\n        }\n\n    }\n   \n    \n      \n","source":"_posts/linux-nginx服务搭建.md","raw":"---\ntitle: 搭建 nginx_server\ncategories:\n  - 服务器相关\nabbrlink: fa953e4f\ndate: 2022-04-17 22:53:07\ntags:\n  - linux\n---\n\n# 安装nginx\n\n## 1.yum 安装（默认情况下使用yum安装的nginx包含ssl模块）\n        \n        官方 yum 源链接 http://nginx.org/en/linux_packages.html#RHEL-CentOS\n        \n        vim /etc/yum.repos.d/nginx.repo\n        ```\n        [nginx-stable]\n        name=nginx stable repo\n        baseurl=http://nginx.org/packages/centos/$releasever/$basearch/\n        gpgcheck=1\n        enabled=1\n        gpgkey=https://nginx.org/keys/nginx_signing.key\n        module_hotfixes=true\n        \n        [nginx-mainline]\n        name=nginx mainline repo\n        baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/\n        gpgcheck=1\n        enabled=0\n        gpgkey=https://nginx.org/keys/nginx_signing.key\n        module_hotfixes=true\n        ```\n        \n        yum-config-manager --enable nginx-stable\n        \n        yum install nginx\n\n\n## 2.源码编译安装\n\n    下载源码包  http://nginx.org/en/download.html  下载稳定版本\n    \n    Mainline version：Mainline 是 Nginx 目前主力在做的版本，可以说是开发版\n    Stable version：最新稳定版，生产环境上建议使用的版本\n    Legacy versions：遗留的老版本的稳定版\n    \n    下载命令\n    wget http://nginx.org/download/nginx-1.22.0.tar.gz\n    \n    解压缩\n    tar -zxvf nginx-1.22.0.tar.gz\n        \n     ./configure --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-pcre\n     \n     make && make install\n     \n     ln -s /usr/local/nginx/conf  /etc/nginx\n     \n     \n     \n# 配置服务\n\n    vim /lib/systemd/system/nginx.service     \n         \n     ```\n    [Unit]\n    Description=nginx\n    After=network.target\n    \n    [Service]\n    Type=forking\n    ExecStart=/usr/local/nginx/sbin/nginx\n    ExecReload=/usr/local/nginx/sbin/nginx -s reload\n    ExecStop=/usr/local/nginx/sbin/nginx -s quit\n    PrivateTmp=true\n    \n    [Install]\n    WantedBy=multi-user.target\n    ```\n    \n    软连接etc目录\n    ln -s /usr/local/nginx/conf /etc/nginx   \n    \n    systemctl status nginx\n    systemctl reload nginx\n    systemctl start nginx\n    \n    开机启动\n    systemctl enable nginx\n    \n    添加用户\n    groupadd www\n    useradd -g www -s /sbin/nologin www  \n    \n# 配置文件  \n###### /etc/nginx/nginx.conf \n       \n ```\n    user  www;\n    #cpu 几核 这进程就多少\n    worker_processes  2;\n    worker_cpu_affinity 01 10;\n    \n    worker_rlimit_nofile 65535;  # 一般等于ulimit -n系统值\n    \n    #error_log  logs/error.log;\n    #error_log  logs/error.log  notice;\n    #error_log  logs/error.log  info;\n    \n    #pid        logs/nginx.pid;\n    \n    \n    events {\n        worker_connections  10240;\n        use epoll;\n    }\n    \n    \n    http {\n        include       mime.types;\n        default_type  application/octet-stream;\n        server_tokens off;\n    \n        #log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n        #                  '$status $body_bytes_sent \"$http_referer\" '\n        #                  '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n    \n        #access_log  logs/access.log  main;\n    \n        sendfile        on;\n        #tcp_nopush     on;\n    \n        #keepalive_timeout  0;\n        keepalive_timeout  65;\n    \n        gzip on;       #表示开启压缩功能\n        gzip_min_length  1k; #表示允许压缩的页面最小字节数，页面字节数从header头的Content-Length中获取。默认值是0，表示不管页面多大都进行压缩，建议设置成大于1K。如果小于1K可能会>越压越大\n        gzip_buffers     4 32k; #压缩缓存区大小\n        gzip_http_version 1.1; #压缩版本\n        gzip_comp_level 6; #压缩比率， 一般选择4-6，为了性能\n        gzip_types text/css text/xml application/javascript;\n        #指定压缩的类型 gzip_vary on;　#vary header支持\n    \n    \n        #配置空主机头 404\n        server {\n            listen 80 default;\n            server_name _;\n            root html;\n            location / { return 404;}\n            location ~ /.ht { deny all; }\n    \n        }\n        include vhost/*.conf;\n    }\n```  \n \n    \n###### vhost/*.conf   \n\n    server{\n        listen 80;\n        server_name tp.webstudy.cc;\n        set $wwwroot /home/www/htdocs/tp.webstudy.cc;\n        root $wwwroot;\n        access_log  logs/ai.access.log;\n        error_log logs/ai.error.log debug;\n\n        #ssl_certificate     /usr/local/nginx/conf/ssl/jinju.utooo.com/Nginx/1_jinju.utooo.com_bundle.crt;\n        #ssl_certificate_key /usr/local/nginx/conf/ssl/jinju.utooo.com/Nginx/2_jinju.utooo.com.key;\n        #ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n        location / {\n            index  index.php index.html index.htm;\n            # 这里使用try_files进行url重写，不用rewrite了\n            # try_files $uri $uri/ /index.php?$query_string;\n        }\n\n       #error_page   500 502 503 504  /50x.html;\n       location = /50x.html {\n            root   html;\n        }\n        location ~ .*\\.php{\n                include fastcgi_params;\n                fastcgi_param SCRIPT_FILENAME   $document_root$fastcgi_script_name;\n                fastcgi_pass 127.0.0.1:9000;\n                fastcgi_index index.php;\n        }\n\n    }\n   \n    \n      \n","slug":"linux-nginx服务搭建","published":1,"updated":"2024-11-25T11:15:52.211Z","_id":"cm04ukh6k000a4koc9jwc4lbn","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"安装nginx\"><a href=\"#安装nginx\" class=\"headerlink\" title=\"安装nginx\"></a>安装nginx</h1><h2 id=\"1-yum-安装（默认情况下使用yum安装的nginx包含ssl模块）\"><a href=\"#1-yum-安装（默认情况下使用yum安装的nginx包含ssl模块）\" class=\"headerlink\" title=\"1.yum 安装（默认情况下使用yum安装的nginx包含ssl模块）\"></a>1.yum 安装（默认情况下使用yum安装的nginx包含ssl模块）</h2><pre><code>    官方 yum 源链接 http://nginx.org/en/linux_packages.html#RHEL-CentOS\n    \n    vim /etc/yum.repos.d/nginx.repo\n    <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[nginx-stable]</span><br><span class=\"line\">name=nginx stable repo</span><br><span class=\"line\">baseurl=http://nginx.org/packages/centos/$releasever/$basearch/</span><br><span class=\"line\">gpgcheck=1</span><br><span class=\"line\">enabled=1</span><br><span class=\"line\">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class=\"line\">module_hotfixes=true</span><br><span class=\"line\"></span><br><span class=\"line\">[nginx-mainline]</span><br><span class=\"line\">name=nginx mainline repo</span><br><span class=\"line\">baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/</span><br><span class=\"line\">gpgcheck=1</span><br><span class=\"line\">enabled=0</span><br><span class=\"line\">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class=\"line\">module_hotfixes=true</span><br></pre></td></tr></table></figure>\n    \n    yum-config-manager --enable nginx-stable\n    \n    yum install nginx\n</code></pre>\n<h2 id=\"2-源码编译安装\"><a href=\"#2-源码编译安装\" class=\"headerlink\" title=\"2.源码编译安装\"></a>2.源码编译安装</h2><pre><code>下载源码包  http://nginx.org/en/download.html  下载稳定版本\n\nMainline version：Mainline 是 Nginx 目前主力在做的版本，可以说是开发版\nStable version：最新稳定版，生产环境上建议使用的版本\nLegacy versions：遗留的老版本的稳定版\n\n下载命令\nwget http://nginx.org/download/nginx-1.22.0.tar.gz\n\n解压缩\ntar -zxvf nginx-1.22.0.tar.gz\n    \n ./configure --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-pcre\n \n make &amp;&amp; make install\n \n ln -s /usr/local/nginx/conf  /etc/nginx\n \n \n \n</code></pre>\n<h1 id=\"配置服务\"><a href=\"#配置服务\" class=\"headerlink\" title=\"配置服务\"></a>配置服务</h1><pre><code>vim /lib/systemd/system/nginx.service     \n     \n <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[Unit]</span><br><span class=\"line\">Description=nginx</span><br><span class=\"line\">After=network.target</span><br><span class=\"line\"></span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Type=forking</span><br><span class=\"line\">ExecStart=/usr/local/nginx/sbin/nginx</span><br><span class=\"line\">ExecReload=/usr/local/nginx/sbin/nginx -s reload</span><br><span class=\"line\">ExecStop=/usr/local/nginx/sbin/nginx -s quit</span><br><span class=\"line\">PrivateTmp=true</span><br><span class=\"line\"></span><br><span class=\"line\">[Install]</span><br><span class=\"line\">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>\n\n软连接etc目录\nln -s /usr/local/nginx/conf /etc/nginx   \n\nsystemctl status nginx\nsystemctl reload nginx\nsystemctl start nginx\n\n开机启动\nsystemctl enable nginx\n\n添加用户\ngroupadd www\nuseradd -g www -s /sbin/nologin www  \n</code></pre>\n<h1 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h1><h6 id=\"etc-nginx-nginx-conf\"><a href=\"#etc-nginx-nginx-conf\" class=\"headerlink\" title=\"/etc/nginx/nginx.conf\"></a>/etc/nginx/nginx.conf</h6><pre><code>   user  www;\n   #cpu 几核 这进程就多少\n   worker_processes  2;\n   worker_cpu_affinity 01 10;\n   \n   worker_rlimit_nofile 65535;  # 一般等于ulimit -n系统值\n   \n   #error_log  logs/error.log;\n   #error_log  logs/error.log  notice;\n   #error_log  logs/error.log  info;\n   \n   #pid        logs/nginx.pid;\n   \n   \n   events &#123;\n       worker_connections  10240;\n       use epoll;\n   &#125;\n   \n   \n   http &#123;\n       include       mime.types;\n       default_type  application/octet-stream;\n       server_tokens off;\n   \n       #log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;\n       #                  &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;\n       #                  &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;\n   \n       #access_log  logs/access.log  main;\n   \n       sendfile        on;\n       #tcp_nopush     on;\n   \n       #keepalive_timeout  0;\n       keepalive_timeout  65;\n   \n       gzip on;       #表示开启压缩功能\n       gzip_min_length  1k; #表示允许压缩的页面最小字节数，页面字节数从header头的Content-Length中获取。默认值是0，表示不管页面多大都进行压缩，建议设置成大于1K。如果小于1K可能会&gt;越压越大\n       gzip_buffers     4 32k; #压缩缓存区大小\n       gzip_http_version 1.1; #压缩版本\n       gzip_comp_level 6; #压缩比率， 一般选择4-6，为了性能\n       gzip_types text/css text/xml application/javascript;\n       #指定压缩的类型 gzip_vary on;　#vary header支持\n   \n   \n       #配置空主机头 404\n       server &#123;\n           listen 80 default;\n           server_name _;\n           root html;\n           location / &#123; return 404;&#125;\n           location ~ /.ht &#123; deny all; &#125;\n   \n       &#125;\n       include vhost/*.conf;\n   &#125;\n</code></pre>\n<h6 id=\"vhost-conf\"><a href=\"#vhost-conf\" class=\"headerlink\" title=\"vhost/*.conf\"></a>vhost/*.conf</h6><pre><code>server&#123;\n    listen 80;\n    server_name tp.webstudy.cc;\n    set $wwwroot /home/www/htdocs/tp.webstudy.cc;\n    root $wwwroot;\n    access_log  logs/ai.access.log;\n    error_log logs/ai.error.log debug;\n\n    #ssl_certificate     /usr/local/nginx/conf/ssl/jinju.utooo.com/Nginx/1_jinju.utooo.com_bundle.crt;\n    #ssl_certificate_key /usr/local/nginx/conf/ssl/jinju.utooo.com/Nginx/2_jinju.utooo.com.key;\n    #ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    location / &#123;\n        index  index.php index.html index.htm;\n        # 这里使用try_files进行url重写，不用rewrite了\n        # try_files $uri $uri/ /index.php?$query_string;\n    &#125;\n\n   #error_page   500 502 503 504  /50x.html;\n   location = /50x.html &#123;\n        root   html;\n    &#125;\n    location ~ .*\\.php&#123;\n            include fastcgi_params;\n            fastcgi_param SCRIPT_FILENAME   $document_root$fastcgi_script_name;\n            fastcgi_pass 127.0.0.1:9000;\n            fastcgi_index index.php;\n    &#125;\n\n&#125;\n\n\n  \n</code></pre>\n","site":{"data":{}},"length":3355,"excerpt":"","more":"<h1 id=\"安装nginx\"><a href=\"#安装nginx\" class=\"headerlink\" title=\"安装nginx\"></a>安装nginx</h1><h2 id=\"1-yum-安装（默认情况下使用yum安装的nginx包含ssl模块）\"><a href=\"#1-yum-安装（默认情况下使用yum安装的nginx包含ssl模块）\" class=\"headerlink\" title=\"1.yum 安装（默认情况下使用yum安装的nginx包含ssl模块）\"></a>1.yum 安装（默认情况下使用yum安装的nginx包含ssl模块）</h2><pre><code>    官方 yum 源链接 http://nginx.org/en/linux_packages.html#RHEL-CentOS\n    \n    vim /etc/yum.repos.d/nginx.repo\n    <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[nginx-stable]</span><br><span class=\"line\">name=nginx stable repo</span><br><span class=\"line\">baseurl=http://nginx.org/packages/centos/$releasever/$basearch/</span><br><span class=\"line\">gpgcheck=1</span><br><span class=\"line\">enabled=1</span><br><span class=\"line\">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class=\"line\">module_hotfixes=true</span><br><span class=\"line\"></span><br><span class=\"line\">[nginx-mainline]</span><br><span class=\"line\">name=nginx mainline repo</span><br><span class=\"line\">baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/</span><br><span class=\"line\">gpgcheck=1</span><br><span class=\"line\">enabled=0</span><br><span class=\"line\">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class=\"line\">module_hotfixes=true</span><br></pre></td></tr></table></figure>\n    \n    yum-config-manager --enable nginx-stable\n    \n    yum install nginx\n</code></pre>\n<h2 id=\"2-源码编译安装\"><a href=\"#2-源码编译安装\" class=\"headerlink\" title=\"2.源码编译安装\"></a>2.源码编译安装</h2><pre><code>下载源码包  http://nginx.org/en/download.html  下载稳定版本\n\nMainline version：Mainline 是 Nginx 目前主力在做的版本，可以说是开发版\nStable version：最新稳定版，生产环境上建议使用的版本\nLegacy versions：遗留的老版本的稳定版\n\n下载命令\nwget http://nginx.org/download/nginx-1.22.0.tar.gz\n\n解压缩\ntar -zxvf nginx-1.22.0.tar.gz\n    \n ./configure --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-pcre\n \n make &amp;&amp; make install\n \n ln -s /usr/local/nginx/conf  /etc/nginx\n \n \n \n</code></pre>\n<h1 id=\"配置服务\"><a href=\"#配置服务\" class=\"headerlink\" title=\"配置服务\"></a>配置服务</h1><pre><code>vim /lib/systemd/system/nginx.service     \n     \n <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[Unit]</span><br><span class=\"line\">Description=nginx</span><br><span class=\"line\">After=network.target</span><br><span class=\"line\"></span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Type=forking</span><br><span class=\"line\">ExecStart=/usr/local/nginx/sbin/nginx</span><br><span class=\"line\">ExecReload=/usr/local/nginx/sbin/nginx -s reload</span><br><span class=\"line\">ExecStop=/usr/local/nginx/sbin/nginx -s quit</span><br><span class=\"line\">PrivateTmp=true</span><br><span class=\"line\"></span><br><span class=\"line\">[Install]</span><br><span class=\"line\">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>\n\n软连接etc目录\nln -s /usr/local/nginx/conf /etc/nginx   \n\nsystemctl status nginx\nsystemctl reload nginx\nsystemctl start nginx\n\n开机启动\nsystemctl enable nginx\n\n添加用户\ngroupadd www\nuseradd -g www -s /sbin/nologin www  \n</code></pre>\n<h1 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h1><h6 id=\"etc-nginx-nginx-conf\"><a href=\"#etc-nginx-nginx-conf\" class=\"headerlink\" title=\"/etc/nginx/nginx.conf\"></a>/etc/nginx/nginx.conf</h6><pre><code>   user  www;\n   #cpu 几核 这进程就多少\n   worker_processes  2;\n   worker_cpu_affinity 01 10;\n   \n   worker_rlimit_nofile 65535;  # 一般等于ulimit -n系统值\n   \n   #error_log  logs/error.log;\n   #error_log  logs/error.log  notice;\n   #error_log  logs/error.log  info;\n   \n   #pid        logs/nginx.pid;\n   \n   \n   events &#123;\n       worker_connections  10240;\n       use epoll;\n   &#125;\n   \n   \n   http &#123;\n       include       mime.types;\n       default_type  application/octet-stream;\n       server_tokens off;\n   \n       #log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;\n       #                  &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;\n       #                  &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;\n   \n       #access_log  logs/access.log  main;\n   \n       sendfile        on;\n       #tcp_nopush     on;\n   \n       #keepalive_timeout  0;\n       keepalive_timeout  65;\n   \n       gzip on;       #表示开启压缩功能\n       gzip_min_length  1k; #表示允许压缩的页面最小字节数，页面字节数从header头的Content-Length中获取。默认值是0，表示不管页面多大都进行压缩，建议设置成大于1K。如果小于1K可能会&gt;越压越大\n       gzip_buffers     4 32k; #压缩缓存区大小\n       gzip_http_version 1.1; #压缩版本\n       gzip_comp_level 6; #压缩比率， 一般选择4-6，为了性能\n       gzip_types text/css text/xml application/javascript;\n       #指定压缩的类型 gzip_vary on;　#vary header支持\n   \n   \n       #配置空主机头 404\n       server &#123;\n           listen 80 default;\n           server_name _;\n           root html;\n           location / &#123; return 404;&#125;\n           location ~ /.ht &#123; deny all; &#125;\n   \n       &#125;\n       include vhost/*.conf;\n   &#125;\n</code></pre>\n<h6 id=\"vhost-conf\"><a href=\"#vhost-conf\" class=\"headerlink\" title=\"vhost/*.conf\"></a>vhost/*.conf</h6><pre><code>server&#123;\n    listen 80;\n    server_name tp.webstudy.cc;\n    set $wwwroot /home/www/htdocs/tp.webstudy.cc;\n    root $wwwroot;\n    access_log  logs/ai.access.log;\n    error_log logs/ai.error.log debug;\n\n    #ssl_certificate     /usr/local/nginx/conf/ssl/jinju.utooo.com/Nginx/1_jinju.utooo.com_bundle.crt;\n    #ssl_certificate_key /usr/local/nginx/conf/ssl/jinju.utooo.com/Nginx/2_jinju.utooo.com.key;\n    #ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;\n\n    location / &#123;\n        index  index.php index.html index.htm;\n        # 这里使用try_files进行url重写，不用rewrite了\n        # try_files $uri $uri/ /index.php?$query_string;\n    &#125;\n\n   #error_page   500 502 503 504  /50x.html;\n   location = /50x.html &#123;\n        root   html;\n    &#125;\n    location ~ .*\\.php&#123;\n            include fastcgi_params;\n            fastcgi_param SCRIPT_FILENAME   $document_root$fastcgi_script_name;\n            fastcgi_pass 127.0.0.1:9000;\n            fastcgi_index index.php;\n    &#125;\n\n&#125;\n\n\n  \n</code></pre>\n"},{"title":"php扩展编译安装","abbrlink":"928212f0","date":"2023-07-19T01:14:51.000Z","_content":"\n\n# 一、找点phpize 和 php-config路径\n\n    find / -name phpize\n    \n    find / -name php-config\n    \n    \n# 二、找到 \n\n项目目录下执行 查找到的phpize \n\n    /opt/remi/php74/root/usr/bin/phpize\n    \n    如报错\n    Can't find PHP headers in /usr/include/php The php-devel package is required for use of this command...\n    \n    安装php-devel即可\n   \n    yum install -y php-devel\n    \n    remi安装如下安装\n    yum install -y php73-php-devel\n\n    \n# 三、编译\n    \n     1.进入项目目录下\n     ./configure --with-php-config=【第一步查询到的路径】\n     \n     示例\n        ./configure --with-php-config=/www/server/php/71/bin/php-config\n\n     2. 执行\n     \n     make && make install\n\n# 四、添加配置\n    \n    vi /具体路径/php.ini\n     \n    extension=swoole.so\n    \n    如是remi 安装的php \n    在/etc/opt/remi/php73/php.d下新建\n    新建ini文件  参考其他设置下\n    \n    万变方案 phpinfo 看下是如何加载扩展的 具体的目录 多有\n    \n# 五、重启服务\n\n    systemctl restart php-fpm   \n","source":"_posts/linux-php扩展安装.md","raw":"---\ntitle: php扩展编译安装\nabbrlink: 928212f0\ndate: 2023-07-19 09:14:51\ntags:\n  - linux\ncategories:\n  - PHP开发\n---\n\n\n# 一、找点phpize 和 php-config路径\n\n    find / -name phpize\n    \n    find / -name php-config\n    \n    \n# 二、找到 \n\n项目目录下执行 查找到的phpize \n\n    /opt/remi/php74/root/usr/bin/phpize\n    \n    如报错\n    Can't find PHP headers in /usr/include/php The php-devel package is required for use of this command...\n    \n    安装php-devel即可\n   \n    yum install -y php-devel\n    \n    remi安装如下安装\n    yum install -y php73-php-devel\n\n    \n# 三、编译\n    \n     1.进入项目目录下\n     ./configure --with-php-config=【第一步查询到的路径】\n     \n     示例\n        ./configure --with-php-config=/www/server/php/71/bin/php-config\n\n     2. 执行\n     \n     make && make install\n\n# 四、添加配置\n    \n    vi /具体路径/php.ini\n     \n    extension=swoole.so\n    \n    如是remi 安装的php \n    在/etc/opt/remi/php73/php.d下新建\n    新建ini文件  参考其他设置下\n    \n    万变方案 phpinfo 看下是如何加载扩展的 具体的目录 多有\n    \n# 五、重启服务\n\n    systemctl restart php-fpm   \n","slug":"linux-php扩展安装","published":1,"updated":"2024-11-25T11:25:29.026Z","_id":"cm04ukh6o000c4koc4axigsam","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、找点phpize-和-php-config路径\"><a href=\"#一、找点phpize-和-php-config路径\" class=\"headerlink\" title=\"一、找点phpize 和 php-config路径\"></a>一、找点phpize 和 php-config路径</h1><pre><code>find / -name phpize\n\nfind / -name php-config\n</code></pre>\n<h1 id=\"二、找到\"><a href=\"#二、找到\" class=\"headerlink\" title=\"二、找到\"></a>二、找到</h1><p>项目目录下执行 查找到的phpize </p>\n<pre><code>/opt/remi/php74/root/usr/bin/phpize\n\n如报错\nCan&#39;t find PHP headers in /usr/include/php The php-devel package is required for use of this command...\n\n安装php-devel即可\n\nyum install -y php-devel\n\nremi安装如下安装\nyum install -y php73-php-devel\n</code></pre>\n<h1 id=\"三、编译\"><a href=\"#三、编译\" class=\"headerlink\" title=\"三、编译\"></a>三、编译</h1><pre><code> 1.进入项目目录下\n ./configure --with-php-config=【第一步查询到的路径】\n \n 示例\n    ./configure --with-php-config=/www/server/php/71/bin/php-config\n\n 2. 执行\n \n make &amp;&amp; make install\n</code></pre>\n<h1 id=\"四、添加配置\"><a href=\"#四、添加配置\" class=\"headerlink\" title=\"四、添加配置\"></a>四、添加配置</h1><pre><code>vi /具体路径/php.ini\n \nextension=swoole.so\n\n如是remi 安装的php \n在/etc/opt/remi/php73/php.d下新建\n新建ini文件  参考其他设置下\n\n万变方案 phpinfo 看下是如何加载扩展的 具体的目录 多有\n</code></pre>\n<h1 id=\"五、重启服务\"><a href=\"#五、重启服务\" class=\"headerlink\" title=\"五、重启服务\"></a>五、重启服务</h1><pre><code>systemctl restart php-fpm   \n</code></pre>\n","site":{"data":{}},"length":579,"excerpt":"","more":"<h1 id=\"一、找点phpize-和-php-config路径\"><a href=\"#一、找点phpize-和-php-config路径\" class=\"headerlink\" title=\"一、找点phpize 和 php-config路径\"></a>一、找点phpize 和 php-config路径</h1><pre><code>find / -name phpize\n\nfind / -name php-config\n</code></pre>\n<h1 id=\"二、找到\"><a href=\"#二、找到\" class=\"headerlink\" title=\"二、找到\"></a>二、找到</h1><p>项目目录下执行 查找到的phpize </p>\n<pre><code>/opt/remi/php74/root/usr/bin/phpize\n\n如报错\nCan&#39;t find PHP headers in /usr/include/php The php-devel package is required for use of this command...\n\n安装php-devel即可\n\nyum install -y php-devel\n\nremi安装如下安装\nyum install -y php73-php-devel\n</code></pre>\n<h1 id=\"三、编译\"><a href=\"#三、编译\" class=\"headerlink\" title=\"三、编译\"></a>三、编译</h1><pre><code> 1.进入项目目录下\n ./configure --with-php-config=【第一步查询到的路径】\n \n 示例\n    ./configure --with-php-config=/www/server/php/71/bin/php-config\n\n 2. 执行\n \n make &amp;&amp; make install\n</code></pre>\n<h1 id=\"四、添加配置\"><a href=\"#四、添加配置\" class=\"headerlink\" title=\"四、添加配置\"></a>四、添加配置</h1><pre><code>vi /具体路径/php.ini\n \nextension=swoole.so\n\n如是remi 安装的php \n在/etc/opt/remi/php73/php.d下新建\n新建ini文件  参考其他设置下\n\n万变方案 phpinfo 看下是如何加载扩展的 具体的目录 多有\n</code></pre>\n<h1 id=\"五、重启服务\"><a href=\"#五、重启服务\" class=\"headerlink\" title=\"五、重启服务\"></a>五、重启服务</h1><pre><code>systemctl restart php-fpm   \n</code></pre>\n"},{"title":"rsyslog日志上报服务","abbrlink":"aaedf8b3","date":"2024-02-01T10:52:54.000Z","_content":"\n# rsyslog 基础\n## 日志类别\n\n    日志类型 日志内容\n    auth 用户认证时产生的日志\n    syslog 系统日志\n    local0~local7 自定义程序使用\n    等等\n\n## Properties模板元素属性\n\n常用的变量\n\n    hostname 打印该日志的主机名。\n    fromhost 接收的信息来自于哪个节点。这里是DNS解析的名字。\n    fromhost-ip 接收的信息来自于哪个节点，这里是IP，本地的是127.0.0.1。\n    syslogtag 信息标签。大致形如 programed[14321] 。\n    programname 文件名\n    \n    Properties与时间相关的属性属性 释义\n    $now 当前日期时间戳，格式为YYYY-MM-DD (2020-07-08)\n    $year 当前年份， 四位数 (2020)\n    $month 当前月份， 两位数 (07)\n    $day 当前月份的日期，两位数 (08)\n    $wday 当前天数周几 ：0=Sunday,...6=Saturday\n    $hour 当前小时（24小时机制），两位数(16)\n    $hhour 半小时机值，就是0-29分钟显示0，30-59分钟显示1。\n    $qhour 一刻钟机值，通过0-3显示，每15分钟一截。\n    $minute 当前分钟数，两位数(57)\n\n示例\n    定义日志目录\n    \n    $template RemoteTestlogs,\"/var/log/syslog/%fromhost-ip%/test.log\"\n    \n    /var/log/syslog/%$YEAR%-%$MONTH%-%$DAY%/%FROMHOST-IP%-%programname%.log\n    \n##日志文件权限 \n\n日志文件权限新生成的目录和文件权限可以在配置文件设置\n\n     vim /etc/rsyslog.conf\n     #尽量在开头设置\n     $FileOwner root\n     $FileGroup root\n     $FileCreateMode 0755 #文件权限\n     $DirCreateMode 0755 #目录权限\n     $Umask 0022\n     \n## 模版配置\n\n\n 1、示例1\n \n     $template DynamicFile,\"/var/log/test_logs/%timegenerated%-test.log\"\n     *.* ?DynamicFile\n \n 2、示例2\n \n     $template RemoteHost,\"/home/rsyslog-data/%$YEAR%-%$MONTH%-%$DAY%/%FROMHOST-IP%.log\n     *.* ?RemoteHost\n     #    & ~ 忽略所有的日志.\n     & ~\n \n 3、示例3\n \n     #配置文件存储模板\n     $template RemoteAuditLogs,\"/data/auditd/%FROMHOST-IP%/audit.log\" *\n     $template RemoteNetworkLogs,\"/data/network-log/%HOSTNAME%/network.log\" *\n     #引用模板\n     local6.* ?RemoteNetworkLogs\n     local2.* ?RemoteAuditLog   \n# 配置案例\n## 客户端配置\n\n    \n1.2 相关配置\n    \n 增加imfile模块配置，【不然自定义的日志，无法发送到服务端】\n       \n    $ModLoad imuxsock # provides support for local system logging (e.g. via logger command)\n    $ModLoad imjournal # provides access to the systemd journal\n    # 下发添加 方法一\n    module(load=\"imfile\" PollingInterval=\"1\") \n    # 方法二\n    $ModLoad imfile\n    \n    local7.* /var/log/local7.log\n    \n    #只发送local7 类型日志\n    #local7.* @@121.4.27.111\n    #将所有日志 多发送  \n    *.* @@121.4.27.111\n    \n    \n 新增/etc/rsyslog.d/local7.conf\n \n \n      #工作目录 这个可不配 默认/var/log/下\n      #$WorkDirectory /var/log/rsyslog\n      \n      #输入文件模式\n      input(type=\"imfile\"\n           File=\"/var/log/local7.log\"   #可指定任意文件，但需要将文件权限置为777\n           Tag=\"local7\"      #文件标识，服务器接收到消息可以使用这个tag分类\n           Severity=\"info\"            #日志级别\n           Facility=\"local7\"             \n           PersistStateInterval=\"1\"     #回写偏移量数据到文件间隔时间(秒)\n           ruleset=\"remote\")          #规则集，rsyslog.conf中定义的rule名称\n\n## 服务端配置\n\n定义开启 接收的协议 以及端口\n    \n    # Provides UDP syslog reception\n    $ModLoad imudp\n    $UDPServerRun 514\n     \n    # Provides TCP syslog reception\n    $ModLoad imtcp\n    $InputTCPServerRun 514\n\n定义模版\n\n   1.示例1\n   \n    #生成模板\n    $template SpiceTmpl,\"%msg:2:$%\\n\"\n    $template CatalinaDynaFile,\"/var/log/rsyslog/%fromhost-ip%/catalina_%$YEAR%-%$MONTH%-%$DAY%.log\"\n      \n    #匹配规则，文章后面将分享其他配置类型\n    :fromhost-ip,contains,\"192.168.88.132\" ?CatalinaDynaFile;SpiceTmpl\n    \n   2.示例2\n    \n    $template RemoteLogs,\"/var/log/syslog/%$YEAR%-%$MONTH%-%$DAY%/%FROMHOST-IP%-%programname%.log\"\n    *.* ?RemoteLogs\n    & ~\n\n## 测试\n    \n    -it error：这是两个选项的组合。-i选项指定附加进程ID（PID）到日志消息中，-t error选项指定将\"error\"作为消息的标记（TAG）。\n    -p local5.crit：这是指定日志消息的优先级的选项。在这个例子中，local5.crit表示使用syslog的local5设施和crit（严重）优先级。\n    \"hello world\"：这是要记录的实际消息内容。\n    \n    该命令用于向系统日志中添加一条日志消息\n    logger -it local1 -p local1.info \"hello\"\n  \n","source":"_posts/linux-rsyslog日志服务.md","raw":"---\ntitle: rsyslog日志上报服务\nabbrlink: aaedf8b3\ncategories:\n  - 服务器相关\ndate: 2024-02-01 18:52:54\ntags:\n  - linux  \n---\n\n# rsyslog 基础\n## 日志类别\n\n    日志类型 日志内容\n    auth 用户认证时产生的日志\n    syslog 系统日志\n    local0~local7 自定义程序使用\n    等等\n\n## Properties模板元素属性\n\n常用的变量\n\n    hostname 打印该日志的主机名。\n    fromhost 接收的信息来自于哪个节点。这里是DNS解析的名字。\n    fromhost-ip 接收的信息来自于哪个节点，这里是IP，本地的是127.0.0.1。\n    syslogtag 信息标签。大致形如 programed[14321] 。\n    programname 文件名\n    \n    Properties与时间相关的属性属性 释义\n    $now 当前日期时间戳，格式为YYYY-MM-DD (2020-07-08)\n    $year 当前年份， 四位数 (2020)\n    $month 当前月份， 两位数 (07)\n    $day 当前月份的日期，两位数 (08)\n    $wday 当前天数周几 ：0=Sunday,...6=Saturday\n    $hour 当前小时（24小时机制），两位数(16)\n    $hhour 半小时机值，就是0-29分钟显示0，30-59分钟显示1。\n    $qhour 一刻钟机值，通过0-3显示，每15分钟一截。\n    $minute 当前分钟数，两位数(57)\n\n示例\n    定义日志目录\n    \n    $template RemoteTestlogs,\"/var/log/syslog/%fromhost-ip%/test.log\"\n    \n    /var/log/syslog/%$YEAR%-%$MONTH%-%$DAY%/%FROMHOST-IP%-%programname%.log\n    \n##日志文件权限 \n\n日志文件权限新生成的目录和文件权限可以在配置文件设置\n\n     vim /etc/rsyslog.conf\n     #尽量在开头设置\n     $FileOwner root\n     $FileGroup root\n     $FileCreateMode 0755 #文件权限\n     $DirCreateMode 0755 #目录权限\n     $Umask 0022\n     \n## 模版配置\n\n\n 1、示例1\n \n     $template DynamicFile,\"/var/log/test_logs/%timegenerated%-test.log\"\n     *.* ?DynamicFile\n \n 2、示例2\n \n     $template RemoteHost,\"/home/rsyslog-data/%$YEAR%-%$MONTH%-%$DAY%/%FROMHOST-IP%.log\n     *.* ?RemoteHost\n     #    & ~ 忽略所有的日志.\n     & ~\n \n 3、示例3\n \n     #配置文件存储模板\n     $template RemoteAuditLogs,\"/data/auditd/%FROMHOST-IP%/audit.log\" *\n     $template RemoteNetworkLogs,\"/data/network-log/%HOSTNAME%/network.log\" *\n     #引用模板\n     local6.* ?RemoteNetworkLogs\n     local2.* ?RemoteAuditLog   \n# 配置案例\n## 客户端配置\n\n    \n1.2 相关配置\n    \n 增加imfile模块配置，【不然自定义的日志，无法发送到服务端】\n       \n    $ModLoad imuxsock # provides support for local system logging (e.g. via logger command)\n    $ModLoad imjournal # provides access to the systemd journal\n    # 下发添加 方法一\n    module(load=\"imfile\" PollingInterval=\"1\") \n    # 方法二\n    $ModLoad imfile\n    \n    local7.* /var/log/local7.log\n    \n    #只发送local7 类型日志\n    #local7.* @@121.4.27.111\n    #将所有日志 多发送  \n    *.* @@121.4.27.111\n    \n    \n 新增/etc/rsyslog.d/local7.conf\n \n \n      #工作目录 这个可不配 默认/var/log/下\n      #$WorkDirectory /var/log/rsyslog\n      \n      #输入文件模式\n      input(type=\"imfile\"\n           File=\"/var/log/local7.log\"   #可指定任意文件，但需要将文件权限置为777\n           Tag=\"local7\"      #文件标识，服务器接收到消息可以使用这个tag分类\n           Severity=\"info\"            #日志级别\n           Facility=\"local7\"             \n           PersistStateInterval=\"1\"     #回写偏移量数据到文件间隔时间(秒)\n           ruleset=\"remote\")          #规则集，rsyslog.conf中定义的rule名称\n\n## 服务端配置\n\n定义开启 接收的协议 以及端口\n    \n    # Provides UDP syslog reception\n    $ModLoad imudp\n    $UDPServerRun 514\n     \n    # Provides TCP syslog reception\n    $ModLoad imtcp\n    $InputTCPServerRun 514\n\n定义模版\n\n   1.示例1\n   \n    #生成模板\n    $template SpiceTmpl,\"%msg:2:$%\\n\"\n    $template CatalinaDynaFile,\"/var/log/rsyslog/%fromhost-ip%/catalina_%$YEAR%-%$MONTH%-%$DAY%.log\"\n      \n    #匹配规则，文章后面将分享其他配置类型\n    :fromhost-ip,contains,\"192.168.88.132\" ?CatalinaDynaFile;SpiceTmpl\n    \n   2.示例2\n    \n    $template RemoteLogs,\"/var/log/syslog/%$YEAR%-%$MONTH%-%$DAY%/%FROMHOST-IP%-%programname%.log\"\n    *.* ?RemoteLogs\n    & ~\n\n## 测试\n    \n    -it error：这是两个选项的组合。-i选项指定附加进程ID（PID）到日志消息中，-t error选项指定将\"error\"作为消息的标记（TAG）。\n    -p local5.crit：这是指定日志消息的优先级的选项。在这个例子中，local5.crit表示使用syslog的local5设施和crit（严重）优先级。\n    \"hello world\"：这是要记录的实际消息内容。\n    \n    该命令用于向系统日志中添加一条日志消息\n    logger -it local1 -p local1.info \"hello\"\n  \n","slug":"linux-rsyslog日志服务","published":1,"updated":"2024-11-25T11:18:49.370Z","_id":"cm04ukh6u000f4koc2rmk1l3c","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"rsyslog-基础\"><a href=\"#rsyslog-基础\" class=\"headerlink\" title=\"rsyslog 基础\"></a>rsyslog 基础</h1><h2 id=\"日志类别\"><a href=\"#日志类别\" class=\"headerlink\" title=\"日志类别\"></a>日志类别</h2><pre><code>日志类型 日志内容\nauth 用户认证时产生的日志\nsyslog 系统日志\nlocal0~local7 自定义程序使用\n等等\n</code></pre>\n<h2 id=\"Properties模板元素属性\"><a href=\"#Properties模板元素属性\" class=\"headerlink\" title=\"Properties模板元素属性\"></a>Properties模板元素属性</h2><p>常用的变量</p>\n<pre><code>hostname 打印该日志的主机名。\nfromhost 接收的信息来自于哪个节点。这里是DNS解析的名字。\nfromhost-ip 接收的信息来自于哪个节点，这里是IP，本地的是127.0.0.1。\nsyslogtag 信息标签。大致形如 programed[14321] 。\nprogramname 文件名\n\nProperties与时间相关的属性属性 释义\n$now 当前日期时间戳，格式为YYYY-MM-DD (2020-07-08)\n$year 当前年份， 四位数 (2020)\n$month 当前月份， 两位数 (07)\n$day 当前月份的日期，两位数 (08)\n$wday 当前天数周几 ：0=Sunday,...6=Saturday\n$hour 当前小时（24小时机制），两位数(16)\n$hhour 半小时机值，就是0-29分钟显示0，30-59分钟显示1。\n$qhour 一刻钟机值，通过0-3显示，每15分钟一截。\n$minute 当前分钟数，两位数(57)\n</code></pre>\n<p>示例<br>    定义日志目录</p>\n<pre><code>$template RemoteTestlogs,&quot;/var/log/syslog/%fromhost-ip%/test.log&quot;\n\n/var/log/syslog/%$YEAR%-%$MONTH%-%$DAY%/%FROMHOST-IP%-%programname%.log\n</code></pre>\n<p>##日志文件权限 </p>\n<p>日志文件权限新生成的目录和文件权限可以在配置文件设置</p>\n<pre><code> vim /etc/rsyslog.conf\n #尽量在开头设置\n $FileOwner root\n $FileGroup root\n $FileCreateMode 0755 #文件权限\n $DirCreateMode 0755 #目录权限\n $Umask 0022\n \n</code></pre>\n<h2 id=\"模版配置\"><a href=\"#模版配置\" class=\"headerlink\" title=\"模版配置\"></a>模版配置</h2><p> 1、示例1</p>\n<pre><code> $template DynamicFile,&quot;/var/log/test_logs/%timegenerated%-test.log&quot;\n *.* ?DynamicFile\n</code></pre>\n<p> 2、示例2</p>\n<pre><code> $template RemoteHost,&quot;/home/rsyslog-data/%$YEAR%-%$MONTH%-%$DAY%/%FROMHOST-IP%.log\n *.* ?RemoteHost\n #    &amp; ~ 忽略所有的日志.\n &amp; ~\n</code></pre>\n<p> 3、示例3</p>\n<pre><code> #配置文件存储模板\n $template RemoteAuditLogs,&quot;/data/auditd/%FROMHOST-IP%/audit.log&quot; *\n $template RemoteNetworkLogs,&quot;/data/network-log/%HOSTNAME%/network.log&quot; *\n #引用模板\n local6.* ?RemoteNetworkLogs\n local2.* ?RemoteAuditLog   \n</code></pre>\n<h1 id=\"配置案例\"><a href=\"#配置案例\" class=\"headerlink\" title=\"配置案例\"></a>配置案例</h1><h2 id=\"客户端配置\"><a href=\"#客户端配置\" class=\"headerlink\" title=\"客户端配置\"></a>客户端配置</h2><p>1.2 相关配置</p>\n<p> 增加imfile模块配置，【不然自定义的日志，无法发送到服务端】</p>\n<pre><code>$ModLoad imuxsock # provides support for local system logging (e.g. via logger command)\n$ModLoad imjournal # provides access to the systemd journal\n# 下发添加 方法一\nmodule(load=&quot;imfile&quot; PollingInterval=&quot;1&quot;) \n# 方法二\n$ModLoad imfile\n\nlocal7.* /var/log/local7.log\n\n#只发送local7 类型日志\n#local7.* @@121.4.27.111\n#将所有日志 多发送  \n*.* @@121.4.27.111\n</code></pre>\n<p> 新增/etc/rsyslog.d/local7.conf</p>\n<pre><code>  #工作目录 这个可不配 默认/var/log/下\n  #$WorkDirectory /var/log/rsyslog\n  \n  #输入文件模式\n  input(type=&quot;imfile&quot;\n       File=&quot;/var/log/local7.log&quot;   #可指定任意文件，但需要将文件权限置为777\n       Tag=&quot;local7&quot;      #文件标识，服务器接收到消息可以使用这个tag分类\n       Severity=&quot;info&quot;            #日志级别\n       Facility=&quot;local7&quot;             \n       PersistStateInterval=&quot;1&quot;     #回写偏移量数据到文件间隔时间(秒)\n       ruleset=&quot;remote&quot;)          #规则集，rsyslog.conf中定义的rule名称\n</code></pre>\n<h2 id=\"服务端配置\"><a href=\"#服务端配置\" class=\"headerlink\" title=\"服务端配置\"></a>服务端配置</h2><p>定义开启 接收的协议 以及端口</p>\n<pre><code># Provides UDP syslog reception\n$ModLoad imudp\n$UDPServerRun 514\n \n# Provides TCP syslog reception\n$ModLoad imtcp\n$InputTCPServerRun 514\n</code></pre>\n<p>定义模版</p>\n<p>   1.示例1</p>\n<pre><code>#生成模板\n$template SpiceTmpl,&quot;%msg:2:$%\\n&quot;\n$template CatalinaDynaFile,&quot;/var/log/rsyslog/%fromhost-ip%/catalina_%$YEAR%-%$MONTH%-%$DAY%.log&quot;\n  \n#匹配规则，文章后面将分享其他配置类型\n:fromhost-ip,contains,&quot;192.168.88.132&quot; ?CatalinaDynaFile;SpiceTmpl\n</code></pre>\n<p>   2.示例2</p>\n<pre><code>$template RemoteLogs,&quot;/var/log/syslog/%$YEAR%-%$MONTH%-%$DAY%/%FROMHOST-IP%-%programname%.log&quot;\n*.* ?RemoteLogs\n&amp; ~\n</code></pre>\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><pre><code>-it error：这是两个选项的组合。-i选项指定附加进程ID（PID）到日志消息中，-t error选项指定将&quot;error&quot;作为消息的标记（TAG）。\n-p local5.crit：这是指定日志消息的优先级的选项。在这个例子中，local5.crit表示使用syslog的local5设施和crit（严重）优先级。\n&quot;hello world&quot;：这是要记录的实际消息内容。\n\n该命令用于向系统日志中添加一条日志消息\nlogger -it local1 -p local1.info &quot;hello&quot;\n</code></pre>\n","site":{"data":{}},"length":2757,"excerpt":"","more":"<h1 id=\"rsyslog-基础\"><a href=\"#rsyslog-基础\" class=\"headerlink\" title=\"rsyslog 基础\"></a>rsyslog 基础</h1><h2 id=\"日志类别\"><a href=\"#日志类别\" class=\"headerlink\" title=\"日志类别\"></a>日志类别</h2><pre><code>日志类型 日志内容\nauth 用户认证时产生的日志\nsyslog 系统日志\nlocal0~local7 自定义程序使用\n等等\n</code></pre>\n<h2 id=\"Properties模板元素属性\"><a href=\"#Properties模板元素属性\" class=\"headerlink\" title=\"Properties模板元素属性\"></a>Properties模板元素属性</h2><p>常用的变量</p>\n<pre><code>hostname 打印该日志的主机名。\nfromhost 接收的信息来自于哪个节点。这里是DNS解析的名字。\nfromhost-ip 接收的信息来自于哪个节点，这里是IP，本地的是127.0.0.1。\nsyslogtag 信息标签。大致形如 programed[14321] 。\nprogramname 文件名\n\nProperties与时间相关的属性属性 释义\n$now 当前日期时间戳，格式为YYYY-MM-DD (2020-07-08)\n$year 当前年份， 四位数 (2020)\n$month 当前月份， 两位数 (07)\n$day 当前月份的日期，两位数 (08)\n$wday 当前天数周几 ：0=Sunday,...6=Saturday\n$hour 当前小时（24小时机制），两位数(16)\n$hhour 半小时机值，就是0-29分钟显示0，30-59分钟显示1。\n$qhour 一刻钟机值，通过0-3显示，每15分钟一截。\n$minute 当前分钟数，两位数(57)\n</code></pre>\n<p>示例<br>    定义日志目录</p>\n<pre><code>$template RemoteTestlogs,&quot;/var/log/syslog/%fromhost-ip%/test.log&quot;\n\n/var/log/syslog/%$YEAR%-%$MONTH%-%$DAY%/%FROMHOST-IP%-%programname%.log\n</code></pre>\n<p>##日志文件权限 </p>\n<p>日志文件权限新生成的目录和文件权限可以在配置文件设置</p>\n<pre><code> vim /etc/rsyslog.conf\n #尽量在开头设置\n $FileOwner root\n $FileGroup root\n $FileCreateMode 0755 #文件权限\n $DirCreateMode 0755 #目录权限\n $Umask 0022\n \n</code></pre>\n<h2 id=\"模版配置\"><a href=\"#模版配置\" class=\"headerlink\" title=\"模版配置\"></a>模版配置</h2><p> 1、示例1</p>\n<pre><code> $template DynamicFile,&quot;/var/log/test_logs/%timegenerated%-test.log&quot;\n *.* ?DynamicFile\n</code></pre>\n<p> 2、示例2</p>\n<pre><code> $template RemoteHost,&quot;/home/rsyslog-data/%$YEAR%-%$MONTH%-%$DAY%/%FROMHOST-IP%.log\n *.* ?RemoteHost\n #    &amp; ~ 忽略所有的日志.\n &amp; ~\n</code></pre>\n<p> 3、示例3</p>\n<pre><code> #配置文件存储模板\n $template RemoteAuditLogs,&quot;/data/auditd/%FROMHOST-IP%/audit.log&quot; *\n $template RemoteNetworkLogs,&quot;/data/network-log/%HOSTNAME%/network.log&quot; *\n #引用模板\n local6.* ?RemoteNetworkLogs\n local2.* ?RemoteAuditLog   \n</code></pre>\n<h1 id=\"配置案例\"><a href=\"#配置案例\" class=\"headerlink\" title=\"配置案例\"></a>配置案例</h1><h2 id=\"客户端配置\"><a href=\"#客户端配置\" class=\"headerlink\" title=\"客户端配置\"></a>客户端配置</h2><p>1.2 相关配置</p>\n<p> 增加imfile模块配置，【不然自定义的日志，无法发送到服务端】</p>\n<pre><code>$ModLoad imuxsock # provides support for local system logging (e.g. via logger command)\n$ModLoad imjournal # provides access to the systemd journal\n# 下发添加 方法一\nmodule(load=&quot;imfile&quot; PollingInterval=&quot;1&quot;) \n# 方法二\n$ModLoad imfile\n\nlocal7.* /var/log/local7.log\n\n#只发送local7 类型日志\n#local7.* @@121.4.27.111\n#将所有日志 多发送  \n*.* @@121.4.27.111\n</code></pre>\n<p> 新增/etc/rsyslog.d/local7.conf</p>\n<pre><code>  #工作目录 这个可不配 默认/var/log/下\n  #$WorkDirectory /var/log/rsyslog\n  \n  #输入文件模式\n  input(type=&quot;imfile&quot;\n       File=&quot;/var/log/local7.log&quot;   #可指定任意文件，但需要将文件权限置为777\n       Tag=&quot;local7&quot;      #文件标识，服务器接收到消息可以使用这个tag分类\n       Severity=&quot;info&quot;            #日志级别\n       Facility=&quot;local7&quot;             \n       PersistStateInterval=&quot;1&quot;     #回写偏移量数据到文件间隔时间(秒)\n       ruleset=&quot;remote&quot;)          #规则集，rsyslog.conf中定义的rule名称\n</code></pre>\n<h2 id=\"服务端配置\"><a href=\"#服务端配置\" class=\"headerlink\" title=\"服务端配置\"></a>服务端配置</h2><p>定义开启 接收的协议 以及端口</p>\n<pre><code># Provides UDP syslog reception\n$ModLoad imudp\n$UDPServerRun 514\n \n# Provides TCP syslog reception\n$ModLoad imtcp\n$InputTCPServerRun 514\n</code></pre>\n<p>定义模版</p>\n<p>   1.示例1</p>\n<pre><code>#生成模板\n$template SpiceTmpl,&quot;%msg:2:$%\\n&quot;\n$template CatalinaDynaFile,&quot;/var/log/rsyslog/%fromhost-ip%/catalina_%$YEAR%-%$MONTH%-%$DAY%.log&quot;\n  \n#匹配规则，文章后面将分享其他配置类型\n:fromhost-ip,contains,&quot;192.168.88.132&quot; ?CatalinaDynaFile;SpiceTmpl\n</code></pre>\n<p>   2.示例2</p>\n<pre><code>$template RemoteLogs,&quot;/var/log/syslog/%$YEAR%-%$MONTH%-%$DAY%/%FROMHOST-IP%-%programname%.log&quot;\n*.* ?RemoteLogs\n&amp; ~\n</code></pre>\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><pre><code>-it error：这是两个选项的组合。-i选项指定附加进程ID（PID）到日志消息中，-t error选项指定将&quot;error&quot;作为消息的标记（TAG）。\n-p local5.crit：这是指定日志消息的优先级的选项。在这个例子中，local5.crit表示使用syslog的local5设施和crit（严重）优先级。\n&quot;hello world&quot;：这是要记录的实际消息内容。\n\n该命令用于向系统日志中添加一条日志消息\nlogger -it local1 -p local1.info &quot;hello&quot;\n</code></pre>\n"},{"title":"java学习2-运行javaee程序","abbrlink":"2b88779d","date":"2024-04-10T02:09:40.000Z","_content":"\n\n# 目录结构\n\nsrc：（source）存放所有资源和代码\n        main：主程序\n                ○ java（源 根）：.java文件。package 包路径com.项目名称\n                ○ resources（资源 根）：资源文件，如xml、properties配置文件。\n                        templates：动态页面，如 thymeleaf 页面。\n                                需要服务器渲染，所以直接访问是无意义的，也访问不到。\n                        static：静态资源，如 html、css、js、image。\n                                □ 可直接 localhost:8080/hello.html 访问该目录文件。\n                                □ 也可 return \"hello.html\"; 跳转。\n                        编译后，resources和源根在同一目录下！\n                ○ lib：存放 jar包，需要设置添加到库。\n                ○ webapp：web资源\n                        页面静态资源：html、css、js、图片 \n                        WEB-INF：固定写法。此目录下的文件不能被外部(浏览器)直接访问。\n                                lib：jar包存放的目录\n                                web.xml：web 项目的配置文件(3.0规范之后可以省略)\n                                classes：target中，java编译生成class文件和资源文件存放的路径。对于war项目，配置文件中的classpath就是指这里。\n        test：测试程序\n                java（测试 根）：.java文件。\n                resources（测试资源 根）：资源文件，如xml、properties配置文件。\npom.xml：maven 配置文件。\ntarget：存放 Maven 构建当前模块，所生成的输出文件。\n        classes：这就是 classpath。\n                com.**：存放编译后的 .class 文件\n                资源文件：src/main/resources 的所有文件。\n模块配置文件.iml\n\n# 运行程序代码\n\n```java\npackage com.study;\nimport javax.servlet.*;\nimport java.io.IOException;\nimport java.io.PrintWriter;\npublic class MyFirstServlet implements Servlet {\n    public void init(ServletConfig config) throws ServletException {\n        System.out.println(\"Init\");\n    }\n    public void service(ServletRequest request, ServletResponse response)\n            throws ServletException, IOException {\n        System.out.println(\"From service\");\n        PrintWriter out = response.getWriter();\n        out.println(\"Hello, Java Web.\");\n    }\n    public void destroy() {\n        System.out.println(\"Destroy\");\n    }\n    public String getServletInfo() {\n        return null;\n    }\n    public ServletConfig getServletConfig() {\n        return null;\n    }\n}\n```\njavax.servlet 这个包找不到。前面提的过 Servlet API 是包含在 JavaEE 当中的。\n为了方便，我们直接使用 Tomcat 附带的 servlet-api.jar 包。\n下载 tomcat 就有\nidea 具体操作如下图\n方法一\n![lena](../pic/java2-1.png)\n\n方法二\n![lena](../pic/java2-2.png)\n\n\n# 运行程序\nidea 调试\nidea 配置tomcat 直接点击运行就可以了\nidea 配置tomcat如下\n![lena](../pic/java2-3.jpg)\n\n\n服务器部署。\n\ntomcat 目录下的webapps 目录创建项目目录\n示例如下：\n    webapps\n      - MyFirstServlet\n        - WEB-INF\n          - web.xml\n\n<font color=\"red\">将 IDEA 编译出的产物（默认应该在 out/target 文件夹中）</font>，\n把 package 结构已经对应的产物拷贝到 WEB-INF 中的 classes 文件\nwebapps\n  - MyFirstServlet\n    - WEB-INF\n      - classes\n        - com\n          - skyline\n            - MyFirstServlet.class\n      - web.xml\n\n\n# 遇到问题\n\n1.为啥idea 编译后 有时候在out 目录下 有时候子安target 目录下\n\n在IDEA中，编译后生成的输出文件可以存放在不同的目录中，一般是由项目的配置文件决定的。\n如果项目使用了Maven或者Gradle等构建工具，那么编译后的输出文件会存放在target目录下；\n如果项目没有使用构建工具或者使用了自定义的构建配置，那么可以在IDEA中设置输出目录路径，\n可能会存放在out目录下","source":"_posts/java开发-运行javaee程序.md","raw":"---\ntitle: java学习2-运行javaee程序\nabbrlink: 2b88779d\ndate: 2024-04-10 10:09:40\ntags:\n---\n\n\n# 目录结构\n\nsrc：（source）存放所有资源和代码\n        main：主程序\n                ○ java（源 根）：.java文件。package 包路径com.项目名称\n                ○ resources（资源 根）：资源文件，如xml、properties配置文件。\n                        templates：动态页面，如 thymeleaf 页面。\n                                需要服务器渲染，所以直接访问是无意义的，也访问不到。\n                        static：静态资源，如 html、css、js、image。\n                                □ 可直接 localhost:8080/hello.html 访问该目录文件。\n                                □ 也可 return \"hello.html\"; 跳转。\n                        编译后，resources和源根在同一目录下！\n                ○ lib：存放 jar包，需要设置添加到库。\n                ○ webapp：web资源\n                        页面静态资源：html、css、js、图片 \n                        WEB-INF：固定写法。此目录下的文件不能被外部(浏览器)直接访问。\n                                lib：jar包存放的目录\n                                web.xml：web 项目的配置文件(3.0规范之后可以省略)\n                                classes：target中，java编译生成class文件和资源文件存放的路径。对于war项目，配置文件中的classpath就是指这里。\n        test：测试程序\n                java（测试 根）：.java文件。\n                resources（测试资源 根）：资源文件，如xml、properties配置文件。\npom.xml：maven 配置文件。\ntarget：存放 Maven 构建当前模块，所生成的输出文件。\n        classes：这就是 classpath。\n                com.**：存放编译后的 .class 文件\n                资源文件：src/main/resources 的所有文件。\n模块配置文件.iml\n\n# 运行程序代码\n\n```java\npackage com.study;\nimport javax.servlet.*;\nimport java.io.IOException;\nimport java.io.PrintWriter;\npublic class MyFirstServlet implements Servlet {\n    public void init(ServletConfig config) throws ServletException {\n        System.out.println(\"Init\");\n    }\n    public void service(ServletRequest request, ServletResponse response)\n            throws ServletException, IOException {\n        System.out.println(\"From service\");\n        PrintWriter out = response.getWriter();\n        out.println(\"Hello, Java Web.\");\n    }\n    public void destroy() {\n        System.out.println(\"Destroy\");\n    }\n    public String getServletInfo() {\n        return null;\n    }\n    public ServletConfig getServletConfig() {\n        return null;\n    }\n}\n```\njavax.servlet 这个包找不到。前面提的过 Servlet API 是包含在 JavaEE 当中的。\n为了方便，我们直接使用 Tomcat 附带的 servlet-api.jar 包。\n下载 tomcat 就有\nidea 具体操作如下图\n方法一\n![lena](../pic/java2-1.png)\n\n方法二\n![lena](../pic/java2-2.png)\n\n\n# 运行程序\nidea 调试\nidea 配置tomcat 直接点击运行就可以了\nidea 配置tomcat如下\n![lena](../pic/java2-3.jpg)\n\n\n服务器部署。\n\ntomcat 目录下的webapps 目录创建项目目录\n示例如下：\n    webapps\n      - MyFirstServlet\n        - WEB-INF\n          - web.xml\n\n<font color=\"red\">将 IDEA 编译出的产物（默认应该在 out/target 文件夹中）</font>，\n把 package 结构已经对应的产物拷贝到 WEB-INF 中的 classes 文件\nwebapps\n  - MyFirstServlet\n    - WEB-INF\n      - classes\n        - com\n          - skyline\n            - MyFirstServlet.class\n      - web.xml\n\n\n# 遇到问题\n\n1.为啥idea 编译后 有时候在out 目录下 有时候子安target 目录下\n\n在IDEA中，编译后生成的输出文件可以存放在不同的目录中，一般是由项目的配置文件决定的。\n如果项目使用了Maven或者Gradle等构建工具，那么编译后的输出文件会存放在target目录下；\n如果项目没有使用构建工具或者使用了自定义的构建配置，那么可以在IDEA中设置输出目录路径，\n可能会存放在out目录下","slug":"java开发-运行javaee程序","published":1,"updated":"2024-04-10T07:05:29.734Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm04ukh6w000h4koccnle20km","content":"<h1 id=\"目录结构\"><a href=\"#目录结构\" class=\"headerlink\" title=\"目录结构\"></a>目录结构</h1><p>src：（source）存放所有资源和代码<br>        main：主程序<br>                ○ java（源 根）：.java文件。package 包路径com.项目名称<br>                ○ resources（资源 根）：资源文件，如xml、properties配置文件。<br>                        templates：动态页面，如 thymeleaf 页面。<br>                                需要服务器渲染，所以直接访问是无意义的，也访问不到。<br>                        static：静态资源，如 html、css、js、image。<br>                                □ 可直接 localhost:8080/hello.html 访问该目录文件。<br>                                □ 也可 return “hello.html”; 跳转。<br>                        编译后，resources和源根在同一目录下！<br>                ○ lib：存放 jar包，需要设置添加到库。<br>                ○ webapp：web资源<br>                        页面静态资源：html、css、js、图片<br>                        WEB-INF：固定写法。此目录下的文件不能被外部(浏览器)直接访问。<br>                                lib：jar包存放的目录<br>                                web.xml：web 项目的配置文件(3.0规范之后可以省略)<br>                                classes：target中，java编译生成class文件和资源文件存放的路径。对于war项目，配置文件中的classpath就是指这里。<br>        test：测试程序<br>                java（测试 根）：.java文件。<br>                resources（测试资源 根）：资源文件，如xml、properties配置文件。<br>pom.xml：maven 配置文件。<br>target：存放 Maven 构建当前模块，所生成的输出文件。<br>        classes：这就是 classpath。<br>                com.**：存放编译后的 .class 文件<br>                资源文件：src/main/resources 的所有文件。<br>模块配置文件.iml</p>\n<h1 id=\"运行程序代码\"><a href=\"#运行程序代码\" class=\"headerlink\" title=\"运行程序代码\"></a>运行程序代码</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.study;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.PrintWriter;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyFirstServlet</span> <span class=\"keyword\">implements</span> <span class=\"title\">Servlet</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(ServletConfig config)</span> <span class=\"keyword\">throws</span> ServletException </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Init&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">service</span><span class=\"params\">(ServletRequest request, ServletResponse response)</span></span></span><br><span class=\"line\"><span class=\"function\">            <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;From service&quot;</span>);</span><br><span class=\"line\">        PrintWriter out = response.getWriter();</span><br><span class=\"line\">        out.println(<span class=\"string\">&quot;Hello, Java Web.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">destroy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Destroy&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getServletInfo</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ServletConfig <span class=\"title\">getServletConfig</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>javax.servlet 这个包找不到。前面提的过 Servlet API 是包含在 JavaEE 当中的。<br>为了方便，我们直接使用 Tomcat 附带的 servlet-api.jar 包。<br>下载 tomcat 就有<br>idea 具体操作如下图<br>方法一<br><img src=\"../pic/java2-1.png\" alt=\"lena\"></p>\n<p>方法二<br><img src=\"../pic/java2-2.png\" alt=\"lena\"></p>\n<h1 id=\"运行程序\"><a href=\"#运行程序\" class=\"headerlink\" title=\"运行程序\"></a>运行程序</h1><p>idea 调试<br>idea 配置tomcat 直接点击运行就可以了<br>idea 配置tomcat如下<br><img src=\"../pic/java2-3.jpg\" alt=\"lena\"></p>\n<p>服务器部署。</p>\n<p>tomcat 目录下的webapps 目录创建项目目录<br>示例如下：<br>    webapps<br>      - MyFirstServlet<br>        - WEB-INF<br>          - web.xml</p>\n<p><font color=\"red\">将 IDEA 编译出的产物（默认应该在 out/target 文件夹中）</font>，<br>把 package 结构已经对应的产物拷贝到 WEB-INF 中的 classes 文件<br>webapps</p>\n<ul>\n<li>MyFirstServlet<ul>\n<li>WEB-INF<ul>\n<li>classes<ul>\n<li>com<ul>\n<li>skyline<ul>\n<li>MyFirstServlet.class</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>web.xml</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"遇到问题\"><a href=\"#遇到问题\" class=\"headerlink\" title=\"遇到问题\"></a>遇到问题</h1><p>1.为啥idea 编译后 有时候在out 目录下 有时候子安target 目录下</p>\n<p>在IDEA中，编译后生成的输出文件可以存放在不同的目录中，一般是由项目的配置文件决定的。<br>如果项目使用了Maven或者Gradle等构建工具，那么编译后的输出文件会存放在target目录下；<br>如果项目没有使用构建工具或者使用了自定义的构建配置，那么可以在IDEA中设置输出目录路径，<br>可能会存放在out目录下</p>\n","site":{"data":{}},"length":1957,"excerpt":"","more":"<h1 id=\"目录结构\"><a href=\"#目录结构\" class=\"headerlink\" title=\"目录结构\"></a>目录结构</h1><p>src：（source）存放所有资源和代码<br>        main：主程序<br>                ○ java（源 根）：.java文件。package 包路径com.项目名称<br>                ○ resources（资源 根）：资源文件，如xml、properties配置文件。<br>                        templates：动态页面，如 thymeleaf 页面。<br>                                需要服务器渲染，所以直接访问是无意义的，也访问不到。<br>                        static：静态资源，如 html、css、js、image。<br>                                □ 可直接 localhost:8080/hello.html 访问该目录文件。<br>                                □ 也可 return “hello.html”; 跳转。<br>                        编译后，resources和源根在同一目录下！<br>                ○ lib：存放 jar包，需要设置添加到库。<br>                ○ webapp：web资源<br>                        页面静态资源：html、css、js、图片<br>                        WEB-INF：固定写法。此目录下的文件不能被外部(浏览器)直接访问。<br>                                lib：jar包存放的目录<br>                                web.xml：web 项目的配置文件(3.0规范之后可以省略)<br>                                classes：target中，java编译生成class文件和资源文件存放的路径。对于war项目，配置文件中的classpath就是指这里。<br>        test：测试程序<br>                java（测试 根）：.java文件。<br>                resources（测试资源 根）：资源文件，如xml、properties配置文件。<br>pom.xml：maven 配置文件。<br>target：存放 Maven 构建当前模块，所生成的输出文件。<br>        classes：这就是 classpath。<br>                com.**：存放编译后的 .class 文件<br>                资源文件：src/main/resources 的所有文件。<br>模块配置文件.iml</p>\n<h1 id=\"运行程序代码\"><a href=\"#运行程序代码\" class=\"headerlink\" title=\"运行程序代码\"></a>运行程序代码</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.study;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.PrintWriter;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyFirstServlet</span> <span class=\"keyword\">implements</span> <span class=\"title\">Servlet</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(ServletConfig config)</span> <span class=\"keyword\">throws</span> ServletException </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Init&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">service</span><span class=\"params\">(ServletRequest request, ServletResponse response)</span></span></span><br><span class=\"line\"><span class=\"function\">            <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;From service&quot;</span>);</span><br><span class=\"line\">        PrintWriter out = response.getWriter();</span><br><span class=\"line\">        out.println(<span class=\"string\">&quot;Hello, Java Web.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">destroy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Destroy&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getServletInfo</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ServletConfig <span class=\"title\">getServletConfig</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>javax.servlet 这个包找不到。前面提的过 Servlet API 是包含在 JavaEE 当中的。<br>为了方便，我们直接使用 Tomcat 附带的 servlet-api.jar 包。<br>下载 tomcat 就有<br>idea 具体操作如下图<br>方法一<br><img src=\"../pic/java2-1.png\" alt=\"lena\"></p>\n<p>方法二<br><img src=\"../pic/java2-2.png\" alt=\"lena\"></p>\n<h1 id=\"运行程序\"><a href=\"#运行程序\" class=\"headerlink\" title=\"运行程序\"></a>运行程序</h1><p>idea 调试<br>idea 配置tomcat 直接点击运行就可以了<br>idea 配置tomcat如下<br><img src=\"../pic/java2-3.jpg\" alt=\"lena\"></p>\n<p>服务器部署。</p>\n<p>tomcat 目录下的webapps 目录创建项目目录<br>示例如下：<br>    webapps<br>      - MyFirstServlet<br>        - WEB-INF<br>          - web.xml</p>\n<p><font color=\"red\">将 IDEA 编译出的产物（默认应该在 out/target 文件夹中）</font>，<br>把 package 结构已经对应的产物拷贝到 WEB-INF 中的 classes 文件<br>webapps</p>\n<ul>\n<li>MyFirstServlet<ul>\n<li>WEB-INF<ul>\n<li>classes<ul>\n<li>com<ul>\n<li>skyline<ul>\n<li>MyFirstServlet.class</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>web.xml</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"遇到问题\"><a href=\"#遇到问题\" class=\"headerlink\" title=\"遇到问题\"></a>遇到问题</h1><p>1.为啥idea 编译后 有时候在out 目录下 有时候子安target 目录下</p>\n<p>在IDEA中，编译后生成的输出文件可以存放在不同的目录中，一般是由项目的配置文件决定的。<br>如果项目使用了Maven或者Gradle等构建工具，那么编译后的输出文件会存放在target目录下；<br>如果项目没有使用构建工具或者使用了自定义的构建配置，那么可以在IDEA中设置输出目录路径，<br>可能会存放在out目录下</p>\n"},{"title":"linux-系统后台运行任务","abbrlink":"66259c3b","date":"2023-07-19T01:15:25.000Z","_content":"","source":"_posts/linux-后台运行任务.md","raw":"---\ntitle: linux-系统后台运行任务\nabbrlink: 66259c3b\ndate: 2023-07-19 09:15:25\ntags:\n  - linux\ncategories:\n  - 服务器相关   \n---\n","slug":"linux-后台运行任务","published":1,"updated":"2024-11-25T11:19:33.547Z","_id":"cm04ukh6z000i4koc2gs4gses","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"linux-守护进程supervisor服务","abbrlink":"28b7458e","date":"2023-07-19T03:38:09.000Z","_content":"\n# 一、安装\n\n    yum install supervisor    #centos 系统\n    \n    apt install supervisor    #ubuntu 系统\n    \n    \n# 二、配置守护进程   \n\n<font color='red'>在/etc/supervisord.d/下新建后缀名为ini的文件</font>\n\n    ; 设置进程的名称，使用 supervisorctl 来管理进程时需要使用该进程名\n    [program:myblog] \n    directory = /home/web/myblog          ; 程序的启动目录\n    command=./start.sh start              ; 启动命令 最好绝对路径\n    autostart = true                      ; 在 supervisord 启动的时候也自动启动\n    numprocs=1                            ; 默认为1\n    RestartSec=30\n    process_name=%(program_name)s         ; 默认为 %(program_name)s，即 [program:x] 中的 x\n    user=root                             ; 使用 root 用户来启动该进程\n    autorestart=true                      ; 程序崩溃时自动重启，重启次数是有限制的，默认为3次\n    redirect_stderr=true                  ; 重定向输出的日志\n    stderr_logfile= /home/web/myblog/myblog_stderr.log\n    stdout_logfile = /home/web/myblog/myblog_stdout.log\n    loglevel=info\n    \n# 三、supervisord管理\n\n    systemctl status  supervisord\n    systemctl start  supervisord  \n    systemctl stop  supervisord  \n    systemctl restart  supervisord  \n   \n# 四、supervisorctl管理    \n    \n    supervisorctl status 查看进程运行状态\n    \n    supervisorctl start 进程名 启动进程\n    \n    supervisorctl stop 进程名 关闭进程\n    \n    supervisorctl restart 进程名 重启进程\n    \n    supervisorctl reread 重新读取配置\n    \n    supervisorctl update 重新载入配置文件\n    \n    supervisorctl shutdown 关闭supervisord\n    \n    supervisorctl clear 进程名 清空进程日志\n    \n    supervisorctl 进入到交互模式下。使用help查看所有命令。\n    \n    start stop restart + all 表示启动，关闭，重启所有进程。\n    \n示例\n\n    supervisorctl start myblog\n    supervisorctl status myblog\n    supervisorctl status \n    supervisorctl update\n    \n# 五、案例\n\n\n    /etc/supervisor/conf.d/huanjing-queue.conf\n    \n    \n    [program:hjqueue]\n    directory = /www/wwwroot/huanjingjiance.kuaidasoft.com          ; 程序的启动目录\n    command= bash -c \"sudo -u www  /www/server/php/73/bin/php think queue:listen --queue=hj212 >> /www/wwwroot/huanjingjiance.kuaidasoft.com/runtime/log/queue.log 2>&1\"          ; 启动命令 最好绝对路径\n    autostart = true                      ; 在 supervisord 启动的时候也自动启动\n    numprocs=1                            ; 默认为1\n    RestartSec=30\n    process_name=hjqueue         ; 默认为 %(program_name)s，即 [program:x] 中的 x\n    user=root                             ; 使用 root 用户来启动该进程\n    autorestart=true                      ; 程序崩溃时自动重启，重启次数是有限制的，默认为3次\n    redirect_stderr=true                  ; 重定向输出的日志\n    stderr_logfile= /www/wwwroot/huanjingjiance.kuaidasoft.com/runtime/log/huanjing_stderr.log\n    stdout_logfile = /www/wwwroot/huanjingjiance.kuaidasoft.com/runtime/log/huanjing_stdout.log\n    loglevel=info\n    \n    \n    supervisorctl status hjqueue\n    supervisorctl start hjqueue\n    \n    \n    \n    \n\n        ","source":"_posts/linux-守护进程supervisor服务.md","raw":"---\ntitle: linux-守护进程supervisor服务\nabbrlink: 28b7458e\ndate: 2023-07-19 11:38:09\ntags:\n  - linux\ncategories:\n  - 服务器相关   \n---\n\n# 一、安装\n\n    yum install supervisor    #centos 系统\n    \n    apt install supervisor    #ubuntu 系统\n    \n    \n# 二、配置守护进程   \n\n<font color='red'>在/etc/supervisord.d/下新建后缀名为ini的文件</font>\n\n    ; 设置进程的名称，使用 supervisorctl 来管理进程时需要使用该进程名\n    [program:myblog] \n    directory = /home/web/myblog          ; 程序的启动目录\n    command=./start.sh start              ; 启动命令 最好绝对路径\n    autostart = true                      ; 在 supervisord 启动的时候也自动启动\n    numprocs=1                            ; 默认为1\n    RestartSec=30\n    process_name=%(program_name)s         ; 默认为 %(program_name)s，即 [program:x] 中的 x\n    user=root                             ; 使用 root 用户来启动该进程\n    autorestart=true                      ; 程序崩溃时自动重启，重启次数是有限制的，默认为3次\n    redirect_stderr=true                  ; 重定向输出的日志\n    stderr_logfile= /home/web/myblog/myblog_stderr.log\n    stdout_logfile = /home/web/myblog/myblog_stdout.log\n    loglevel=info\n    \n# 三、supervisord管理\n\n    systemctl status  supervisord\n    systemctl start  supervisord  \n    systemctl stop  supervisord  \n    systemctl restart  supervisord  \n   \n# 四、supervisorctl管理    \n    \n    supervisorctl status 查看进程运行状态\n    \n    supervisorctl start 进程名 启动进程\n    \n    supervisorctl stop 进程名 关闭进程\n    \n    supervisorctl restart 进程名 重启进程\n    \n    supervisorctl reread 重新读取配置\n    \n    supervisorctl update 重新载入配置文件\n    \n    supervisorctl shutdown 关闭supervisord\n    \n    supervisorctl clear 进程名 清空进程日志\n    \n    supervisorctl 进入到交互模式下。使用help查看所有命令。\n    \n    start stop restart + all 表示启动，关闭，重启所有进程。\n    \n示例\n\n    supervisorctl start myblog\n    supervisorctl status myblog\n    supervisorctl status \n    supervisorctl update\n    \n# 五、案例\n\n\n    /etc/supervisor/conf.d/huanjing-queue.conf\n    \n    \n    [program:hjqueue]\n    directory = /www/wwwroot/huanjingjiance.kuaidasoft.com          ; 程序的启动目录\n    command= bash -c \"sudo -u www  /www/server/php/73/bin/php think queue:listen --queue=hj212 >> /www/wwwroot/huanjingjiance.kuaidasoft.com/runtime/log/queue.log 2>&1\"          ; 启动命令 最好绝对路径\n    autostart = true                      ; 在 supervisord 启动的时候也自动启动\n    numprocs=1                            ; 默认为1\n    RestartSec=30\n    process_name=hjqueue         ; 默认为 %(program_name)s，即 [program:x] 中的 x\n    user=root                             ; 使用 root 用户来启动该进程\n    autorestart=true                      ; 程序崩溃时自动重启，重启次数是有限制的，默认为3次\n    redirect_stderr=true                  ; 重定向输出的日志\n    stderr_logfile= /www/wwwroot/huanjingjiance.kuaidasoft.com/runtime/log/huanjing_stderr.log\n    stdout_logfile = /www/wwwroot/huanjingjiance.kuaidasoft.com/runtime/log/huanjing_stdout.log\n    loglevel=info\n    \n    \n    supervisorctl status hjqueue\n    supervisorctl start hjqueue\n    \n    \n    \n    \n\n        ","slug":"linux-守护进程supervisor服务","published":1,"updated":"2024-11-25T11:19:38.023Z","_id":"cm04ukh70000j4koce5ttfen8","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、安装\"><a href=\"#一、安装\" class=\"headerlink\" title=\"一、安装\"></a>一、安装</h1><pre><code>yum install supervisor    #centos 系统\n\napt install supervisor    #ubuntu 系统\n</code></pre>\n<h1 id=\"二、配置守护进程\"><a href=\"#二、配置守护进程\" class=\"headerlink\" title=\"二、配置守护进程\"></a>二、配置守护进程</h1><p><font color='red'>在/etc/supervisord.d/下新建后缀名为ini的文件</font></p>\n<pre><code>; 设置进程的名称，使用 supervisorctl 来管理进程时需要使用该进程名\n[program:myblog] \ndirectory = /home/web/myblog          ; 程序的启动目录\ncommand=./start.sh start              ; 启动命令 最好绝对路径\nautostart = true                      ; 在 supervisord 启动的时候也自动启动\nnumprocs=1                            ; 默认为1\nRestartSec=30\nprocess_name=%(program_name)s         ; 默认为 %(program_name)s，即 [program:x] 中的 x\nuser=root                             ; 使用 root 用户来启动该进程\nautorestart=true                      ; 程序崩溃时自动重启，重启次数是有限制的，默认为3次\nredirect_stderr=true                  ; 重定向输出的日志\nstderr_logfile= /home/web/myblog/myblog_stderr.log\nstdout_logfile = /home/web/myblog/myblog_stdout.log\nloglevel=info\n</code></pre>\n<h1 id=\"三、supervisord管理\"><a href=\"#三、supervisord管理\" class=\"headerlink\" title=\"三、supervisord管理\"></a>三、supervisord管理</h1><pre><code>systemctl status  supervisord\nsystemctl start  supervisord  \nsystemctl stop  supervisord  \nsystemctl restart  supervisord  \n</code></pre>\n<h1 id=\"四、supervisorctl管理\"><a href=\"#四、supervisorctl管理\" class=\"headerlink\" title=\"四、supervisorctl管理\"></a>四、supervisorctl管理</h1><pre><code>supervisorctl status 查看进程运行状态\n\nsupervisorctl start 进程名 启动进程\n\nsupervisorctl stop 进程名 关闭进程\n\nsupervisorctl restart 进程名 重启进程\n\nsupervisorctl reread 重新读取配置\n\nsupervisorctl update 重新载入配置文件\n\nsupervisorctl shutdown 关闭supervisord\n\nsupervisorctl clear 进程名 清空进程日志\n\nsupervisorctl 进入到交互模式下。使用help查看所有命令。\n\nstart stop restart + all 表示启动，关闭，重启所有进程。\n</code></pre>\n<p>示例</p>\n<pre><code>supervisorctl start myblog\nsupervisorctl status myblog\nsupervisorctl status \nsupervisorctl update\n</code></pre>\n<h1 id=\"五、案例\"><a href=\"#五、案例\" class=\"headerlink\" title=\"五、案例\"></a>五、案例</h1><pre><code>/etc/supervisor/conf.d/huanjing-queue.conf\n\n\n[program:hjqueue]\ndirectory = /www/wwwroot/huanjingjiance.kuaidasoft.com          ; 程序的启动目录\ncommand= bash -c &quot;sudo -u www  /www/server/php/73/bin/php think queue:listen --queue=hj212 &gt;&gt; /www/wwwroot/huanjingjiance.kuaidasoft.com/runtime/log/queue.log 2&gt;&amp;1&quot;          ; 启动命令 最好绝对路径\nautostart = true                      ; 在 supervisord 启动的时候也自动启动\nnumprocs=1                            ; 默认为1\nRestartSec=30\nprocess_name=hjqueue         ; 默认为 %(program_name)s，即 [program:x] 中的 x\nuser=root                             ; 使用 root 用户来启动该进程\nautorestart=true                      ; 程序崩溃时自动重启，重启次数是有限制的，默认为3次\nredirect_stderr=true                  ; 重定向输出的日志\nstderr_logfile= /www/wwwroot/huanjingjiance.kuaidasoft.com/runtime/log/huanjing_stderr.log\nstdout_logfile = /www/wwwroot/huanjingjiance.kuaidasoft.com/runtime/log/huanjing_stdout.log\nloglevel=info\n\n\nsupervisorctl status hjqueue\nsupervisorctl start hjqueue\n\n\n\n\n\n    \n</code></pre>\n","site":{"data":{}},"length":1836,"excerpt":"","more":"<h1 id=\"一、安装\"><a href=\"#一、安装\" class=\"headerlink\" title=\"一、安装\"></a>一、安装</h1><pre><code>yum install supervisor    #centos 系统\n\napt install supervisor    #ubuntu 系统\n</code></pre>\n<h1 id=\"二、配置守护进程\"><a href=\"#二、配置守护进程\" class=\"headerlink\" title=\"二、配置守护进程\"></a>二、配置守护进程</h1><p><font color='red'>在/etc/supervisord.d/下新建后缀名为ini的文件</font></p>\n<pre><code>; 设置进程的名称，使用 supervisorctl 来管理进程时需要使用该进程名\n[program:myblog] \ndirectory = /home/web/myblog          ; 程序的启动目录\ncommand=./start.sh start              ; 启动命令 最好绝对路径\nautostart = true                      ; 在 supervisord 启动的时候也自动启动\nnumprocs=1                            ; 默认为1\nRestartSec=30\nprocess_name=%(program_name)s         ; 默认为 %(program_name)s，即 [program:x] 中的 x\nuser=root                             ; 使用 root 用户来启动该进程\nautorestart=true                      ; 程序崩溃时自动重启，重启次数是有限制的，默认为3次\nredirect_stderr=true                  ; 重定向输出的日志\nstderr_logfile= /home/web/myblog/myblog_stderr.log\nstdout_logfile = /home/web/myblog/myblog_stdout.log\nloglevel=info\n</code></pre>\n<h1 id=\"三、supervisord管理\"><a href=\"#三、supervisord管理\" class=\"headerlink\" title=\"三、supervisord管理\"></a>三、supervisord管理</h1><pre><code>systemctl status  supervisord\nsystemctl start  supervisord  \nsystemctl stop  supervisord  \nsystemctl restart  supervisord  \n</code></pre>\n<h1 id=\"四、supervisorctl管理\"><a href=\"#四、supervisorctl管理\" class=\"headerlink\" title=\"四、supervisorctl管理\"></a>四、supervisorctl管理</h1><pre><code>supervisorctl status 查看进程运行状态\n\nsupervisorctl start 进程名 启动进程\n\nsupervisorctl stop 进程名 关闭进程\n\nsupervisorctl restart 进程名 重启进程\n\nsupervisorctl reread 重新读取配置\n\nsupervisorctl update 重新载入配置文件\n\nsupervisorctl shutdown 关闭supervisord\n\nsupervisorctl clear 进程名 清空进程日志\n\nsupervisorctl 进入到交互模式下。使用help查看所有命令。\n\nstart stop restart + all 表示启动，关闭，重启所有进程。\n</code></pre>\n<p>示例</p>\n<pre><code>supervisorctl start myblog\nsupervisorctl status myblog\nsupervisorctl status \nsupervisorctl update\n</code></pre>\n<h1 id=\"五、案例\"><a href=\"#五、案例\" class=\"headerlink\" title=\"五、案例\"></a>五、案例</h1><pre><code>/etc/supervisor/conf.d/huanjing-queue.conf\n\n\n[program:hjqueue]\ndirectory = /www/wwwroot/huanjingjiance.kuaidasoft.com          ; 程序的启动目录\ncommand= bash -c &quot;sudo -u www  /www/server/php/73/bin/php think queue:listen --queue=hj212 &gt;&gt; /www/wwwroot/huanjingjiance.kuaidasoft.com/runtime/log/queue.log 2&gt;&amp;1&quot;          ; 启动命令 最好绝对路径\nautostart = true                      ; 在 supervisord 启动的时候也自动启动\nnumprocs=1                            ; 默认为1\nRestartSec=30\nprocess_name=hjqueue         ; 默认为 %(program_name)s，即 [program:x] 中的 x\nuser=root                             ; 使用 root 用户来启动该进程\nautorestart=true                      ; 程序崩溃时自动重启，重启次数是有限制的，默认为3次\nredirect_stderr=true                  ; 重定向输出的日志\nstderr_logfile= /www/wwwroot/huanjingjiance.kuaidasoft.com/runtime/log/huanjing_stderr.log\nstdout_logfile = /www/wwwroot/huanjingjiance.kuaidasoft.com/runtime/log/huanjing_stdout.log\nloglevel=info\n\n\nsupervisorctl status hjqueue\nsupervisorctl start hjqueue\n\n\n\n\n\n    \n</code></pre>\n"},{"title":"linux-升级openssh","abbrlink":"59b7aac2","date":"2023-08-01T11:48:14.000Z","_content":"\n\n# centos系统\n    \n## 查看是否安装openssh    \n\n    rpm -qa|grep openssh\n    有则卸载\n    \n    卸载用rpm -e 如果出现依赖包导致无法卸载，在最后面加上--nodeps即可\n    rpm -e openssl --nodeps\n    yum remove openssh-server\n    \n    卸载还可以手动删除\n      /etc/init.d/sshd \n      /etc/ssh\n      /usr/bin/ssh\n      /usr/sbin/sshd\n          \n## 查当前openssh版本是否需要升级\n     \n    ssh -V\n\n## 备份配置文件\n\n    mv /etc/ssh /etc/ssh.bak\n    \n## 下载最新版本\n    \n    https://www.openssh.com/openbsd.html    \n    \n    \n## 编译安装\n\n    ./configure \\\n      --prefix=/usr \\\n      --sysconfdir=/etc/ssh \\\n      --with-md5-passwords \\\n      --with-pam \\\n      --with-tcp-wrappers \\\n      --with-ssl-dir=/usr/local/ssl\n      \n      \n      make && make install\n        \n## 修改相关配置\n\n    cp -p contrib/redhat/sshd.init /etc/init.d/sshd \n    \n    chmod u+x /etc/init.d/sshd \n    \n    /etc/init.d/sshd start 此命令后就加入systemctl\n    \n    systemctl enable sshd 加入开机启动\n    \n    # vim /etc/ssh/sshd_config\n    PermitRootLogin yes                #允许root账户登录，单root账户必须加上，其他的参数请自行修改\n    \n ## 报错处理\n \n    1.编译时报错\n    \n        configure: error: PAM headers not found\n        \n    解决方法\n        \n        yum -y install pam-devel\n        \n        \n    2.编译别的目录，然后通过相应文件覆盖或者软连接方式更新\n      如果密码正确 就是登录不上\n      \n      删除重装     \n\n\n# ubutun系统\n\n## 查看是否安装\n\n    dpkg --list|grep ssh\n    卸载\n    sudo apt-get remove openssh-server \n    \n## 编译过程参考centos即可    ","source":"_posts/linux-升级openssh.md","raw":"---\ntitle: linux-升级openssh\nabbrlink: 59b7aac2\ndate: 2023-08-01 19:48:14\ntags:\n  - linux\ncategories:\n  - 服务器相关 \n---\n\n\n# centos系统\n    \n## 查看是否安装openssh    \n\n    rpm -qa|grep openssh\n    有则卸载\n    \n    卸载用rpm -e 如果出现依赖包导致无法卸载，在最后面加上--nodeps即可\n    rpm -e openssl --nodeps\n    yum remove openssh-server\n    \n    卸载还可以手动删除\n      /etc/init.d/sshd \n      /etc/ssh\n      /usr/bin/ssh\n      /usr/sbin/sshd\n          \n## 查当前openssh版本是否需要升级\n     \n    ssh -V\n\n## 备份配置文件\n\n    mv /etc/ssh /etc/ssh.bak\n    \n## 下载最新版本\n    \n    https://www.openssh.com/openbsd.html    \n    \n    \n## 编译安装\n\n    ./configure \\\n      --prefix=/usr \\\n      --sysconfdir=/etc/ssh \\\n      --with-md5-passwords \\\n      --with-pam \\\n      --with-tcp-wrappers \\\n      --with-ssl-dir=/usr/local/ssl\n      \n      \n      make && make install\n        \n## 修改相关配置\n\n    cp -p contrib/redhat/sshd.init /etc/init.d/sshd \n    \n    chmod u+x /etc/init.d/sshd \n    \n    /etc/init.d/sshd start 此命令后就加入systemctl\n    \n    systemctl enable sshd 加入开机启动\n    \n    # vim /etc/ssh/sshd_config\n    PermitRootLogin yes                #允许root账户登录，单root账户必须加上，其他的参数请自行修改\n    \n ## 报错处理\n \n    1.编译时报错\n    \n        configure: error: PAM headers not found\n        \n    解决方法\n        \n        yum -y install pam-devel\n        \n        \n    2.编译别的目录，然后通过相应文件覆盖或者软连接方式更新\n      如果密码正确 就是登录不上\n      \n      删除重装     \n\n\n# ubutun系统\n\n## 查看是否安装\n\n    dpkg --list|grep ssh\n    卸载\n    sudo apt-get remove openssh-server \n    \n## 编译过程参考centos即可    ","slug":"linux-升级openssh","published":1,"updated":"2024-11-25T11:19:21.598Z","_id":"cm04ukh74000l4koc6ui687e3","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"centos系统\"><a href=\"#centos系统\" class=\"headerlink\" title=\"centos系统\"></a>centos系统</h1><h2 id=\"查看是否安装openssh\"><a href=\"#查看是否安装openssh\" class=\"headerlink\" title=\"查看是否安装openssh\"></a>查看是否安装openssh</h2><pre><code>rpm -qa|grep openssh\n有则卸载\n\n卸载用rpm -e 如果出现依赖包导致无法卸载，在最后面加上--nodeps即可\nrpm -e openssl --nodeps\nyum remove openssh-server\n\n卸载还可以手动删除\n  /etc/init.d/sshd \n  /etc/ssh\n  /usr/bin/ssh\n  /usr/sbin/sshd\n      \n</code></pre>\n<h2 id=\"查当前openssh版本是否需要升级\"><a href=\"#查当前openssh版本是否需要升级\" class=\"headerlink\" title=\"查当前openssh版本是否需要升级\"></a>查当前openssh版本是否需要升级</h2><pre><code>ssh -V\n</code></pre>\n<h2 id=\"备份配置文件\"><a href=\"#备份配置文件\" class=\"headerlink\" title=\"备份配置文件\"></a>备份配置文件</h2><pre><code>mv /etc/ssh /etc/ssh.bak\n</code></pre>\n<h2 id=\"下载最新版本\"><a href=\"#下载最新版本\" class=\"headerlink\" title=\"下载最新版本\"></a>下载最新版本</h2><pre><code>https://www.openssh.com/openbsd.html    \n</code></pre>\n<h2 id=\"编译安装\"><a href=\"#编译安装\" class=\"headerlink\" title=\"编译安装\"></a>编译安装</h2><pre><code>./configure \\\n  --prefix=/usr \\\n  --sysconfdir=/etc/ssh \\\n  --with-md5-passwords \\\n  --with-pam \\\n  --with-tcp-wrappers \\\n  --with-ssl-dir=/usr/local/ssl\n  \n  \n  make &amp;&amp; make install\n    \n</code></pre>\n<h2 id=\"修改相关配置\"><a href=\"#修改相关配置\" class=\"headerlink\" title=\"修改相关配置\"></a>修改相关配置</h2><pre><code>cp -p contrib/redhat/sshd.init /etc/init.d/sshd \n\nchmod u+x /etc/init.d/sshd \n\n/etc/init.d/sshd start 此命令后就加入systemctl\n\nsystemctl enable sshd 加入开机启动\n\n# vim /etc/ssh/sshd_config\nPermitRootLogin yes                #允许root账户登录，单root账户必须加上，其他的参数请自行修改\n</code></pre>\n<h2 id=\"报错处理\"><a href=\"#报错处理\" class=\"headerlink\" title=\"报错处理\"></a>报错处理</h2><pre><code>1.编译时报错\n\n    configure: error: PAM headers not found\n    \n解决方法\n    \n    yum -y install pam-devel\n    \n    \n2.编译别的目录，然后通过相应文件覆盖或者软连接方式更新\n  如果密码正确 就是登录不上\n  \n  删除重装     \n</code></pre>\n<h1 id=\"ubutun系统\"><a href=\"#ubutun系统\" class=\"headerlink\" title=\"ubutun系统\"></a>ubutun系统</h1><h2 id=\"查看是否安装\"><a href=\"#查看是否安装\" class=\"headerlink\" title=\"查看是否安装\"></a>查看是否安装</h2><pre><code>dpkg --list|grep ssh\n卸载\nsudo apt-get remove openssh-server \n</code></pre>\n<h2 id=\"编译过程参考centos即可\"><a href=\"#编译过程参考centos即可\" class=\"headerlink\" title=\"编译过程参考centos即可\"></a>编译过程参考centos即可</h2>","site":{"data":{}},"length":839,"excerpt":"","more":"<h1 id=\"centos系统\"><a href=\"#centos系统\" class=\"headerlink\" title=\"centos系统\"></a>centos系统</h1><h2 id=\"查看是否安装openssh\"><a href=\"#查看是否安装openssh\" class=\"headerlink\" title=\"查看是否安装openssh\"></a>查看是否安装openssh</h2><pre><code>rpm -qa|grep openssh\n有则卸载\n\n卸载用rpm -e 如果出现依赖包导致无法卸载，在最后面加上--nodeps即可\nrpm -e openssl --nodeps\nyum remove openssh-server\n\n卸载还可以手动删除\n  /etc/init.d/sshd \n  /etc/ssh\n  /usr/bin/ssh\n  /usr/sbin/sshd\n      \n</code></pre>\n<h2 id=\"查当前openssh版本是否需要升级\"><a href=\"#查当前openssh版本是否需要升级\" class=\"headerlink\" title=\"查当前openssh版本是否需要升级\"></a>查当前openssh版本是否需要升级</h2><pre><code>ssh -V\n</code></pre>\n<h2 id=\"备份配置文件\"><a href=\"#备份配置文件\" class=\"headerlink\" title=\"备份配置文件\"></a>备份配置文件</h2><pre><code>mv /etc/ssh /etc/ssh.bak\n</code></pre>\n<h2 id=\"下载最新版本\"><a href=\"#下载最新版本\" class=\"headerlink\" title=\"下载最新版本\"></a>下载最新版本</h2><pre><code>https://www.openssh.com/openbsd.html    \n</code></pre>\n<h2 id=\"编译安装\"><a href=\"#编译安装\" class=\"headerlink\" title=\"编译安装\"></a>编译安装</h2><pre><code>./configure \\\n  --prefix=/usr \\\n  --sysconfdir=/etc/ssh \\\n  --with-md5-passwords \\\n  --with-pam \\\n  --with-tcp-wrappers \\\n  --with-ssl-dir=/usr/local/ssl\n  \n  \n  make &amp;&amp; make install\n    \n</code></pre>\n<h2 id=\"修改相关配置\"><a href=\"#修改相关配置\" class=\"headerlink\" title=\"修改相关配置\"></a>修改相关配置</h2><pre><code>cp -p contrib/redhat/sshd.init /etc/init.d/sshd \n\nchmod u+x /etc/init.d/sshd \n\n/etc/init.d/sshd start 此命令后就加入systemctl\n\nsystemctl enable sshd 加入开机启动\n\n# vim /etc/ssh/sshd_config\nPermitRootLogin yes                #允许root账户登录，单root账户必须加上，其他的参数请自行修改\n</code></pre>\n<h2 id=\"报错处理\"><a href=\"#报错处理\" class=\"headerlink\" title=\"报错处理\"></a>报错处理</h2><pre><code>1.编译时报错\n\n    configure: error: PAM headers not found\n    \n解决方法\n    \n    yum -y install pam-devel\n    \n    \n2.编译别的目录，然后通过相应文件覆盖或者软连接方式更新\n  如果密码正确 就是登录不上\n  \n  删除重装     \n</code></pre>\n<h1 id=\"ubutun系统\"><a href=\"#ubutun系统\" class=\"headerlink\" title=\"ubutun系统\"></a>ubutun系统</h1><h2 id=\"查看是否安装\"><a href=\"#查看是否安装\" class=\"headerlink\" title=\"查看是否安装\"></a>查看是否安装</h2><pre><code>dpkg --list|grep ssh\n卸载\nsudo apt-get remove openssh-server \n</code></pre>\n<h2 id=\"编译过程参考centos即可\"><a href=\"#编译过程参考centos即可\" class=\"headerlink\" title=\"编译过程参考centos即可\"></a>编译过程参考centos即可</h2>"},{"title":"linux-安装配置php环境","abbrlink":"35d2b340","date":"2022-04-17T14:53:21.000Z","_content":"# 一、安装Remi源：\n\n    # CentOS 6 / RHEL 6\n    yum install http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n    # CentOS 7 / RHEL 7\n    yum install http://rpms.remirepo.net/enterprise/remi-release-7.rpm\n \n \n# 二、配置Remi源(可以不操作)：\n \n     编辑remi源repo文件 /etc/yum.repos.d/remi.repo\n     启用 Remi Repository修改 enabled=0 为 enabled=1。\n     为 Remi Repository 设置合适的优先级在 [remi] 那一节的结尾另起一行添加下面的代码：\n     priority=3    \n    \n    \n# 三、安装 php\n\n     yum install php73 php73-php-fpm php73-php-opcache php73-php-gd php73-php-mbstring php73-php-xml php73-php-pdo php73-php-mysqlnd php73-php-pecl-mysql php73-php-bcmath\n    php73-php-mcrypt   \n    \n    \n# 四.开机启动   \n\n    systemctl enable  php73-php-fpm\n    \n# 五.服务相关命令\n\n    systemctl start  php73-php-fpm\n    systemctl stop  php73-php-fpm\n    systemctl status  php73-php-fpm\n    \n    \n# 六.加入系统命令\n\n    ln -s  /opt/remi/php73/root/usr/bin/php /usr/bin/php\n    \n# 七.添加用户\n    \n    groupadd www\n    useradd -g www -s /sbin/nologin www\n        \n# 八.PHP-FPM配置文件www.conf\n```\n[www]\n\nuser = www\ngroup = www\n\n;listen = 127.0.0.1:9000\nlisten = /dev/shm/php71-fpm.socket\n\nlisten.owner = www\nlisten.group = www\nlisten.mode = 0660\n\n\nlisten.allowed_clients = 127.0.0.1\n\n#如果选择static，则进程数就数固定的，由pm.max_children指定固定的子进程数。\npm = static\npm.max_children = 256\npm.start_servers = 5\n#随着php-fpm一起启动时创建的子进程数目。默认值：min_spare_servers + (max_spare_servers - min_spare_servers) / 2。\n#这里表示，一起启动会有20个子进程\npm.min_spare_servers = 5\n#设置服务器空闲时最小php-fpm进程数量。必须设置。如果空闲的时候，会检查如果少于10个，就会启动几个来补上。\npm.max_spare_servers = 35\n#设置服务器空闲时最大php-fpm进程数量。必须设置。如果空闲时，会检查进程数，多于30个了，就会关闭几个，达到30个的状态。\npm.max_requests = 5000\n#设置每个子进程重生之前服务的请求数. 对于可能存在内存泄漏的第三方模块来说是非常有用的. \n#如果设置为 '0' 则一直接受请求. 等同于 PHP_FCGI_MAX_REQUESTS 环境变量. 默认值: 0.\npm.status_path = /php7-php-fpm-status\n\n#当request_slowlog_timeout 设为一个具体秒时request_slowlog_timeout =5，表\n#示如果哪个脚本执行时间大于5秒，会记录这个脚本到慢日志文件中\nrequest_slowlog_timeout =10\nslowlog = /var/opt/remi/php71/log/php-fpm/www-slow.log\n\nphp_admin_value[error_log] = /var/opt/remi/php71/log/php-fpm/www-error.log\nphp_admin_flag[log_errors] = on\n\n\n\nphp_value[session.save_handler] = files\nphp_value[session.save_path]    = /var/opt/remi/php71/lib/php/session\nphp_value[soap.wsdl_cache_dir]  = /var/opt/remi/php71/lib/php/wsdlcache\n\n```\n\n# 九、php.ini配置文件\n```\n#关闭PHP版本信息\nexpose_php = On\n\n#.单个脚本等待输入的最长时间\nmax_input_time = 60\n\nmemory_limit = 128M\nerror_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT\n\n#每个脚本最大允许执行时间(秒)，0表示没有限制\nmax_execution_time = 300\n\n#上传文件的最大许可大小\nupload_max_filesize = 20M\n\n#post上传的大小，要>=upload_max_filesize\npost_max_size = 20M\n\n\n#修改成如下设置：\nsession.save_handler = memcache\nsession.save_path = \"tcp://10.0.0.18:11211\"\n```\n    ","source":"_posts/linux-安装配置php环境.md","raw":"---\ntitle: linux-安装配置php环境\nabbrlink: 35d2b340\ncategories:\n  - 服务器相关\ndate: 2022-04-17 22:53:21\ntags:\n  - linux\n---\n# 一、安装Remi源：\n\n    # CentOS 6 / RHEL 6\n    yum install http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n    # CentOS 7 / RHEL 7\n    yum install http://rpms.remirepo.net/enterprise/remi-release-7.rpm\n \n \n# 二、配置Remi源(可以不操作)：\n \n     编辑remi源repo文件 /etc/yum.repos.d/remi.repo\n     启用 Remi Repository修改 enabled=0 为 enabled=1。\n     为 Remi Repository 设置合适的优先级在 [remi] 那一节的结尾另起一行添加下面的代码：\n     priority=3    \n    \n    \n# 三、安装 php\n\n     yum install php73 php73-php-fpm php73-php-opcache php73-php-gd php73-php-mbstring php73-php-xml php73-php-pdo php73-php-mysqlnd php73-php-pecl-mysql php73-php-bcmath\n    php73-php-mcrypt   \n    \n    \n# 四.开机启动   \n\n    systemctl enable  php73-php-fpm\n    \n# 五.服务相关命令\n\n    systemctl start  php73-php-fpm\n    systemctl stop  php73-php-fpm\n    systemctl status  php73-php-fpm\n    \n    \n# 六.加入系统命令\n\n    ln -s  /opt/remi/php73/root/usr/bin/php /usr/bin/php\n    \n# 七.添加用户\n    \n    groupadd www\n    useradd -g www -s /sbin/nologin www\n        \n# 八.PHP-FPM配置文件www.conf\n```\n[www]\n\nuser = www\ngroup = www\n\n;listen = 127.0.0.1:9000\nlisten = /dev/shm/php71-fpm.socket\n\nlisten.owner = www\nlisten.group = www\nlisten.mode = 0660\n\n\nlisten.allowed_clients = 127.0.0.1\n\n#如果选择static，则进程数就数固定的，由pm.max_children指定固定的子进程数。\npm = static\npm.max_children = 256\npm.start_servers = 5\n#随着php-fpm一起启动时创建的子进程数目。默认值：min_spare_servers + (max_spare_servers - min_spare_servers) / 2。\n#这里表示，一起启动会有20个子进程\npm.min_spare_servers = 5\n#设置服务器空闲时最小php-fpm进程数量。必须设置。如果空闲的时候，会检查如果少于10个，就会启动几个来补上。\npm.max_spare_servers = 35\n#设置服务器空闲时最大php-fpm进程数量。必须设置。如果空闲时，会检查进程数，多于30个了，就会关闭几个，达到30个的状态。\npm.max_requests = 5000\n#设置每个子进程重生之前服务的请求数. 对于可能存在内存泄漏的第三方模块来说是非常有用的. \n#如果设置为 '0' 则一直接受请求. 等同于 PHP_FCGI_MAX_REQUESTS 环境变量. 默认值: 0.\npm.status_path = /php7-php-fpm-status\n\n#当request_slowlog_timeout 设为一个具体秒时request_slowlog_timeout =5，表\n#示如果哪个脚本执行时间大于5秒，会记录这个脚本到慢日志文件中\nrequest_slowlog_timeout =10\nslowlog = /var/opt/remi/php71/log/php-fpm/www-slow.log\n\nphp_admin_value[error_log] = /var/opt/remi/php71/log/php-fpm/www-error.log\nphp_admin_flag[log_errors] = on\n\n\n\nphp_value[session.save_handler] = files\nphp_value[session.save_path]    = /var/opt/remi/php71/lib/php/session\nphp_value[soap.wsdl_cache_dir]  = /var/opt/remi/php71/lib/php/wsdlcache\n\n```\n\n# 九、php.ini配置文件\n```\n#关闭PHP版本信息\nexpose_php = On\n\n#.单个脚本等待输入的最长时间\nmax_input_time = 60\n\nmemory_limit = 128M\nerror_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT\n\n#每个脚本最大允许执行时间(秒)，0表示没有限制\nmax_execution_time = 300\n\n#上传文件的最大许可大小\nupload_max_filesize = 20M\n\n#post上传的大小，要>=upload_max_filesize\npost_max_size = 20M\n\n\n#修改成如下设置：\nsession.save_handler = memcache\nsession.save_path = \"tcp://10.0.0.18:11211\"\n```\n    ","slug":"linux-安装配置php环境","published":1,"updated":"2024-11-25T11:16:25.697Z","_id":"cm04ukh75000m4koc843e81sv","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、安装Remi源：\"><a href=\"#一、安装Remi源：\" class=\"headerlink\" title=\"一、安装Remi源：\"></a>一、安装Remi源：</h1><pre><code># CentOS 6 / RHEL 6\nyum install http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n# CentOS 7 / RHEL 7\nyum install http://rpms.remirepo.net/enterprise/remi-release-7.rpm\n</code></pre>\n<h1 id=\"二、配置Remi源-可以不操作-：\"><a href=\"#二、配置Remi源-可以不操作-：\" class=\"headerlink\" title=\"二、配置Remi源(可以不操作)：\"></a>二、配置Remi源(可以不操作)：</h1><pre><code> 编辑remi源repo文件 /etc/yum.repos.d/remi.repo\n 启用 Remi Repository修改 enabled=0 为 enabled=1。\n 为 Remi Repository 设置合适的优先级在 [remi] 那一节的结尾另起一行添加下面的代码：\n priority=3    \n</code></pre>\n<h1 id=\"三、安装-php\"><a href=\"#三、安装-php\" class=\"headerlink\" title=\"三、安装 php\"></a>三、安装 php</h1><pre><code> yum install php73 php73-php-fpm php73-php-opcache php73-php-gd php73-php-mbstring php73-php-xml php73-php-pdo php73-php-mysqlnd php73-php-pecl-mysql php73-php-bcmath\nphp73-php-mcrypt   \n</code></pre>\n<h1 id=\"四-开机启动\"><a href=\"#四-开机启动\" class=\"headerlink\" title=\"四.开机启动\"></a>四.开机启动</h1><pre><code>systemctl enable  php73-php-fpm\n</code></pre>\n<h1 id=\"五-服务相关命令\"><a href=\"#五-服务相关命令\" class=\"headerlink\" title=\"五.服务相关命令\"></a>五.服务相关命令</h1><pre><code>systemctl start  php73-php-fpm\nsystemctl stop  php73-php-fpm\nsystemctl status  php73-php-fpm\n</code></pre>\n<h1 id=\"六-加入系统命令\"><a href=\"#六-加入系统命令\" class=\"headerlink\" title=\"六.加入系统命令\"></a>六.加入系统命令</h1><pre><code>ln -s  /opt/remi/php73/root/usr/bin/php /usr/bin/php\n</code></pre>\n<h1 id=\"七-添加用户\"><a href=\"#七-添加用户\" class=\"headerlink\" title=\"七.添加用户\"></a>七.添加用户</h1><pre><code>groupadd www\nuseradd -g www -s /sbin/nologin www\n    \n</code></pre>\n<h1 id=\"八-PHP-FPM配置文件www-conf\"><a href=\"#八-PHP-FPM配置文件www-conf\" class=\"headerlink\" title=\"八.PHP-FPM配置文件www.conf\"></a>八.PHP-FPM配置文件<a href=\"http://www.conf/\">www.conf</a></h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[www]</span><br><span class=\"line\"></span><br><span class=\"line\">user = www</span><br><span class=\"line\">group = www</span><br><span class=\"line\"></span><br><span class=\"line\">;listen = 127.0.0.1:9000</span><br><span class=\"line\">listen = /dev/shm/php71-fpm.socket</span><br><span class=\"line\"></span><br><span class=\"line\">listen.owner = www</span><br><span class=\"line\">listen.group = www</span><br><span class=\"line\">listen.mode = 0660</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">listen.allowed_clients = 127.0.0.1</span><br><span class=\"line\"></span><br><span class=\"line\">#如果选择static，则进程数就数固定的，由pm.max_children指定固定的子进程数。</span><br><span class=\"line\">pm = static</span><br><span class=\"line\">pm.max_children = 256</span><br><span class=\"line\">pm.start_servers = 5</span><br><span class=\"line\">#随着php-fpm一起启动时创建的子进程数目。默认值：min_spare_servers + (max_spare_servers - min_spare_servers) / 2。</span><br><span class=\"line\">#这里表示，一起启动会有20个子进程</span><br><span class=\"line\">pm.min_spare_servers = 5</span><br><span class=\"line\">#设置服务器空闲时最小php-fpm进程数量。必须设置。如果空闲的时候，会检查如果少于10个，就会启动几个来补上。</span><br><span class=\"line\">pm.max_spare_servers = 35</span><br><span class=\"line\">#设置服务器空闲时最大php-fpm进程数量。必须设置。如果空闲时，会检查进程数，多于30个了，就会关闭几个，达到30个的状态。</span><br><span class=\"line\">pm.max_requests = 5000</span><br><span class=\"line\">#设置每个子进程重生之前服务的请求数. 对于可能存在内存泄漏的第三方模块来说是非常有用的. </span><br><span class=\"line\">#如果设置为 &#x27;0&#x27; 则一直接受请求. 等同于 PHP_FCGI_MAX_REQUESTS 环境变量. 默认值: 0.</span><br><span class=\"line\">pm.status_path = /php7-php-fpm-status</span><br><span class=\"line\"></span><br><span class=\"line\">#当request_slowlog_timeout 设为一个具体秒时request_slowlog_timeout =5，表</span><br><span class=\"line\">#示如果哪个脚本执行时间大于5秒，会记录这个脚本到慢日志文件中</span><br><span class=\"line\">request_slowlog_timeout =10</span><br><span class=\"line\">slowlog = /var/opt/remi/php71/log/php-fpm/www-slow.log</span><br><span class=\"line\"></span><br><span class=\"line\">php_admin_value[error_log] = /var/opt/remi/php71/log/php-fpm/www-error.log</span><br><span class=\"line\">php_admin_flag[log_errors] = on</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">php_value[session.save_handler] = files</span><br><span class=\"line\">php_value[session.save_path]    = /var/opt/remi/php71/lib/php/session</span><br><span class=\"line\">php_value[soap.wsdl_cache_dir]  = /var/opt/remi/php71/lib/php/wsdlcache</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"九、php-ini配置文件\"><a href=\"#九、php-ini配置文件\" class=\"headerlink\" title=\"九、php.ini配置文件\"></a>九、php.ini配置文件</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#关闭PHP版本信息</span><br><span class=\"line\">expose_php = On</span><br><span class=\"line\"></span><br><span class=\"line\">#.单个脚本等待输入的最长时间</span><br><span class=\"line\">max_input_time = 60</span><br><span class=\"line\"></span><br><span class=\"line\">memory_limit = 128M</span><br><span class=\"line\">error_reporting = E_ALL &amp; ~E_DEPRECATED &amp; ~E_STRICT</span><br><span class=\"line\"></span><br><span class=\"line\">#每个脚本最大允许执行时间(秒)，0表示没有限制</span><br><span class=\"line\">max_execution_time = 300</span><br><span class=\"line\"></span><br><span class=\"line\">#上传文件的最大许可大小</span><br><span class=\"line\">upload_max_filesize = 20M</span><br><span class=\"line\"></span><br><span class=\"line\">#post上传的大小，要&gt;=upload_max_filesize</span><br><span class=\"line\">post_max_size = 20M</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#修改成如下设置：</span><br><span class=\"line\">session.save_handler = memcache</span><br><span class=\"line\">session.save_path = &quot;tcp://10.0.0.18:11211&quot;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"length":2342,"excerpt":"","more":"<h1 id=\"一、安装Remi源：\"><a href=\"#一、安装Remi源：\" class=\"headerlink\" title=\"一、安装Remi源：\"></a>一、安装Remi源：</h1><pre><code># CentOS 6 / RHEL 6\nyum install http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n# CentOS 7 / RHEL 7\nyum install http://rpms.remirepo.net/enterprise/remi-release-7.rpm\n</code></pre>\n<h1 id=\"二、配置Remi源-可以不操作-：\"><a href=\"#二、配置Remi源-可以不操作-：\" class=\"headerlink\" title=\"二、配置Remi源(可以不操作)：\"></a>二、配置Remi源(可以不操作)：</h1><pre><code> 编辑remi源repo文件 /etc/yum.repos.d/remi.repo\n 启用 Remi Repository修改 enabled=0 为 enabled=1。\n 为 Remi Repository 设置合适的优先级在 [remi] 那一节的结尾另起一行添加下面的代码：\n priority=3    \n</code></pre>\n<h1 id=\"三、安装-php\"><a href=\"#三、安装-php\" class=\"headerlink\" title=\"三、安装 php\"></a>三、安装 php</h1><pre><code> yum install php73 php73-php-fpm php73-php-opcache php73-php-gd php73-php-mbstring php73-php-xml php73-php-pdo php73-php-mysqlnd php73-php-pecl-mysql php73-php-bcmath\nphp73-php-mcrypt   \n</code></pre>\n<h1 id=\"四-开机启动\"><a href=\"#四-开机启动\" class=\"headerlink\" title=\"四.开机启动\"></a>四.开机启动</h1><pre><code>systemctl enable  php73-php-fpm\n</code></pre>\n<h1 id=\"五-服务相关命令\"><a href=\"#五-服务相关命令\" class=\"headerlink\" title=\"五.服务相关命令\"></a>五.服务相关命令</h1><pre><code>systemctl start  php73-php-fpm\nsystemctl stop  php73-php-fpm\nsystemctl status  php73-php-fpm\n</code></pre>\n<h1 id=\"六-加入系统命令\"><a href=\"#六-加入系统命令\" class=\"headerlink\" title=\"六.加入系统命令\"></a>六.加入系统命令</h1><pre><code>ln -s  /opt/remi/php73/root/usr/bin/php /usr/bin/php\n</code></pre>\n<h1 id=\"七-添加用户\"><a href=\"#七-添加用户\" class=\"headerlink\" title=\"七.添加用户\"></a>七.添加用户</h1><pre><code>groupadd www\nuseradd -g www -s /sbin/nologin www\n    \n</code></pre>\n<h1 id=\"八-PHP-FPM配置文件www-conf\"><a href=\"#八-PHP-FPM配置文件www-conf\" class=\"headerlink\" title=\"八.PHP-FPM配置文件www.conf\"></a>八.PHP-FPM配置文件<a href=\"http://www.conf/\">www.conf</a></h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[www]</span><br><span class=\"line\"></span><br><span class=\"line\">user = www</span><br><span class=\"line\">group = www</span><br><span class=\"line\"></span><br><span class=\"line\">;listen = 127.0.0.1:9000</span><br><span class=\"line\">listen = /dev/shm/php71-fpm.socket</span><br><span class=\"line\"></span><br><span class=\"line\">listen.owner = www</span><br><span class=\"line\">listen.group = www</span><br><span class=\"line\">listen.mode = 0660</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">listen.allowed_clients = 127.0.0.1</span><br><span class=\"line\"></span><br><span class=\"line\">#如果选择static，则进程数就数固定的，由pm.max_children指定固定的子进程数。</span><br><span class=\"line\">pm = static</span><br><span class=\"line\">pm.max_children = 256</span><br><span class=\"line\">pm.start_servers = 5</span><br><span class=\"line\">#随着php-fpm一起启动时创建的子进程数目。默认值：min_spare_servers + (max_spare_servers - min_spare_servers) / 2。</span><br><span class=\"line\">#这里表示，一起启动会有20个子进程</span><br><span class=\"line\">pm.min_spare_servers = 5</span><br><span class=\"line\">#设置服务器空闲时最小php-fpm进程数量。必须设置。如果空闲的时候，会检查如果少于10个，就会启动几个来补上。</span><br><span class=\"line\">pm.max_spare_servers = 35</span><br><span class=\"line\">#设置服务器空闲时最大php-fpm进程数量。必须设置。如果空闲时，会检查进程数，多于30个了，就会关闭几个，达到30个的状态。</span><br><span class=\"line\">pm.max_requests = 5000</span><br><span class=\"line\">#设置每个子进程重生之前服务的请求数. 对于可能存在内存泄漏的第三方模块来说是非常有用的. </span><br><span class=\"line\">#如果设置为 &#x27;0&#x27; 则一直接受请求. 等同于 PHP_FCGI_MAX_REQUESTS 环境变量. 默认值: 0.</span><br><span class=\"line\">pm.status_path = /php7-php-fpm-status</span><br><span class=\"line\"></span><br><span class=\"line\">#当request_slowlog_timeout 设为一个具体秒时request_slowlog_timeout =5，表</span><br><span class=\"line\">#示如果哪个脚本执行时间大于5秒，会记录这个脚本到慢日志文件中</span><br><span class=\"line\">request_slowlog_timeout =10</span><br><span class=\"line\">slowlog = /var/opt/remi/php71/log/php-fpm/www-slow.log</span><br><span class=\"line\"></span><br><span class=\"line\">php_admin_value[error_log] = /var/opt/remi/php71/log/php-fpm/www-error.log</span><br><span class=\"line\">php_admin_flag[log_errors] = on</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">php_value[session.save_handler] = files</span><br><span class=\"line\">php_value[session.save_path]    = /var/opt/remi/php71/lib/php/session</span><br><span class=\"line\">php_value[soap.wsdl_cache_dir]  = /var/opt/remi/php71/lib/php/wsdlcache</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"九、php-ini配置文件\"><a href=\"#九、php-ini配置文件\" class=\"headerlink\" title=\"九、php.ini配置文件\"></a>九、php.ini配置文件</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#关闭PHP版本信息</span><br><span class=\"line\">expose_php = On</span><br><span class=\"line\"></span><br><span class=\"line\">#.单个脚本等待输入的最长时间</span><br><span class=\"line\">max_input_time = 60</span><br><span class=\"line\"></span><br><span class=\"line\">memory_limit = 128M</span><br><span class=\"line\">error_reporting = E_ALL &amp; ~E_DEPRECATED &amp; ~E_STRICT</span><br><span class=\"line\"></span><br><span class=\"line\">#每个脚本最大允许执行时间(秒)，0表示没有限制</span><br><span class=\"line\">max_execution_time = 300</span><br><span class=\"line\"></span><br><span class=\"line\">#上传文件的最大许可大小</span><br><span class=\"line\">upload_max_filesize = 20M</span><br><span class=\"line\"></span><br><span class=\"line\">#post上传的大小，要&gt;=upload_max_filesize</span><br><span class=\"line\">post_max_size = 20M</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#修改成如下设置：</span><br><span class=\"line\">session.save_handler = memcache</span><br><span class=\"line\">session.save_path = &quot;tcp://10.0.0.18:11211&quot;</span><br></pre></td></tr></table></figure>\n"},{"title":"搭建openvpn","abbrlink":"224c29d4","date":"2023-08-28T05:42:06.000Z","_content":"# 一、安装\n## 1.1、安装epel库和openvpn软件\n\n    yum -y install openvpn easy-rsa firewalld\n\n    yum install epel-release -y\n \n \n## 1.2、开启路由转发\n\n     echo  \"net.ipv4.ip_forward = 1\" >>/etc/sysctl.conf\n     sysctl -p\n \n## 1.3、创建OpenVPN相关的密钥\n\n     cp -rf /usr/share/easy-rsa/3.0/* /etc/openvpn/easy-rsa/\n     cp -p /usr/share/doc/easy-rsa-3.0.6/vars.example /etc/openvpn/easy-rsa/vars\n     cd /etc/openvpn/easy-rsa/\n \n \n ### 1.3.1、创建ca证书\n \n    /usr/share/easy-rsa/3/easyrsa init-pki\n    /usr/share/easy-rsa/3/easyrsa build-ca nopass\n\n\n### 1.3..2、创建client证书和签名\n\n    /usr/share/easy-rsa/3/easyrsa gen-req client1 nopass           #Enter\n    /usr/share/easy-rsa/3/easyrsa sign-req client client1          #需要输入yes\n    创建dh、tls、crl（证书撤销秘钥）\n    /usr/share/easy-rsa/3/easyrsa gen-dh\n    openvpn --genkey --secret /etc/openvpn/easy-rsa/ta.key\n    /usr/share/easy-rsa/3/easyrsa  gen-crl\n\n\n### 1.3.3、将秘钥拷贝至相应目录\n\n    cp -p pki/ca.crt /etc/openvpn/server/\n    cp -p pki/issued/server1.crt /etc/openvpn/server/\n    cp -p pki/private/server1.key /etc/openvpn/server/\n    cp -p ta.key /etc/openvpn/server/\n    cp -p pki/ca.crt /etc/openvpn/client/\n    cp -p pki/issued/client1.crt /etc/openvpn/client/\n    cp -p pki/private/client1.key /etc/openvpn/client/\n    cp -p ta.key /etc/openvpn/client/\n    cp pki/dh.pem /etc/openvpn/server/\n    cp pki/crl.pem /etc/openvpn/server/\n    cp /usr/share/doc/openvpn-2.4.11/sample/sample-config-files/server.conf /etc/openvpn/\n    \n    \n# 二、配置 openvpn\n\n## 2.1、编辑配置文件 /etc/openvpn/server.conf   \n\n    cp /usr/share/doc/openvpn-2.4.11/sample/sample-config-files/server.conf /etc/openvpn/      \n    #拷贝实例修改或直接拷贝以下内容\n    vim /etc/openvpn/server.conf\n\n    local 0.0.0.0    #监听地址\n    port 1194        #监听端口\n    proto tcp        #监听协议\n    dev tun          #采用路由隧道模式\n    ca /etc/openvpn/server/ca.crt              #ca证书路径\n    cert /etc/openvpn/server/server1.crt       #服务器证书\n    key /etc/openvpn/server/server1.key        #服务器秘钥\n    dh /etc/openvpn/server/dh.pem              #密钥交换协议文件\n    #####注意在设备中加一条到10.100.100.0虚拟网段的路由！！！！\n    server 10.100.100.0 255.255.255.0          \n    ####给客户端分配地址池，注意：不能和VPN服务器内网网段有相同\n    #####注意在设备中加一条到10.100.100.0虚拟网段的路由！！！！\n    ifconfig-pool-persist ipp.txt\n    #push \"redirect-gateway def1 bypass-dhcp\"      #推送默认路由（所有流量走vpn）\n    push \"route 192.168.0.0 255.255.255.0\"           \n    #推送客户端常用路由（根据自己内网网段来写或修改客户端配置添加路由）\n    push \"dhcp-option DNS 192.168.5.251\"           #dhcp分配dns\n    client-to-client       #客户端之间互相通信\n    keepalive 10 120       #存活时间，10秒ping一次,120 如未收到响应则视为断线\n    comp-lzo               #传输数据压缩\n    max-clients 100        #最多允许 100 客户端连接\n    user openvpn           #用户\n    group openvpn          #用户组\n    cipher AES-256-CBC     #加密方式--客户端必须一致\n    persist-key\n    persist-tun\n    status /var/log/openvpn-status.log\n    log         /var/log/openvpn.log\n    verb 3\n    #以下参数为用户认证使用\n    script-security 3\n    auth-user-pass-verify /etc/openvpn/checkpsw.sh via-env    #指定用户认证脚本\n    username-as-common-name\n    verify-client-cert none\n \n ## 2.2虚拟网段的路由\n    \n    iptables -t nat -A POSTROUTING -s 10.100.100.0/24 -j MASQUERADE\n   \n   \n    firewall-cmd --add-masquerade --permanent\n    firewall-cmd --query-masquerade --permanent\n    \n    firewall-cmd --zone=public --add-rich-rule='rule family=\"ipv4\" source address=\"10.100.100.0/24\" port protocol=\"tcp\" accept'\n    firewall-cmd --zone=public --add-masquerade\n    \n# 三、用户认证\n    \n ## 3.1编写用户认证脚本文件 (脚本是由openvpn官网提供)\n \n    vim /etc/openvpn/checkpsw.sh\n    #!/bin/sh\n    ###########################################################\n    # checkpsw.sh (C) 2004 Mathias Sundman \n    # This script will authenticate OpenVPN users against\n    # a plain text file. The passfile should simply contain\n    # one row per user with the username first followed by\n    # one or more space(s) or tab(s) and then the password.\n    \n    PASSFILE=\"/etc/openvpn/psw-file\"\n    LOG_FILE=\"/etc/openvpn/openvpn-password.log\"\n    TIME_STAMP=`date \"+%Y-%m-%d %T\"`\n    ###########################################################\n    \n    if [ ! -r \"${PASSFILE}\" ]; then\n      echo \"${TIME_STAMP}: Could not open password file \\\"${PASSFILE}\\\" for reading.\" >>${LOG_FILE}\n      exit 1\n    fi\n    \n    CORRECT_PASSWORD=`awk '!/^;/&&!/^#/&&$1==\"'${username}'\"{print $2;exit}' ${PASSFILE}`\n    \n    if [ \"${CORRECT_PASSWORD}\" = \"\" ]; then \n      echo \"${TIME_STAMP}: User does not exist: username=\\\"${username}\\\", password=\\\"${password}\\\".\" >> ${LOG_FILE}\n      exit 1\n    fi\n    \n    if [ \"${password}\" = \"${CORRECT_PASSWORD}\" ]; then \n      echo \"${TIME_STAMP}: Successful authentication: username=\\\"${username}\\\".\" >> ${LOG_FILE}\n      exit 0\n    fi\n    \n    echo \"${TIME_STAMP}: Incorrect password: username=\\\"${username}\\\",     password=\\\"${password}\\\".\" >> ${LOG_FILE}\n    exit 1\n\n ## 3.2 加权限及添加用户账号\n \n    给脚本添加执行权限\n    chmod 755 /etc/openvpn/checkpsw.sh\n    \n    \n    编辑密码文件\n    vim /etc/openvpn/psw-file\n    tom  123456\n    Jerry 654321\n    #前面为用户名，后面为密码。 中间使用空格分开\n  \n  \n# 四、客户端配置\n    client.ovpn\n    \n    ##---------以下为将ca.crt证书写入到客户端文件的方式（直接给一个client.ovpn文件即可）------------##\n    client\n    dev tun\n    proto tcp   #根据服务端的来\n    remote utnanjing.tpddns.cn 11194\n    resolv-retry infinite\n    nobind\n    persist-key\n    persist-tun\n    <ca>\n    -----BEGIN CERTIFICATE-----\n    MIIDNTCCAh2gAwIBAgIJAJgy1QReG9VmMA0GCSqGSIb3DQEBCwUAMBYxFDASBgNV\n    BAMMC0Vhc3ktUlNBIENBMB4XDTIzMDgyNDA5NTgzN1oXDTMzMDgyMTA5NTgzN1ow\n    FjEUMBIGA1UEAwwLRWFzeS1SU0EgQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw\n    ggEKAoIBAQDLutXX/OaN1muPGKQV2uiEaZbQy9F0PptJxM3ZTHdyn+HuQ/3xqYHz\n    z6hgIr2IjWtD5pqZXGMwIxbpNFKfPfJtwU5xpuUA6hxWV3yYtaXGsaLvFA0StL/N\n    P5/3VgL1KpdcivjMejgVCwX5CkN97hsS6uk9Z/PUB9OEAWygeRHS8CYQ37PhXmDC\n    h/1VeXWZDHJzxCD1fqoo2dB8MGFJjvg3FVQ0o8Gf0XE9cvj5dtk73f6AyiuYTeLL\n    nD8vY8jbCVGeLcnoDnduK6y6ZLFOUHWfEPH+a1jDFLpXIby0oo3yBWcldzaKJMzf\n    UP7HoczkDaUo5ykecDjxGkD8kpTmwyQPAgMBAAGjgYUwgYIwHQYDVR0OBBYEFPCY\n    FNHxZ/eBKLRh009Bm08j8zurMEYGA1UdIwQ/MD2AFPCYFNHxZ/eBKLRh009Bm08j\n    8zuroRqkGDAWMRQwEgYDVQQDDAtFYXN5LVJTQSBDQYIJAJgy1QReG9VmMAwGA1Ud\n    EwQFMAMBAf8wCwYDVR0PBAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCYFaym5wCr\n    lti+7p9MqLm4UF7pOmZQ2NamZjP1cQuMh2SgdJphddZEhEUO5NOQms8gMJsZ3sd7\n    DIul+XkDcbhjKNNxD4oeXiITR8BgLsCkqtLStwWtOSLGxgHHWD3S+IBSM21A4Rxy\n    hE4VUr81i9XUM2lI7ml5RgCVTvbWosCnVFuXypaYs4/c1yJJ1I578M6oVWjahJOx\n    ENoeYYSI/V+2ySTtRQlW8HQEc4GhSeybhmXgrfLKhmHTVl/ZqZg5zp3kwBcnsrUQ\n    junuLBLMMYSLPXhJQFU/10EMxv/9AAdBGiO3RL0G2qYc0JF11qVpmD9nwP9f/YR3\n    Yvs7E2kwDViH\n    -----END CERTIFICATE-----\n    </ca>\n    cipher AES-256-CBC\n    comp-lzo\n    verb 3\n    auth-user-pass              #使用用户名密码登录openvpn服务器\n    auth-nocache\n\n\n    证书方式\n    \n    client\n    dev tun\n    proto tcp\n    remote 公网ipxxx.xxx.xxx.xxx 1194\n    resolv-retry infinite\n    nobind\n    persist-key\n    persist-tun\n    ca ca.crt\n    cert client1.crt  #拷贝自服务端\n    key client1.key   #拷贝自服务端 \n    remote-cert-tls server\n    cipher AES-256-CBC\n    comp-lzo\n    verb 3","source":"_posts/linux-搭建openvpn.md","raw":"---\ntitle: 搭建openvpn\nabbrlink: 224c29d4\ndate: 2023-08-28 13:42:06\ntags:\n - linux\ncategories:\n  - 服务器相关  \n---\n# 一、安装\n## 1.1、安装epel库和openvpn软件\n\n    yum -y install openvpn easy-rsa firewalld\n\n    yum install epel-release -y\n \n \n## 1.2、开启路由转发\n\n     echo  \"net.ipv4.ip_forward = 1\" >>/etc/sysctl.conf\n     sysctl -p\n \n## 1.3、创建OpenVPN相关的密钥\n\n     cp -rf /usr/share/easy-rsa/3.0/* /etc/openvpn/easy-rsa/\n     cp -p /usr/share/doc/easy-rsa-3.0.6/vars.example /etc/openvpn/easy-rsa/vars\n     cd /etc/openvpn/easy-rsa/\n \n \n ### 1.3.1、创建ca证书\n \n    /usr/share/easy-rsa/3/easyrsa init-pki\n    /usr/share/easy-rsa/3/easyrsa build-ca nopass\n\n\n### 1.3..2、创建client证书和签名\n\n    /usr/share/easy-rsa/3/easyrsa gen-req client1 nopass           #Enter\n    /usr/share/easy-rsa/3/easyrsa sign-req client client1          #需要输入yes\n    创建dh、tls、crl（证书撤销秘钥）\n    /usr/share/easy-rsa/3/easyrsa gen-dh\n    openvpn --genkey --secret /etc/openvpn/easy-rsa/ta.key\n    /usr/share/easy-rsa/3/easyrsa  gen-crl\n\n\n### 1.3.3、将秘钥拷贝至相应目录\n\n    cp -p pki/ca.crt /etc/openvpn/server/\n    cp -p pki/issued/server1.crt /etc/openvpn/server/\n    cp -p pki/private/server1.key /etc/openvpn/server/\n    cp -p ta.key /etc/openvpn/server/\n    cp -p pki/ca.crt /etc/openvpn/client/\n    cp -p pki/issued/client1.crt /etc/openvpn/client/\n    cp -p pki/private/client1.key /etc/openvpn/client/\n    cp -p ta.key /etc/openvpn/client/\n    cp pki/dh.pem /etc/openvpn/server/\n    cp pki/crl.pem /etc/openvpn/server/\n    cp /usr/share/doc/openvpn-2.4.11/sample/sample-config-files/server.conf /etc/openvpn/\n    \n    \n# 二、配置 openvpn\n\n## 2.1、编辑配置文件 /etc/openvpn/server.conf   \n\n    cp /usr/share/doc/openvpn-2.4.11/sample/sample-config-files/server.conf /etc/openvpn/      \n    #拷贝实例修改或直接拷贝以下内容\n    vim /etc/openvpn/server.conf\n\n    local 0.0.0.0    #监听地址\n    port 1194        #监听端口\n    proto tcp        #监听协议\n    dev tun          #采用路由隧道模式\n    ca /etc/openvpn/server/ca.crt              #ca证书路径\n    cert /etc/openvpn/server/server1.crt       #服务器证书\n    key /etc/openvpn/server/server1.key        #服务器秘钥\n    dh /etc/openvpn/server/dh.pem              #密钥交换协议文件\n    #####注意在设备中加一条到10.100.100.0虚拟网段的路由！！！！\n    server 10.100.100.0 255.255.255.0          \n    ####给客户端分配地址池，注意：不能和VPN服务器内网网段有相同\n    #####注意在设备中加一条到10.100.100.0虚拟网段的路由！！！！\n    ifconfig-pool-persist ipp.txt\n    #push \"redirect-gateway def1 bypass-dhcp\"      #推送默认路由（所有流量走vpn）\n    push \"route 192.168.0.0 255.255.255.0\"           \n    #推送客户端常用路由（根据自己内网网段来写或修改客户端配置添加路由）\n    push \"dhcp-option DNS 192.168.5.251\"           #dhcp分配dns\n    client-to-client       #客户端之间互相通信\n    keepalive 10 120       #存活时间，10秒ping一次,120 如未收到响应则视为断线\n    comp-lzo               #传输数据压缩\n    max-clients 100        #最多允许 100 客户端连接\n    user openvpn           #用户\n    group openvpn          #用户组\n    cipher AES-256-CBC     #加密方式--客户端必须一致\n    persist-key\n    persist-tun\n    status /var/log/openvpn-status.log\n    log         /var/log/openvpn.log\n    verb 3\n    #以下参数为用户认证使用\n    script-security 3\n    auth-user-pass-verify /etc/openvpn/checkpsw.sh via-env    #指定用户认证脚本\n    username-as-common-name\n    verify-client-cert none\n \n ## 2.2虚拟网段的路由\n    \n    iptables -t nat -A POSTROUTING -s 10.100.100.0/24 -j MASQUERADE\n   \n   \n    firewall-cmd --add-masquerade --permanent\n    firewall-cmd --query-masquerade --permanent\n    \n    firewall-cmd --zone=public --add-rich-rule='rule family=\"ipv4\" source address=\"10.100.100.0/24\" port protocol=\"tcp\" accept'\n    firewall-cmd --zone=public --add-masquerade\n    \n# 三、用户认证\n    \n ## 3.1编写用户认证脚本文件 (脚本是由openvpn官网提供)\n \n    vim /etc/openvpn/checkpsw.sh\n    #!/bin/sh\n    ###########################################################\n    # checkpsw.sh (C) 2004 Mathias Sundman \n    # This script will authenticate OpenVPN users against\n    # a plain text file. The passfile should simply contain\n    # one row per user with the username first followed by\n    # one or more space(s) or tab(s) and then the password.\n    \n    PASSFILE=\"/etc/openvpn/psw-file\"\n    LOG_FILE=\"/etc/openvpn/openvpn-password.log\"\n    TIME_STAMP=`date \"+%Y-%m-%d %T\"`\n    ###########################################################\n    \n    if [ ! -r \"${PASSFILE}\" ]; then\n      echo \"${TIME_STAMP}: Could not open password file \\\"${PASSFILE}\\\" for reading.\" >>${LOG_FILE}\n      exit 1\n    fi\n    \n    CORRECT_PASSWORD=`awk '!/^;/&&!/^#/&&$1==\"'${username}'\"{print $2;exit}' ${PASSFILE}`\n    \n    if [ \"${CORRECT_PASSWORD}\" = \"\" ]; then \n      echo \"${TIME_STAMP}: User does not exist: username=\\\"${username}\\\", password=\\\"${password}\\\".\" >> ${LOG_FILE}\n      exit 1\n    fi\n    \n    if [ \"${password}\" = \"${CORRECT_PASSWORD}\" ]; then \n      echo \"${TIME_STAMP}: Successful authentication: username=\\\"${username}\\\".\" >> ${LOG_FILE}\n      exit 0\n    fi\n    \n    echo \"${TIME_STAMP}: Incorrect password: username=\\\"${username}\\\",     password=\\\"${password}\\\".\" >> ${LOG_FILE}\n    exit 1\n\n ## 3.2 加权限及添加用户账号\n \n    给脚本添加执行权限\n    chmod 755 /etc/openvpn/checkpsw.sh\n    \n    \n    编辑密码文件\n    vim /etc/openvpn/psw-file\n    tom  123456\n    Jerry 654321\n    #前面为用户名，后面为密码。 中间使用空格分开\n  \n  \n# 四、客户端配置\n    client.ovpn\n    \n    ##---------以下为将ca.crt证书写入到客户端文件的方式（直接给一个client.ovpn文件即可）------------##\n    client\n    dev tun\n    proto tcp   #根据服务端的来\n    remote utnanjing.tpddns.cn 11194\n    resolv-retry infinite\n    nobind\n    persist-key\n    persist-tun\n    <ca>\n    -----BEGIN CERTIFICATE-----\n    MIIDNTCCAh2gAwIBAgIJAJgy1QReG9VmMA0GCSqGSIb3DQEBCwUAMBYxFDASBgNV\n    BAMMC0Vhc3ktUlNBIENBMB4XDTIzMDgyNDA5NTgzN1oXDTMzMDgyMTA5NTgzN1ow\n    FjEUMBIGA1UEAwwLRWFzeS1SU0EgQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw\n    ggEKAoIBAQDLutXX/OaN1muPGKQV2uiEaZbQy9F0PptJxM3ZTHdyn+HuQ/3xqYHz\n    z6hgIr2IjWtD5pqZXGMwIxbpNFKfPfJtwU5xpuUA6hxWV3yYtaXGsaLvFA0StL/N\n    P5/3VgL1KpdcivjMejgVCwX5CkN97hsS6uk9Z/PUB9OEAWygeRHS8CYQ37PhXmDC\n    h/1VeXWZDHJzxCD1fqoo2dB8MGFJjvg3FVQ0o8Gf0XE9cvj5dtk73f6AyiuYTeLL\n    nD8vY8jbCVGeLcnoDnduK6y6ZLFOUHWfEPH+a1jDFLpXIby0oo3yBWcldzaKJMzf\n    UP7HoczkDaUo5ykecDjxGkD8kpTmwyQPAgMBAAGjgYUwgYIwHQYDVR0OBBYEFPCY\n    FNHxZ/eBKLRh009Bm08j8zurMEYGA1UdIwQ/MD2AFPCYFNHxZ/eBKLRh009Bm08j\n    8zuroRqkGDAWMRQwEgYDVQQDDAtFYXN5LVJTQSBDQYIJAJgy1QReG9VmMAwGA1Ud\n    EwQFMAMBAf8wCwYDVR0PBAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCYFaym5wCr\n    lti+7p9MqLm4UF7pOmZQ2NamZjP1cQuMh2SgdJphddZEhEUO5NOQms8gMJsZ3sd7\n    DIul+XkDcbhjKNNxD4oeXiITR8BgLsCkqtLStwWtOSLGxgHHWD3S+IBSM21A4Rxy\n    hE4VUr81i9XUM2lI7ml5RgCVTvbWosCnVFuXypaYs4/c1yJJ1I578M6oVWjahJOx\n    ENoeYYSI/V+2ySTtRQlW8HQEc4GhSeybhmXgrfLKhmHTVl/ZqZg5zp3kwBcnsrUQ\n    junuLBLMMYSLPXhJQFU/10EMxv/9AAdBGiO3RL0G2qYc0JF11qVpmD9nwP9f/YR3\n    Yvs7E2kwDViH\n    -----END CERTIFICATE-----\n    </ca>\n    cipher AES-256-CBC\n    comp-lzo\n    verb 3\n    auth-user-pass              #使用用户名密码登录openvpn服务器\n    auth-nocache\n\n\n    证书方式\n    \n    client\n    dev tun\n    proto tcp\n    remote 公网ipxxx.xxx.xxx.xxx 1194\n    resolv-retry infinite\n    nobind\n    persist-key\n    persist-tun\n    ca ca.crt\n    cert client1.crt  #拷贝自服务端\n    key client1.key   #拷贝自服务端 \n    remote-cert-tls server\n    cipher AES-256-CBC\n    comp-lzo\n    verb 3","slug":"linux-搭建openvpn","published":1,"updated":"2024-11-25T11:38:06.126Z","_id":"cm04ukh76000n4koce89503wu","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、安装\"><a href=\"#一、安装\" class=\"headerlink\" title=\"一、安装\"></a>一、安装</h1><h2 id=\"1-1、安装epel库和openvpn软件\"><a href=\"#1-1、安装epel库和openvpn软件\" class=\"headerlink\" title=\"1.1、安装epel库和openvpn软件\"></a>1.1、安装epel库和openvpn软件</h2><pre><code>yum -y install openvpn easy-rsa firewalld\n\nyum install epel-release -y\n</code></pre>\n<h2 id=\"1-2、开启路由转发\"><a href=\"#1-2、开启路由转发\" class=\"headerlink\" title=\"1.2、开启路由转发\"></a>1.2、开启路由转发</h2><pre><code> echo  &quot;net.ipv4.ip_forward = 1&quot; &gt;&gt;/etc/sysctl.conf\n sysctl -p\n</code></pre>\n<h2 id=\"1-3、创建OpenVPN相关的密钥\"><a href=\"#1-3、创建OpenVPN相关的密钥\" class=\"headerlink\" title=\"1.3、创建OpenVPN相关的密钥\"></a>1.3、创建OpenVPN相关的密钥</h2><pre><code> cp -rf /usr/share/easy-rsa/3.0/* /etc/openvpn/easy-rsa/\n cp -p /usr/share/doc/easy-rsa-3.0.6/vars.example /etc/openvpn/easy-rsa/vars\n cd /etc/openvpn/easy-rsa/\n</code></pre>\n<h3 id=\"1-3-1、创建ca证书\"><a href=\"#1-3-1、创建ca证书\" class=\"headerlink\" title=\"1.3.1、创建ca证书\"></a>1.3.1、创建ca证书</h3><pre><code>/usr/share/easy-rsa/3/easyrsa init-pki\n/usr/share/easy-rsa/3/easyrsa build-ca nopass\n</code></pre>\n<h3 id=\"1-3-2、创建client证书和签名\"><a href=\"#1-3-2、创建client证书和签名\" class=\"headerlink\" title=\"1.3..2、创建client证书和签名\"></a>1.3..2、创建client证书和签名</h3><pre><code>/usr/share/easy-rsa/3/easyrsa gen-req client1 nopass           #Enter\n/usr/share/easy-rsa/3/easyrsa sign-req client client1          #需要输入yes\n创建dh、tls、crl（证书撤销秘钥）\n/usr/share/easy-rsa/3/easyrsa gen-dh\nopenvpn --genkey --secret /etc/openvpn/easy-rsa/ta.key\n/usr/share/easy-rsa/3/easyrsa  gen-crl\n</code></pre>\n<h3 id=\"1-3-3、将秘钥拷贝至相应目录\"><a href=\"#1-3-3、将秘钥拷贝至相应目录\" class=\"headerlink\" title=\"1.3.3、将秘钥拷贝至相应目录\"></a>1.3.3、将秘钥拷贝至相应目录</h3><pre><code>cp -p pki/ca.crt /etc/openvpn/server/\ncp -p pki/issued/server1.crt /etc/openvpn/server/\ncp -p pki/private/server1.key /etc/openvpn/server/\ncp -p ta.key /etc/openvpn/server/\ncp -p pki/ca.crt /etc/openvpn/client/\ncp -p pki/issued/client1.crt /etc/openvpn/client/\ncp -p pki/private/client1.key /etc/openvpn/client/\ncp -p ta.key /etc/openvpn/client/\ncp pki/dh.pem /etc/openvpn/server/\ncp pki/crl.pem /etc/openvpn/server/\ncp /usr/share/doc/openvpn-2.4.11/sample/sample-config-files/server.conf /etc/openvpn/\n</code></pre>\n<h1 id=\"二、配置-openvpn\"><a href=\"#二、配置-openvpn\" class=\"headerlink\" title=\"二、配置 openvpn\"></a>二、配置 openvpn</h1><h2 id=\"2-1、编辑配置文件-etc-openvpn-server-conf\"><a href=\"#2-1、编辑配置文件-etc-openvpn-server-conf\" class=\"headerlink\" title=\"2.1、编辑配置文件 /etc/openvpn/server.conf\"></a>2.1、编辑配置文件 /etc/openvpn/server.conf</h2><pre><code>cp /usr/share/doc/openvpn-2.4.11/sample/sample-config-files/server.conf /etc/openvpn/      \n#拷贝实例修改或直接拷贝以下内容\nvim /etc/openvpn/server.conf\n\nlocal 0.0.0.0    #监听地址\nport 1194        #监听端口\nproto tcp        #监听协议\ndev tun          #采用路由隧道模式\nca /etc/openvpn/server/ca.crt              #ca证书路径\ncert /etc/openvpn/server/server1.crt       #服务器证书\nkey /etc/openvpn/server/server1.key        #服务器秘钥\ndh /etc/openvpn/server/dh.pem              #密钥交换协议文件\n#####注意在设备中加一条到10.100.100.0虚拟网段的路由！！！！\nserver 10.100.100.0 255.255.255.0          \n####给客户端分配地址池，注意：不能和VPN服务器内网网段有相同\n#####注意在设备中加一条到10.100.100.0虚拟网段的路由！！！！\nifconfig-pool-persist ipp.txt\n#push &quot;redirect-gateway def1 bypass-dhcp&quot;      #推送默认路由（所有流量走vpn）\npush &quot;route 192.168.0.0 255.255.255.0&quot;           \n#推送客户端常用路由（根据自己内网网段来写或修改客户端配置添加路由）\npush &quot;dhcp-option DNS 192.168.5.251&quot;           #dhcp分配dns\nclient-to-client       #客户端之间互相通信\nkeepalive 10 120       #存活时间，10秒ping一次,120 如未收到响应则视为断线\ncomp-lzo               #传输数据压缩\nmax-clients 100        #最多允许 100 客户端连接\nuser openvpn           #用户\ngroup openvpn          #用户组\ncipher AES-256-CBC     #加密方式--客户端必须一致\npersist-key\npersist-tun\nstatus /var/log/openvpn-status.log\nlog         /var/log/openvpn.log\nverb 3\n#以下参数为用户认证使用\nscript-security 3\nauth-user-pass-verify /etc/openvpn/checkpsw.sh via-env    #指定用户认证脚本\nusername-as-common-name\nverify-client-cert none\n</code></pre>\n<h2 id=\"2-2虚拟网段的路由\"><a href=\"#2-2虚拟网段的路由\" class=\"headerlink\" title=\"2.2虚拟网段的路由\"></a>2.2虚拟网段的路由</h2><pre><code>iptables -t nat -A POSTROUTING -s 10.100.100.0/24 -j MASQUERADE\n\n\nfirewall-cmd --add-masquerade --permanent\nfirewall-cmd --query-masquerade --permanent\n\nfirewall-cmd --zone=public --add-rich-rule=&#39;rule family=&quot;ipv4&quot; source address=&quot;10.100.100.0/24&quot; port protocol=&quot;tcp&quot; accept&#39;\nfirewall-cmd --zone=public --add-masquerade\n</code></pre>\n<h1 id=\"三、用户认证\"><a href=\"#三、用户认证\" class=\"headerlink\" title=\"三、用户认证\"></a>三、用户认证</h1><h2 id=\"3-1编写用户认证脚本文件-脚本是由openvpn官网提供\"><a href=\"#3-1编写用户认证脚本文件-脚本是由openvpn官网提供\" class=\"headerlink\" title=\"3.1编写用户认证脚本文件 (脚本是由openvpn官网提供)\"></a>3.1编写用户认证脚本文件 (脚本是由openvpn官网提供)</h2><pre><code>vim /etc/openvpn/checkpsw.sh\n#!/bin/sh\n###########################################################\n# checkpsw.sh (C) 2004 Mathias Sundman \n# This script will authenticate OpenVPN users against\n# a plain text file. The passfile should simply contain\n# one row per user with the username first followed by\n# one or more space(s) or tab(s) and then the password.\n\nPASSFILE=&quot;/etc/openvpn/psw-file&quot;\nLOG_FILE=&quot;/etc/openvpn/openvpn-password.log&quot;\nTIME_STAMP=`date &quot;+%Y-%m-%d %T&quot;`\n###########################################################\n\nif [ ! -r &quot;$&#123;PASSFILE&#125;&quot; ]; then\n  echo &quot;$&#123;TIME_STAMP&#125;: Could not open password file \\&quot;$&#123;PASSFILE&#125;\\&quot; for reading.&quot; &gt;&gt;$&#123;LOG_FILE&#125;\n  exit 1\nfi\n\nCORRECT_PASSWORD=`awk &#39;!/^;/&amp;&amp;!/^#/&amp;&amp;$1==&quot;&#39;$&#123;username&#125;&#39;&quot;&#123;print $2;exit&#125;&#39; $&#123;PASSFILE&#125;`\n\nif [ &quot;$&#123;CORRECT_PASSWORD&#125;&quot; = &quot;&quot; ]; then \n  echo &quot;$&#123;TIME_STAMP&#125;: User does not exist: username=\\&quot;$&#123;username&#125;\\&quot;, password=\\&quot;$&#123;password&#125;\\&quot;.&quot; &gt;&gt; $&#123;LOG_FILE&#125;\n  exit 1\nfi\n\nif [ &quot;$&#123;password&#125;&quot; = &quot;$&#123;CORRECT_PASSWORD&#125;&quot; ]; then \n  echo &quot;$&#123;TIME_STAMP&#125;: Successful authentication: username=\\&quot;$&#123;username&#125;\\&quot;.&quot; &gt;&gt; $&#123;LOG_FILE&#125;\n  exit 0\nfi\n\necho &quot;$&#123;TIME_STAMP&#125;: Incorrect password: username=\\&quot;$&#123;username&#125;\\&quot;,     password=\\&quot;$&#123;password&#125;\\&quot;.&quot; &gt;&gt; $&#123;LOG_FILE&#125;\nexit 1\n</code></pre>\n<h2 id=\"3-2-加权限及添加用户账号\"><a href=\"#3-2-加权限及添加用户账号\" class=\"headerlink\" title=\"3.2 加权限及添加用户账号\"></a>3.2 加权限及添加用户账号</h2><pre><code>给脚本添加执行权限\nchmod 755 /etc/openvpn/checkpsw.sh\n\n\n编辑密码文件\nvim /etc/openvpn/psw-file\ntom  123456\nJerry 654321\n#前面为用户名，后面为密码。 中间使用空格分开\n</code></pre>\n<h1 id=\"四、客户端配置\"><a href=\"#四、客户端配置\" class=\"headerlink\" title=\"四、客户端配置\"></a>四、客户端配置</h1><pre><code>client.ovpn\n\n##---------以下为将ca.crt证书写入到客户端文件的方式（直接给一个client.ovpn文件即可）------------##\nclient\ndev tun\nproto tcp   #根据服务端的来\nremote utnanjing.tpddns.cn 11194\nresolv-retry infinite\nnobind\npersist-key\npersist-tun\n&lt;ca&gt;\n-----BEGIN CERTIFICATE-----\nMIIDNTCCAh2gAwIBAgIJAJgy1QReG9VmMA0GCSqGSIb3DQEBCwUAMBYxFDASBgNV\nBAMMC0Vhc3ktUlNBIENBMB4XDTIzMDgyNDA5NTgzN1oXDTMzMDgyMTA5NTgzN1ow\nFjEUMBIGA1UEAwwLRWFzeS1SU0EgQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw\nggEKAoIBAQDLutXX/OaN1muPGKQV2uiEaZbQy9F0PptJxM3ZTHdyn+HuQ/3xqYHz\nz6hgIr2IjWtD5pqZXGMwIxbpNFKfPfJtwU5xpuUA6hxWV3yYtaXGsaLvFA0StL/N\nP5/3VgL1KpdcivjMejgVCwX5CkN97hsS6uk9Z/PUB9OEAWygeRHS8CYQ37PhXmDC\nh/1VeXWZDHJzxCD1fqoo2dB8MGFJjvg3FVQ0o8Gf0XE9cvj5dtk73f6AyiuYTeLL\nnD8vY8jbCVGeLcnoDnduK6y6ZLFOUHWfEPH+a1jDFLpXIby0oo3yBWcldzaKJMzf\nUP7HoczkDaUo5ykecDjxGkD8kpTmwyQPAgMBAAGjgYUwgYIwHQYDVR0OBBYEFPCY\nFNHxZ/eBKLRh009Bm08j8zurMEYGA1UdIwQ/MD2AFPCYFNHxZ/eBKLRh009Bm08j\n8zuroRqkGDAWMRQwEgYDVQQDDAtFYXN5LVJTQSBDQYIJAJgy1QReG9VmMAwGA1Ud\nEwQFMAMBAf8wCwYDVR0PBAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCYFaym5wCr\nlti+7p9MqLm4UF7pOmZQ2NamZjP1cQuMh2SgdJphddZEhEUO5NOQms8gMJsZ3sd7\nDIul+XkDcbhjKNNxD4oeXiITR8BgLsCkqtLStwWtOSLGxgHHWD3S+IBSM21A4Rxy\nhE4VUr81i9XUM2lI7ml5RgCVTvbWosCnVFuXypaYs4/c1yJJ1I578M6oVWjahJOx\nENoeYYSI/V+2ySTtRQlW8HQEc4GhSeybhmXgrfLKhmHTVl/ZqZg5zp3kwBcnsrUQ\njunuLBLMMYSLPXhJQFU/10EMxv/9AAdBGiO3RL0G2qYc0JF11qVpmD9nwP9f/YR3\nYvs7E2kwDViH\n-----END CERTIFICATE-----\n&lt;/ca&gt;\ncipher AES-256-CBC\ncomp-lzo\nverb 3\nauth-user-pass              #使用用户名密码登录openvpn服务器\nauth-nocache\n\n\n证书方式\n\nclient\ndev tun\nproto tcp\nremote 公网ipxxx.xxx.xxx.xxx 1194\nresolv-retry infinite\nnobind\npersist-key\npersist-tun\nca ca.crt\ncert client1.crt  #拷贝自服务端\nkey client1.key   #拷贝自服务端 \nremote-cert-tls server\ncipher AES-256-CBC\ncomp-lzo\nverb 3\n</code></pre>\n","site":{"data":{}},"length":5964,"excerpt":"","more":"<h1 id=\"一、安装\"><a href=\"#一、安装\" class=\"headerlink\" title=\"一、安装\"></a>一、安装</h1><h2 id=\"1-1、安装epel库和openvpn软件\"><a href=\"#1-1、安装epel库和openvpn软件\" class=\"headerlink\" title=\"1.1、安装epel库和openvpn软件\"></a>1.1、安装epel库和openvpn软件</h2><pre><code>yum -y install openvpn easy-rsa firewalld\n\nyum install epel-release -y\n</code></pre>\n<h2 id=\"1-2、开启路由转发\"><a href=\"#1-2、开启路由转发\" class=\"headerlink\" title=\"1.2、开启路由转发\"></a>1.2、开启路由转发</h2><pre><code> echo  &quot;net.ipv4.ip_forward = 1&quot; &gt;&gt;/etc/sysctl.conf\n sysctl -p\n</code></pre>\n<h2 id=\"1-3、创建OpenVPN相关的密钥\"><a href=\"#1-3、创建OpenVPN相关的密钥\" class=\"headerlink\" title=\"1.3、创建OpenVPN相关的密钥\"></a>1.3、创建OpenVPN相关的密钥</h2><pre><code> cp -rf /usr/share/easy-rsa/3.0/* /etc/openvpn/easy-rsa/\n cp -p /usr/share/doc/easy-rsa-3.0.6/vars.example /etc/openvpn/easy-rsa/vars\n cd /etc/openvpn/easy-rsa/\n</code></pre>\n<h3 id=\"1-3-1、创建ca证书\"><a href=\"#1-3-1、创建ca证书\" class=\"headerlink\" title=\"1.3.1、创建ca证书\"></a>1.3.1、创建ca证书</h3><pre><code>/usr/share/easy-rsa/3/easyrsa init-pki\n/usr/share/easy-rsa/3/easyrsa build-ca nopass\n</code></pre>\n<h3 id=\"1-3-2、创建client证书和签名\"><a href=\"#1-3-2、创建client证书和签名\" class=\"headerlink\" title=\"1.3..2、创建client证书和签名\"></a>1.3..2、创建client证书和签名</h3><pre><code>/usr/share/easy-rsa/3/easyrsa gen-req client1 nopass           #Enter\n/usr/share/easy-rsa/3/easyrsa sign-req client client1          #需要输入yes\n创建dh、tls、crl（证书撤销秘钥）\n/usr/share/easy-rsa/3/easyrsa gen-dh\nopenvpn --genkey --secret /etc/openvpn/easy-rsa/ta.key\n/usr/share/easy-rsa/3/easyrsa  gen-crl\n</code></pre>\n<h3 id=\"1-3-3、将秘钥拷贝至相应目录\"><a href=\"#1-3-3、将秘钥拷贝至相应目录\" class=\"headerlink\" title=\"1.3.3、将秘钥拷贝至相应目录\"></a>1.3.3、将秘钥拷贝至相应目录</h3><pre><code>cp -p pki/ca.crt /etc/openvpn/server/\ncp -p pki/issued/server1.crt /etc/openvpn/server/\ncp -p pki/private/server1.key /etc/openvpn/server/\ncp -p ta.key /etc/openvpn/server/\ncp -p pki/ca.crt /etc/openvpn/client/\ncp -p pki/issued/client1.crt /etc/openvpn/client/\ncp -p pki/private/client1.key /etc/openvpn/client/\ncp -p ta.key /etc/openvpn/client/\ncp pki/dh.pem /etc/openvpn/server/\ncp pki/crl.pem /etc/openvpn/server/\ncp /usr/share/doc/openvpn-2.4.11/sample/sample-config-files/server.conf /etc/openvpn/\n</code></pre>\n<h1 id=\"二、配置-openvpn\"><a href=\"#二、配置-openvpn\" class=\"headerlink\" title=\"二、配置 openvpn\"></a>二、配置 openvpn</h1><h2 id=\"2-1、编辑配置文件-etc-openvpn-server-conf\"><a href=\"#2-1、编辑配置文件-etc-openvpn-server-conf\" class=\"headerlink\" title=\"2.1、编辑配置文件 /etc/openvpn/server.conf\"></a>2.1、编辑配置文件 /etc/openvpn/server.conf</h2><pre><code>cp /usr/share/doc/openvpn-2.4.11/sample/sample-config-files/server.conf /etc/openvpn/      \n#拷贝实例修改或直接拷贝以下内容\nvim /etc/openvpn/server.conf\n\nlocal 0.0.0.0    #监听地址\nport 1194        #监听端口\nproto tcp        #监听协议\ndev tun          #采用路由隧道模式\nca /etc/openvpn/server/ca.crt              #ca证书路径\ncert /etc/openvpn/server/server1.crt       #服务器证书\nkey /etc/openvpn/server/server1.key        #服务器秘钥\ndh /etc/openvpn/server/dh.pem              #密钥交换协议文件\n#####注意在设备中加一条到10.100.100.0虚拟网段的路由！！！！\nserver 10.100.100.0 255.255.255.0          \n####给客户端分配地址池，注意：不能和VPN服务器内网网段有相同\n#####注意在设备中加一条到10.100.100.0虚拟网段的路由！！！！\nifconfig-pool-persist ipp.txt\n#push &quot;redirect-gateway def1 bypass-dhcp&quot;      #推送默认路由（所有流量走vpn）\npush &quot;route 192.168.0.0 255.255.255.0&quot;           \n#推送客户端常用路由（根据自己内网网段来写或修改客户端配置添加路由）\npush &quot;dhcp-option DNS 192.168.5.251&quot;           #dhcp分配dns\nclient-to-client       #客户端之间互相通信\nkeepalive 10 120       #存活时间，10秒ping一次,120 如未收到响应则视为断线\ncomp-lzo               #传输数据压缩\nmax-clients 100        #最多允许 100 客户端连接\nuser openvpn           #用户\ngroup openvpn          #用户组\ncipher AES-256-CBC     #加密方式--客户端必须一致\npersist-key\npersist-tun\nstatus /var/log/openvpn-status.log\nlog         /var/log/openvpn.log\nverb 3\n#以下参数为用户认证使用\nscript-security 3\nauth-user-pass-verify /etc/openvpn/checkpsw.sh via-env    #指定用户认证脚本\nusername-as-common-name\nverify-client-cert none\n</code></pre>\n<h2 id=\"2-2虚拟网段的路由\"><a href=\"#2-2虚拟网段的路由\" class=\"headerlink\" title=\"2.2虚拟网段的路由\"></a>2.2虚拟网段的路由</h2><pre><code>iptables -t nat -A POSTROUTING -s 10.100.100.0/24 -j MASQUERADE\n\n\nfirewall-cmd --add-masquerade --permanent\nfirewall-cmd --query-masquerade --permanent\n\nfirewall-cmd --zone=public --add-rich-rule=&#39;rule family=&quot;ipv4&quot; source address=&quot;10.100.100.0/24&quot; port protocol=&quot;tcp&quot; accept&#39;\nfirewall-cmd --zone=public --add-masquerade\n</code></pre>\n<h1 id=\"三、用户认证\"><a href=\"#三、用户认证\" class=\"headerlink\" title=\"三、用户认证\"></a>三、用户认证</h1><h2 id=\"3-1编写用户认证脚本文件-脚本是由openvpn官网提供\"><a href=\"#3-1编写用户认证脚本文件-脚本是由openvpn官网提供\" class=\"headerlink\" title=\"3.1编写用户认证脚本文件 (脚本是由openvpn官网提供)\"></a>3.1编写用户认证脚本文件 (脚本是由openvpn官网提供)</h2><pre><code>vim /etc/openvpn/checkpsw.sh\n#!/bin/sh\n###########################################################\n# checkpsw.sh (C) 2004 Mathias Sundman \n# This script will authenticate OpenVPN users against\n# a plain text file. The passfile should simply contain\n# one row per user with the username first followed by\n# one or more space(s) or tab(s) and then the password.\n\nPASSFILE=&quot;/etc/openvpn/psw-file&quot;\nLOG_FILE=&quot;/etc/openvpn/openvpn-password.log&quot;\nTIME_STAMP=`date &quot;+%Y-%m-%d %T&quot;`\n###########################################################\n\nif [ ! -r &quot;$&#123;PASSFILE&#125;&quot; ]; then\n  echo &quot;$&#123;TIME_STAMP&#125;: Could not open password file \\&quot;$&#123;PASSFILE&#125;\\&quot; for reading.&quot; &gt;&gt;$&#123;LOG_FILE&#125;\n  exit 1\nfi\n\nCORRECT_PASSWORD=`awk &#39;!/^;/&amp;&amp;!/^#/&amp;&amp;$1==&quot;&#39;$&#123;username&#125;&#39;&quot;&#123;print $2;exit&#125;&#39; $&#123;PASSFILE&#125;`\n\nif [ &quot;$&#123;CORRECT_PASSWORD&#125;&quot; = &quot;&quot; ]; then \n  echo &quot;$&#123;TIME_STAMP&#125;: User does not exist: username=\\&quot;$&#123;username&#125;\\&quot;, password=\\&quot;$&#123;password&#125;\\&quot;.&quot; &gt;&gt; $&#123;LOG_FILE&#125;\n  exit 1\nfi\n\nif [ &quot;$&#123;password&#125;&quot; = &quot;$&#123;CORRECT_PASSWORD&#125;&quot; ]; then \n  echo &quot;$&#123;TIME_STAMP&#125;: Successful authentication: username=\\&quot;$&#123;username&#125;\\&quot;.&quot; &gt;&gt; $&#123;LOG_FILE&#125;\n  exit 0\nfi\n\necho &quot;$&#123;TIME_STAMP&#125;: Incorrect password: username=\\&quot;$&#123;username&#125;\\&quot;,     password=\\&quot;$&#123;password&#125;\\&quot;.&quot; &gt;&gt; $&#123;LOG_FILE&#125;\nexit 1\n</code></pre>\n<h2 id=\"3-2-加权限及添加用户账号\"><a href=\"#3-2-加权限及添加用户账号\" class=\"headerlink\" title=\"3.2 加权限及添加用户账号\"></a>3.2 加权限及添加用户账号</h2><pre><code>给脚本添加执行权限\nchmod 755 /etc/openvpn/checkpsw.sh\n\n\n编辑密码文件\nvim /etc/openvpn/psw-file\ntom  123456\nJerry 654321\n#前面为用户名，后面为密码。 中间使用空格分开\n</code></pre>\n<h1 id=\"四、客户端配置\"><a href=\"#四、客户端配置\" class=\"headerlink\" title=\"四、客户端配置\"></a>四、客户端配置</h1><pre><code>client.ovpn\n\n##---------以下为将ca.crt证书写入到客户端文件的方式（直接给一个client.ovpn文件即可）------------##\nclient\ndev tun\nproto tcp   #根据服务端的来\nremote utnanjing.tpddns.cn 11194\nresolv-retry infinite\nnobind\npersist-key\npersist-tun\n&lt;ca&gt;\n-----BEGIN CERTIFICATE-----\nMIIDNTCCAh2gAwIBAgIJAJgy1QReG9VmMA0GCSqGSIb3DQEBCwUAMBYxFDASBgNV\nBAMMC0Vhc3ktUlNBIENBMB4XDTIzMDgyNDA5NTgzN1oXDTMzMDgyMTA5NTgzN1ow\nFjEUMBIGA1UEAwwLRWFzeS1SU0EgQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw\nggEKAoIBAQDLutXX/OaN1muPGKQV2uiEaZbQy9F0PptJxM3ZTHdyn+HuQ/3xqYHz\nz6hgIr2IjWtD5pqZXGMwIxbpNFKfPfJtwU5xpuUA6hxWV3yYtaXGsaLvFA0StL/N\nP5/3VgL1KpdcivjMejgVCwX5CkN97hsS6uk9Z/PUB9OEAWygeRHS8CYQ37PhXmDC\nh/1VeXWZDHJzxCD1fqoo2dB8MGFJjvg3FVQ0o8Gf0XE9cvj5dtk73f6AyiuYTeLL\nnD8vY8jbCVGeLcnoDnduK6y6ZLFOUHWfEPH+a1jDFLpXIby0oo3yBWcldzaKJMzf\nUP7HoczkDaUo5ykecDjxGkD8kpTmwyQPAgMBAAGjgYUwgYIwHQYDVR0OBBYEFPCY\nFNHxZ/eBKLRh009Bm08j8zurMEYGA1UdIwQ/MD2AFPCYFNHxZ/eBKLRh009Bm08j\n8zuroRqkGDAWMRQwEgYDVQQDDAtFYXN5LVJTQSBDQYIJAJgy1QReG9VmMAwGA1Ud\nEwQFMAMBAf8wCwYDVR0PBAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCYFaym5wCr\nlti+7p9MqLm4UF7pOmZQ2NamZjP1cQuMh2SgdJphddZEhEUO5NOQms8gMJsZ3sd7\nDIul+XkDcbhjKNNxD4oeXiITR8BgLsCkqtLStwWtOSLGxgHHWD3S+IBSM21A4Rxy\nhE4VUr81i9XUM2lI7ml5RgCVTvbWosCnVFuXypaYs4/c1yJJ1I578M6oVWjahJOx\nENoeYYSI/V+2ySTtRQlW8HQEc4GhSeybhmXgrfLKhmHTVl/ZqZg5zp3kwBcnsrUQ\njunuLBLMMYSLPXhJQFU/10EMxv/9AAdBGiO3RL0G2qYc0JF11qVpmD9nwP9f/YR3\nYvs7E2kwDViH\n-----END CERTIFICATE-----\n&lt;/ca&gt;\ncipher AES-256-CBC\ncomp-lzo\nverb 3\nauth-user-pass              #使用用户名密码登录openvpn服务器\nauth-nocache\n\n\n证书方式\n\nclient\ndev tun\nproto tcp\nremote 公网ipxxx.xxx.xxx.xxx 1194\nresolv-retry infinite\nnobind\npersist-key\npersist-tun\nca ca.crt\ncert client1.crt  #拷贝自服务端\nkey client1.key   #拷贝自服务端 \nremote-cert-tls server\ncipher AES-256-CBC\ncomp-lzo\nverb 3\n</code></pre>\n"},{"title":"搭建nps内网穿透","abbrlink":"a04b492d","date":"2023-08-29T07:19:19.000Z","_content":"# 前言\n内网穿透的方式有很多种，什么Frp、Ngrok、NPS、蒲公英等等，\n\n\n# NPS简介\n\nnps是一款轻量级、高性能、功能强大的内网穿透代理服务器。目前支持tcp、udp流量转发，\n可支持任何tcp、udp上层协议（访问内网网站、本地支付接口调试、ssh访问、远程桌面，内网dns解析等等……），\n此外还支持内网http代理、内网socks5代理、p2p等，并带有功能强大的web管理端\n\n# 安装docker\n\n    配置docker阿里云 镜像\n    yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n        \n    yum install docker-ce docker-ce-cli containerd.io\n\n# 安装nps\n\n    拉取镜像\n    docker pull ffdfgdfg/nps\n\n    添加配置文件\n    创建nps挂载文件目录(自己随意设置)\n    mkdir -p /docker/nps/conf\n    \n    配置下载地址 https://github.com/ehang-io/nps/blob/master/conf\n    修改刚下载的conf文件夹里的/docker/nps/conf/nps.conf文件：\n    \n    web_host=a.o.com   #修改为你的域名admin.nps.youdomain.com\n    web_username=admin \n    web_password=123   #修改为一个强密码，毕竟是放在公网上的服务\n    web_port = 8090    访问的端口号\n    web_ip=0.0.0.0\n\n    \n    运行nps\n    docker run -d   --restart=always --name nps --net=host -v /docker/nps/conf:/conf ffdfgdfg/nps\n\n\n# 客户端安装npc\n  \n    拉取npc镜像\n    docker pull ffdfgdfg/npc\n\n    nps新增客户端 获取到key\n    ![lena](../pic/nps-1.jpg)\n\n    docker run -d --restart=always --name npc-227 --net=host ffdfgdfg/npc -server=111.231.69.227:8024 -vkey=dle31e3ry1yl616p\n    【参数 -server 服务端IP:8024  -vkey 服务端获取】 \n    \n   \n    \n# 访问\n    \n    http://ip/8090  账号密码 配置文件中   \n\n    ![lena](../pic/nps-2.jpg)","source":"_posts/linux-搭建nps内网穿透.md","raw":"---\ntitle: 搭建nps内网穿透\nabbrlink: a04b492d\ndate: 2023-08-29 15:19:19\ntags:\n - linux\ncategories:\n  - 服务器相关  \n---\n# 前言\n内网穿透的方式有很多种，什么Frp、Ngrok、NPS、蒲公英等等，\n\n\n# NPS简介\n\nnps是一款轻量级、高性能、功能强大的内网穿透代理服务器。目前支持tcp、udp流量转发，\n可支持任何tcp、udp上层协议（访问内网网站、本地支付接口调试、ssh访问、远程桌面，内网dns解析等等……），\n此外还支持内网http代理、内网socks5代理、p2p等，并带有功能强大的web管理端\n\n# 安装docker\n\n    配置docker阿里云 镜像\n    yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n        \n    yum install docker-ce docker-ce-cli containerd.io\n\n# 安装nps\n\n    拉取镜像\n    docker pull ffdfgdfg/nps\n\n    添加配置文件\n    创建nps挂载文件目录(自己随意设置)\n    mkdir -p /docker/nps/conf\n    \n    配置下载地址 https://github.com/ehang-io/nps/blob/master/conf\n    修改刚下载的conf文件夹里的/docker/nps/conf/nps.conf文件：\n    \n    web_host=a.o.com   #修改为你的域名admin.nps.youdomain.com\n    web_username=admin \n    web_password=123   #修改为一个强密码，毕竟是放在公网上的服务\n    web_port = 8090    访问的端口号\n    web_ip=0.0.0.0\n\n    \n    运行nps\n    docker run -d   --restart=always --name nps --net=host -v /docker/nps/conf:/conf ffdfgdfg/nps\n\n\n# 客户端安装npc\n  \n    拉取npc镜像\n    docker pull ffdfgdfg/npc\n\n    nps新增客户端 获取到key\n    ![lena](../pic/nps-1.jpg)\n\n    docker run -d --restart=always --name npc-227 --net=host ffdfgdfg/npc -server=111.231.69.227:8024 -vkey=dle31e3ry1yl616p\n    【参数 -server 服务端IP:8024  -vkey 服务端获取】 \n    \n   \n    \n# 访问\n    \n    http://ip/8090  账号密码 配置文件中   \n\n    ![lena](../pic/nps-2.jpg)","slug":"linux-搭建nps内网穿透","published":1,"updated":"2025-07-03T02:34:38.690Z","_id":"cm04ukh79000o4kocfq86h4l5","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>内网穿透的方式有很多种，什么Frp、Ngrok、NPS、蒲公英等等，</p>\n<h1 id=\"NPS简介\"><a href=\"#NPS简介\" class=\"headerlink\" title=\"NPS简介\"></a>NPS简介</h1><p>nps是一款轻量级、高性能、功能强大的内网穿透代理服务器。目前支持tcp、udp流量转发，<br>可支持任何tcp、udp上层协议（访问内网网站、本地支付接口调试、ssh访问、远程桌面，内网dns解析等等……），<br>此外还支持内网http代理、内网socks5代理、p2p等，并带有功能强大的web管理端</p>\n<h1 id=\"安装docker\"><a href=\"#安装docker\" class=\"headerlink\" title=\"安装docker\"></a>安装docker</h1><pre><code>配置docker阿里云 镜像\nyum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n    \nyum install docker-ce docker-ce-cli containerd.io\n</code></pre>\n<h1 id=\"安装nps\"><a href=\"#安装nps\" class=\"headerlink\" title=\"安装nps\"></a>安装nps</h1><pre><code>拉取镜像\ndocker pull ffdfgdfg/nps\n\n添加配置文件\n创建nps挂载文件目录(自己随意设置)\nmkdir -p /docker/nps/conf\n\n配置下载地址 https://github.com/ehang-io/nps/blob/master/conf\n修改刚下载的conf文件夹里的/docker/nps/conf/nps.conf文件：\n\nweb_host=a.o.com   #修改为你的域名admin.nps.youdomain.com\nweb_username=admin \nweb_password=123   #修改为一个强密码，毕竟是放在公网上的服务\nweb_port = 8090    访问的端口号\nweb_ip=0.0.0.0\n\n\n运行nps\ndocker run -d   --restart=always --name nps --net=host -v /docker/nps/conf:/conf ffdfgdfg/nps\n</code></pre>\n<h1 id=\"客户端安装npc\"><a href=\"#客户端安装npc\" class=\"headerlink\" title=\"客户端安装npc\"></a>客户端安装npc</h1><pre><code>拉取npc镜像\ndocker pull ffdfgdfg/npc\n\nnps新增客户端 获取到key\n![lena](../pic/nps-1.jpg)\n\ndocker run -d --restart=always --name npc-227 --net=host ffdfgdfg/npc -server=111.231.69.227:8024 -vkey=dle31e3ry1yl616p\n【参数 -server 服务端IP:8024  -vkey 服务端获取】 \n</code></pre>\n<h1 id=\"访问\"><a href=\"#访问\" class=\"headerlink\" title=\"访问\"></a>访问</h1><pre><code>http://ip/8090  账号密码 配置文件中   \n\n![lena](../pic/nps-2.jpg)\n</code></pre>\n","site":{"data":{}},"length":1011,"excerpt":"","more":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>内网穿透的方式有很多种，什么Frp、Ngrok、NPS、蒲公英等等，</p>\n<h1 id=\"NPS简介\"><a href=\"#NPS简介\" class=\"headerlink\" title=\"NPS简介\"></a>NPS简介</h1><p>nps是一款轻量级、高性能、功能强大的内网穿透代理服务器。目前支持tcp、udp流量转发，<br>可支持任何tcp、udp上层协议（访问内网网站、本地支付接口调试、ssh访问、远程桌面，内网dns解析等等……），<br>此外还支持内网http代理、内网socks5代理、p2p等，并带有功能强大的web管理端</p>\n<h1 id=\"安装docker\"><a href=\"#安装docker\" class=\"headerlink\" title=\"安装docker\"></a>安装docker</h1><pre><code>配置docker阿里云 镜像\nyum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n    \nyum install docker-ce docker-ce-cli containerd.io\n</code></pre>\n<h1 id=\"安装nps\"><a href=\"#安装nps\" class=\"headerlink\" title=\"安装nps\"></a>安装nps</h1><pre><code>拉取镜像\ndocker pull ffdfgdfg/nps\n\n添加配置文件\n创建nps挂载文件目录(自己随意设置)\nmkdir -p /docker/nps/conf\n\n配置下载地址 https://github.com/ehang-io/nps/blob/master/conf\n修改刚下载的conf文件夹里的/docker/nps/conf/nps.conf文件：\n\nweb_host=a.o.com   #修改为你的域名admin.nps.youdomain.com\nweb_username=admin \nweb_password=123   #修改为一个强密码，毕竟是放在公网上的服务\nweb_port = 8090    访问的端口号\nweb_ip=0.0.0.0\n\n\n运行nps\ndocker run -d   --restart=always --name nps --net=host -v /docker/nps/conf:/conf ffdfgdfg/nps\n</code></pre>\n<h1 id=\"客户端安装npc\"><a href=\"#客户端安装npc\" class=\"headerlink\" title=\"客户端安装npc\"></a>客户端安装npc</h1><pre><code>拉取npc镜像\ndocker pull ffdfgdfg/npc\n\nnps新增客户端 获取到key\n![lena](../pic/nps-1.jpg)\n\ndocker run -d --restart=always --name npc-227 --net=host ffdfgdfg/npc -server=111.231.69.227:8024 -vkey=dle31e3ry1yl616p\n【参数 -server 服务端IP:8024  -vkey 服务端获取】 \n</code></pre>\n<h1 id=\"访问\"><a href=\"#访问\" class=\"headerlink\" title=\"访问\"></a>访问</h1><pre><code>http://ip/8090  账号密码 配置文件中   \n\n![lena](../pic/nps-2.jpg)\n</code></pre>\n"},{"title":"linux-硬盘分区","abbrlink":"2acbc304","date":"2023-03-16T02:24:39.000Z","_content":"   \n\n# 一、 硬盘分区基础知识\n    磁盘分区类型：硬盘分区最常见的类型为msdos和gpt，\n    前者表示MBR分区，而后者表示GPT分区。传统的BIOS只支持MBR分区硬盘启动，\n    一个硬盘只能分成四个分区，并且单个分区最大不超过2TB。\n    GPT(即GUID分区表)是源自EFI标准的一种较新的磁盘分区表结构的标准，是未来磁盘分区的主要形式。\n    与MBR分区方式相比，突破MBR4个主分区限制，每个磁盘最多支持128个分区，持大于2T的分区，最大卷可达18EB。\n    1、MBR分区：\n    MBR的意思是“主引导记录”，它有自己的启动器，也就是启动代码，\n    一旦启动代码被破坏，系统就没法启动，只有通过修复才能启动系统。最大支持2TB容量（T; terabytes,1TB=1024GB），\n    对分区的设限：最多4个主分区或3个主分区加一个扩展分区。创建工具典型有fdisk。\n    \n    2、GPT分区：GPT意为GUID分区表，这是一个正逐渐取代MBR的新标准，它由UEFI辅住而形成的，\n    这样就有了UEFI用于取代老旧的BIOS，而GPT则取代老旧的MBR。这个标准没有MBR的那些限制比如：容量2T限制、分区个数限制等。磁盘驱动器容量可以大得多，\n    大到操作系统和文件系统都没法支持。它同时还支持几乎无限个分区数量，限制只在于操作系统，Windows支持最多128个GPT分区。GPT和MBR是不同的分区表类型。\n    使用MBR分区表的硬盘最多只能划分4个主分区磁盘，并且MBR最大仅支持2TB的硬盘。如果需要分区的硬盘容量超过2TB了，则需要使用GPT分区表类型，\n    此分区表类型不受分区个数、硬盘大小的限制。创建GPT分区典型工具有parted,gdisk,sgdisk等,fdisk不支持创建GPT分区。\n    我们管理的服务器可能会随着业务量的不断增长而造成磁盘数据空间不足的情况（不考虑inode），这个时候我们就可能需要增加磁盘或挂载一些其他的块设备，\n    这里我主要介绍如何使用fdisk分区工具创建磁盘分区和挂载分区。最重要的三步就是：\n    1、创建主分区。（主分区创建之后可以马上被使用但不能再分区）\n    2、创建扩展分区 (扩展分区必须再进行二次分区后才能被使用)\n    3、在扩展分区上创建逻辑分区（扩充分区再分下去的是什么呢？它就是逻辑分区（Logical Partion））\n    Linux下单个磁盘最多可以有15个分区。3个主分区 + 1个扩展分区 + 11个逻辑分区。\n    建议的分区方法是：先分3个主分区，第四个分区为扩展分区，然后在扩展分区中再分成11个逻辑分区。\n    在unix/linux系统中，一切都是文件。\n    所有硬盘、软盘、键盘等设备都用文件来代表，对应 着/dev下面的文件。\n    对于应用程序来说，可以像对待普通文件一样打开，关闭、读写这些设备文件。\n    但是这种文件名，比如/dev/sda、/dev /raw/raw1都是用户空间名称，\n    OS Kernel根本不知道这个名称指的是什么。在内核空间是通过major、minor device number 来区分设备的\n    \n    块设备也是通过/dev目录下的文件系统节点来访问。块设备上能够容纳文件系统。\n    常见的块设备如磁盘、emmc flash、nand flash、 SD卡等。\n    \n    在linux系统中/dev目录下使用ls -l命令查看详细信息，第一个字母“b”为块设备文件的标识。/dev下每个块设备文件对应一个磁盘的分区。\n\n\n# 二、创建分区\n  \n    虽然支持mbr的硬盘（容量小于等于2T）分区表中最多能存储四个分区，但我们实际使用时一般只分为两个分区，\n    一个是主分区（Primary Partion）一个是扩展分区(extended partition)两种，主分区可以马上被使用但不能再分区，\n    扩展分区必须再进行分区后才能使用，也就是说它必须还要进行二次分区。那么由扩充分区再分下去的是什么呢？它就是逻辑分区（Logical Partion）。 \n    对习惯于使用Dos或Windows的朋友来说，有几个分区就有几个驱动器，并且每个分区都会获得一个字母标识符，然后就可以选用这个字母来指定在这个分区上的文件和目录，\n    它们的文件结构都是独立的，非常好理解。 \n    因为对Linux用户来说无论有几个分区，分给哪一目录使用，它归根结底就只有一个根目录，一个独立且唯一的文件结构。\n     Linux中每个分区都是用来组成整个文件系统的一部分，因为它采用了一种叫“挂载点”的处理方法，它的整个文件系统中包含了一整套的文件和目录，\n     且将一个分区和一个目录联系起来。这时要载入的一个分区将使它的存储空间在一个目录下获得。\n     \n     \n     1、 fdisk -l 查看块设备情况（块设备包括硬盘，U盘，SD卡） \n\n\n# 格式化分区\n    \n    \n    虚拟文件系统(VFS) 操作模型，通过mkfs.xxx等这种系列性的命令创建格式化很多不同的文件系统，\n    比如：mkfs.ext4 /dev/sda 、 mkfs.btrfs /dev/sdb等,但这些不同的文件系统都有各自的API接口，而用户想要的是，不管你是什么API，\n    他们只关心mount/umount，或open/close等操作，等于屏蔽了底层的文件系统类型，运维层面只关心mount等操作即可。不同的文件系统类型有不同的特点，\n    因而根据存储设备的硬件特性、系统需求等有不同的应用场合,什么意思呢，也就是说假如你用了不同设备都是硬盘，那么建立这个硬盘可以用不同的文件系统来做映射，\n    可能就会获得不同的性能提升。还是要看相关的设备种类和厂商设计的目的。\n    \n    \n    文件系统\t描 述\n    Ext\tLinux 中最早的文件系统，由于在性能和兼容性上具有很多缺陷，现在已经很少使用,是为 Linux 核心所做的第一个文件系统，最大可支持 2GB 的文件系统。\n    \n    Ext2\t是 Ext 文件系统的升级版本，Red Hat Linux 7.2 版本以前的系统默认都是 Ext2 文件系统。于 1993 年发布，\n            支持最大 16TB 的分区和最大 2TB 的文件（1TB=1024GB=1024x1024KB)\n            Linux正统的文件系统(如ext2、ext3)一个文件由目录项、inode和数据块组成。\n            目录项:包括文件名和inode节点号。\n            Inode：又称文件索引节点，是文件基本信息的存放地和数据块指针存放地。\n            数据块：文件的具体内容存放地。\n            将硬盘分区时会划分出目录块、inode Table区块和data block数据区域。一个文件由一个目录项、inode和数据区域块组成。\n            Inode包含文件的属性(如读写属性、owner等，以及指向数据块的指针)，数据区域块则是文件内容。\n            当查看某个文件时，会先从inode table中查出文件属性及数据存放点，再从数据块中读取数据\n    \n    Ext3\t是 Ext2 文件系统的升级版本，最大的区别就是带日志功能，以便在系统突然停止时提高文件系统的可靠性。支持最大 16TB 的分区和最大 2TB 的文件\n    \n    Ext4\t是 Ext3 文件系统的升级版。Ext4 在性能、伸缩性和可靠性方面进行了大量改进。Ext4 的变化可以说是翻天覆地的，\n            比如向下兼容 Ext3、最大 1EB 文件系统和 16TB 文件、无限数量子目录、Extents 连续数据块 概念、多块分配、延迟分配、\n            持久预分配、快速 FSCK、日志校验、无日志模式、在线碎片整理、inode 增强、\n            默认启用 barrier 等。它是 CentOS 6.3 的默认文件系统\n            \n            \n    xfs\t    被业界称为最先进、最具有可升级性的文件系统技术，由 SGI 公司设计，目前最新的 CentOS 7 版本默认使用的就是此文件系统。\n    \n    swap\tswap 是 Linux 中用于交换分区的文件系统（类似于 Windows 中的虚拟内存)，\n    当内存不够用时，使用交换分区暂时替代内存。一般大小为内存的 2 倍，但是不要超过 2GB。它是 Linux 的必需分区\n    \n    NFS\tNFS 是网络文件系统（Network File System）的缩写，是用来实现不同主机之间文件共享的一种网络服务，本地主机可以通过挂载的方式使用远程共享的资源\n    iso9660\t光盘的标准文件系统。Linux 要想使用光盘，必须支持 iso9660 文件系统\n    \n    fat\t就是 Windows 下的 fatl6 文件系统，在 Linux 中识别为 fat\n    \n    vfat\t就是 Windows 下的 fat32 文件系统，在 Linux 中识别为 vfat。支持最大 32GB 的分区和最大 4GB 的文件\n<font color='red'>VFAT 是一种早期的文件系统，通常用于与 Windows 系统兼容的可移动设备。由于 VFAT 文件系统不支持类似 UNIX 文件系统的权限和所有权概念，\n因此在挂载后无法执行 chown 命令来更改文件和目录的所有者。</font>\n    \n    NTFS\t就是 Windows 下的 NTFS 文件系统，不过 Linux 默认是不能识别 NTFS 文件系统的，如果需要识别，则需要重新编译内核才能支持。\n            它比 fat32 文件系统更加安全，速度更快，支持最大 2TB 的分区和最大 64GB 的文件\n    ufs\tSun 公司的操作系统 Solaris 和 SunOS 所采用的文件系统\n    \n    proc\tLinux 中基于内存的虚拟文件系统，用来管理内存存储目录 /proc\n    \n    sysfs\t和 proc —样，也是基于内存的虚拟文件系统，用来管理内存存储目录 /sysfs\n    \n    tmpfs\t也是一种基于内存的虚拟文件系统，不过也可以使用 swap 交换分区\n    \n    现在一般是Ext4 xfs格式\n\n\n# 分区工具 \n    fdisk命令可以用于对2TB以内的磁盘进行添加、删除、转换分区的功能,用户可以根据实际情况进行合理划分。\n    \n    \n    parted -l命令\n    \n    parted一款功能强大的磁盘分区和分区大小调整工具。\n    \n    parted -l同fdisk -l命令类似，但是它可以识别2TB以上的硬盘，也能查看 GPT 磁盘的分区\n    \n    \n#具体操作  \n ## 基本命令介绍   \n    df -h\n          查看分区情况 相对比较直观\n          \n    fdisk -l\n          查看系统有几块硬盘  分标有多大  分了那几个区\n          \n          \n    lsblk\n    lsblk -f  \n    查看分区信息  -f更详细\n    令可以列出所有可用块设备的信息,而且还能显示他们之间的依赖关系，但是它不会列出RAM盘的信息。块设备有硬盘,闪存盘,CD-ROM等等\n    \n    用 blkid  获取磁盘的uuid和属性\n    \n## 详细操作    \n    \n    分区\n    1.fdisk   盘符    示例：fidisk /dev/sdb\n    \n    2.输入n 是创建分区（一般下面多是默认）\n    \n    3.然后选择分区类型\n                    p   primary(主分区)\n                    e   extende（扩展）\n                    \n    4.设置分区号（一般默认）  \n                  \n    \n    5.然后设置     起始扇区\n                  结束扇区  \n                    \n    6.设置完 输入w    保存     \n    \n    7.特殊操作需要删除分区 输入d 然后选择分区号                   \n    \n    \n    格式化  \n            mkfs -t ext3 /dev/sdb2\n            mkfs -t ext4 /dev/sdb2 \n            mkfs.xfs -f /dev/sdb2\n            \n            \n    查看分区信息       \n    lsblk\n    lsblk -f  更详细\n    \n    \n    用 blkid  获取磁盘的uuid和属性\n\n    vim /etc/fstab\n\n\n    配置模板：UUID=*************  挂载路径  格式  defaults  1  1 \n    示例   UUID=b2cc970b-7cf4-453e-b3f5-916497b9530e  /apps  xfs  defaults  1  1 \n    \n","source":"_posts/linux-硬盘分区.md","raw":"---\ntitle: linux-硬盘分区\nabbrlink: 2acbc304\ndate: 2023-03-16 10:24:39\ntags:\n - linux\ncategories:\n  - 服务器相关  \n---\n   \n\n# 一、 硬盘分区基础知识\n    磁盘分区类型：硬盘分区最常见的类型为msdos和gpt，\n    前者表示MBR分区，而后者表示GPT分区。传统的BIOS只支持MBR分区硬盘启动，\n    一个硬盘只能分成四个分区，并且单个分区最大不超过2TB。\n    GPT(即GUID分区表)是源自EFI标准的一种较新的磁盘分区表结构的标准，是未来磁盘分区的主要形式。\n    与MBR分区方式相比，突破MBR4个主分区限制，每个磁盘最多支持128个分区，持大于2T的分区，最大卷可达18EB。\n    1、MBR分区：\n    MBR的意思是“主引导记录”，它有自己的启动器，也就是启动代码，\n    一旦启动代码被破坏，系统就没法启动，只有通过修复才能启动系统。最大支持2TB容量（T; terabytes,1TB=1024GB），\n    对分区的设限：最多4个主分区或3个主分区加一个扩展分区。创建工具典型有fdisk。\n    \n    2、GPT分区：GPT意为GUID分区表，这是一个正逐渐取代MBR的新标准，它由UEFI辅住而形成的，\n    这样就有了UEFI用于取代老旧的BIOS，而GPT则取代老旧的MBR。这个标准没有MBR的那些限制比如：容量2T限制、分区个数限制等。磁盘驱动器容量可以大得多，\n    大到操作系统和文件系统都没法支持。它同时还支持几乎无限个分区数量，限制只在于操作系统，Windows支持最多128个GPT分区。GPT和MBR是不同的分区表类型。\n    使用MBR分区表的硬盘最多只能划分4个主分区磁盘，并且MBR最大仅支持2TB的硬盘。如果需要分区的硬盘容量超过2TB了，则需要使用GPT分区表类型，\n    此分区表类型不受分区个数、硬盘大小的限制。创建GPT分区典型工具有parted,gdisk,sgdisk等,fdisk不支持创建GPT分区。\n    我们管理的服务器可能会随着业务量的不断增长而造成磁盘数据空间不足的情况（不考虑inode），这个时候我们就可能需要增加磁盘或挂载一些其他的块设备，\n    这里我主要介绍如何使用fdisk分区工具创建磁盘分区和挂载分区。最重要的三步就是：\n    1、创建主分区。（主分区创建之后可以马上被使用但不能再分区）\n    2、创建扩展分区 (扩展分区必须再进行二次分区后才能被使用)\n    3、在扩展分区上创建逻辑分区（扩充分区再分下去的是什么呢？它就是逻辑分区（Logical Partion））\n    Linux下单个磁盘最多可以有15个分区。3个主分区 + 1个扩展分区 + 11个逻辑分区。\n    建议的分区方法是：先分3个主分区，第四个分区为扩展分区，然后在扩展分区中再分成11个逻辑分区。\n    在unix/linux系统中，一切都是文件。\n    所有硬盘、软盘、键盘等设备都用文件来代表，对应 着/dev下面的文件。\n    对于应用程序来说，可以像对待普通文件一样打开，关闭、读写这些设备文件。\n    但是这种文件名，比如/dev/sda、/dev /raw/raw1都是用户空间名称，\n    OS Kernel根本不知道这个名称指的是什么。在内核空间是通过major、minor device number 来区分设备的\n    \n    块设备也是通过/dev目录下的文件系统节点来访问。块设备上能够容纳文件系统。\n    常见的块设备如磁盘、emmc flash、nand flash、 SD卡等。\n    \n    在linux系统中/dev目录下使用ls -l命令查看详细信息，第一个字母“b”为块设备文件的标识。/dev下每个块设备文件对应一个磁盘的分区。\n\n\n# 二、创建分区\n  \n    虽然支持mbr的硬盘（容量小于等于2T）分区表中最多能存储四个分区，但我们实际使用时一般只分为两个分区，\n    一个是主分区（Primary Partion）一个是扩展分区(extended partition)两种，主分区可以马上被使用但不能再分区，\n    扩展分区必须再进行分区后才能使用，也就是说它必须还要进行二次分区。那么由扩充分区再分下去的是什么呢？它就是逻辑分区（Logical Partion）。 \n    对习惯于使用Dos或Windows的朋友来说，有几个分区就有几个驱动器，并且每个分区都会获得一个字母标识符，然后就可以选用这个字母来指定在这个分区上的文件和目录，\n    它们的文件结构都是独立的，非常好理解。 \n    因为对Linux用户来说无论有几个分区，分给哪一目录使用，它归根结底就只有一个根目录，一个独立且唯一的文件结构。\n     Linux中每个分区都是用来组成整个文件系统的一部分，因为它采用了一种叫“挂载点”的处理方法，它的整个文件系统中包含了一整套的文件和目录，\n     且将一个分区和一个目录联系起来。这时要载入的一个分区将使它的存储空间在一个目录下获得。\n     \n     \n     1、 fdisk -l 查看块设备情况（块设备包括硬盘，U盘，SD卡） \n\n\n# 格式化分区\n    \n    \n    虚拟文件系统(VFS) 操作模型，通过mkfs.xxx等这种系列性的命令创建格式化很多不同的文件系统，\n    比如：mkfs.ext4 /dev/sda 、 mkfs.btrfs /dev/sdb等,但这些不同的文件系统都有各自的API接口，而用户想要的是，不管你是什么API，\n    他们只关心mount/umount，或open/close等操作，等于屏蔽了底层的文件系统类型，运维层面只关心mount等操作即可。不同的文件系统类型有不同的特点，\n    因而根据存储设备的硬件特性、系统需求等有不同的应用场合,什么意思呢，也就是说假如你用了不同设备都是硬盘，那么建立这个硬盘可以用不同的文件系统来做映射，\n    可能就会获得不同的性能提升。还是要看相关的设备种类和厂商设计的目的。\n    \n    \n    文件系统\t描 述\n    Ext\tLinux 中最早的文件系统，由于在性能和兼容性上具有很多缺陷，现在已经很少使用,是为 Linux 核心所做的第一个文件系统，最大可支持 2GB 的文件系统。\n    \n    Ext2\t是 Ext 文件系统的升级版本，Red Hat Linux 7.2 版本以前的系统默认都是 Ext2 文件系统。于 1993 年发布，\n            支持最大 16TB 的分区和最大 2TB 的文件（1TB=1024GB=1024x1024KB)\n            Linux正统的文件系统(如ext2、ext3)一个文件由目录项、inode和数据块组成。\n            目录项:包括文件名和inode节点号。\n            Inode：又称文件索引节点，是文件基本信息的存放地和数据块指针存放地。\n            数据块：文件的具体内容存放地。\n            将硬盘分区时会划分出目录块、inode Table区块和data block数据区域。一个文件由一个目录项、inode和数据区域块组成。\n            Inode包含文件的属性(如读写属性、owner等，以及指向数据块的指针)，数据区域块则是文件内容。\n            当查看某个文件时，会先从inode table中查出文件属性及数据存放点，再从数据块中读取数据\n    \n    Ext3\t是 Ext2 文件系统的升级版本，最大的区别就是带日志功能，以便在系统突然停止时提高文件系统的可靠性。支持最大 16TB 的分区和最大 2TB 的文件\n    \n    Ext4\t是 Ext3 文件系统的升级版。Ext4 在性能、伸缩性和可靠性方面进行了大量改进。Ext4 的变化可以说是翻天覆地的，\n            比如向下兼容 Ext3、最大 1EB 文件系统和 16TB 文件、无限数量子目录、Extents 连续数据块 概念、多块分配、延迟分配、\n            持久预分配、快速 FSCK、日志校验、无日志模式、在线碎片整理、inode 增强、\n            默认启用 barrier 等。它是 CentOS 6.3 的默认文件系统\n            \n            \n    xfs\t    被业界称为最先进、最具有可升级性的文件系统技术，由 SGI 公司设计，目前最新的 CentOS 7 版本默认使用的就是此文件系统。\n    \n    swap\tswap 是 Linux 中用于交换分区的文件系统（类似于 Windows 中的虚拟内存)，\n    当内存不够用时，使用交换分区暂时替代内存。一般大小为内存的 2 倍，但是不要超过 2GB。它是 Linux 的必需分区\n    \n    NFS\tNFS 是网络文件系统（Network File System）的缩写，是用来实现不同主机之间文件共享的一种网络服务，本地主机可以通过挂载的方式使用远程共享的资源\n    iso9660\t光盘的标准文件系统。Linux 要想使用光盘，必须支持 iso9660 文件系统\n    \n    fat\t就是 Windows 下的 fatl6 文件系统，在 Linux 中识别为 fat\n    \n    vfat\t就是 Windows 下的 fat32 文件系统，在 Linux 中识别为 vfat。支持最大 32GB 的分区和最大 4GB 的文件\n<font color='red'>VFAT 是一种早期的文件系统，通常用于与 Windows 系统兼容的可移动设备。由于 VFAT 文件系统不支持类似 UNIX 文件系统的权限和所有权概念，\n因此在挂载后无法执行 chown 命令来更改文件和目录的所有者。</font>\n    \n    NTFS\t就是 Windows 下的 NTFS 文件系统，不过 Linux 默认是不能识别 NTFS 文件系统的，如果需要识别，则需要重新编译内核才能支持。\n            它比 fat32 文件系统更加安全，速度更快，支持最大 2TB 的分区和最大 64GB 的文件\n    ufs\tSun 公司的操作系统 Solaris 和 SunOS 所采用的文件系统\n    \n    proc\tLinux 中基于内存的虚拟文件系统，用来管理内存存储目录 /proc\n    \n    sysfs\t和 proc —样，也是基于内存的虚拟文件系统，用来管理内存存储目录 /sysfs\n    \n    tmpfs\t也是一种基于内存的虚拟文件系统，不过也可以使用 swap 交换分区\n    \n    现在一般是Ext4 xfs格式\n\n\n# 分区工具 \n    fdisk命令可以用于对2TB以内的磁盘进行添加、删除、转换分区的功能,用户可以根据实际情况进行合理划分。\n    \n    \n    parted -l命令\n    \n    parted一款功能强大的磁盘分区和分区大小调整工具。\n    \n    parted -l同fdisk -l命令类似，但是它可以识别2TB以上的硬盘，也能查看 GPT 磁盘的分区\n    \n    \n#具体操作  \n ## 基本命令介绍   \n    df -h\n          查看分区情况 相对比较直观\n          \n    fdisk -l\n          查看系统有几块硬盘  分标有多大  分了那几个区\n          \n          \n    lsblk\n    lsblk -f  \n    查看分区信息  -f更详细\n    令可以列出所有可用块设备的信息,而且还能显示他们之间的依赖关系，但是它不会列出RAM盘的信息。块设备有硬盘,闪存盘,CD-ROM等等\n    \n    用 blkid  获取磁盘的uuid和属性\n    \n## 详细操作    \n    \n    分区\n    1.fdisk   盘符    示例：fidisk /dev/sdb\n    \n    2.输入n 是创建分区（一般下面多是默认）\n    \n    3.然后选择分区类型\n                    p   primary(主分区)\n                    e   extende（扩展）\n                    \n    4.设置分区号（一般默认）  \n                  \n    \n    5.然后设置     起始扇区\n                  结束扇区  \n                    \n    6.设置完 输入w    保存     \n    \n    7.特殊操作需要删除分区 输入d 然后选择分区号                   \n    \n    \n    格式化  \n            mkfs -t ext3 /dev/sdb2\n            mkfs -t ext4 /dev/sdb2 \n            mkfs.xfs -f /dev/sdb2\n            \n            \n    查看分区信息       \n    lsblk\n    lsblk -f  更详细\n    \n    \n    用 blkid  获取磁盘的uuid和属性\n\n    vim /etc/fstab\n\n\n    配置模板：UUID=*************  挂载路径  格式  defaults  1  1 \n    示例   UUID=b2cc970b-7cf4-453e-b3f5-916497b9530e  /apps  xfs  defaults  1  1 \n    \n","slug":"linux-硬盘分区","published":1,"updated":"2024-11-25T11:20:03.785Z","_id":"cm04ukh7c000r4koc0aht3pqb","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、-硬盘分区基础知识\"><a href=\"#一、-硬盘分区基础知识\" class=\"headerlink\" title=\"一、 硬盘分区基础知识\"></a>一、 硬盘分区基础知识</h1><pre><code>磁盘分区类型：硬盘分区最常见的类型为msdos和gpt，\n前者表示MBR分区，而后者表示GPT分区。传统的BIOS只支持MBR分区硬盘启动，\n一个硬盘只能分成四个分区，并且单个分区最大不超过2TB。\nGPT(即GUID分区表)是源自EFI标准的一种较新的磁盘分区表结构的标准，是未来磁盘分区的主要形式。\n与MBR分区方式相比，突破MBR4个主分区限制，每个磁盘最多支持128个分区，持大于2T的分区，最大卷可达18EB。\n1、MBR分区：\nMBR的意思是“主引导记录”，它有自己的启动器，也就是启动代码，\n一旦启动代码被破坏，系统就没法启动，只有通过修复才能启动系统。最大支持2TB容量（T; terabytes,1TB=1024GB），\n对分区的设限：最多4个主分区或3个主分区加一个扩展分区。创建工具典型有fdisk。\n\n2、GPT分区：GPT意为GUID分区表，这是一个正逐渐取代MBR的新标准，它由UEFI辅住而形成的，\n这样就有了UEFI用于取代老旧的BIOS，而GPT则取代老旧的MBR。这个标准没有MBR的那些限制比如：容量2T限制、分区个数限制等。磁盘驱动器容量可以大得多，\n大到操作系统和文件系统都没法支持。它同时还支持几乎无限个分区数量，限制只在于操作系统，Windows支持最多128个GPT分区。GPT和MBR是不同的分区表类型。\n使用MBR分区表的硬盘最多只能划分4个主分区磁盘，并且MBR最大仅支持2TB的硬盘。如果需要分区的硬盘容量超过2TB了，则需要使用GPT分区表类型，\n此分区表类型不受分区个数、硬盘大小的限制。创建GPT分区典型工具有parted,gdisk,sgdisk等,fdisk不支持创建GPT分区。\n我们管理的服务器可能会随着业务量的不断增长而造成磁盘数据空间不足的情况（不考虑inode），这个时候我们就可能需要增加磁盘或挂载一些其他的块设备，\n这里我主要介绍如何使用fdisk分区工具创建磁盘分区和挂载分区。最重要的三步就是：\n1、创建主分区。（主分区创建之后可以马上被使用但不能再分区）\n2、创建扩展分区 (扩展分区必须再进行二次分区后才能被使用)\n3、在扩展分区上创建逻辑分区（扩充分区再分下去的是什么呢？它就是逻辑分区（Logical Partion））\nLinux下单个磁盘最多可以有15个分区。3个主分区 + 1个扩展分区 + 11个逻辑分区。\n建议的分区方法是：先分3个主分区，第四个分区为扩展分区，然后在扩展分区中再分成11个逻辑分区。\n在unix/linux系统中，一切都是文件。\n所有硬盘、软盘、键盘等设备都用文件来代表，对应 着/dev下面的文件。\n对于应用程序来说，可以像对待普通文件一样打开，关闭、读写这些设备文件。\n但是这种文件名，比如/dev/sda、/dev /raw/raw1都是用户空间名称，\nOS Kernel根本不知道这个名称指的是什么。在内核空间是通过major、minor device number 来区分设备的\n\n块设备也是通过/dev目录下的文件系统节点来访问。块设备上能够容纳文件系统。\n常见的块设备如磁盘、emmc flash、nand flash、 SD卡等。\n\n在linux系统中/dev目录下使用ls -l命令查看详细信息，第一个字母“b”为块设备文件的标识。/dev下每个块设备文件对应一个磁盘的分区。\n</code></pre>\n<h1 id=\"二、创建分区\"><a href=\"#二、创建分区\" class=\"headerlink\" title=\"二、创建分区\"></a>二、创建分区</h1><pre><code>虽然支持mbr的硬盘（容量小于等于2T）分区表中最多能存储四个分区，但我们实际使用时一般只分为两个分区，\n一个是主分区（Primary Partion）一个是扩展分区(extended partition)两种，主分区可以马上被使用但不能再分区，\n扩展分区必须再进行分区后才能使用，也就是说它必须还要进行二次分区。那么由扩充分区再分下去的是什么呢？它就是逻辑分区（Logical Partion）。 \n对习惯于使用Dos或Windows的朋友来说，有几个分区就有几个驱动器，并且每个分区都会获得一个字母标识符，然后就可以选用这个字母来指定在这个分区上的文件和目录，\n它们的文件结构都是独立的，非常好理解。 \n因为对Linux用户来说无论有几个分区，分给哪一目录使用，它归根结底就只有一个根目录，一个独立且唯一的文件结构。\n Linux中每个分区都是用来组成整个文件系统的一部分，因为它采用了一种叫“挂载点”的处理方法，它的整个文件系统中包含了一整套的文件和目录，\n 且将一个分区和一个目录联系起来。这时要载入的一个分区将使它的存储空间在一个目录下获得。\n \n \n 1、 fdisk -l 查看块设备情况（块设备包括硬盘，U盘，SD卡） \n</code></pre>\n<h1 id=\"格式化分区\"><a href=\"#格式化分区\" class=\"headerlink\" title=\"格式化分区\"></a>格式化分区</h1><pre><code>虚拟文件系统(VFS) 操作模型，通过mkfs.xxx等这种系列性的命令创建格式化很多不同的文件系统，\n比如：mkfs.ext4 /dev/sda 、 mkfs.btrfs /dev/sdb等,但这些不同的文件系统都有各自的API接口，而用户想要的是，不管你是什么API，\n他们只关心mount/umount，或open/close等操作，等于屏蔽了底层的文件系统类型，运维层面只关心mount等操作即可。不同的文件系统类型有不同的特点，\n因而根据存储设备的硬件特性、系统需求等有不同的应用场合,什么意思呢，也就是说假如你用了不同设备都是硬盘，那么建立这个硬盘可以用不同的文件系统来做映射，\n可能就会获得不同的性能提升。还是要看相关的设备种类和厂商设计的目的。\n\n\n文件系统    描 述\nExt    Linux 中最早的文件系统，由于在性能和兼容性上具有很多缺陷，现在已经很少使用,是为 Linux 核心所做的第一个文件系统，最大可支持 2GB 的文件系统。\n\nExt2    是 Ext 文件系统的升级版本，Red Hat Linux 7.2 版本以前的系统默认都是 Ext2 文件系统。于 1993 年发布，\n        支持最大 16TB 的分区和最大 2TB 的文件（1TB=1024GB=1024x1024KB)\n        Linux正统的文件系统(如ext2、ext3)一个文件由目录项、inode和数据块组成。\n        目录项:包括文件名和inode节点号。\n        Inode：又称文件索引节点，是文件基本信息的存放地和数据块指针存放地。\n        数据块：文件的具体内容存放地。\n        将硬盘分区时会划分出目录块、inode Table区块和data block数据区域。一个文件由一个目录项、inode和数据区域块组成。\n        Inode包含文件的属性(如读写属性、owner等，以及指向数据块的指针)，数据区域块则是文件内容。\n        当查看某个文件时，会先从inode table中查出文件属性及数据存放点，再从数据块中读取数据\n\nExt3    是 Ext2 文件系统的升级版本，最大的区别就是带日志功能，以便在系统突然停止时提高文件系统的可靠性。支持最大 16TB 的分区和最大 2TB 的文件\n\nExt4    是 Ext3 文件系统的升级版。Ext4 在性能、伸缩性和可靠性方面进行了大量改进。Ext4 的变化可以说是翻天覆地的，\n        比如向下兼容 Ext3、最大 1EB 文件系统和 16TB 文件、无限数量子目录、Extents 连续数据块 概念、多块分配、延迟分配、\n        持久预分配、快速 FSCK、日志校验、无日志模式、在线碎片整理、inode 增强、\n        默认启用 barrier 等。它是 CentOS 6.3 的默认文件系统\n        \n        \nxfs        被业界称为最先进、最具有可升级性的文件系统技术，由 SGI 公司设计，目前最新的 CentOS 7 版本默认使用的就是此文件系统。\n\nswap    swap 是 Linux 中用于交换分区的文件系统（类似于 Windows 中的虚拟内存)，\n当内存不够用时，使用交换分区暂时替代内存。一般大小为内存的 2 倍，但是不要超过 2GB。它是 Linux 的必需分区\n\nNFS    NFS 是网络文件系统（Network File System）的缩写，是用来实现不同主机之间文件共享的一种网络服务，本地主机可以通过挂载的方式使用远程共享的资源\niso9660    光盘的标准文件系统。Linux 要想使用光盘，必须支持 iso9660 文件系统\n\nfat    就是 Windows 下的 fatl6 文件系统，在 Linux 中识别为 fat\n\nvfat    就是 Windows 下的 fat32 文件系统，在 Linux 中识别为 vfat。支持最大 32GB 的分区和最大 4GB 的文件\n</code></pre>\n<p><font color='red'>VFAT 是一种早期的文件系统，通常用于与 Windows 系统兼容的可移动设备。由于 VFAT 文件系统不支持类似 UNIX 文件系统的权限和所有权概念，<br>因此在挂载后无法执行 chown 命令来更改文件和目录的所有者。</font></p>\n<pre><code>NTFS    就是 Windows 下的 NTFS 文件系统，不过 Linux 默认是不能识别 NTFS 文件系统的，如果需要识别，则需要重新编译内核才能支持。\n        它比 fat32 文件系统更加安全，速度更快，支持最大 2TB 的分区和最大 64GB 的文件\nufs    Sun 公司的操作系统 Solaris 和 SunOS 所采用的文件系统\n\nproc    Linux 中基于内存的虚拟文件系统，用来管理内存存储目录 /proc\n\nsysfs    和 proc —样，也是基于内存的虚拟文件系统，用来管理内存存储目录 /sysfs\n\ntmpfs    也是一种基于内存的虚拟文件系统，不过也可以使用 swap 交换分区\n\n现在一般是Ext4 xfs格式\n</code></pre>\n<h1 id=\"分区工具\"><a href=\"#分区工具\" class=\"headerlink\" title=\"分区工具\"></a>分区工具</h1><pre><code>fdisk命令可以用于对2TB以内的磁盘进行添加、删除、转换分区的功能,用户可以根据实际情况进行合理划分。\n\n\nparted -l命令\n\nparted一款功能强大的磁盘分区和分区大小调整工具。\n\nparted -l同fdisk -l命令类似，但是它可以识别2TB以上的硬盘，也能查看 GPT 磁盘的分区\n</code></pre>\n<p>#具体操作  </p>\n<h2 id=\"基本命令介绍\"><a href=\"#基本命令介绍\" class=\"headerlink\" title=\"基本命令介绍\"></a>基本命令介绍</h2><pre><code>df -h\n      查看分区情况 相对比较直观\n      \nfdisk -l\n      查看系统有几块硬盘  分标有多大  分了那几个区\n      \n      \nlsblk\nlsblk -f  \n查看分区信息  -f更详细\n令可以列出所有可用块设备的信息,而且还能显示他们之间的依赖关系，但是它不会列出RAM盘的信息。块设备有硬盘,闪存盘,CD-ROM等等\n\n用 blkid  获取磁盘的uuid和属性\n</code></pre>\n<h2 id=\"详细操作\"><a href=\"#详细操作\" class=\"headerlink\" title=\"详细操作\"></a>详细操作</h2><pre><code>分区\n1.fdisk   盘符    示例：fidisk /dev/sdb\n\n2.输入n 是创建分区（一般下面多是默认）\n\n3.然后选择分区类型\n                p   primary(主分区)\n                e   extende（扩展）\n                \n4.设置分区号（一般默认）  \n              \n\n5.然后设置     起始扇区\n              结束扇区  \n                \n6.设置完 输入w    保存     \n\n7.特殊操作需要删除分区 输入d 然后选择分区号                   \n\n\n格式化  \n        mkfs -t ext3 /dev/sdb2\n        mkfs -t ext4 /dev/sdb2 \n        mkfs.xfs -f /dev/sdb2\n        \n        \n查看分区信息       \nlsblk\nlsblk -f  更详细\n\n\n用 blkid  获取磁盘的uuid和属性\n\nvim /etc/fstab\n\n\n配置模板：UUID=*************  挂载路径  格式  defaults  1  1 \n示例   UUID=b2cc970b-7cf4-453e-b3f5-916497b9530e  /apps  xfs  defaults  1  1 \n</code></pre>\n","site":{"data":{}},"length":4345,"excerpt":"","more":"<h1 id=\"一、-硬盘分区基础知识\"><a href=\"#一、-硬盘分区基础知识\" class=\"headerlink\" title=\"一、 硬盘分区基础知识\"></a>一、 硬盘分区基础知识</h1><pre><code>磁盘分区类型：硬盘分区最常见的类型为msdos和gpt，\n前者表示MBR分区，而后者表示GPT分区。传统的BIOS只支持MBR分区硬盘启动，\n一个硬盘只能分成四个分区，并且单个分区最大不超过2TB。\nGPT(即GUID分区表)是源自EFI标准的一种较新的磁盘分区表结构的标准，是未来磁盘分区的主要形式。\n与MBR分区方式相比，突破MBR4个主分区限制，每个磁盘最多支持128个分区，持大于2T的分区，最大卷可达18EB。\n1、MBR分区：\nMBR的意思是“主引导记录”，它有自己的启动器，也就是启动代码，\n一旦启动代码被破坏，系统就没法启动，只有通过修复才能启动系统。最大支持2TB容量（T; terabytes,1TB=1024GB），\n对分区的设限：最多4个主分区或3个主分区加一个扩展分区。创建工具典型有fdisk。\n\n2、GPT分区：GPT意为GUID分区表，这是一个正逐渐取代MBR的新标准，它由UEFI辅住而形成的，\n这样就有了UEFI用于取代老旧的BIOS，而GPT则取代老旧的MBR。这个标准没有MBR的那些限制比如：容量2T限制、分区个数限制等。磁盘驱动器容量可以大得多，\n大到操作系统和文件系统都没法支持。它同时还支持几乎无限个分区数量，限制只在于操作系统，Windows支持最多128个GPT分区。GPT和MBR是不同的分区表类型。\n使用MBR分区表的硬盘最多只能划分4个主分区磁盘，并且MBR最大仅支持2TB的硬盘。如果需要分区的硬盘容量超过2TB了，则需要使用GPT分区表类型，\n此分区表类型不受分区个数、硬盘大小的限制。创建GPT分区典型工具有parted,gdisk,sgdisk等,fdisk不支持创建GPT分区。\n我们管理的服务器可能会随着业务量的不断增长而造成磁盘数据空间不足的情况（不考虑inode），这个时候我们就可能需要增加磁盘或挂载一些其他的块设备，\n这里我主要介绍如何使用fdisk分区工具创建磁盘分区和挂载分区。最重要的三步就是：\n1、创建主分区。（主分区创建之后可以马上被使用但不能再分区）\n2、创建扩展分区 (扩展分区必须再进行二次分区后才能被使用)\n3、在扩展分区上创建逻辑分区（扩充分区再分下去的是什么呢？它就是逻辑分区（Logical Partion））\nLinux下单个磁盘最多可以有15个分区。3个主分区 + 1个扩展分区 + 11个逻辑分区。\n建议的分区方法是：先分3个主分区，第四个分区为扩展分区，然后在扩展分区中再分成11个逻辑分区。\n在unix/linux系统中，一切都是文件。\n所有硬盘、软盘、键盘等设备都用文件来代表，对应 着/dev下面的文件。\n对于应用程序来说，可以像对待普通文件一样打开，关闭、读写这些设备文件。\n但是这种文件名，比如/dev/sda、/dev /raw/raw1都是用户空间名称，\nOS Kernel根本不知道这个名称指的是什么。在内核空间是通过major、minor device number 来区分设备的\n\n块设备也是通过/dev目录下的文件系统节点来访问。块设备上能够容纳文件系统。\n常见的块设备如磁盘、emmc flash、nand flash、 SD卡等。\n\n在linux系统中/dev目录下使用ls -l命令查看详细信息，第一个字母“b”为块设备文件的标识。/dev下每个块设备文件对应一个磁盘的分区。\n</code></pre>\n<h1 id=\"二、创建分区\"><a href=\"#二、创建分区\" class=\"headerlink\" title=\"二、创建分区\"></a>二、创建分区</h1><pre><code>虽然支持mbr的硬盘（容量小于等于2T）分区表中最多能存储四个分区，但我们实际使用时一般只分为两个分区，\n一个是主分区（Primary Partion）一个是扩展分区(extended partition)两种，主分区可以马上被使用但不能再分区，\n扩展分区必须再进行分区后才能使用，也就是说它必须还要进行二次分区。那么由扩充分区再分下去的是什么呢？它就是逻辑分区（Logical Partion）。 \n对习惯于使用Dos或Windows的朋友来说，有几个分区就有几个驱动器，并且每个分区都会获得一个字母标识符，然后就可以选用这个字母来指定在这个分区上的文件和目录，\n它们的文件结构都是独立的，非常好理解。 \n因为对Linux用户来说无论有几个分区，分给哪一目录使用，它归根结底就只有一个根目录，一个独立且唯一的文件结构。\n Linux中每个分区都是用来组成整个文件系统的一部分，因为它采用了一种叫“挂载点”的处理方法，它的整个文件系统中包含了一整套的文件和目录，\n 且将一个分区和一个目录联系起来。这时要载入的一个分区将使它的存储空间在一个目录下获得。\n \n \n 1、 fdisk -l 查看块设备情况（块设备包括硬盘，U盘，SD卡） \n</code></pre>\n<h1 id=\"格式化分区\"><a href=\"#格式化分区\" class=\"headerlink\" title=\"格式化分区\"></a>格式化分区</h1><pre><code>虚拟文件系统(VFS) 操作模型，通过mkfs.xxx等这种系列性的命令创建格式化很多不同的文件系统，\n比如：mkfs.ext4 /dev/sda 、 mkfs.btrfs /dev/sdb等,但这些不同的文件系统都有各自的API接口，而用户想要的是，不管你是什么API，\n他们只关心mount/umount，或open/close等操作，等于屏蔽了底层的文件系统类型，运维层面只关心mount等操作即可。不同的文件系统类型有不同的特点，\n因而根据存储设备的硬件特性、系统需求等有不同的应用场合,什么意思呢，也就是说假如你用了不同设备都是硬盘，那么建立这个硬盘可以用不同的文件系统来做映射，\n可能就会获得不同的性能提升。还是要看相关的设备种类和厂商设计的目的。\n\n\n文件系统    描 述\nExt    Linux 中最早的文件系统，由于在性能和兼容性上具有很多缺陷，现在已经很少使用,是为 Linux 核心所做的第一个文件系统，最大可支持 2GB 的文件系统。\n\nExt2    是 Ext 文件系统的升级版本，Red Hat Linux 7.2 版本以前的系统默认都是 Ext2 文件系统。于 1993 年发布，\n        支持最大 16TB 的分区和最大 2TB 的文件（1TB=1024GB=1024x1024KB)\n        Linux正统的文件系统(如ext2、ext3)一个文件由目录项、inode和数据块组成。\n        目录项:包括文件名和inode节点号。\n        Inode：又称文件索引节点，是文件基本信息的存放地和数据块指针存放地。\n        数据块：文件的具体内容存放地。\n        将硬盘分区时会划分出目录块、inode Table区块和data block数据区域。一个文件由一个目录项、inode和数据区域块组成。\n        Inode包含文件的属性(如读写属性、owner等，以及指向数据块的指针)，数据区域块则是文件内容。\n        当查看某个文件时，会先从inode table中查出文件属性及数据存放点，再从数据块中读取数据\n\nExt3    是 Ext2 文件系统的升级版本，最大的区别就是带日志功能，以便在系统突然停止时提高文件系统的可靠性。支持最大 16TB 的分区和最大 2TB 的文件\n\nExt4    是 Ext3 文件系统的升级版。Ext4 在性能、伸缩性和可靠性方面进行了大量改进。Ext4 的变化可以说是翻天覆地的，\n        比如向下兼容 Ext3、最大 1EB 文件系统和 16TB 文件、无限数量子目录、Extents 连续数据块 概念、多块分配、延迟分配、\n        持久预分配、快速 FSCK、日志校验、无日志模式、在线碎片整理、inode 增强、\n        默认启用 barrier 等。它是 CentOS 6.3 的默认文件系统\n        \n        \nxfs        被业界称为最先进、最具有可升级性的文件系统技术，由 SGI 公司设计，目前最新的 CentOS 7 版本默认使用的就是此文件系统。\n\nswap    swap 是 Linux 中用于交换分区的文件系统（类似于 Windows 中的虚拟内存)，\n当内存不够用时，使用交换分区暂时替代内存。一般大小为内存的 2 倍，但是不要超过 2GB。它是 Linux 的必需分区\n\nNFS    NFS 是网络文件系统（Network File System）的缩写，是用来实现不同主机之间文件共享的一种网络服务，本地主机可以通过挂载的方式使用远程共享的资源\niso9660    光盘的标准文件系统。Linux 要想使用光盘，必须支持 iso9660 文件系统\n\nfat    就是 Windows 下的 fatl6 文件系统，在 Linux 中识别为 fat\n\nvfat    就是 Windows 下的 fat32 文件系统，在 Linux 中识别为 vfat。支持最大 32GB 的分区和最大 4GB 的文件\n</code></pre>\n<p><font color='red'>VFAT 是一种早期的文件系统，通常用于与 Windows 系统兼容的可移动设备。由于 VFAT 文件系统不支持类似 UNIX 文件系统的权限和所有权概念，<br>因此在挂载后无法执行 chown 命令来更改文件和目录的所有者。</font></p>\n<pre><code>NTFS    就是 Windows 下的 NTFS 文件系统，不过 Linux 默认是不能识别 NTFS 文件系统的，如果需要识别，则需要重新编译内核才能支持。\n        它比 fat32 文件系统更加安全，速度更快，支持最大 2TB 的分区和最大 64GB 的文件\nufs    Sun 公司的操作系统 Solaris 和 SunOS 所采用的文件系统\n\nproc    Linux 中基于内存的虚拟文件系统，用来管理内存存储目录 /proc\n\nsysfs    和 proc —样，也是基于内存的虚拟文件系统，用来管理内存存储目录 /sysfs\n\ntmpfs    也是一种基于内存的虚拟文件系统，不过也可以使用 swap 交换分区\n\n现在一般是Ext4 xfs格式\n</code></pre>\n<h1 id=\"分区工具\"><a href=\"#分区工具\" class=\"headerlink\" title=\"分区工具\"></a>分区工具</h1><pre><code>fdisk命令可以用于对2TB以内的磁盘进行添加、删除、转换分区的功能,用户可以根据实际情况进行合理划分。\n\n\nparted -l命令\n\nparted一款功能强大的磁盘分区和分区大小调整工具。\n\nparted -l同fdisk -l命令类似，但是它可以识别2TB以上的硬盘，也能查看 GPT 磁盘的分区\n</code></pre>\n<p>#具体操作  </p>\n<h2 id=\"基本命令介绍\"><a href=\"#基本命令介绍\" class=\"headerlink\" title=\"基本命令介绍\"></a>基本命令介绍</h2><pre><code>df -h\n      查看分区情况 相对比较直观\n      \nfdisk -l\n      查看系统有几块硬盘  分标有多大  分了那几个区\n      \n      \nlsblk\nlsblk -f  \n查看分区信息  -f更详细\n令可以列出所有可用块设备的信息,而且还能显示他们之间的依赖关系，但是它不会列出RAM盘的信息。块设备有硬盘,闪存盘,CD-ROM等等\n\n用 blkid  获取磁盘的uuid和属性\n</code></pre>\n<h2 id=\"详细操作\"><a href=\"#详细操作\" class=\"headerlink\" title=\"详细操作\"></a>详细操作</h2><pre><code>分区\n1.fdisk   盘符    示例：fidisk /dev/sdb\n\n2.输入n 是创建分区（一般下面多是默认）\n\n3.然后选择分区类型\n                p   primary(主分区)\n                e   extende（扩展）\n                \n4.设置分区号（一般默认）  \n              \n\n5.然后设置     起始扇区\n              结束扇区  \n                \n6.设置完 输入w    保存     \n\n7.特殊操作需要删除分区 输入d 然后选择分区号                   \n\n\n格式化  \n        mkfs -t ext3 /dev/sdb2\n        mkfs -t ext4 /dev/sdb2 \n        mkfs.xfs -f /dev/sdb2\n        \n        \n查看分区信息       \nlsblk\nlsblk -f  更详细\n\n\n用 blkid  获取磁盘的uuid和属性\n\nvim /etc/fstab\n\n\n配置模板：UUID=*************  挂载路径  格式  defaults  1  1 \n示例   UUID=b2cc970b-7cf4-453e-b3f5-916497b9530e  /apps  xfs  defaults  1  1 \n</code></pre>\n"},{"title":"linux-编译安装软件总结","abbrlink":"1b78fbfa","date":"2024-03-06T07:41:02.000Z","_content":"\n\n# make 很慢\n\nmake -j4   表示同时运行4个编译任务\n\n编译任务数  一般情况是cpu 核心的一半\n\n\n\n# make遇到语法错误\n\n大概率是gcc 版本高了或者低了\n\n安装示例\n\n    wget https://mirrors.tuna.tsinghua.edu.cn/gnu/gcc/gcc-8.2.0/gcc-8.2.0.tar.gz\n    tar -zxvf gcc-8.2.0.tar.gz\n    ./contrib/download_prerequisites\n    mkdir build\n    cd bulid\n    ../configure --prefix=/usr/local/gcc-8.2.0 --enable-bootstrap --enable-checking=release --enable-languages=c,c++ --disable-multilib\n    make \n    make install\n    echo -e '\\nexport PATH=/usr/local/gcc-8.2.0/bin:$PATH\\n' >> /etc/profile.d/gcc.sh && source /etc/profile.d/gcc.sh\n    ln -sv /usr/local/gcc-8.2.0/include/ /usr/include/gcc\n    ldconfig -v\n    ldconfig -p |grep gcc\n    gcc -v","source":"_posts/linux-编译安装软件总结.md","raw":"---\ntitle: linux-编译安装软件总结\nabbrlink: 1b78fbfa\ndate: 2024-03-06 15:41:02\ntags:\n - linux \n---\n\n\n# make 很慢\n\nmake -j4   表示同时运行4个编译任务\n\n编译任务数  一般情况是cpu 核心的一半\n\n\n\n# make遇到语法错误\n\n大概率是gcc 版本高了或者低了\n\n安装示例\n\n    wget https://mirrors.tuna.tsinghua.edu.cn/gnu/gcc/gcc-8.2.0/gcc-8.2.0.tar.gz\n    tar -zxvf gcc-8.2.0.tar.gz\n    ./contrib/download_prerequisites\n    mkdir build\n    cd bulid\n    ../configure --prefix=/usr/local/gcc-8.2.0 --enable-bootstrap --enable-checking=release --enable-languages=c,c++ --disable-multilib\n    make \n    make install\n    echo -e '\\nexport PATH=/usr/local/gcc-8.2.0/bin:$PATH\\n' >> /etc/profile.d/gcc.sh && source /etc/profile.d/gcc.sh\n    ln -sv /usr/local/gcc-8.2.0/include/ /usr/include/gcc\n    ldconfig -v\n    ldconfig -p |grep gcc\n    gcc -v","slug":"linux-编译安装软件总结","published":1,"updated":"2024-11-25T11:20:10.932Z","_id":"cm04ukh7d000t4koc2xgy7u4z","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"make-很慢\"><a href=\"#make-很慢\" class=\"headerlink\" title=\"make 很慢\"></a>make 很慢</h1><p>make -j4   表示同时运行4个编译任务</p>\n<p>编译任务数  一般情况是cpu 核心的一半</p>\n<h1 id=\"make遇到语法错误\"><a href=\"#make遇到语法错误\" class=\"headerlink\" title=\"make遇到语法错误\"></a>make遇到语法错误</h1><p>大概率是gcc 版本高了或者低了</p>\n<p>安装示例</p>\n<pre><code>wget https://mirrors.tuna.tsinghua.edu.cn/gnu/gcc/gcc-8.2.0/gcc-8.2.0.tar.gz\ntar -zxvf gcc-8.2.0.tar.gz\n./contrib/download_prerequisites\nmkdir build\ncd bulid\n../configure --prefix=/usr/local/gcc-8.2.0 --enable-bootstrap --enable-checking=release --enable-languages=c,c++ --disable-multilib\nmake \nmake install\necho -e &#39;\\nexport PATH=/usr/local/gcc-8.2.0/bin:$PATH\\n&#39; &gt;&gt; /etc/profile.d/gcc.sh &amp;&amp; source /etc/profile.d/gcc.sh\nln -sv /usr/local/gcc-8.2.0/include/ /usr/include/gcc\nldconfig -v\nldconfig -p |grep gcc\ngcc -v\n</code></pre>\n","site":{"data":{}},"length":571,"excerpt":"","more":"<h1 id=\"make-很慢\"><a href=\"#make-很慢\" class=\"headerlink\" title=\"make 很慢\"></a>make 很慢</h1><p>make -j4   表示同时运行4个编译任务</p>\n<p>编译任务数  一般情况是cpu 核心的一半</p>\n<h1 id=\"make遇到语法错误\"><a href=\"#make遇到语法错误\" class=\"headerlink\" title=\"make遇到语法错误\"></a>make遇到语法错误</h1><p>大概率是gcc 版本高了或者低了</p>\n<p>安装示例</p>\n<pre><code>wget https://mirrors.tuna.tsinghua.edu.cn/gnu/gcc/gcc-8.2.0/gcc-8.2.0.tar.gz\ntar -zxvf gcc-8.2.0.tar.gz\n./contrib/download_prerequisites\nmkdir build\ncd bulid\n../configure --prefix=/usr/local/gcc-8.2.0 --enable-bootstrap --enable-checking=release --enable-languages=c,c++ --disable-multilib\nmake \nmake install\necho -e &#39;\\nexport PATH=/usr/local/gcc-8.2.0/bin:$PATH\\n&#39; &gt;&gt; /etc/profile.d/gcc.sh &amp;&amp; source /etc/profile.d/gcc.sh\nln -sv /usr/local/gcc-8.2.0/include/ /usr/include/gcc\nldconfig -v\nldconfig -p |grep gcc\ngcc -v\n</code></pre>\n"},{"title":"linux配置代理","abbrlink":"42347bce","date":"2024-03-01T09:29:34.000Z","_content":"\n#设置wget\n\n\n编辑文件为：/etc/wgetrc[全局配置文件]  ~/.wgetrc[用户配置文件] 添加下面两行：\n\nhttp_proxy=http://111.112.113.114:8080\nhttps_proxy=http://111.112.113.114:8080\n\n更新一下环境文件：\nsource /etc/wgetrc\n\n\n\n","source":"_posts/linux-配置代理.md","raw":"---\ntitle: linux配置代理\nabbrlink: 42347bce\ndate: 2024-03-01 17:29:34\ntags:\n - linux\ncategories:\n  - 服务器相关  \n---\n\n#设置wget\n\n\n编辑文件为：/etc/wgetrc[全局配置文件]  ~/.wgetrc[用户配置文件] 添加下面两行：\n\nhttp_proxy=http://111.112.113.114:8080\nhttps_proxy=http://111.112.113.114:8080\n\n更新一下环境文件：\nsource /etc/wgetrc\n\n\n\n","slug":"linux-配置代理","published":1,"updated":"2024-11-25T11:20:15.492Z","_id":"cm04ukh7f000u4koc3hvt3qa6","comments":1,"layout":"post","photos":[],"link":"","content":"<p>#设置wget</p>\n<p>编辑文件为：/etc/wgetrc[全局配置文件]  ~/.wgetrc[用户配置文件] 添加下面两行：</p>\n<p>http_proxy=<a href=\"http://111.112.113.114:8080/\">http://111.112.113.114:8080</a><br>https_proxy=<a href=\"http://111.112.113.114:8080/\">http://111.112.113.114:8080</a></p>\n<p>更新一下环境文件：<br>source /etc/wgetrc</p>\n","site":{"data":{}},"length":159,"excerpt":"","more":"<p>#设置wget</p>\n<p>编辑文件为：/etc/wgetrc[全局配置文件]  ~/.wgetrc[用户配置文件] 添加下面两行：</p>\n<p>http_proxy=<a href=\"http://111.112.113.114:8080/\">http://111.112.113.114:8080</a><br>https_proxy=<a href=\"http://111.112.113.114:8080/\">http://111.112.113.114:8080</a></p>\n<p>更新一下环境文件：<br>source /etc/wgetrc</p>\n"},{"title":"mysql的常用应用","abbrlink":"c8d81a10","date":"2023-10-17T02:12:16.000Z","_content":"\n\n#mysql忘记密码,重置密码\n\n\n1.修改my.cnf\n\n添加\n\n    --skip-grant-tables\n\n2.进入数据\n\n    执行\n    use mysql;\n    mysql> update user set password=password('123') where user='root' and host='localhost';\n    mysql> flush privileges;\n\n\n\n#mysql导出、导入数据命令\n\n导出\nmysqldump -u <用户名> -p<密码> <数据库名> > <输出文件路径>\n\n示例\n\n     mysqldump  -u root -p wastewater.iguanwei.com >bak.sql\n\n\n导入\n\n    方法一：\n    mysql -u用户名 -p 数据库名 < 123.sql\n    示例：\n        mysql -u root -p book < 123.sql\n    方法二：\n    登录mysql\n    source 123.sql;\n\n\n\n# mysql修改root权限/修改密码/远程访问\n\n    GRANT ALL PRIVILEGES ON *.* TO 'root'@'%'IDENTIFIED BY 'Storage@202312' WITH GRANT OPTION;\n\n\n#","source":"_posts/mysql-常用命令应用.md","raw":"---\ntitle: mysql的常用应用\nabbrlink: c8d81a10\ndate: 2023-10-17 10:12:16\ntags:\n - mysql\n---\n\n\n#mysql忘记密码,重置密码\n\n\n1.修改my.cnf\n\n添加\n\n    --skip-grant-tables\n\n2.进入数据\n\n    执行\n    use mysql;\n    mysql> update user set password=password('123') where user='root' and host='localhost';\n    mysql> flush privileges;\n\n\n\n#mysql导出、导入数据命令\n\n导出\nmysqldump -u <用户名> -p<密码> <数据库名> > <输出文件路径>\n\n示例\n\n     mysqldump  -u root -p wastewater.iguanwei.com >bak.sql\n\n\n导入\n\n    方法一：\n    mysql -u用户名 -p 数据库名 < 123.sql\n    示例：\n        mysql -u root -p book < 123.sql\n    方法二：\n    登录mysql\n    source 123.sql;\n\n\n\n# mysql修改root权限/修改密码/远程访问\n\n    GRANT ALL PRIVILEGES ON *.* TO 'root'@'%'IDENTIFIED BY 'Storage@202312' WITH GRANT OPTION;\n\n\n#","slug":"mysql-常用命令应用","published":1,"updated":"2024-11-25T11:20:54.052Z","_id":"cm04ukh7h000x4kocax7a0sja","comments":1,"layout":"post","photos":[],"link":"","content":"<p>#mysql忘记密码,重置密码</p>\n<p>1.修改my.cnf</p>\n<p>添加</p>\n<pre><code>--skip-grant-tables\n</code></pre>\n<p>2.进入数据</p>\n<pre><code>执行\nuse mysql;\nmysql&gt; update user set password=password(&#39;123&#39;) where user=&#39;root&#39; and host=&#39;localhost&#39;;\nmysql&gt; flush privileges;\n</code></pre>\n<p>#mysql导出、导入数据命令</p>\n<p>导出<br>mysqldump -u &lt;用户名&gt; -p&lt;密码&gt; &lt;数据库名&gt; &gt; &lt;输出文件路径&gt;</p>\n<p>示例</p>\n<pre><code> mysqldump  -u root -p wastewater.iguanwei.com &gt;bak.sql\n</code></pre>\n<p>导入</p>\n<pre><code>方法一：\nmysql -u用户名 -p 数据库名 &lt; 123.sql\n示例：\n    mysql -u root -p book &lt; 123.sql\n方法二：\n登录mysql\nsource 123.sql;\n</code></pre>\n<h1 id=\"mysql修改root权限-修改密码-远程访问\"><a href=\"#mysql修改root权限-修改密码-远程访问\" class=\"headerlink\" title=\"mysql修改root权限/修改密码/远程访问\"></a>mysql修改root权限/修改密码/远程访问</h1><pre><code>GRANT ALL PRIVILEGES ON *.* TO &#39;root&#39;@&#39;%&#39;IDENTIFIED BY &#39;Storage@202312&#39; WITH GRANT OPTION;\n</code></pre>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>","site":{"data":{}},"length":543,"excerpt":"","more":"<p>#mysql忘记密码,重置密码</p>\n<p>1.修改my.cnf</p>\n<p>添加</p>\n<pre><code>--skip-grant-tables\n</code></pre>\n<p>2.进入数据</p>\n<pre><code>执行\nuse mysql;\nmysql&gt; update user set password=password(&#39;123&#39;) where user=&#39;root&#39; and host=&#39;localhost&#39;;\nmysql&gt; flush privileges;\n</code></pre>\n<p>#mysql导出、导入数据命令</p>\n<p>导出<br>mysqldump -u &lt;用户名&gt; -p&lt;密码&gt; &lt;数据库名&gt; &gt; &lt;输出文件路径&gt;</p>\n<p>示例</p>\n<pre><code> mysqldump  -u root -p wastewater.iguanwei.com &gt;bak.sql\n</code></pre>\n<p>导入</p>\n<pre><code>方法一：\nmysql -u用户名 -p 数据库名 &lt; 123.sql\n示例：\n    mysql -u root -p book &lt; 123.sql\n方法二：\n登录mysql\nsource 123.sql;\n</code></pre>\n<h1 id=\"mysql修改root权限-修改密码-远程访问\"><a href=\"#mysql修改root权限-修改密码-远程访问\" class=\"headerlink\" title=\"mysql修改root权限/修改密码/远程访问\"></a>mysql修改root权限/修改密码/远程访问</h1><pre><code>GRANT ALL PRIVILEGES ON *.* TO &#39;root&#39;@&#39;%&#39;IDENTIFIED BY &#39;Storage@202312&#39; WITH GRANT OPTION;\n</code></pre>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>"},{"title":"nginx-vhost-安全配置模版","abbrlink":"8a9d1567","date":"2023-07-13T11:11:30.000Z","_content":"#nginx-vhost-安全配置模版\n\n    server{\n            listen 443 ssl ;\n            server_name  [域名或者ip];\n            index        index.php index.html index.htm;\n            root [项目路径];\n            access_log  /var/log/nginx/[项目名称].access.log;\n            error_log   /var/log/nginx/[项目名称].error.log;\n    \n            #证书文件名称\n            ssl_certificate [证书路径 公钥];\n            #私钥文件名称\n            ssl_certificate_key [证书路径 私钥];\n            ssl_session_timeout 5m;\n            #请按照以下协议配置\n            ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n            #请按照以下套件配置，配置加密套件，写法遵循 openssl 标准。\n            ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;\n            ssl_prefer_server_ciphers on\n    \n    \n            #允许cookie\n            add_header 'Access-Control-Allow-Credentials' 'true';\n            #安全头\n            add_header X-Xss-header \"1;mode=block\";\n            add_header Set-Cookie \"HttpOnly\";\n            add_header Set-Cookie \"Secure\";\n            add_header X-Frame-Options \"SAMEORIGIN\";\n    \n            location ~ \\.(json|lock|git)$ {\n                     deny all;\n            }\n            location ~ ^/(uploads|assets)/.*\\.(php|php5|jsp|shtml)$ {\n                deny all;\n            }\n            location ~ .*\\.(txt|doc|pdf|rar|gz|zip|docx|exe|xlsx|ppt|pptx)$ {\n                add_header Content-Disposition attachment;\n            }\n            location =/assets/libs/bootstrap/Gemfile {\n                           return 404;\n            }\n            location ~ /\\. {\n                deny  all;\n            }\n    \n            location / {\n                    proxy_cookie_path / \"/; httponly; secure; SameSite=None\";\n                    if (!-e $request_filename) {\n                            rewrite  ^(.*)$  /index.php?s=/$1  last;\n                            break;\n                    }\n    \n            }\n    \n            location ~ \\.php(.*)$ {\n                    fastcgi_pass   [访问php方式];\n                    fastcgi_index  index.php;\n                    fastcgi_split_path_info  ^((?U).+\\.php)(/?.+)$;\n                    fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n                    fastcgi_param  PATH_INFO  $fastcgi_path_info;\n                    fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;\n                    include        fastcgi_params;\n            }\n    \n            #timeout\n            large_client_header_buffers 4 16k;\n            client_max_body_size 180m;\n            client_body_buffer_size 128k;\n            fastcgi_connect_timeout 600;\n            fastcgi_read_timeout 600;\n            fastcgi_send_timeout 600;\n            fastcgi_buffer_size 128k;\n            fastcgi_buffers   2 256k;\n            fastcgi_busy_buffers_size 256k;\n            fastcgi_temp_file_write_size 256k;\n            proxy_read_timeout  240s;\n    }","source":"_posts/nginx-vhost安全配置模版.md","raw":"---\ntitle: nginx-vhost-安全配置模版\nabbrlink: 8a9d1567\ncategories:\n  - 服务器相关\n  - nginx\ndate: 2023-07-13 19:11:30\ntags:\n---\n#nginx-vhost-安全配置模版\n\n    server{\n            listen 443 ssl ;\n            server_name  [域名或者ip];\n            index        index.php index.html index.htm;\n            root [项目路径];\n            access_log  /var/log/nginx/[项目名称].access.log;\n            error_log   /var/log/nginx/[项目名称].error.log;\n    \n            #证书文件名称\n            ssl_certificate [证书路径 公钥];\n            #私钥文件名称\n            ssl_certificate_key [证书路径 私钥];\n            ssl_session_timeout 5m;\n            #请按照以下协议配置\n            ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n            #请按照以下套件配置，配置加密套件，写法遵循 openssl 标准。\n            ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;\n            ssl_prefer_server_ciphers on\n    \n    \n            #允许cookie\n            add_header 'Access-Control-Allow-Credentials' 'true';\n            #安全头\n            add_header X-Xss-header \"1;mode=block\";\n            add_header Set-Cookie \"HttpOnly\";\n            add_header Set-Cookie \"Secure\";\n            add_header X-Frame-Options \"SAMEORIGIN\";\n    \n            location ~ \\.(json|lock|git)$ {\n                     deny all;\n            }\n            location ~ ^/(uploads|assets)/.*\\.(php|php5|jsp|shtml)$ {\n                deny all;\n            }\n            location ~ .*\\.(txt|doc|pdf|rar|gz|zip|docx|exe|xlsx|ppt|pptx)$ {\n                add_header Content-Disposition attachment;\n            }\n            location =/assets/libs/bootstrap/Gemfile {\n                           return 404;\n            }\n            location ~ /\\. {\n                deny  all;\n            }\n    \n            location / {\n                    proxy_cookie_path / \"/; httponly; secure; SameSite=None\";\n                    if (!-e $request_filename) {\n                            rewrite  ^(.*)$  /index.php?s=/$1  last;\n                            break;\n                    }\n    \n            }\n    \n            location ~ \\.php(.*)$ {\n                    fastcgi_pass   [访问php方式];\n                    fastcgi_index  index.php;\n                    fastcgi_split_path_info  ^((?U).+\\.php)(/?.+)$;\n                    fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n                    fastcgi_param  PATH_INFO  $fastcgi_path_info;\n                    fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;\n                    include        fastcgi_params;\n            }\n    \n            #timeout\n            large_client_header_buffers 4 16k;\n            client_max_body_size 180m;\n            client_body_buffer_size 128k;\n            fastcgi_connect_timeout 600;\n            fastcgi_read_timeout 600;\n            fastcgi_send_timeout 600;\n            fastcgi_buffer_size 128k;\n            fastcgi_buffers   2 256k;\n            fastcgi_busy_buffers_size 256k;\n            fastcgi_temp_file_write_size 256k;\n            proxy_read_timeout  240s;\n    }","slug":"nginx-vhost安全配置模版","published":1,"updated":"2024-11-25T11:22:33.904Z","_id":"cm04ukh7j000y4koccp0k7ius","comments":1,"layout":"post","photos":[],"link":"","content":"<p>#nginx-vhost-安全配置模版</p>\n<pre><code>server&#123;\n        listen 443 ssl ;\n        server_name  [域名或者ip];\n        index        index.php index.html index.htm;\n        root [项目路径];\n        access_log  /var/log/nginx/[项目名称].access.log;\n        error_log   /var/log/nginx/[项目名称].error.log;\n\n        #证书文件名称\n        ssl_certificate [证书路径 公钥];\n        #私钥文件名称\n        ssl_certificate_key [证书路径 私钥];\n        ssl_session_timeout 5m;\n        #请按照以下协议配置\n        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n        #请按照以下套件配置，配置加密套件，写法遵循 openssl 标准。\n        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;\n        ssl_prefer_server_ciphers on\n\n\n        #允许cookie\n        add_header &#39;Access-Control-Allow-Credentials&#39; &#39;true&#39;;\n        #安全头\n        add_header X-Xss-header &quot;1;mode=block&quot;;\n        add_header Set-Cookie &quot;HttpOnly&quot;;\n        add_header Set-Cookie &quot;Secure&quot;;\n        add_header X-Frame-Options &quot;SAMEORIGIN&quot;;\n\n        location ~ \\.(json|lock|git)$ &#123;\n                 deny all;\n        &#125;\n        location ~ ^/(uploads|assets)/.*\\.(php|php5|jsp|shtml)$ &#123;\n            deny all;\n        &#125;\n        location ~ .*\\.(txt|doc|pdf|rar|gz|zip|docx|exe|xlsx|ppt|pptx)$ &#123;\n            add_header Content-Disposition attachment;\n        &#125;\n        location =/assets/libs/bootstrap/Gemfile &#123;\n                       return 404;\n        &#125;\n        location ~ /\\. &#123;\n            deny  all;\n        &#125;\n\n        location / &#123;\n                proxy_cookie_path / &quot;/; httponly; secure; SameSite=None&quot;;\n                if (!-e $request_filename) &#123;\n                        rewrite  ^(.*)$  /index.php?s=/$1  last;\n                        break;\n                &#125;\n\n        &#125;\n\n        location ~ \\.php(.*)$ &#123;\n                fastcgi_pass   [访问php方式];\n                fastcgi_index  index.php;\n                fastcgi_split_path_info  ^((?U).+\\.php)(/?.+)$;\n                fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n                fastcgi_param  PATH_INFO  $fastcgi_path_info;\n                fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;\n                include        fastcgi_params;\n        &#125;\n\n        #timeout\n        large_client_header_buffers 4 16k;\n        client_max_body_size 180m;\n        client_body_buffer_size 128k;\n        fastcgi_connect_timeout 600;\n        fastcgi_read_timeout 600;\n        fastcgi_send_timeout 600;\n        fastcgi_buffer_size 128k;\n        fastcgi_buffers   2 256k;\n        fastcgi_busy_buffers_size 256k;\n        fastcgi_temp_file_write_size 256k;\n        proxy_read_timeout  240s;\n&#125;\n</code></pre>\n","site":{"data":{}},"length":1802,"excerpt":"","more":"<p>#nginx-vhost-安全配置模版</p>\n<pre><code>server&#123;\n        listen 443 ssl ;\n        server_name  [域名或者ip];\n        index        index.php index.html index.htm;\n        root [项目路径];\n        access_log  /var/log/nginx/[项目名称].access.log;\n        error_log   /var/log/nginx/[项目名称].error.log;\n\n        #证书文件名称\n        ssl_certificate [证书路径 公钥];\n        #私钥文件名称\n        ssl_certificate_key [证书路径 私钥];\n        ssl_session_timeout 5m;\n        #请按照以下协议配置\n        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n        #请按照以下套件配置，配置加密套件，写法遵循 openssl 标准。\n        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;\n        ssl_prefer_server_ciphers on\n\n\n        #允许cookie\n        add_header &#39;Access-Control-Allow-Credentials&#39; &#39;true&#39;;\n        #安全头\n        add_header X-Xss-header &quot;1;mode=block&quot;;\n        add_header Set-Cookie &quot;HttpOnly&quot;;\n        add_header Set-Cookie &quot;Secure&quot;;\n        add_header X-Frame-Options &quot;SAMEORIGIN&quot;;\n\n        location ~ \\.(json|lock|git)$ &#123;\n                 deny all;\n        &#125;\n        location ~ ^/(uploads|assets)/.*\\.(php|php5|jsp|shtml)$ &#123;\n            deny all;\n        &#125;\n        location ~ .*\\.(txt|doc|pdf|rar|gz|zip|docx|exe|xlsx|ppt|pptx)$ &#123;\n            add_header Content-Disposition attachment;\n        &#125;\n        location =/assets/libs/bootstrap/Gemfile &#123;\n                       return 404;\n        &#125;\n        location ~ /\\. &#123;\n            deny  all;\n        &#125;\n\n        location / &#123;\n                proxy_cookie_path / &quot;/; httponly; secure; SameSite=None&quot;;\n                if (!-e $request_filename) &#123;\n                        rewrite  ^(.*)$  /index.php?s=/$1  last;\n                        break;\n                &#125;\n\n        &#125;\n\n        location ~ \\.php(.*)$ &#123;\n                fastcgi_pass   [访问php方式];\n                fastcgi_index  index.php;\n                fastcgi_split_path_info  ^((?U).+\\.php)(/?.+)$;\n                fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n                fastcgi_param  PATH_INFO  $fastcgi_path_info;\n                fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;\n                include        fastcgi_params;\n        &#125;\n\n        #timeout\n        large_client_header_buffers 4 16k;\n        client_max_body_size 180m;\n        client_body_buffer_size 128k;\n        fastcgi_connect_timeout 600;\n        fastcgi_read_timeout 600;\n        fastcgi_send_timeout 600;\n        fastcgi_buffer_size 128k;\n        fastcgi_buffers   2 256k;\n        fastcgi_busy_buffers_size 256k;\n        fastcgi_temp_file_write_size 256k;\n        proxy_read_timeout  240s;\n&#125;\n</code></pre>\n"},{"title":"nginx-配置location","abbrlink":"e22c93eb","date":"2023-07-29T07:33:47.000Z","_content":"","source":"_posts/nginx-配置location.md","raw":"---\ntitle: nginx-配置location\nabbrlink: e22c93eb\ncategories:\n  - 服务器相关\n  - nginx\ndate: 2023-07-29 15:33:47\ntags:\n---\n","slug":"nginx-配置location","published":1,"updated":"2024-11-25T11:22:42.876Z","_id":"cm04ukh7k000z4koc8u759m42","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"php开发-hj212环保协议2007","abbrlink":"8e3b07ac","date":"2023-07-13T12:08:15.000Z","_content":"\n# 基础\n\n    1、基于TCP/IP\n    \n    \n    2、数据包示例\n    \n        ##0069QN=20230812235921004;ST=91;CN=9021;PW=123456;MN=000202;Flag=4;CP=&&&&1540\n        \n        ##0106QN=20230812233003569;ST=32;CN=3020;PW=123456;MN=000102;Flag=5;CP=&&DataTime=20230812233003;i12001-Info=4&&7D00\n        \n        ##0580QN=20230914000010688;ST=32;CN=2061;PW=123456;MN=3207xuweixinqu0000000233;Flag=4;CP=&&DataTime=20230913230000;w21001-Min=23.592,w21001-Max=23.592,w21001-Avg=23.592,w21001-Cou=0.000,w21001-Flag=N;w21011-Min=0.476,w21011-Max=0.476,w21011-Avg=0.476,w21011-Cou=0.000,w21011-Flag=N;w01018-Min=181.574,w01018-Max=181.574,w01018-Avg=181.574,w01018-Cou=0.000,w01018-Flag=N;w21003-Min=5.036,w21003-Max=5.036,w21003-Avg=5.036,w21003-Cou=0.000,w21003-Flag=N;w01001-Min=6.856,w01001-Max=6.874,w01001-Avg=6.864,w01001-Flag=N;w01010-Min=23.284,w01010-Max=23.411,w01010-Avg=23.349,w01010-Flag=N&&F6C1\n    \n        ##0620QN=20230813000015114;ST=32;CN=2051;PW=123456;MN=000101;Flag=5;CP=&&DataTime=20230812235000;w01018-Cou=0.0,w01018-Min=3547.8,w01018-Avg=3547.8,w01018-Max=3547.8,w01018-Flag=N;w21003-Cou=0.00,w21003-Min=129.63,w21003-Avg=129.63,w21003-Max=129.63,w21003-Flag=N;w21011-Cou=0.00,w21011-Min=0.43,w21011-Avg=0.43,w21011-Max=0.43,w21011-Flag=N;w21001-Cou=0.00,w21001-Min=67.35,w21001-Avg=67.35,w21001-Max=67.35,w21001-Flag=N;w01001-Min=6.65,w01001-Avg=6.65,w01001-Max=6.65,w01001-Flag=N;w01010-Min=26.2,w01010-Avg=26.5,w01010-Max=26.7,w01010-Flag=N;w00000-Cou=0.00,w00000-Min=0.00,w00000-Avg=0.00,w00000-Max=0.00,w00000-Flag=N&&2BC0\n    \n    \n \n# hj212解析\n    \n    <?php\n    namespace app\\hj212;\n    \n    use app\\hj212\\feature\\ParserFeature;\n    use app\\hj212\\model\\verify\\PacketElement;\n    \n    /**\n     * T212通信包解析器\n     * Class T212Parser\n     * @package App\\core\n     */\n    class T212Parser {\n    \n        public static $HEADER = '##';\n        //需要双引号(\"\")\n        public static $FOOTER = \"\\r\\n\";\n    \n        protected $reader;\n        //位置\n        protected $readerIndex = 0;\n    \n        private $parserFeature;\n    \n        //TEMP\n        private $count;\n    //    private PacketElement token;\n    \n        function __construct($reader = ''){\n            $this->reader = $reader;\n    \n        }\n    \n        public function setReader($reader) {\n            $this->reader = $reader;\n            $this->readerIndex = 0;\n        }\n    \n        /**\n         * 设置解析特性\n         * @param parserFeature 解析特性\n         */\n        function setParserFeature(int $parserFeature) {\n            $this->parserFeature = $parserFeature;\n        }\n    \n        /**\n         * 读取 包头\n         * @return mixed\n         * @throws IOException\n         */\n        public function readHeader() {\n    \n    //        $header = new char[2];\n    //        $count = $reader.read($header);\n    \n            $header = substr($this->reader,$this->readerIndex,PacketElement::HEADER);\n            $this->readerIndex = $this->readerIndex + PacketElement::HEADER;\n            $count = strlen($header);\n            VerifyUtil::verifyEqualLen($count, PacketElement::HEADER, PacketElement::getElementVar());\n            VerifyUtil::verifyChar($header, self::$HEADER, PacketElement::getElementVar());\n    \n            return $header;\n        }\n    \n        /**\n         * 读取 数据段长度\n         * @see PacketElement#DATA_LEN\n         * @return chars\n         * @throws T212FormatException\n         * @throws IOException\n         */\n        function readDataLen(){\n            $len = substr($this->reader,$this->readerIndex,PacketElement::DATA_LEN);\n            $this->readerIndex = $this->readerIndex + PacketElement::DATA_LEN;\n            $count = strlen($len);\n            VerifyUtil::verifyEqualLen($count,PacketElement::DATA_LEN, PacketElement::getElementVar());\n            return $len;\n        }\n    \n        /**\n         * 读取 数据段\n         * @see PacketElement#DATA\n         * @return chars\n         * @throws IOException\n         */\n        public function readData(int $segmentLen) {\n            $segment = substr($this->reader,$this->readerIndex, $segmentLen);\n            $this->readerIndex = $this->readerIndex + $segmentLen;\n            $count = strlen($segment);\n            VerifyUtil::verifyEqualLen($count,$segmentLen, PacketElement::getElementVar());\n            return $segment;\n        }\n    \n        /**\n         * 读取 DATA_CRC 校验\n         * @see PacketElement#DATA_CRC\n         * @return header chars\n         * @throws IOException\n         */\n        function readCrc() {\n            $crc = substr($this->reader,$this->readerIndex, PacketElement::DATA_CRC);\n            $this->readerIndex = $this->readerIndex + PacketElement::DATA_CRC;\n            $count = strlen($crc);\n            VerifyUtil::verifyEqualLen($count,PacketElement::DATA_CRC, PacketElement::getElementVar());\n            return $crc;\n        }\n    \n        /**\n         * 读取 包尾\n         * @see PacketElement\n         * @return chars\n         * @throws IOException\n         */\n        function readFooter() {\n            $footer = substr($this->reader,$this->readerIndex,PacketElement::FOOTER);\n            $this->readerIndex = $this->readerIndex + PacketElement::FOOTER;\n            $count = strlen($footer);\n    \n            VerifyUtil::verifyEqualLen($count, PacketElement::FOOTER, PacketElement::getElementVar());\n            VerifyUtil::verifyChar($footer, self::$FOOTER, PacketElement::getElementVar());\n    \n            return $footer;\n        }\n    \n        /**\n         * 读取 4字节Integer\n         * @param radix 进制\n         * @return Integer\n         * @throws IOException\n         */\n        public function readCrcInt16() {\n            $crc = substr($this->reader,$this->readerIndex, PacketElement::DATA_CRC);\n    //        $this->readerIndex = $this->readerIndex + PacketElement::DATA_CRC;\n            $count = strlen($crc);\n    \n            if($count != 4){\n                return -1;\n            }\n            //本身为十六进制字符串\n            return $crc;\n        }\n    \n        /**\n         * 读取 data + 校验\n         * @see PacketElement\n         * @return chars\n    \\     * @throws IOException\n         */\n        function readDataAndCrc(int $dataLen) {\n            $data = substr($this->reader,$this->readerIndex, $dataLen);\n            $this->readerIndex = $this->readerIndex + $dataLen;\n            $count = strlen($data);\n            VerifyUtil::verifyEqualLen($count,$dataLen, PacketElement::getElementVar());\n    \n            $crc = $this->readCrcInt16();\n            $check_crc = self::crc16Checkout($data,$dataLen);\n    \n            if($crc != -1 && $check_crc == $crc){\n                return $data;\n            }\n            return null;\n        }\n    \n        /**\n         * CRC校验\n         * @param msg 消息\n         * @param length 长度\n         * @return DATA_CRC 校验码\n         */\n        public static function crc16Checkout($msg, int $length) {\n            $crc_reg = 0xFFFF;\n            for($i=0; $i<$length; $i++) {\n                $crc_reg = ($crc_reg>>8) ^ ord($msg[$i]);\n    //            echo $crc_reg . \"\\r\\n\";\n                for($j=0;$j<8;$j++) {\n                    $check = $crc_reg & 0x0001;\n                    $crc_reg >>= 1;\n                    if ($check == 0x0001) {\n                        $crc_reg ^= 0xA001;\n                    }\n                }\n            }\n            $res = strtoupper(dechex($crc_reg));\n            $res = str_pad($res, 4, \"0\", STR_PAD_LEFT);\n            return $res;\n        }\n    \n    \n    \n    }\n\n\n# Swoole接收处理\n\n    <?php\n    /**\n     * Created by PhpStorm\n     * USER: Zhaoys\n     * Date: 2022/2/8 19:09\n     */\n    \n    namespace app\\hj212\\command;\n    \n    use app\\hj212\\model\\Data;\n    use app\\hj212\\model\\Pollution;\n    use app\\hj212\\segment\\converter\\DataConverter;\n    use app\\hj212\\VerifyUtil;\n    use Swoole\\Server as SwooleServer;\n    use app\\hj212\\T212Parser;\n    use think\\console\\Command;\n    use think\\console\\Input;\n    use think\\console\\Output;\n    use think\\Exception;\n    use think\\Db;\n    \n    class Hj212Server extends Command\n    {\n        // Server 实例\n        protected $server;\n    \n        protected $t212Parser;\n    \n        protected $buffer;\n    \n        protected function configure()\n        {\n            $this->setName('hj212:start')->setDescription('Start hj212 Server!');\n        }\n    \n        protected function execute(Input $input, Output $output)\n        {\n    //        // 监听所有地址，监听端口f\n            $this->server = new SwooleServer('0.0.0.0', 65212);\n    \n            $this->server->set(array(\n                'worker_num' => 10,\n    //            'task_worker_num' => 2,   //必须设置 on task\n                'max_request' => 10000,\n    //            'open_length_check' => true,\n    //            'package_length_func' => '',\n                'daemonize' => true,\n                'log_file' => \"runtime/log/swoole.log\",\n                'dispatch_mode' => 2,\n            ));\n            $this->t212Parser = new T212Parser();\n            $this->server->on('start', array($this, 'onStart'));\n    \n            $this->server->on('connect', array($this, 'onConnect'));\n            $this->server->on('receive', array($this, 'onReceive'));\n    \n            $this->server->on('close', array($this, 'onClose'));\n            $this->server->start();\n    \n        }\n    \n    \n        public function onStart($serv)\n        {\n            echo \"TCP Server is started at tcp://\\n\";\n        }\n    \n    \n        public function onConnect($serv, $fd)\n        {\n            echo \"connection open: {$fd}\\n\";\n            file_put_contents('runtime/log/hj212connect_' . date(\"Ymd\") . '.log', date('Y-m-d H:i:s') .\"ip\".$this->getIP().\"open: {$fd}\");\n        }\n    \n        public function onReceive($serv, $fd, $reactor_id, $data)\n        {\n            file_put_contents('runtime/log/hj212receive_' . date(\"Ymd\") . '.log', date('Y-m-d H:i:s') . \"receive:  \" . $data . PHP_EOL, FILE_APPEND);\n    \n            $tempdata = rtrim($data, \"\\r\\n\");\n            $strlen = strlen($tempdata);\n            $endstr = substr($tempdata, $strlen - 6, 2);\n            $strartstr = substr($data, 0, 2);\n            if ($strartstr == \"##\" && $endstr != \"&&\") {\n                $this->buffer = $data;\n                return;\n            } else if ($strartstr != \"##\" && $endstr == \"&&\" && $this->buffer && VerifyUtil::verifyCrc($this->buffer . $tempdata)) {\n                $data = rtrim($this->buffer, \"\\r\\n\") . $data;\n            } else if ($strartstr != \"##\" && $endstr == \"&&\" && $this->buffer && !VerifyUtil::verifyCrc($this->buffer . $tempdata)) {\n                $this->buffer = rtrim($this->buffer, \"\\r\\n\") . $tempdata;\n                return;\n            //##1715QN=20230727145559023;ST=32;CN=3020;PW=123456;MN=000102;Flag=5;CP=&&Data\n            }else if($strartstr == \"##\" && $endstr == \"&&\" && !VerifyUtil::verifyCrc($this->buffer . $tempdata)){\n                $this->buffer = $data;\n                return;\n            }\n            $sourceData = $data;\n            $this->t212Parser->setReader($data);\n            $this->t212Parser->readHeader();\n            $dataLen = $this->t212Parser->readDataLen();\n            $data = $this->t212Parser->readDataAndCrc($dataLen);\n            $dataConverter = new DataConverter($data);\n            $insetdata = $dataConverter->convertData();\n            $insetdata['data_len'] = $dataLen;\n            $insetdata['crc'] = $this->t212Parser->readCrcInt16();\n            $insetdata['source_data'] = $sourceData;\n            $cpData = $dataConverter->convertCpData();\n            //存在数据空的情况 ##0069QN=20230723080035006;ST=91;CN=9021;PW=123456;MN=000201;Flag=4;CP=&&&&BDC1\n            $insetdata['cp_datatime'] = isset($cpData['cpData']['datatime']) ? $cpData['cpData']['datatime'] : 0;\n            Db::startTrans();\n            try {\n                $dataModel = new Data($insetdata);\n                $dataModel->save();\n                //            $pollutionModel = new Pollution();\n                //            foreach ($cpData['pollution'] as $k => $val) {\n                //                $pModel = clone $pollutionModel;\n                //                $val['data_id'] = $dataModel->id;\n                //                $val['code'] = $k;\n                //                $pModel->data($val);\n                //                $pModel->save();\n                //            }\n                Db::commit();\n            } catch (Exception $e) {\n                Db::rollback();\n            }\n            $str = \"QN={$insetdata['qn']};ST=91;CN=9014;PW={$insetdata['pw']};MN={$insetdata['mn']};Flag=4;CP=&&&&\\r\\n\";\n            $num = strlen($str);\n            $newNum = str_pad($num, 4, \"0\", STR_PAD_LEFT);\n            $resStr = \"##\" . $newNum . $str;\n            $this->buffer = \"\";\n            $this->server->send($fd, $resStr);\n    \n        }\n    \n        public function onClose($serv, $fd)\n        {\n            echo \"connection close: {$fd}\\n\";\n        }\n    \n        /**\n         * 同步任务\n         * $this->serv->taskwait($data); 触发\n         * @param $server\n         * @param $task_id\n         * @param $data\n         */\n        function onSyncTask($serv, $task_id, $from_id, $data)\n        {\n            echo \"Sync task Callback: \" . $data;\n    \n            $this->t212Parser->setReader($data);\n            $header = $this->t212Parser->readHeader();\n            $dataLen = $this->t212Parser->readDataLen();\n            $data = $this->t212Parser->readDataAndCrc($dataLen);\n            echo $data;\n    \n            $result = $data;\n            // 通知完成\n            $this->server->finish($result);\n        }\n    \n        /**\n         * 异步任务\n         * $this->serv->task($data); 触发\n         * @param $server\n         * @param $task_id\n         * @param $data\n         */\n        function onAsynTask($serv, $task_id, $from_id, $data)\n        {\n            echo \"Asyn task Callback: \";\n            // 通知完成\n            $this->server->finish($data . \"cccccsssss\");\n    \n        }\n    \n        public function onFinish($serv, $task_id, $data)\n        {\n            echo \"任务完成\";//taskwait  不触发这个函数。。\n        }\n    \n        public function getIP()\n        {\n            if (isset($_SERVER)){\n                if (isset($_SERVER[\"HTTP_X_FORWARDED_FOR\"])){\n                    $realip = $_SERVER[\"HTTP_X_FORWARDED_FOR\"];\n                } else if (isset($_SERVER[\"HTTP_CLIENT_IP\"])) {\n                    $realip = $_SERVER[\"HTTP_CLIENT_IP\"];\n                } else {\n                    $realip = isset($_SERVER[\"REMOTE_ADDR\"]) ? $_SERVER[\"REMOTE_ADDR\"] : '127.0.0.1';\n                }\n            } else {\n                if (getenv(\"HTTP_X_FORWARDED_FOR\")){\n                    $realip = getenv(\"HTTP_X_FORWARDED_FOR\");\n                } else if (getenv(\"HTTP_CLIENT_IP\")) {\n                    $realip = getenv(\"HTTP_CLIENT_IP\");\n                } else {\n                    $realip = getenv(\"REMOTE_ADDR\");\n                }\n            }\n            return $realip;\n        }\n    \n    }","source":"_posts/php开发-hj212环保协议2007.md","raw":"---\ntitle: php开发-hj212环保协议2007\ntags: PHP开发\ncategories:\n  - PHP开发\nabbrlink: 8e3b07ac\ndate: 2023-07-13 20:08:15\n---\n\n# 基础\n\n    1、基于TCP/IP\n    \n    \n    2、数据包示例\n    \n        ##0069QN=20230812235921004;ST=91;CN=9021;PW=123456;MN=000202;Flag=4;CP=&&&&1540\n        \n        ##0106QN=20230812233003569;ST=32;CN=3020;PW=123456;MN=000102;Flag=5;CP=&&DataTime=20230812233003;i12001-Info=4&&7D00\n        \n        ##0580QN=20230914000010688;ST=32;CN=2061;PW=123456;MN=3207xuweixinqu0000000233;Flag=4;CP=&&DataTime=20230913230000;w21001-Min=23.592,w21001-Max=23.592,w21001-Avg=23.592,w21001-Cou=0.000,w21001-Flag=N;w21011-Min=0.476,w21011-Max=0.476,w21011-Avg=0.476,w21011-Cou=0.000,w21011-Flag=N;w01018-Min=181.574,w01018-Max=181.574,w01018-Avg=181.574,w01018-Cou=0.000,w01018-Flag=N;w21003-Min=5.036,w21003-Max=5.036,w21003-Avg=5.036,w21003-Cou=0.000,w21003-Flag=N;w01001-Min=6.856,w01001-Max=6.874,w01001-Avg=6.864,w01001-Flag=N;w01010-Min=23.284,w01010-Max=23.411,w01010-Avg=23.349,w01010-Flag=N&&F6C1\n    \n        ##0620QN=20230813000015114;ST=32;CN=2051;PW=123456;MN=000101;Flag=5;CP=&&DataTime=20230812235000;w01018-Cou=0.0,w01018-Min=3547.8,w01018-Avg=3547.8,w01018-Max=3547.8,w01018-Flag=N;w21003-Cou=0.00,w21003-Min=129.63,w21003-Avg=129.63,w21003-Max=129.63,w21003-Flag=N;w21011-Cou=0.00,w21011-Min=0.43,w21011-Avg=0.43,w21011-Max=0.43,w21011-Flag=N;w21001-Cou=0.00,w21001-Min=67.35,w21001-Avg=67.35,w21001-Max=67.35,w21001-Flag=N;w01001-Min=6.65,w01001-Avg=6.65,w01001-Max=6.65,w01001-Flag=N;w01010-Min=26.2,w01010-Avg=26.5,w01010-Max=26.7,w01010-Flag=N;w00000-Cou=0.00,w00000-Min=0.00,w00000-Avg=0.00,w00000-Max=0.00,w00000-Flag=N&&2BC0\n    \n    \n \n# hj212解析\n    \n    <?php\n    namespace app\\hj212;\n    \n    use app\\hj212\\feature\\ParserFeature;\n    use app\\hj212\\model\\verify\\PacketElement;\n    \n    /**\n     * T212通信包解析器\n     * Class T212Parser\n     * @package App\\core\n     */\n    class T212Parser {\n    \n        public static $HEADER = '##';\n        //需要双引号(\"\")\n        public static $FOOTER = \"\\r\\n\";\n    \n        protected $reader;\n        //位置\n        protected $readerIndex = 0;\n    \n        private $parserFeature;\n    \n        //TEMP\n        private $count;\n    //    private PacketElement token;\n    \n        function __construct($reader = ''){\n            $this->reader = $reader;\n    \n        }\n    \n        public function setReader($reader) {\n            $this->reader = $reader;\n            $this->readerIndex = 0;\n        }\n    \n        /**\n         * 设置解析特性\n         * @param parserFeature 解析特性\n         */\n        function setParserFeature(int $parserFeature) {\n            $this->parserFeature = $parserFeature;\n        }\n    \n        /**\n         * 读取 包头\n         * @return mixed\n         * @throws IOException\n         */\n        public function readHeader() {\n    \n    //        $header = new char[2];\n    //        $count = $reader.read($header);\n    \n            $header = substr($this->reader,$this->readerIndex,PacketElement::HEADER);\n            $this->readerIndex = $this->readerIndex + PacketElement::HEADER;\n            $count = strlen($header);\n            VerifyUtil::verifyEqualLen($count, PacketElement::HEADER, PacketElement::getElementVar());\n            VerifyUtil::verifyChar($header, self::$HEADER, PacketElement::getElementVar());\n    \n            return $header;\n        }\n    \n        /**\n         * 读取 数据段长度\n         * @see PacketElement#DATA_LEN\n         * @return chars\n         * @throws T212FormatException\n         * @throws IOException\n         */\n        function readDataLen(){\n            $len = substr($this->reader,$this->readerIndex,PacketElement::DATA_LEN);\n            $this->readerIndex = $this->readerIndex + PacketElement::DATA_LEN;\n            $count = strlen($len);\n            VerifyUtil::verifyEqualLen($count,PacketElement::DATA_LEN, PacketElement::getElementVar());\n            return $len;\n        }\n    \n        /**\n         * 读取 数据段\n         * @see PacketElement#DATA\n         * @return chars\n         * @throws IOException\n         */\n        public function readData(int $segmentLen) {\n            $segment = substr($this->reader,$this->readerIndex, $segmentLen);\n            $this->readerIndex = $this->readerIndex + $segmentLen;\n            $count = strlen($segment);\n            VerifyUtil::verifyEqualLen($count,$segmentLen, PacketElement::getElementVar());\n            return $segment;\n        }\n    \n        /**\n         * 读取 DATA_CRC 校验\n         * @see PacketElement#DATA_CRC\n         * @return header chars\n         * @throws IOException\n         */\n        function readCrc() {\n            $crc = substr($this->reader,$this->readerIndex, PacketElement::DATA_CRC);\n            $this->readerIndex = $this->readerIndex + PacketElement::DATA_CRC;\n            $count = strlen($crc);\n            VerifyUtil::verifyEqualLen($count,PacketElement::DATA_CRC, PacketElement::getElementVar());\n            return $crc;\n        }\n    \n        /**\n         * 读取 包尾\n         * @see PacketElement\n         * @return chars\n         * @throws IOException\n         */\n        function readFooter() {\n            $footer = substr($this->reader,$this->readerIndex,PacketElement::FOOTER);\n            $this->readerIndex = $this->readerIndex + PacketElement::FOOTER;\n            $count = strlen($footer);\n    \n            VerifyUtil::verifyEqualLen($count, PacketElement::FOOTER, PacketElement::getElementVar());\n            VerifyUtil::verifyChar($footer, self::$FOOTER, PacketElement::getElementVar());\n    \n            return $footer;\n        }\n    \n        /**\n         * 读取 4字节Integer\n         * @param radix 进制\n         * @return Integer\n         * @throws IOException\n         */\n        public function readCrcInt16() {\n            $crc = substr($this->reader,$this->readerIndex, PacketElement::DATA_CRC);\n    //        $this->readerIndex = $this->readerIndex + PacketElement::DATA_CRC;\n            $count = strlen($crc);\n    \n            if($count != 4){\n                return -1;\n            }\n            //本身为十六进制字符串\n            return $crc;\n        }\n    \n        /**\n         * 读取 data + 校验\n         * @see PacketElement\n         * @return chars\n    \\     * @throws IOException\n         */\n        function readDataAndCrc(int $dataLen) {\n            $data = substr($this->reader,$this->readerIndex, $dataLen);\n            $this->readerIndex = $this->readerIndex + $dataLen;\n            $count = strlen($data);\n            VerifyUtil::verifyEqualLen($count,$dataLen, PacketElement::getElementVar());\n    \n            $crc = $this->readCrcInt16();\n            $check_crc = self::crc16Checkout($data,$dataLen);\n    \n            if($crc != -1 && $check_crc == $crc){\n                return $data;\n            }\n            return null;\n        }\n    \n        /**\n         * CRC校验\n         * @param msg 消息\n         * @param length 长度\n         * @return DATA_CRC 校验码\n         */\n        public static function crc16Checkout($msg, int $length) {\n            $crc_reg = 0xFFFF;\n            for($i=0; $i<$length; $i++) {\n                $crc_reg = ($crc_reg>>8) ^ ord($msg[$i]);\n    //            echo $crc_reg . \"\\r\\n\";\n                for($j=0;$j<8;$j++) {\n                    $check = $crc_reg & 0x0001;\n                    $crc_reg >>= 1;\n                    if ($check == 0x0001) {\n                        $crc_reg ^= 0xA001;\n                    }\n                }\n            }\n            $res = strtoupper(dechex($crc_reg));\n            $res = str_pad($res, 4, \"0\", STR_PAD_LEFT);\n            return $res;\n        }\n    \n    \n    \n    }\n\n\n# Swoole接收处理\n\n    <?php\n    /**\n     * Created by PhpStorm\n     * USER: Zhaoys\n     * Date: 2022/2/8 19:09\n     */\n    \n    namespace app\\hj212\\command;\n    \n    use app\\hj212\\model\\Data;\n    use app\\hj212\\model\\Pollution;\n    use app\\hj212\\segment\\converter\\DataConverter;\n    use app\\hj212\\VerifyUtil;\n    use Swoole\\Server as SwooleServer;\n    use app\\hj212\\T212Parser;\n    use think\\console\\Command;\n    use think\\console\\Input;\n    use think\\console\\Output;\n    use think\\Exception;\n    use think\\Db;\n    \n    class Hj212Server extends Command\n    {\n        // Server 实例\n        protected $server;\n    \n        protected $t212Parser;\n    \n        protected $buffer;\n    \n        protected function configure()\n        {\n            $this->setName('hj212:start')->setDescription('Start hj212 Server!');\n        }\n    \n        protected function execute(Input $input, Output $output)\n        {\n    //        // 监听所有地址，监听端口f\n            $this->server = new SwooleServer('0.0.0.0', 65212);\n    \n            $this->server->set(array(\n                'worker_num' => 10,\n    //            'task_worker_num' => 2,   //必须设置 on task\n                'max_request' => 10000,\n    //            'open_length_check' => true,\n    //            'package_length_func' => '',\n                'daemonize' => true,\n                'log_file' => \"runtime/log/swoole.log\",\n                'dispatch_mode' => 2,\n            ));\n            $this->t212Parser = new T212Parser();\n            $this->server->on('start', array($this, 'onStart'));\n    \n            $this->server->on('connect', array($this, 'onConnect'));\n            $this->server->on('receive', array($this, 'onReceive'));\n    \n            $this->server->on('close', array($this, 'onClose'));\n            $this->server->start();\n    \n        }\n    \n    \n        public function onStart($serv)\n        {\n            echo \"TCP Server is started at tcp://\\n\";\n        }\n    \n    \n        public function onConnect($serv, $fd)\n        {\n            echo \"connection open: {$fd}\\n\";\n            file_put_contents('runtime/log/hj212connect_' . date(\"Ymd\") . '.log', date('Y-m-d H:i:s') .\"ip\".$this->getIP().\"open: {$fd}\");\n        }\n    \n        public function onReceive($serv, $fd, $reactor_id, $data)\n        {\n            file_put_contents('runtime/log/hj212receive_' . date(\"Ymd\") . '.log', date('Y-m-d H:i:s') . \"receive:  \" . $data . PHP_EOL, FILE_APPEND);\n    \n            $tempdata = rtrim($data, \"\\r\\n\");\n            $strlen = strlen($tempdata);\n            $endstr = substr($tempdata, $strlen - 6, 2);\n            $strartstr = substr($data, 0, 2);\n            if ($strartstr == \"##\" && $endstr != \"&&\") {\n                $this->buffer = $data;\n                return;\n            } else if ($strartstr != \"##\" && $endstr == \"&&\" && $this->buffer && VerifyUtil::verifyCrc($this->buffer . $tempdata)) {\n                $data = rtrim($this->buffer, \"\\r\\n\") . $data;\n            } else if ($strartstr != \"##\" && $endstr == \"&&\" && $this->buffer && !VerifyUtil::verifyCrc($this->buffer . $tempdata)) {\n                $this->buffer = rtrim($this->buffer, \"\\r\\n\") . $tempdata;\n                return;\n            //##1715QN=20230727145559023;ST=32;CN=3020;PW=123456;MN=000102;Flag=5;CP=&&Data\n            }else if($strartstr == \"##\" && $endstr == \"&&\" && !VerifyUtil::verifyCrc($this->buffer . $tempdata)){\n                $this->buffer = $data;\n                return;\n            }\n            $sourceData = $data;\n            $this->t212Parser->setReader($data);\n            $this->t212Parser->readHeader();\n            $dataLen = $this->t212Parser->readDataLen();\n            $data = $this->t212Parser->readDataAndCrc($dataLen);\n            $dataConverter = new DataConverter($data);\n            $insetdata = $dataConverter->convertData();\n            $insetdata['data_len'] = $dataLen;\n            $insetdata['crc'] = $this->t212Parser->readCrcInt16();\n            $insetdata['source_data'] = $sourceData;\n            $cpData = $dataConverter->convertCpData();\n            //存在数据空的情况 ##0069QN=20230723080035006;ST=91;CN=9021;PW=123456;MN=000201;Flag=4;CP=&&&&BDC1\n            $insetdata['cp_datatime'] = isset($cpData['cpData']['datatime']) ? $cpData['cpData']['datatime'] : 0;\n            Db::startTrans();\n            try {\n                $dataModel = new Data($insetdata);\n                $dataModel->save();\n                //            $pollutionModel = new Pollution();\n                //            foreach ($cpData['pollution'] as $k => $val) {\n                //                $pModel = clone $pollutionModel;\n                //                $val['data_id'] = $dataModel->id;\n                //                $val['code'] = $k;\n                //                $pModel->data($val);\n                //                $pModel->save();\n                //            }\n                Db::commit();\n            } catch (Exception $e) {\n                Db::rollback();\n            }\n            $str = \"QN={$insetdata['qn']};ST=91;CN=9014;PW={$insetdata['pw']};MN={$insetdata['mn']};Flag=4;CP=&&&&\\r\\n\";\n            $num = strlen($str);\n            $newNum = str_pad($num, 4, \"0\", STR_PAD_LEFT);\n            $resStr = \"##\" . $newNum . $str;\n            $this->buffer = \"\";\n            $this->server->send($fd, $resStr);\n    \n        }\n    \n        public function onClose($serv, $fd)\n        {\n            echo \"connection close: {$fd}\\n\";\n        }\n    \n        /**\n         * 同步任务\n         * $this->serv->taskwait($data); 触发\n         * @param $server\n         * @param $task_id\n         * @param $data\n         */\n        function onSyncTask($serv, $task_id, $from_id, $data)\n        {\n            echo \"Sync task Callback: \" . $data;\n    \n            $this->t212Parser->setReader($data);\n            $header = $this->t212Parser->readHeader();\n            $dataLen = $this->t212Parser->readDataLen();\n            $data = $this->t212Parser->readDataAndCrc($dataLen);\n            echo $data;\n    \n            $result = $data;\n            // 通知完成\n            $this->server->finish($result);\n        }\n    \n        /**\n         * 异步任务\n         * $this->serv->task($data); 触发\n         * @param $server\n         * @param $task_id\n         * @param $data\n         */\n        function onAsynTask($serv, $task_id, $from_id, $data)\n        {\n            echo \"Asyn task Callback: \";\n            // 通知完成\n            $this->server->finish($data . \"cccccsssss\");\n    \n        }\n    \n        public function onFinish($serv, $task_id, $data)\n        {\n            echo \"任务完成\";//taskwait  不触发这个函数。。\n        }\n    \n        public function getIP()\n        {\n            if (isset($_SERVER)){\n                if (isset($_SERVER[\"HTTP_X_FORWARDED_FOR\"])){\n                    $realip = $_SERVER[\"HTTP_X_FORWARDED_FOR\"];\n                } else if (isset($_SERVER[\"HTTP_CLIENT_IP\"])) {\n                    $realip = $_SERVER[\"HTTP_CLIENT_IP\"];\n                } else {\n                    $realip = isset($_SERVER[\"REMOTE_ADDR\"]) ? $_SERVER[\"REMOTE_ADDR\"] : '127.0.0.1';\n                }\n            } else {\n                if (getenv(\"HTTP_X_FORWARDED_FOR\")){\n                    $realip = getenv(\"HTTP_X_FORWARDED_FOR\");\n                } else if (getenv(\"HTTP_CLIENT_IP\")) {\n                    $realip = getenv(\"HTTP_CLIENT_IP\");\n                } else {\n                    $realip = getenv(\"REMOTE_ADDR\");\n                }\n            }\n            return $realip;\n        }\n    \n    }","slug":"php开发-hj212环保协议2007","published":1,"updated":"2024-08-20T01:58:32.822Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm04ukh7l00104kocanb61nce","content":"<h1 id=\"基础\"><a href=\"#基础\" class=\"headerlink\" title=\"基础\"></a>基础</h1><pre><code>1、基于TCP/IP\n\n\n2、数据包示例\n\n    ##0069QN=20230812235921004;ST=91;CN=9021;PW=123456;MN=000202;Flag=4;CP=&amp;&amp;&amp;&amp;1540\n    \n    ##0106QN=20230812233003569;ST=32;CN=3020;PW=123456;MN=000102;Flag=5;CP=&amp;&amp;DataTime=20230812233003;i12001-Info=4&amp;&amp;7D00\n    \n    ##0580QN=20230914000010688;ST=32;CN=2061;PW=123456;MN=3207xuweixinqu0000000233;Flag=4;CP=&amp;&amp;DataTime=20230913230000;w21001-Min=23.592,w21001-Max=23.592,w21001-Avg=23.592,w21001-Cou=0.000,w21001-Flag=N;w21011-Min=0.476,w21011-Max=0.476,w21011-Avg=0.476,w21011-Cou=0.000,w21011-Flag=N;w01018-Min=181.574,w01018-Max=181.574,w01018-Avg=181.574,w01018-Cou=0.000,w01018-Flag=N;w21003-Min=5.036,w21003-Max=5.036,w21003-Avg=5.036,w21003-Cou=0.000,w21003-Flag=N;w01001-Min=6.856,w01001-Max=6.874,w01001-Avg=6.864,w01001-Flag=N;w01010-Min=23.284,w01010-Max=23.411,w01010-Avg=23.349,w01010-Flag=N&amp;&amp;F6C1\n\n    ##0620QN=20230813000015114;ST=32;CN=2051;PW=123456;MN=000101;Flag=5;CP=&amp;&amp;DataTime=20230812235000;w01018-Cou=0.0,w01018-Min=3547.8,w01018-Avg=3547.8,w01018-Max=3547.8,w01018-Flag=N;w21003-Cou=0.00,w21003-Min=129.63,w21003-Avg=129.63,w21003-Max=129.63,w21003-Flag=N;w21011-Cou=0.00,w21011-Min=0.43,w21011-Avg=0.43,w21011-Max=0.43,w21011-Flag=N;w21001-Cou=0.00,w21001-Min=67.35,w21001-Avg=67.35,w21001-Max=67.35,w21001-Flag=N;w01001-Min=6.65,w01001-Avg=6.65,w01001-Max=6.65,w01001-Flag=N;w01010-Min=26.2,w01010-Avg=26.5,w01010-Max=26.7,w01010-Flag=N;w00000-Cou=0.00,w00000-Min=0.00,w00000-Avg=0.00,w00000-Max=0.00,w00000-Flag=N&amp;&amp;2BC0\n</code></pre>\n<h1 id=\"hj212解析\"><a href=\"#hj212解析\" class=\"headerlink\" title=\"hj212解析\"></a>hj212解析</h1><pre><code>&lt;?php\nnamespace app\\hj212;\n\nuse app\\hj212\\feature\\ParserFeature;\nuse app\\hj212\\model\\verify\\PacketElement;\n\n/**\n * T212通信包解析器\n * Class T212Parser\n * @package App\\core\n */\nclass T212Parser &#123;\n\n    public static $HEADER = &#39;##&#39;;\n    //需要双引号(&quot;&quot;)\n    public static $FOOTER = &quot;\\r\\n&quot;;\n\n    protected $reader;\n    //位置\n    protected $readerIndex = 0;\n\n    private $parserFeature;\n\n    //TEMP\n    private $count;\n//    private PacketElement token;\n\n    function __construct($reader = &#39;&#39;)&#123;\n        $this-&gt;reader = $reader;\n\n    &#125;\n\n    public function setReader($reader) &#123;\n        $this-&gt;reader = $reader;\n        $this-&gt;readerIndex = 0;\n    &#125;\n\n    /**\n     * 设置解析特性\n     * @param parserFeature 解析特性\n     */\n    function setParserFeature(int $parserFeature) &#123;\n        $this-&gt;parserFeature = $parserFeature;\n    &#125;\n\n    /**\n     * 读取 包头\n     * @return mixed\n     * @throws IOException\n     */\n    public function readHeader() &#123;\n\n//        $header = new char[2];\n//        $count = $reader.read($header);\n\n        $header = substr($this-&gt;reader,$this-&gt;readerIndex,PacketElement::HEADER);\n        $this-&gt;readerIndex = $this-&gt;readerIndex + PacketElement::HEADER;\n        $count = strlen($header);\n        VerifyUtil::verifyEqualLen($count, PacketElement::HEADER, PacketElement::getElementVar());\n        VerifyUtil::verifyChar($header, self::$HEADER, PacketElement::getElementVar());\n\n        return $header;\n    &#125;\n\n    /**\n     * 读取 数据段长度\n     * @see PacketElement#DATA_LEN\n     * @return chars\n     * @throws T212FormatException\n     * @throws IOException\n     */\n    function readDataLen()&#123;\n        $len = substr($this-&gt;reader,$this-&gt;readerIndex,PacketElement::DATA_LEN);\n        $this-&gt;readerIndex = $this-&gt;readerIndex + PacketElement::DATA_LEN;\n        $count = strlen($len);\n        VerifyUtil::verifyEqualLen($count,PacketElement::DATA_LEN, PacketElement::getElementVar());\n        return $len;\n    &#125;\n\n    /**\n     * 读取 数据段\n     * @see PacketElement#DATA\n     * @return chars\n     * @throws IOException\n     */\n    public function readData(int $segmentLen) &#123;\n        $segment = substr($this-&gt;reader,$this-&gt;readerIndex, $segmentLen);\n        $this-&gt;readerIndex = $this-&gt;readerIndex + $segmentLen;\n        $count = strlen($segment);\n        VerifyUtil::verifyEqualLen($count,$segmentLen, PacketElement::getElementVar());\n        return $segment;\n    &#125;\n\n    /**\n     * 读取 DATA_CRC 校验\n     * @see PacketElement#DATA_CRC\n     * @return header chars\n     * @throws IOException\n     */\n    function readCrc() &#123;\n        $crc = substr($this-&gt;reader,$this-&gt;readerIndex, PacketElement::DATA_CRC);\n        $this-&gt;readerIndex = $this-&gt;readerIndex + PacketElement::DATA_CRC;\n        $count = strlen($crc);\n        VerifyUtil::verifyEqualLen($count,PacketElement::DATA_CRC, PacketElement::getElementVar());\n        return $crc;\n    &#125;\n\n    /**\n     * 读取 包尾\n     * @see PacketElement\n     * @return chars\n     * @throws IOException\n     */\n    function readFooter() &#123;\n        $footer = substr($this-&gt;reader,$this-&gt;readerIndex,PacketElement::FOOTER);\n        $this-&gt;readerIndex = $this-&gt;readerIndex + PacketElement::FOOTER;\n        $count = strlen($footer);\n\n        VerifyUtil::verifyEqualLen($count, PacketElement::FOOTER, PacketElement::getElementVar());\n        VerifyUtil::verifyChar($footer, self::$FOOTER, PacketElement::getElementVar());\n\n        return $footer;\n    &#125;\n\n    /**\n     * 读取 4字节Integer\n     * @param radix 进制\n     * @return Integer\n     * @throws IOException\n     */\n    public function readCrcInt16() &#123;\n        $crc = substr($this-&gt;reader,$this-&gt;readerIndex, PacketElement::DATA_CRC);\n//        $this-&gt;readerIndex = $this-&gt;readerIndex + PacketElement::DATA_CRC;\n        $count = strlen($crc);\n\n        if($count != 4)&#123;\n            return -1;\n        &#125;\n        //本身为十六进制字符串\n        return $crc;\n    &#125;\n\n    /**\n     * 读取 data + 校验\n     * @see PacketElement\n     * @return chars\n\\     * @throws IOException\n     */\n    function readDataAndCrc(int $dataLen) &#123;\n        $data = substr($this-&gt;reader,$this-&gt;readerIndex, $dataLen);\n        $this-&gt;readerIndex = $this-&gt;readerIndex + $dataLen;\n        $count = strlen($data);\n        VerifyUtil::verifyEqualLen($count,$dataLen, PacketElement::getElementVar());\n\n        $crc = $this-&gt;readCrcInt16();\n        $check_crc = self::crc16Checkout($data,$dataLen);\n\n        if($crc != -1 &amp;&amp; $check_crc == $crc)&#123;\n            return $data;\n        &#125;\n        return null;\n    &#125;\n\n    /**\n     * CRC校验\n     * @param msg 消息\n     * @param length 长度\n     * @return DATA_CRC 校验码\n     */\n    public static function crc16Checkout($msg, int $length) &#123;\n        $crc_reg = 0xFFFF;\n        for($i=0; $i&lt;$length; $i++) &#123;\n            $crc_reg = ($crc_reg&gt;&gt;8) ^ ord($msg[$i]);\n//            echo $crc_reg . &quot;\\r\\n&quot;;\n            for($j=0;$j&lt;8;$j++) &#123;\n                $check = $crc_reg &amp; 0x0001;\n                $crc_reg &gt;&gt;= 1;\n                if ($check == 0x0001) &#123;\n                    $crc_reg ^= 0xA001;\n                &#125;\n            &#125;\n        &#125;\n        $res = strtoupper(dechex($crc_reg));\n        $res = str_pad($res, 4, &quot;0&quot;, STR_PAD_LEFT);\n        return $res;\n    &#125;\n\n\n\n&#125;\n</code></pre>\n<h1 id=\"Swoole接收处理\"><a href=\"#Swoole接收处理\" class=\"headerlink\" title=\"Swoole接收处理\"></a>Swoole接收处理</h1><pre><code>&lt;?php\n/**\n * Created by PhpStorm\n * USER: Zhaoys\n * Date: 2022/2/8 19:09\n */\n\nnamespace app\\hj212\\command;\n\nuse app\\hj212\\model\\Data;\nuse app\\hj212\\model\\Pollution;\nuse app\\hj212\\segment\\converter\\DataConverter;\nuse app\\hj212\\VerifyUtil;\nuse Swoole\\Server as SwooleServer;\nuse app\\hj212\\T212Parser;\nuse think\\console\\Command;\nuse think\\console\\Input;\nuse think\\console\\Output;\nuse think\\Exception;\nuse think\\Db;\n\nclass Hj212Server extends Command\n&#123;\n    // Server 实例\n    protected $server;\n\n    protected $t212Parser;\n\n    protected $buffer;\n\n    protected function configure()\n    &#123;\n        $this-&gt;setName(&#39;hj212:start&#39;)-&gt;setDescription(&#39;Start hj212 Server!&#39;);\n    &#125;\n\n    protected function execute(Input $input, Output $output)\n    &#123;\n//        // 监听所有地址，监听端口f\n        $this-&gt;server = new SwooleServer(&#39;0.0.0.0&#39;, 65212);\n\n        $this-&gt;server-&gt;set(array(\n            &#39;worker_num&#39; =&gt; 10,\n//            &#39;task_worker_num&#39; =&gt; 2,   //必须设置 on task\n            &#39;max_request&#39; =&gt; 10000,\n//            &#39;open_length_check&#39; =&gt; true,\n//            &#39;package_length_func&#39; =&gt; &#39;&#39;,\n            &#39;daemonize&#39; =&gt; true,\n            &#39;log_file&#39; =&gt; &quot;runtime/log/swoole.log&quot;,\n            &#39;dispatch_mode&#39; =&gt; 2,\n        ));\n        $this-&gt;t212Parser = new T212Parser();\n        $this-&gt;server-&gt;on(&#39;start&#39;, array($this, &#39;onStart&#39;));\n\n        $this-&gt;server-&gt;on(&#39;connect&#39;, array($this, &#39;onConnect&#39;));\n        $this-&gt;server-&gt;on(&#39;receive&#39;, array($this, &#39;onReceive&#39;));\n\n        $this-&gt;server-&gt;on(&#39;close&#39;, array($this, &#39;onClose&#39;));\n        $this-&gt;server-&gt;start();\n\n    &#125;\n\n\n    public function onStart($serv)\n    &#123;\n        echo &quot;TCP Server is started at tcp://\\n&quot;;\n    &#125;\n\n\n    public function onConnect($serv, $fd)\n    &#123;\n        echo &quot;connection open: &#123;$fd&#125;\\n&quot;;\n        file_put_contents(&#39;runtime/log/hj212connect_&#39; . date(&quot;Ymd&quot;) . &#39;.log&#39;, date(&#39;Y-m-d H:i:s&#39;) .&quot;ip&quot;.$this-&gt;getIP().&quot;open: &#123;$fd&#125;&quot;);\n    &#125;\n\n    public function onReceive($serv, $fd, $reactor_id, $data)\n    &#123;\n        file_put_contents(&#39;runtime/log/hj212receive_&#39; . date(&quot;Ymd&quot;) . &#39;.log&#39;, date(&#39;Y-m-d H:i:s&#39;) . &quot;receive:  &quot; . $data . PHP_EOL, FILE_APPEND);\n\n        $tempdata = rtrim($data, &quot;\\r\\n&quot;);\n        $strlen = strlen($tempdata);\n        $endstr = substr($tempdata, $strlen - 6, 2);\n        $strartstr = substr($data, 0, 2);\n        if ($strartstr == &quot;##&quot; &amp;&amp; $endstr != &quot;&amp;&amp;&quot;) &#123;\n            $this-&gt;buffer = $data;\n            return;\n        &#125; else if ($strartstr != &quot;##&quot; &amp;&amp; $endstr == &quot;&amp;&amp;&quot; &amp;&amp; $this-&gt;buffer &amp;&amp; VerifyUtil::verifyCrc($this-&gt;buffer . $tempdata)) &#123;\n            $data = rtrim($this-&gt;buffer, &quot;\\r\\n&quot;) . $data;\n        &#125; else if ($strartstr != &quot;##&quot; &amp;&amp; $endstr == &quot;&amp;&amp;&quot; &amp;&amp; $this-&gt;buffer &amp;&amp; !VerifyUtil::verifyCrc($this-&gt;buffer . $tempdata)) &#123;\n            $this-&gt;buffer = rtrim($this-&gt;buffer, &quot;\\r\\n&quot;) . $tempdata;\n            return;\n        //##1715QN=20230727145559023;ST=32;CN=3020;PW=123456;MN=000102;Flag=5;CP=&amp;&amp;Data\n        &#125;else if($strartstr == &quot;##&quot; &amp;&amp; $endstr == &quot;&amp;&amp;&quot; &amp;&amp; !VerifyUtil::verifyCrc($this-&gt;buffer . $tempdata))&#123;\n            $this-&gt;buffer = $data;\n            return;\n        &#125;\n        $sourceData = $data;\n        $this-&gt;t212Parser-&gt;setReader($data);\n        $this-&gt;t212Parser-&gt;readHeader();\n        $dataLen = $this-&gt;t212Parser-&gt;readDataLen();\n        $data = $this-&gt;t212Parser-&gt;readDataAndCrc($dataLen);\n        $dataConverter = new DataConverter($data);\n        $insetdata = $dataConverter-&gt;convertData();\n        $insetdata[&#39;data_len&#39;] = $dataLen;\n        $insetdata[&#39;crc&#39;] = $this-&gt;t212Parser-&gt;readCrcInt16();\n        $insetdata[&#39;source_data&#39;] = $sourceData;\n        $cpData = $dataConverter-&gt;convertCpData();\n        //存在数据空的情况 ##0069QN=20230723080035006;ST=91;CN=9021;PW=123456;MN=000201;Flag=4;CP=&amp;&amp;&amp;&amp;BDC1\n        $insetdata[&#39;cp_datatime&#39;] = isset($cpData[&#39;cpData&#39;][&#39;datatime&#39;]) ? $cpData[&#39;cpData&#39;][&#39;datatime&#39;] : 0;\n        Db::startTrans();\n        try &#123;\n            $dataModel = new Data($insetdata);\n            $dataModel-&gt;save();\n            //            $pollutionModel = new Pollution();\n            //            foreach ($cpData[&#39;pollution&#39;] as $k =&gt; $val) &#123;\n            //                $pModel = clone $pollutionModel;\n            //                $val[&#39;data_id&#39;] = $dataModel-&gt;id;\n            //                $val[&#39;code&#39;] = $k;\n            //                $pModel-&gt;data($val);\n            //                $pModel-&gt;save();\n            //            &#125;\n            Db::commit();\n        &#125; catch (Exception $e) &#123;\n            Db::rollback();\n        &#125;\n        $str = &quot;QN=&#123;$insetdata[&#39;qn&#39;]&#125;;ST=91;CN=9014;PW=&#123;$insetdata[&#39;pw&#39;]&#125;;MN=&#123;$insetdata[&#39;mn&#39;]&#125;;Flag=4;CP=&amp;&amp;&amp;&amp;\\r\\n&quot;;\n        $num = strlen($str);\n        $newNum = str_pad($num, 4, &quot;0&quot;, STR_PAD_LEFT);\n        $resStr = &quot;##&quot; . $newNum . $str;\n        $this-&gt;buffer = &quot;&quot;;\n        $this-&gt;server-&gt;send($fd, $resStr);\n\n    &#125;\n\n    public function onClose($serv, $fd)\n    &#123;\n        echo &quot;connection close: &#123;$fd&#125;\\n&quot;;\n    &#125;\n\n    /**\n     * 同步任务\n     * $this-&gt;serv-&gt;taskwait($data); 触发\n     * @param $server\n     * @param $task_id\n     * @param $data\n     */\n    function onSyncTask($serv, $task_id, $from_id, $data)\n    &#123;\n        echo &quot;Sync task Callback: &quot; . $data;\n\n        $this-&gt;t212Parser-&gt;setReader($data);\n        $header = $this-&gt;t212Parser-&gt;readHeader();\n        $dataLen = $this-&gt;t212Parser-&gt;readDataLen();\n        $data = $this-&gt;t212Parser-&gt;readDataAndCrc($dataLen);\n        echo $data;\n\n        $result = $data;\n        // 通知完成\n        $this-&gt;server-&gt;finish($result);\n    &#125;\n\n    /**\n     * 异步任务\n     * $this-&gt;serv-&gt;task($data); 触发\n     * @param $server\n     * @param $task_id\n     * @param $data\n     */\n    function onAsynTask($serv, $task_id, $from_id, $data)\n    &#123;\n        echo &quot;Asyn task Callback: &quot;;\n        // 通知完成\n        $this-&gt;server-&gt;finish($data . &quot;cccccsssss&quot;);\n\n    &#125;\n\n    public function onFinish($serv, $task_id, $data)\n    &#123;\n        echo &quot;任务完成&quot;;//taskwait  不触发这个函数。。\n    &#125;\n\n    public function getIP()\n    &#123;\n        if (isset($_SERVER))&#123;\n            if (isset($_SERVER[&quot;HTTP_X_FORWARDED_FOR&quot;]))&#123;\n                $realip = $_SERVER[&quot;HTTP_X_FORWARDED_FOR&quot;];\n            &#125; else if (isset($_SERVER[&quot;HTTP_CLIENT_IP&quot;])) &#123;\n                $realip = $_SERVER[&quot;HTTP_CLIENT_IP&quot;];\n            &#125; else &#123;\n                $realip = isset($_SERVER[&quot;REMOTE_ADDR&quot;]) ? $_SERVER[&quot;REMOTE_ADDR&quot;] : &#39;127.0.0.1&#39;;\n            &#125;\n        &#125; else &#123;\n            if (getenv(&quot;HTTP_X_FORWARDED_FOR&quot;))&#123;\n                $realip = getenv(&quot;HTTP_X_FORWARDED_FOR&quot;);\n            &#125; else if (getenv(&quot;HTTP_CLIENT_IP&quot;)) &#123;\n                $realip = getenv(&quot;HTTP_CLIENT_IP&quot;);\n            &#125; else &#123;\n                $realip = getenv(&quot;REMOTE_ADDR&quot;);\n            &#125;\n        &#125;\n        return $realip;\n    &#125;\n\n&#125;\n</code></pre>\n","site":{"data":{}},"length":11588,"excerpt":"","more":"<h1 id=\"基础\"><a href=\"#基础\" class=\"headerlink\" title=\"基础\"></a>基础</h1><pre><code>1、基于TCP/IP\n\n\n2、数据包示例\n\n    ##0069QN=20230812235921004;ST=91;CN=9021;PW=123456;MN=000202;Flag=4;CP=&amp;&amp;&amp;&amp;1540\n    \n    ##0106QN=20230812233003569;ST=32;CN=3020;PW=123456;MN=000102;Flag=5;CP=&amp;&amp;DataTime=20230812233003;i12001-Info=4&amp;&amp;7D00\n    \n    ##0580QN=20230914000010688;ST=32;CN=2061;PW=123456;MN=3207xuweixinqu0000000233;Flag=4;CP=&amp;&amp;DataTime=20230913230000;w21001-Min=23.592,w21001-Max=23.592,w21001-Avg=23.592,w21001-Cou=0.000,w21001-Flag=N;w21011-Min=0.476,w21011-Max=0.476,w21011-Avg=0.476,w21011-Cou=0.000,w21011-Flag=N;w01018-Min=181.574,w01018-Max=181.574,w01018-Avg=181.574,w01018-Cou=0.000,w01018-Flag=N;w21003-Min=5.036,w21003-Max=5.036,w21003-Avg=5.036,w21003-Cou=0.000,w21003-Flag=N;w01001-Min=6.856,w01001-Max=6.874,w01001-Avg=6.864,w01001-Flag=N;w01010-Min=23.284,w01010-Max=23.411,w01010-Avg=23.349,w01010-Flag=N&amp;&amp;F6C1\n\n    ##0620QN=20230813000015114;ST=32;CN=2051;PW=123456;MN=000101;Flag=5;CP=&amp;&amp;DataTime=20230812235000;w01018-Cou=0.0,w01018-Min=3547.8,w01018-Avg=3547.8,w01018-Max=3547.8,w01018-Flag=N;w21003-Cou=0.00,w21003-Min=129.63,w21003-Avg=129.63,w21003-Max=129.63,w21003-Flag=N;w21011-Cou=0.00,w21011-Min=0.43,w21011-Avg=0.43,w21011-Max=0.43,w21011-Flag=N;w21001-Cou=0.00,w21001-Min=67.35,w21001-Avg=67.35,w21001-Max=67.35,w21001-Flag=N;w01001-Min=6.65,w01001-Avg=6.65,w01001-Max=6.65,w01001-Flag=N;w01010-Min=26.2,w01010-Avg=26.5,w01010-Max=26.7,w01010-Flag=N;w00000-Cou=0.00,w00000-Min=0.00,w00000-Avg=0.00,w00000-Max=0.00,w00000-Flag=N&amp;&amp;2BC0\n</code></pre>\n<h1 id=\"hj212解析\"><a href=\"#hj212解析\" class=\"headerlink\" title=\"hj212解析\"></a>hj212解析</h1><pre><code>&lt;?php\nnamespace app\\hj212;\n\nuse app\\hj212\\feature\\ParserFeature;\nuse app\\hj212\\model\\verify\\PacketElement;\n\n/**\n * T212通信包解析器\n * Class T212Parser\n * @package App\\core\n */\nclass T212Parser &#123;\n\n    public static $HEADER = &#39;##&#39;;\n    //需要双引号(&quot;&quot;)\n    public static $FOOTER = &quot;\\r\\n&quot;;\n\n    protected $reader;\n    //位置\n    protected $readerIndex = 0;\n\n    private $parserFeature;\n\n    //TEMP\n    private $count;\n//    private PacketElement token;\n\n    function __construct($reader = &#39;&#39;)&#123;\n        $this-&gt;reader = $reader;\n\n    &#125;\n\n    public function setReader($reader) &#123;\n        $this-&gt;reader = $reader;\n        $this-&gt;readerIndex = 0;\n    &#125;\n\n    /**\n     * 设置解析特性\n     * @param parserFeature 解析特性\n     */\n    function setParserFeature(int $parserFeature) &#123;\n        $this-&gt;parserFeature = $parserFeature;\n    &#125;\n\n    /**\n     * 读取 包头\n     * @return mixed\n     * @throws IOException\n     */\n    public function readHeader() &#123;\n\n//        $header = new char[2];\n//        $count = $reader.read($header);\n\n        $header = substr($this-&gt;reader,$this-&gt;readerIndex,PacketElement::HEADER);\n        $this-&gt;readerIndex = $this-&gt;readerIndex + PacketElement::HEADER;\n        $count = strlen($header);\n        VerifyUtil::verifyEqualLen($count, PacketElement::HEADER, PacketElement::getElementVar());\n        VerifyUtil::verifyChar($header, self::$HEADER, PacketElement::getElementVar());\n\n        return $header;\n    &#125;\n\n    /**\n     * 读取 数据段长度\n     * @see PacketElement#DATA_LEN\n     * @return chars\n     * @throws T212FormatException\n     * @throws IOException\n     */\n    function readDataLen()&#123;\n        $len = substr($this-&gt;reader,$this-&gt;readerIndex,PacketElement::DATA_LEN);\n        $this-&gt;readerIndex = $this-&gt;readerIndex + PacketElement::DATA_LEN;\n        $count = strlen($len);\n        VerifyUtil::verifyEqualLen($count,PacketElement::DATA_LEN, PacketElement::getElementVar());\n        return $len;\n    &#125;\n\n    /**\n     * 读取 数据段\n     * @see PacketElement#DATA\n     * @return chars\n     * @throws IOException\n     */\n    public function readData(int $segmentLen) &#123;\n        $segment = substr($this-&gt;reader,$this-&gt;readerIndex, $segmentLen);\n        $this-&gt;readerIndex = $this-&gt;readerIndex + $segmentLen;\n        $count = strlen($segment);\n        VerifyUtil::verifyEqualLen($count,$segmentLen, PacketElement::getElementVar());\n        return $segment;\n    &#125;\n\n    /**\n     * 读取 DATA_CRC 校验\n     * @see PacketElement#DATA_CRC\n     * @return header chars\n     * @throws IOException\n     */\n    function readCrc() &#123;\n        $crc = substr($this-&gt;reader,$this-&gt;readerIndex, PacketElement::DATA_CRC);\n        $this-&gt;readerIndex = $this-&gt;readerIndex + PacketElement::DATA_CRC;\n        $count = strlen($crc);\n        VerifyUtil::verifyEqualLen($count,PacketElement::DATA_CRC, PacketElement::getElementVar());\n        return $crc;\n    &#125;\n\n    /**\n     * 读取 包尾\n     * @see PacketElement\n     * @return chars\n     * @throws IOException\n     */\n    function readFooter() &#123;\n        $footer = substr($this-&gt;reader,$this-&gt;readerIndex,PacketElement::FOOTER);\n        $this-&gt;readerIndex = $this-&gt;readerIndex + PacketElement::FOOTER;\n        $count = strlen($footer);\n\n        VerifyUtil::verifyEqualLen($count, PacketElement::FOOTER, PacketElement::getElementVar());\n        VerifyUtil::verifyChar($footer, self::$FOOTER, PacketElement::getElementVar());\n\n        return $footer;\n    &#125;\n\n    /**\n     * 读取 4字节Integer\n     * @param radix 进制\n     * @return Integer\n     * @throws IOException\n     */\n    public function readCrcInt16() &#123;\n        $crc = substr($this-&gt;reader,$this-&gt;readerIndex, PacketElement::DATA_CRC);\n//        $this-&gt;readerIndex = $this-&gt;readerIndex + PacketElement::DATA_CRC;\n        $count = strlen($crc);\n\n        if($count != 4)&#123;\n            return -1;\n        &#125;\n        //本身为十六进制字符串\n        return $crc;\n    &#125;\n\n    /**\n     * 读取 data + 校验\n     * @see PacketElement\n     * @return chars\n\\     * @throws IOException\n     */\n    function readDataAndCrc(int $dataLen) &#123;\n        $data = substr($this-&gt;reader,$this-&gt;readerIndex, $dataLen);\n        $this-&gt;readerIndex = $this-&gt;readerIndex + $dataLen;\n        $count = strlen($data);\n        VerifyUtil::verifyEqualLen($count,$dataLen, PacketElement::getElementVar());\n\n        $crc = $this-&gt;readCrcInt16();\n        $check_crc = self::crc16Checkout($data,$dataLen);\n\n        if($crc != -1 &amp;&amp; $check_crc == $crc)&#123;\n            return $data;\n        &#125;\n        return null;\n    &#125;\n\n    /**\n     * CRC校验\n     * @param msg 消息\n     * @param length 长度\n     * @return DATA_CRC 校验码\n     */\n    public static function crc16Checkout($msg, int $length) &#123;\n        $crc_reg = 0xFFFF;\n        for($i=0; $i&lt;$length; $i++) &#123;\n            $crc_reg = ($crc_reg&gt;&gt;8) ^ ord($msg[$i]);\n//            echo $crc_reg . &quot;\\r\\n&quot;;\n            for($j=0;$j&lt;8;$j++) &#123;\n                $check = $crc_reg &amp; 0x0001;\n                $crc_reg &gt;&gt;= 1;\n                if ($check == 0x0001) &#123;\n                    $crc_reg ^= 0xA001;\n                &#125;\n            &#125;\n        &#125;\n        $res = strtoupper(dechex($crc_reg));\n        $res = str_pad($res, 4, &quot;0&quot;, STR_PAD_LEFT);\n        return $res;\n    &#125;\n\n\n\n&#125;\n</code></pre>\n<h1 id=\"Swoole接收处理\"><a href=\"#Swoole接收处理\" class=\"headerlink\" title=\"Swoole接收处理\"></a>Swoole接收处理</h1><pre><code>&lt;?php\n/**\n * Created by PhpStorm\n * USER: Zhaoys\n * Date: 2022/2/8 19:09\n */\n\nnamespace app\\hj212\\command;\n\nuse app\\hj212\\model\\Data;\nuse app\\hj212\\model\\Pollution;\nuse app\\hj212\\segment\\converter\\DataConverter;\nuse app\\hj212\\VerifyUtil;\nuse Swoole\\Server as SwooleServer;\nuse app\\hj212\\T212Parser;\nuse think\\console\\Command;\nuse think\\console\\Input;\nuse think\\console\\Output;\nuse think\\Exception;\nuse think\\Db;\n\nclass Hj212Server extends Command\n&#123;\n    // Server 实例\n    protected $server;\n\n    protected $t212Parser;\n\n    protected $buffer;\n\n    protected function configure()\n    &#123;\n        $this-&gt;setName(&#39;hj212:start&#39;)-&gt;setDescription(&#39;Start hj212 Server!&#39;);\n    &#125;\n\n    protected function execute(Input $input, Output $output)\n    &#123;\n//        // 监听所有地址，监听端口f\n        $this-&gt;server = new SwooleServer(&#39;0.0.0.0&#39;, 65212);\n\n        $this-&gt;server-&gt;set(array(\n            &#39;worker_num&#39; =&gt; 10,\n//            &#39;task_worker_num&#39; =&gt; 2,   //必须设置 on task\n            &#39;max_request&#39; =&gt; 10000,\n//            &#39;open_length_check&#39; =&gt; true,\n//            &#39;package_length_func&#39; =&gt; &#39;&#39;,\n            &#39;daemonize&#39; =&gt; true,\n            &#39;log_file&#39; =&gt; &quot;runtime/log/swoole.log&quot;,\n            &#39;dispatch_mode&#39; =&gt; 2,\n        ));\n        $this-&gt;t212Parser = new T212Parser();\n        $this-&gt;server-&gt;on(&#39;start&#39;, array($this, &#39;onStart&#39;));\n\n        $this-&gt;server-&gt;on(&#39;connect&#39;, array($this, &#39;onConnect&#39;));\n        $this-&gt;server-&gt;on(&#39;receive&#39;, array($this, &#39;onReceive&#39;));\n\n        $this-&gt;server-&gt;on(&#39;close&#39;, array($this, &#39;onClose&#39;));\n        $this-&gt;server-&gt;start();\n\n    &#125;\n\n\n    public function onStart($serv)\n    &#123;\n        echo &quot;TCP Server is started at tcp://\\n&quot;;\n    &#125;\n\n\n    public function onConnect($serv, $fd)\n    &#123;\n        echo &quot;connection open: &#123;$fd&#125;\\n&quot;;\n        file_put_contents(&#39;runtime/log/hj212connect_&#39; . date(&quot;Ymd&quot;) . &#39;.log&#39;, date(&#39;Y-m-d H:i:s&#39;) .&quot;ip&quot;.$this-&gt;getIP().&quot;open: &#123;$fd&#125;&quot;);\n    &#125;\n\n    public function onReceive($serv, $fd, $reactor_id, $data)\n    &#123;\n        file_put_contents(&#39;runtime/log/hj212receive_&#39; . date(&quot;Ymd&quot;) . &#39;.log&#39;, date(&#39;Y-m-d H:i:s&#39;) . &quot;receive:  &quot; . $data . PHP_EOL, FILE_APPEND);\n\n        $tempdata = rtrim($data, &quot;\\r\\n&quot;);\n        $strlen = strlen($tempdata);\n        $endstr = substr($tempdata, $strlen - 6, 2);\n        $strartstr = substr($data, 0, 2);\n        if ($strartstr == &quot;##&quot; &amp;&amp; $endstr != &quot;&amp;&amp;&quot;) &#123;\n            $this-&gt;buffer = $data;\n            return;\n        &#125; else if ($strartstr != &quot;##&quot; &amp;&amp; $endstr == &quot;&amp;&amp;&quot; &amp;&amp; $this-&gt;buffer &amp;&amp; VerifyUtil::verifyCrc($this-&gt;buffer . $tempdata)) &#123;\n            $data = rtrim($this-&gt;buffer, &quot;\\r\\n&quot;) . $data;\n        &#125; else if ($strartstr != &quot;##&quot; &amp;&amp; $endstr == &quot;&amp;&amp;&quot; &amp;&amp; $this-&gt;buffer &amp;&amp; !VerifyUtil::verifyCrc($this-&gt;buffer . $tempdata)) &#123;\n            $this-&gt;buffer = rtrim($this-&gt;buffer, &quot;\\r\\n&quot;) . $tempdata;\n            return;\n        //##1715QN=20230727145559023;ST=32;CN=3020;PW=123456;MN=000102;Flag=5;CP=&amp;&amp;Data\n        &#125;else if($strartstr == &quot;##&quot; &amp;&amp; $endstr == &quot;&amp;&amp;&quot; &amp;&amp; !VerifyUtil::verifyCrc($this-&gt;buffer . $tempdata))&#123;\n            $this-&gt;buffer = $data;\n            return;\n        &#125;\n        $sourceData = $data;\n        $this-&gt;t212Parser-&gt;setReader($data);\n        $this-&gt;t212Parser-&gt;readHeader();\n        $dataLen = $this-&gt;t212Parser-&gt;readDataLen();\n        $data = $this-&gt;t212Parser-&gt;readDataAndCrc($dataLen);\n        $dataConverter = new DataConverter($data);\n        $insetdata = $dataConverter-&gt;convertData();\n        $insetdata[&#39;data_len&#39;] = $dataLen;\n        $insetdata[&#39;crc&#39;] = $this-&gt;t212Parser-&gt;readCrcInt16();\n        $insetdata[&#39;source_data&#39;] = $sourceData;\n        $cpData = $dataConverter-&gt;convertCpData();\n        //存在数据空的情况 ##0069QN=20230723080035006;ST=91;CN=9021;PW=123456;MN=000201;Flag=4;CP=&amp;&amp;&amp;&amp;BDC1\n        $insetdata[&#39;cp_datatime&#39;] = isset($cpData[&#39;cpData&#39;][&#39;datatime&#39;]) ? $cpData[&#39;cpData&#39;][&#39;datatime&#39;] : 0;\n        Db::startTrans();\n        try &#123;\n            $dataModel = new Data($insetdata);\n            $dataModel-&gt;save();\n            //            $pollutionModel = new Pollution();\n            //            foreach ($cpData[&#39;pollution&#39;] as $k =&gt; $val) &#123;\n            //                $pModel = clone $pollutionModel;\n            //                $val[&#39;data_id&#39;] = $dataModel-&gt;id;\n            //                $val[&#39;code&#39;] = $k;\n            //                $pModel-&gt;data($val);\n            //                $pModel-&gt;save();\n            //            &#125;\n            Db::commit();\n        &#125; catch (Exception $e) &#123;\n            Db::rollback();\n        &#125;\n        $str = &quot;QN=&#123;$insetdata[&#39;qn&#39;]&#125;;ST=91;CN=9014;PW=&#123;$insetdata[&#39;pw&#39;]&#125;;MN=&#123;$insetdata[&#39;mn&#39;]&#125;;Flag=4;CP=&amp;&amp;&amp;&amp;\\r\\n&quot;;\n        $num = strlen($str);\n        $newNum = str_pad($num, 4, &quot;0&quot;, STR_PAD_LEFT);\n        $resStr = &quot;##&quot; . $newNum . $str;\n        $this-&gt;buffer = &quot;&quot;;\n        $this-&gt;server-&gt;send($fd, $resStr);\n\n    &#125;\n\n    public function onClose($serv, $fd)\n    &#123;\n        echo &quot;connection close: &#123;$fd&#125;\\n&quot;;\n    &#125;\n\n    /**\n     * 同步任务\n     * $this-&gt;serv-&gt;taskwait($data); 触发\n     * @param $server\n     * @param $task_id\n     * @param $data\n     */\n    function onSyncTask($serv, $task_id, $from_id, $data)\n    &#123;\n        echo &quot;Sync task Callback: &quot; . $data;\n\n        $this-&gt;t212Parser-&gt;setReader($data);\n        $header = $this-&gt;t212Parser-&gt;readHeader();\n        $dataLen = $this-&gt;t212Parser-&gt;readDataLen();\n        $data = $this-&gt;t212Parser-&gt;readDataAndCrc($dataLen);\n        echo $data;\n\n        $result = $data;\n        // 通知完成\n        $this-&gt;server-&gt;finish($result);\n    &#125;\n\n    /**\n     * 异步任务\n     * $this-&gt;serv-&gt;task($data); 触发\n     * @param $server\n     * @param $task_id\n     * @param $data\n     */\n    function onAsynTask($serv, $task_id, $from_id, $data)\n    &#123;\n        echo &quot;Asyn task Callback: &quot;;\n        // 通知完成\n        $this-&gt;server-&gt;finish($data . &quot;cccccsssss&quot;);\n\n    &#125;\n\n    public function onFinish($serv, $task_id, $data)\n    &#123;\n        echo &quot;任务完成&quot;;//taskwait  不触发这个函数。。\n    &#125;\n\n    public function getIP()\n    &#123;\n        if (isset($_SERVER))&#123;\n            if (isset($_SERVER[&quot;HTTP_X_FORWARDED_FOR&quot;]))&#123;\n                $realip = $_SERVER[&quot;HTTP_X_FORWARDED_FOR&quot;];\n            &#125; else if (isset($_SERVER[&quot;HTTP_CLIENT_IP&quot;])) &#123;\n                $realip = $_SERVER[&quot;HTTP_CLIENT_IP&quot;];\n            &#125; else &#123;\n                $realip = isset($_SERVER[&quot;REMOTE_ADDR&quot;]) ? $_SERVER[&quot;REMOTE_ADDR&quot;] : &#39;127.0.0.1&#39;;\n            &#125;\n        &#125; else &#123;\n            if (getenv(&quot;HTTP_X_FORWARDED_FOR&quot;))&#123;\n                $realip = getenv(&quot;HTTP_X_FORWARDED_FOR&quot;);\n            &#125; else if (getenv(&quot;HTTP_CLIENT_IP&quot;)) &#123;\n                $realip = getenv(&quot;HTTP_CLIENT_IP&quot;);\n            &#125; else &#123;\n                $realip = getenv(&quot;REMOTE_ADDR&quot;);\n            &#125;\n        &#125;\n        return $realip;\n    &#125;\n\n&#125;\n</code></pre>\n"},{"title":"nginx-配置文件","abbrlink":"2bee8b90","date":"2023-07-27T06:17:43.000Z","_content":"# 一 、配置详解\n\n## 1.1nginx配置文件\n    #nginx 已那个用户身份访问文件\n    user  www;  \n    \n    #指定nginx使用的worker进程数\n    worker_processes 8;   \n    \n    #worker_cpu_affinity是一个用于配置工作进程CPU亲和性的选项。\n    #CPU亲和性是指将进程或线程绑定到特定的CPU核心上，以提高性能和效率。\n    #通常cpu几核，就配置几个\n    worker_cpu_affinity 0000001 00000010 00000011 00000100 00000101 00000110 00000111 00001000;\n    \n    #PID配置项是用于指定保存主进程ID的文件路径\n    pid        /var/run/nginx.pid;\n    \n    #用于限制每个worker进程可以打开的最大文件描述符数量。\n    #ulimit -n 查看系统文件句柄数   设置为系统允许的最大文件句柄数的 80% - 90%\n    worker_rlimit_nofile 65535;\n    \n    \n    #用于控制Nginx服务器的事件模型和并发处理方式。\n    events {\n        #用于设置每个worker进程的最大并发连接数 即每个worker进程可以同时处理的最大客户端连接数\n        worker_connections 1024;\n        \n        #常见的事件模型包括epoll、kqueue和select等。\n        use epoll;\n        \n        #用于指定是否允许一个worker进程同时接受多个新连接\n        multi_accept on;\n    }\n    \n    #用于代理TCP和UDP流量，允许将Nginx作为代理服务器来处理网络流量\n    #使用stream模块可以使Nginx具备代理TCP和UDP流量的能力\n    stream {\n           include /etc/nginx/stream/*.conf;\n    }\n    \n    #此模块用于配置HTTP服务器，允许主机作为Web服务器来处理HTTP请求\n    http {\n        #引入mime头文件  定义了Nginx的mime类型    \n        include       mime.types;\n        \n        #指令用于设置在请求无法匹配到任何MIME类型时的默认类型\n        default_type  application/octet-stream;\n        \n        #定义日志格式  main 为日志格式 名称\n        log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                          '$status $body_bytes_sent \"$http_referer\" '\n                          '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n                          \n        #定义访问日志路径 main 指用那个日志格式名称                  \n        access_log  /var/log/nginx/access.log  main;\n        \n        # 当将sendfile设置为on时，Nginx使用sendfile()系统调用来直接将文件从磁盘传输到网络，\n        # 而无需将文件数据复制到用户空间。这样可以显着提高文件传输速度和效率。\n        sendfile on;\n        \n        #将tcp_nopush设置为on时，Nginx会禁用TCP_CORK\n        #允许在nginx worker进程发送数据时立即将响应发送到客户端，而无需等待TCP缓冲区填满。\n        #将tcp_nopush设置为on可以提高响应的实时性，允许立即发送数据到客户端\n        tcp_nopush on;\n        \n        #将tcp_nodelay设置为on时，Nginx会打开TCP_NODELAY，这将禁用TCP的Nagle算法，\n        #以便在发送小数据包或有延迟要求的数据时能够及时发送数据。\n        #将tcp_nodelay设置为on可以减少TCP延迟，适用于实时性要求高的应用场景。\n        tcp_nodelay on;\n        \n        #隐藏Nginx版本号\n        server_tokens  off;    \n\n        proxy_hide_header X-Powered-By;\n        \n        proxy_hide_header Server;\n         \n        #配置空主机头 404 就是禁用http通过ip访问\n        \n        server {\n            listen 80 default_server;\n            server_name _;\n            return 444;\n        }\n        server {\n            listen 443 ssl default_server;\n            server_name _;\n            ssl on;\n            return 444;\n        }\n        \n        include /etc/nginx/conf.d/*.conf;\n    }\n    \n## 1.2log_format可用变量\n\n    $remote_addr：客户端的IP地址。\n    $remote_user：客户端的用户名称（如果有授权）。\n    $time_local：访问时间和日期（格式：[day/month/year:hour:minute:second zone]）。\n    $request_method：HTTP请求的方法（例如GET或POST）。\n    $request_uri：完整的请求URI。\n    $request_length：请求的长度（包括请求行，请求头和请求体）。\n    $status：HTTP响应的状态码。\n    $body_bytes_sent：发送给客户端的响应体的字节数。\n    $http_referer：请求中的“Referer”头部字段，包含了前一个页面的URL。\n    $http_user_agent：请求的用户代理头部字段，表示发起请求的客户端工具或库。\n## 1.3host配置文件\n    \n### upstream 模块    \n    #定义负载均衡\n    #放置在 http 或 server 块\n    upstream name {\n        \n         #用于指定上游服务器的地址和端口。可以指定多个server来定义多个上游服务器。\n         server backend1.example.com;\n         \n         #max_fails 和 fail_timeout：用于设置上游服务器的故障处理策略\n         #max_fails 指定在多少次失败请求后将服务器标记为不可用\n         #fail_timeout 指定在服务器被标记为不可用后，多长时间内不再尝试请求。\n         server 127.0.0.1:8080 max_fails=3 fail_timeout=30s;\n        \n        #设置与上游服务器的连接保持活动的时间。可以提高性能并减少连接建立的开销。\n        keepalive:32;\n\n    }\n\n    #weight：用于设置服务器的权重。权重越高，Nginx 转发给该服务器的请求越多。\n    #示例：\n    upstream backend {\n        server backend1.example.com weight=3;\n        server backend2.example.com weight=2;\n    }\n\n\n\n    #ip_hash：使用客户端的IP地址进行负载均衡，使得来自同一IP地址的请求始终被转发到同一台上游服务器。\n    #示例：\n    upstream backend {\n        ip_hash;\n        server backend1.example.com;\n        server backend2.example.com;\n    }\n    \n### Server模块\n    server：定义一个虚拟主机\n    server{\n        listen：指定服务器监听的端口\n        server_name：配置域名或IP地址\n        root：指定网站文件的根目录\n        index：定义当访问网站时默认显示的文件\n        location：定义请求的URL匹配规则和对应的处理方法。\n        proxy_pass：用于反向代理服务器的配置。\n        ssl_certificate和ssl_certificate_key：配置SSL/TLS证书。\n        try_files：定义文件检查规则\n        \n        gzip on;    将 Gzip 压缩功能开启。\n        \n        将所有类型的文件都进行 Gzip 压缩。这意味着无论是文本文件、图像文件还是视频文件，\n        都将进行压缩传输。如果你希望只压缩特定类型的文件，可以指定具体的文件类型，\n        例如 gzip_types text/plain text/css application/javascript;。\n        gzip_types *;\n       \n        (gzip_proxied on or gzip_proxied off or gzip_proxied expired no-cache no-store private auth) 指定需要压缩的响应类型，\n        并且设置允许或者不允许使用代理服务器进行压缩。any 表示无论何时都进行压缩。\n        gzip_proxied any;\n    }\n\n# 二、常用示例\n    \n## 2.1 mysql 代理示例    \n    stream {\n            server {\n                listen 63306;\n                proxy_connect_timeout 8s;\n                proxy_timeout 24h;\n                proxy_pass 192.168.0.108:3306;\n            }\n    }\n    \n    \n##  2.3 带upstream的写法  \n    upstream rd_servers {\n      server 127.0.0.1:5000;\n    }\n    \n    server{\n      server_tokens off;\n      listen 80;\n      server_name redash.xxxxx.com;\n      access_log /var/log/nginx/rd.access.log;\n    \n      gzip on;\n      gzip_types *;\n      gzip_proxied any;\n    \n      location / {\n        proxy_set_header Host $http_host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_pass       http://rd_servers;\n      }\n    }\n  \n\n  \n","source":"_posts/nginx-配置文件.md","raw":"---\ntitle: nginx-配置文件\nabbrlink: 2bee8b90\ncategories:\n  - 服务器相关\n  - nginx\ndate: 2023-07-27 14:17:43\ntags:\n---\n# 一 、配置详解\n\n## 1.1nginx配置文件\n    #nginx 已那个用户身份访问文件\n    user  www;  \n    \n    #指定nginx使用的worker进程数\n    worker_processes 8;   \n    \n    #worker_cpu_affinity是一个用于配置工作进程CPU亲和性的选项。\n    #CPU亲和性是指将进程或线程绑定到特定的CPU核心上，以提高性能和效率。\n    #通常cpu几核，就配置几个\n    worker_cpu_affinity 0000001 00000010 00000011 00000100 00000101 00000110 00000111 00001000;\n    \n    #PID配置项是用于指定保存主进程ID的文件路径\n    pid        /var/run/nginx.pid;\n    \n    #用于限制每个worker进程可以打开的最大文件描述符数量。\n    #ulimit -n 查看系统文件句柄数   设置为系统允许的最大文件句柄数的 80% - 90%\n    worker_rlimit_nofile 65535;\n    \n    \n    #用于控制Nginx服务器的事件模型和并发处理方式。\n    events {\n        #用于设置每个worker进程的最大并发连接数 即每个worker进程可以同时处理的最大客户端连接数\n        worker_connections 1024;\n        \n        #常见的事件模型包括epoll、kqueue和select等。\n        use epoll;\n        \n        #用于指定是否允许一个worker进程同时接受多个新连接\n        multi_accept on;\n    }\n    \n    #用于代理TCP和UDP流量，允许将Nginx作为代理服务器来处理网络流量\n    #使用stream模块可以使Nginx具备代理TCP和UDP流量的能力\n    stream {\n           include /etc/nginx/stream/*.conf;\n    }\n    \n    #此模块用于配置HTTP服务器，允许主机作为Web服务器来处理HTTP请求\n    http {\n        #引入mime头文件  定义了Nginx的mime类型    \n        include       mime.types;\n        \n        #指令用于设置在请求无法匹配到任何MIME类型时的默认类型\n        default_type  application/octet-stream;\n        \n        #定义日志格式  main 为日志格式 名称\n        log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                          '$status $body_bytes_sent \"$http_referer\" '\n                          '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n                          \n        #定义访问日志路径 main 指用那个日志格式名称                  \n        access_log  /var/log/nginx/access.log  main;\n        \n        # 当将sendfile设置为on时，Nginx使用sendfile()系统调用来直接将文件从磁盘传输到网络，\n        # 而无需将文件数据复制到用户空间。这样可以显着提高文件传输速度和效率。\n        sendfile on;\n        \n        #将tcp_nopush设置为on时，Nginx会禁用TCP_CORK\n        #允许在nginx worker进程发送数据时立即将响应发送到客户端，而无需等待TCP缓冲区填满。\n        #将tcp_nopush设置为on可以提高响应的实时性，允许立即发送数据到客户端\n        tcp_nopush on;\n        \n        #将tcp_nodelay设置为on时，Nginx会打开TCP_NODELAY，这将禁用TCP的Nagle算法，\n        #以便在发送小数据包或有延迟要求的数据时能够及时发送数据。\n        #将tcp_nodelay设置为on可以减少TCP延迟，适用于实时性要求高的应用场景。\n        tcp_nodelay on;\n        \n        #隐藏Nginx版本号\n        server_tokens  off;    \n\n        proxy_hide_header X-Powered-By;\n        \n        proxy_hide_header Server;\n         \n        #配置空主机头 404 就是禁用http通过ip访问\n        \n        server {\n            listen 80 default_server;\n            server_name _;\n            return 444;\n        }\n        server {\n            listen 443 ssl default_server;\n            server_name _;\n            ssl on;\n            return 444;\n        }\n        \n        include /etc/nginx/conf.d/*.conf;\n    }\n    \n## 1.2log_format可用变量\n\n    $remote_addr：客户端的IP地址。\n    $remote_user：客户端的用户名称（如果有授权）。\n    $time_local：访问时间和日期（格式：[day/month/year:hour:minute:second zone]）。\n    $request_method：HTTP请求的方法（例如GET或POST）。\n    $request_uri：完整的请求URI。\n    $request_length：请求的长度（包括请求行，请求头和请求体）。\n    $status：HTTP响应的状态码。\n    $body_bytes_sent：发送给客户端的响应体的字节数。\n    $http_referer：请求中的“Referer”头部字段，包含了前一个页面的URL。\n    $http_user_agent：请求的用户代理头部字段，表示发起请求的客户端工具或库。\n## 1.3host配置文件\n    \n### upstream 模块    \n    #定义负载均衡\n    #放置在 http 或 server 块\n    upstream name {\n        \n         #用于指定上游服务器的地址和端口。可以指定多个server来定义多个上游服务器。\n         server backend1.example.com;\n         \n         #max_fails 和 fail_timeout：用于设置上游服务器的故障处理策略\n         #max_fails 指定在多少次失败请求后将服务器标记为不可用\n         #fail_timeout 指定在服务器被标记为不可用后，多长时间内不再尝试请求。\n         server 127.0.0.1:8080 max_fails=3 fail_timeout=30s;\n        \n        #设置与上游服务器的连接保持活动的时间。可以提高性能并减少连接建立的开销。\n        keepalive:32;\n\n    }\n\n    #weight：用于设置服务器的权重。权重越高，Nginx 转发给该服务器的请求越多。\n    #示例：\n    upstream backend {\n        server backend1.example.com weight=3;\n        server backend2.example.com weight=2;\n    }\n\n\n\n    #ip_hash：使用客户端的IP地址进行负载均衡，使得来自同一IP地址的请求始终被转发到同一台上游服务器。\n    #示例：\n    upstream backend {\n        ip_hash;\n        server backend1.example.com;\n        server backend2.example.com;\n    }\n    \n### Server模块\n    server：定义一个虚拟主机\n    server{\n        listen：指定服务器监听的端口\n        server_name：配置域名或IP地址\n        root：指定网站文件的根目录\n        index：定义当访问网站时默认显示的文件\n        location：定义请求的URL匹配规则和对应的处理方法。\n        proxy_pass：用于反向代理服务器的配置。\n        ssl_certificate和ssl_certificate_key：配置SSL/TLS证书。\n        try_files：定义文件检查规则\n        \n        gzip on;    将 Gzip 压缩功能开启。\n        \n        将所有类型的文件都进行 Gzip 压缩。这意味着无论是文本文件、图像文件还是视频文件，\n        都将进行压缩传输。如果你希望只压缩特定类型的文件，可以指定具体的文件类型，\n        例如 gzip_types text/plain text/css application/javascript;。\n        gzip_types *;\n       \n        (gzip_proxied on or gzip_proxied off or gzip_proxied expired no-cache no-store private auth) 指定需要压缩的响应类型，\n        并且设置允许或者不允许使用代理服务器进行压缩。any 表示无论何时都进行压缩。\n        gzip_proxied any;\n    }\n\n# 二、常用示例\n    \n## 2.1 mysql 代理示例    \n    stream {\n            server {\n                listen 63306;\n                proxy_connect_timeout 8s;\n                proxy_timeout 24h;\n                proxy_pass 192.168.0.108:3306;\n            }\n    }\n    \n    \n##  2.3 带upstream的写法  \n    upstream rd_servers {\n      server 127.0.0.1:5000;\n    }\n    \n    server{\n      server_tokens off;\n      listen 80;\n      server_name redash.xxxxx.com;\n      access_log /var/log/nginx/rd.access.log;\n    \n      gzip on;\n      gzip_types *;\n      gzip_proxied any;\n    \n      location / {\n        proxy_set_header Host $http_host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_pass       http://rd_servers;\n      }\n    }\n  \n\n  \n","slug":"nginx-配置文件","published":1,"updated":"2024-11-25T11:23:19.386Z","_id":"cm04ukh7m00114koc47tredb9","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一-、配置详解\"><a href=\"#一-、配置详解\" class=\"headerlink\" title=\"一 、配置详解\"></a>一 、配置详解</h1><h2 id=\"1-1nginx配置文件\"><a href=\"#1-1nginx配置文件\" class=\"headerlink\" title=\"1.1nginx配置文件\"></a>1.1nginx配置文件</h2><pre><code>#nginx 已那个用户身份访问文件\nuser  www;  \n\n#指定nginx使用的worker进程数\nworker_processes 8;   \n\n#worker_cpu_affinity是一个用于配置工作进程CPU亲和性的选项。\n#CPU亲和性是指将进程或线程绑定到特定的CPU核心上，以提高性能和效率。\n#通常cpu几核，就配置几个\nworker_cpu_affinity 0000001 00000010 00000011 00000100 00000101 00000110 00000111 00001000;\n\n#PID配置项是用于指定保存主进程ID的文件路径\npid        /var/run/nginx.pid;\n\n#用于限制每个worker进程可以打开的最大文件描述符数量。\n#ulimit -n 查看系统文件句柄数   设置为系统允许的最大文件句柄数的 80% - 90%\nworker_rlimit_nofile 65535;\n\n\n#用于控制Nginx服务器的事件模型和并发处理方式。\nevents &#123;\n    #用于设置每个worker进程的最大并发连接数 即每个worker进程可以同时处理的最大客户端连接数\n    worker_connections 1024;\n    \n    #常见的事件模型包括epoll、kqueue和select等。\n    use epoll;\n    \n    #用于指定是否允许一个worker进程同时接受多个新连接\n    multi_accept on;\n&#125;\n\n#用于代理TCP和UDP流量，允许将Nginx作为代理服务器来处理网络流量\n#使用stream模块可以使Nginx具备代理TCP和UDP流量的能力\nstream &#123;\n       include /etc/nginx/stream/*.conf;\n&#125;\n\n#此模块用于配置HTTP服务器，允许主机作为Web服务器来处理HTTP请求\nhttp &#123;\n    #引入mime头文件  定义了Nginx的mime类型    \n    include       mime.types;\n    \n    #指令用于设置在请求无法匹配到任何MIME类型时的默认类型\n    default_type  application/octet-stream;\n    \n    #定义日志格式  main 为日志格式 名称\n    log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;\n                      &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;\n                      &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;\n                      \n    #定义访问日志路径 main 指用那个日志格式名称                  \n    access_log  /var/log/nginx/access.log  main;\n    \n    # 当将sendfile设置为on时，Nginx使用sendfile()系统调用来直接将文件从磁盘传输到网络，\n    # 而无需将文件数据复制到用户空间。这样可以显着提高文件传输速度和效率。\n    sendfile on;\n    \n    #将tcp_nopush设置为on时，Nginx会禁用TCP_CORK\n    #允许在nginx worker进程发送数据时立即将响应发送到客户端，而无需等待TCP缓冲区填满。\n    #将tcp_nopush设置为on可以提高响应的实时性，允许立即发送数据到客户端\n    tcp_nopush on;\n    \n    #将tcp_nodelay设置为on时，Nginx会打开TCP_NODELAY，这将禁用TCP的Nagle算法，\n    #以便在发送小数据包或有延迟要求的数据时能够及时发送数据。\n    #将tcp_nodelay设置为on可以减少TCP延迟，适用于实时性要求高的应用场景。\n    tcp_nodelay on;\n    \n    #隐藏Nginx版本号\n    server_tokens  off;    \n\n    proxy_hide_header X-Powered-By;\n    \n    proxy_hide_header Server;\n     \n    #配置空主机头 404 就是禁用http通过ip访问\n    \n    server &#123;\n        listen 80 default_server;\n        server_name _;\n        return 444;\n    &#125;\n    server &#123;\n        listen 443 ssl default_server;\n        server_name _;\n        ssl on;\n        return 444;\n    &#125;\n    \n    include /etc/nginx/conf.d/*.conf;\n&#125;\n</code></pre>\n<h2 id=\"1-2log-format可用变量\"><a href=\"#1-2log-format可用变量\" class=\"headerlink\" title=\"1.2log_format可用变量\"></a>1.2log_format可用变量</h2><pre><code>$remote_addr：客户端的IP地址。\n$remote_user：客户端的用户名称（如果有授权）。\n$time_local：访问时间和日期（格式：[day/month/year:hour:minute:second zone]）。\n$request_method：HTTP请求的方法（例如GET或POST）。\n$request_uri：完整的请求URI。\n$request_length：请求的长度（包括请求行，请求头和请求体）。\n$status：HTTP响应的状态码。\n$body_bytes_sent：发送给客户端的响应体的字节数。\n$http_referer：请求中的“Referer”头部字段，包含了前一个页面的URL。\n$http_user_agent：请求的用户代理头部字段，表示发起请求的客户端工具或库。\n</code></pre>\n<h2 id=\"1-3host配置文件\"><a href=\"#1-3host配置文件\" class=\"headerlink\" title=\"1.3host配置文件\"></a>1.3host配置文件</h2><h3 id=\"upstream-模块\"><a href=\"#upstream-模块\" class=\"headerlink\" title=\"upstream 模块\"></a>upstream 模块</h3><pre><code>#定义负载均衡\n#放置在 http 或 server 块\nupstream name &#123;\n    \n     #用于指定上游服务器的地址和端口。可以指定多个server来定义多个上游服务器。\n     server backend1.example.com;\n     \n     #max_fails 和 fail_timeout：用于设置上游服务器的故障处理策略\n     #max_fails 指定在多少次失败请求后将服务器标记为不可用\n     #fail_timeout 指定在服务器被标记为不可用后，多长时间内不再尝试请求。\n     server 127.0.0.1:8080 max_fails=3 fail_timeout=30s;\n    \n    #设置与上游服务器的连接保持活动的时间。可以提高性能并减少连接建立的开销。\n    keepalive:32;\n\n&#125;\n\n#weight：用于设置服务器的权重。权重越高，Nginx 转发给该服务器的请求越多。\n#示例：\nupstream backend &#123;\n    server backend1.example.com weight=3;\n    server backend2.example.com weight=2;\n&#125;\n\n\n\n#ip_hash：使用客户端的IP地址进行负载均衡，使得来自同一IP地址的请求始终被转发到同一台上游服务器。\n#示例：\nupstream backend &#123;\n    ip_hash;\n    server backend1.example.com;\n    server backend2.example.com;\n&#125;\n</code></pre>\n<h3 id=\"Server模块\"><a href=\"#Server模块\" class=\"headerlink\" title=\"Server模块\"></a>Server模块</h3><pre><code>server：定义一个虚拟主机\nserver&#123;\n    listen：指定服务器监听的端口\n    server_name：配置域名或IP地址\n    root：指定网站文件的根目录\n    index：定义当访问网站时默认显示的文件\n    location：定义请求的URL匹配规则和对应的处理方法。\n    proxy_pass：用于反向代理服务器的配置。\n    ssl_certificate和ssl_certificate_key：配置SSL/TLS证书。\n    try_files：定义文件检查规则\n    \n    gzip on;    将 Gzip 压缩功能开启。\n    \n    将所有类型的文件都进行 Gzip 压缩。这意味着无论是文本文件、图像文件还是视频文件，\n    都将进行压缩传输。如果你希望只压缩特定类型的文件，可以指定具体的文件类型，\n    例如 gzip_types text/plain text/css application/javascript;。\n    gzip_types *;\n   \n    (gzip_proxied on or gzip_proxied off or gzip_proxied expired no-cache no-store private auth) 指定需要压缩的响应类型，\n    并且设置允许或者不允许使用代理服务器进行压缩。any 表示无论何时都进行压缩。\n    gzip_proxied any;\n&#125;\n</code></pre>\n<h1 id=\"二、常用示例\"><a href=\"#二、常用示例\" class=\"headerlink\" title=\"二、常用示例\"></a>二、常用示例</h1><h2 id=\"2-1-mysql-代理示例\"><a href=\"#2-1-mysql-代理示例\" class=\"headerlink\" title=\"2.1 mysql 代理示例\"></a>2.1 mysql 代理示例</h2><pre><code>stream &#123;\n        server &#123;\n            listen 63306;\n            proxy_connect_timeout 8s;\n            proxy_timeout 24h;\n            proxy_pass 192.168.0.108:3306;\n        &#125;\n&#125;\n</code></pre>\n<h2 id=\"2-3-带upstream的写法\"><a href=\"#2-3-带upstream的写法\" class=\"headerlink\" title=\"2.3 带upstream的写法\"></a>2.3 带upstream的写法</h2><pre><code>upstream rd_servers &#123;\n  server 127.0.0.1:5000;\n&#125;\n\nserver&#123;\n  server_tokens off;\n  listen 80;\n  server_name redash.xxxxx.com;\n  access_log /var/log/nginx/rd.access.log;\n\n  gzip on;\n  gzip_types *;\n  gzip_proxied any;\n\n  location / &#123;\n    proxy_set_header Host $http_host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n    proxy_pass       http://rd_servers;\n  &#125;\n&#125;\n</code></pre>\n","site":{"data":{}},"length":3942,"excerpt":"","more":"<h1 id=\"一-、配置详解\"><a href=\"#一-、配置详解\" class=\"headerlink\" title=\"一 、配置详解\"></a>一 、配置详解</h1><h2 id=\"1-1nginx配置文件\"><a href=\"#1-1nginx配置文件\" class=\"headerlink\" title=\"1.1nginx配置文件\"></a>1.1nginx配置文件</h2><pre><code>#nginx 已那个用户身份访问文件\nuser  www;  \n\n#指定nginx使用的worker进程数\nworker_processes 8;   \n\n#worker_cpu_affinity是一个用于配置工作进程CPU亲和性的选项。\n#CPU亲和性是指将进程或线程绑定到特定的CPU核心上，以提高性能和效率。\n#通常cpu几核，就配置几个\nworker_cpu_affinity 0000001 00000010 00000011 00000100 00000101 00000110 00000111 00001000;\n\n#PID配置项是用于指定保存主进程ID的文件路径\npid        /var/run/nginx.pid;\n\n#用于限制每个worker进程可以打开的最大文件描述符数量。\n#ulimit -n 查看系统文件句柄数   设置为系统允许的最大文件句柄数的 80% - 90%\nworker_rlimit_nofile 65535;\n\n\n#用于控制Nginx服务器的事件模型和并发处理方式。\nevents &#123;\n    #用于设置每个worker进程的最大并发连接数 即每个worker进程可以同时处理的最大客户端连接数\n    worker_connections 1024;\n    \n    #常见的事件模型包括epoll、kqueue和select等。\n    use epoll;\n    \n    #用于指定是否允许一个worker进程同时接受多个新连接\n    multi_accept on;\n&#125;\n\n#用于代理TCP和UDP流量，允许将Nginx作为代理服务器来处理网络流量\n#使用stream模块可以使Nginx具备代理TCP和UDP流量的能力\nstream &#123;\n       include /etc/nginx/stream/*.conf;\n&#125;\n\n#此模块用于配置HTTP服务器，允许主机作为Web服务器来处理HTTP请求\nhttp &#123;\n    #引入mime头文件  定义了Nginx的mime类型    \n    include       mime.types;\n    \n    #指令用于设置在请求无法匹配到任何MIME类型时的默认类型\n    default_type  application/octet-stream;\n    \n    #定义日志格式  main 为日志格式 名称\n    log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;\n                      &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;\n                      &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;\n                      \n    #定义访问日志路径 main 指用那个日志格式名称                  \n    access_log  /var/log/nginx/access.log  main;\n    \n    # 当将sendfile设置为on时，Nginx使用sendfile()系统调用来直接将文件从磁盘传输到网络，\n    # 而无需将文件数据复制到用户空间。这样可以显着提高文件传输速度和效率。\n    sendfile on;\n    \n    #将tcp_nopush设置为on时，Nginx会禁用TCP_CORK\n    #允许在nginx worker进程发送数据时立即将响应发送到客户端，而无需等待TCP缓冲区填满。\n    #将tcp_nopush设置为on可以提高响应的实时性，允许立即发送数据到客户端\n    tcp_nopush on;\n    \n    #将tcp_nodelay设置为on时，Nginx会打开TCP_NODELAY，这将禁用TCP的Nagle算法，\n    #以便在发送小数据包或有延迟要求的数据时能够及时发送数据。\n    #将tcp_nodelay设置为on可以减少TCP延迟，适用于实时性要求高的应用场景。\n    tcp_nodelay on;\n    \n    #隐藏Nginx版本号\n    server_tokens  off;    \n\n    proxy_hide_header X-Powered-By;\n    \n    proxy_hide_header Server;\n     \n    #配置空主机头 404 就是禁用http通过ip访问\n    \n    server &#123;\n        listen 80 default_server;\n        server_name _;\n        return 444;\n    &#125;\n    server &#123;\n        listen 443 ssl default_server;\n        server_name _;\n        ssl on;\n        return 444;\n    &#125;\n    \n    include /etc/nginx/conf.d/*.conf;\n&#125;\n</code></pre>\n<h2 id=\"1-2log-format可用变量\"><a href=\"#1-2log-format可用变量\" class=\"headerlink\" title=\"1.2log_format可用变量\"></a>1.2log_format可用变量</h2><pre><code>$remote_addr：客户端的IP地址。\n$remote_user：客户端的用户名称（如果有授权）。\n$time_local：访问时间和日期（格式：[day/month/year:hour:minute:second zone]）。\n$request_method：HTTP请求的方法（例如GET或POST）。\n$request_uri：完整的请求URI。\n$request_length：请求的长度（包括请求行，请求头和请求体）。\n$status：HTTP响应的状态码。\n$body_bytes_sent：发送给客户端的响应体的字节数。\n$http_referer：请求中的“Referer”头部字段，包含了前一个页面的URL。\n$http_user_agent：请求的用户代理头部字段，表示发起请求的客户端工具或库。\n</code></pre>\n<h2 id=\"1-3host配置文件\"><a href=\"#1-3host配置文件\" class=\"headerlink\" title=\"1.3host配置文件\"></a>1.3host配置文件</h2><h3 id=\"upstream-模块\"><a href=\"#upstream-模块\" class=\"headerlink\" title=\"upstream 模块\"></a>upstream 模块</h3><pre><code>#定义负载均衡\n#放置在 http 或 server 块\nupstream name &#123;\n    \n     #用于指定上游服务器的地址和端口。可以指定多个server来定义多个上游服务器。\n     server backend1.example.com;\n     \n     #max_fails 和 fail_timeout：用于设置上游服务器的故障处理策略\n     #max_fails 指定在多少次失败请求后将服务器标记为不可用\n     #fail_timeout 指定在服务器被标记为不可用后，多长时间内不再尝试请求。\n     server 127.0.0.1:8080 max_fails=3 fail_timeout=30s;\n    \n    #设置与上游服务器的连接保持活动的时间。可以提高性能并减少连接建立的开销。\n    keepalive:32;\n\n&#125;\n\n#weight：用于设置服务器的权重。权重越高，Nginx 转发给该服务器的请求越多。\n#示例：\nupstream backend &#123;\n    server backend1.example.com weight=3;\n    server backend2.example.com weight=2;\n&#125;\n\n\n\n#ip_hash：使用客户端的IP地址进行负载均衡，使得来自同一IP地址的请求始终被转发到同一台上游服务器。\n#示例：\nupstream backend &#123;\n    ip_hash;\n    server backend1.example.com;\n    server backend2.example.com;\n&#125;\n</code></pre>\n<h3 id=\"Server模块\"><a href=\"#Server模块\" class=\"headerlink\" title=\"Server模块\"></a>Server模块</h3><pre><code>server：定义一个虚拟主机\nserver&#123;\n    listen：指定服务器监听的端口\n    server_name：配置域名或IP地址\n    root：指定网站文件的根目录\n    index：定义当访问网站时默认显示的文件\n    location：定义请求的URL匹配规则和对应的处理方法。\n    proxy_pass：用于反向代理服务器的配置。\n    ssl_certificate和ssl_certificate_key：配置SSL/TLS证书。\n    try_files：定义文件检查规则\n    \n    gzip on;    将 Gzip 压缩功能开启。\n    \n    将所有类型的文件都进行 Gzip 压缩。这意味着无论是文本文件、图像文件还是视频文件，\n    都将进行压缩传输。如果你希望只压缩特定类型的文件，可以指定具体的文件类型，\n    例如 gzip_types text/plain text/css application/javascript;。\n    gzip_types *;\n   \n    (gzip_proxied on or gzip_proxied off or gzip_proxied expired no-cache no-store private auth) 指定需要压缩的响应类型，\n    并且设置允许或者不允许使用代理服务器进行压缩。any 表示无论何时都进行压缩。\n    gzip_proxied any;\n&#125;\n</code></pre>\n<h1 id=\"二、常用示例\"><a href=\"#二、常用示例\" class=\"headerlink\" title=\"二、常用示例\"></a>二、常用示例</h1><h2 id=\"2-1-mysql-代理示例\"><a href=\"#2-1-mysql-代理示例\" class=\"headerlink\" title=\"2.1 mysql 代理示例\"></a>2.1 mysql 代理示例</h2><pre><code>stream &#123;\n        server &#123;\n            listen 63306;\n            proxy_connect_timeout 8s;\n            proxy_timeout 24h;\n            proxy_pass 192.168.0.108:3306;\n        &#125;\n&#125;\n</code></pre>\n<h2 id=\"2-3-带upstream的写法\"><a href=\"#2-3-带upstream的写法\" class=\"headerlink\" title=\"2.3 带upstream的写法\"></a>2.3 带upstream的写法</h2><pre><code>upstream rd_servers &#123;\n  server 127.0.0.1:5000;\n&#125;\n\nserver&#123;\n  server_tokens off;\n  listen 80;\n  server_name redash.xxxxx.com;\n  access_log /var/log/nginx/rd.access.log;\n\n  gzip on;\n  gzip_types *;\n  gzip_proxied any;\n\n  location / &#123;\n    proxy_set_header Host $http_host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n    proxy_pass       http://rd_servers;\n  &#125;\n&#125;\n</code></pre>\n"},{"title":"php开发-laravel中的服务容器","abbrlink":"b61a700f","date":"2024-08-16T07:18:09.000Z","_content":"","source":"_posts/php开发-laravel中的服务容器.md","raw":"---\ntitle: php开发-laravel中的服务容器\nabbrlink: b61a700f\ndate: 2024-08-16 15:18:09\ntags: laravel\ncategories:\n  - PHP开发\n---\n","slug":"php开发-laravel中的服务容器","published":1,"updated":"2024-10-18T06:04:10.398Z","_id":"cm04ukh7t00144koc1h5oh3nb","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"php开发-laravel源码学习2","abbrlink":"35967ec2","date":"2023-03-14T03:59:07.000Z","_content":"\n#laravel 核心文件applications\n","source":"_posts/php开发-laravel源码学习2.md","raw":"---\ntitle: php开发-laravel源码学习2\ntags: laravel\ncategories:\n  - PHP开发\nabbrlink: 35967ec2\ndate: 2023-03-14 11:59:07\n---\n\n#laravel 核心文件applications\n","slug":"php开发-laravel源码学习2","published":1,"updated":"2024-06-29T01:34:06.859Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm04ukh8600174kocdmavcyhv","content":"<p>#laravel 核心文件applications</p>\n","site":{"data":{}},"length":24,"excerpt":"","more":"<p>#laravel 核心文件applications</p>\n"},{"title":"session和cookie","abbrlink":"2af5ddcd","date":"2023-07-21T08:25:34.000Z","_content":"","source":"_posts/php开发-session和cookie.md","raw":"---\ntitle: session和cookie\nabbrlink: 2af5ddcd\ndate: 2023-07-21 16:25:34\ncategories:\n  - PHP开发\ntags:\n---\n","slug":"php开发-session和cookie","published":1,"updated":"2024-11-25T11:35:16.471Z","_id":"cm04ukh8800194kocg1dx4u04","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"php开发-laravel学习1","abbrlink":"f00cf8de","date":"2023-03-14T03:45:11.000Z","_content":"\n\n# public/index.php文件解析\n\n```\n# 引入自动加载文件\nrequire __DIR__.'/../bootstrap/autoload.php';\n\n/*\n|--------------------------------------------------------------------------\n| Turn On The Lights\n|--------------------------------------------------------------------------\n|\n| We need to illuminate PHP development, so let us turn on the lights.\n| This bootstraps the framework and gets it ready for use, then it\n| will load up this application so that we can run it and send\n| the responses back to the browser and delight our users.\n|\n*/\n\n$app = require_once __DIR__.'/../bootstrap/app.php';\n\n/*\n|--------------------------------------------------------------------------\n| Run The Application\n|--------------------------------------------------------------------------\n|\n| Once we have the application, we can handle the incoming request\n| through the kernel, and send the associated response back to\n| the client's browser allowing them to enjoy the creative\n| and wonderful application we have prepared for them.\n|\n*/\n\n$kernel = $app->make(Illuminate\\Contracts\\Http\\Kernel::class);\n\n$response = $kernel->handle(\n    $request = Illuminate\\Http\\Request::capture()\n);\n\n$response->send();\n\n$kernel->terminate($request, $response);\n```\n\n\n# /bootstrap/autoload.php文件解析\n\n```\n<?php\n\n#定义记录时间的常量\ndefine('LARAVEL_START', microtime(true));\n\n/*\n|--------------------------------------------------------------------------\n| Register The Composer Auto Loader\n|--------------------------------------------------------------------------\n|\n| Composer provides a convenient, automatically generated class loader\n| for our application. We just need to utilize it! We'll require it\n| into the script here so that we do not have to worry about the\n| loading of any our classes \"manually\". Feels great to relax.\n|\n*/\n#引入外部库   自动加载文件\nrequire __DIR__.'/../vendor/autoload.php';\n\n/*\n|--------------------------------------------------------------------------\n| Include The Compiled Class File\n|--------------------------------------------------------------------------\n|\n| To dramatically increase your application's performance, you may use a\n| compiled class file which contains all of the classes commonly used\n| by a request. The Artisan \"optimize\" is used to create this file.\n|\n*/\n#引入laravel缓存文件\n$compiledPath = __DIR__.'/cache/compiled.php';\n\nif (file_exists($compiledPath)) {\n    require $compiledPath;\n}\n```\n","source":"_posts/php开发-laravel源码学习1.md","raw":"---\ntitle: php开发-laravel学习1\ntags: laravel\ncategories:\n  - PHP开发\nabbrlink: f00cf8de\ndate: 2023-03-14 11:45:11\n---\n\n\n# public/index.php文件解析\n\n```\n# 引入自动加载文件\nrequire __DIR__.'/../bootstrap/autoload.php';\n\n/*\n|--------------------------------------------------------------------------\n| Turn On The Lights\n|--------------------------------------------------------------------------\n|\n| We need to illuminate PHP development, so let us turn on the lights.\n| This bootstraps the framework and gets it ready for use, then it\n| will load up this application so that we can run it and send\n| the responses back to the browser and delight our users.\n|\n*/\n\n$app = require_once __DIR__.'/../bootstrap/app.php';\n\n/*\n|--------------------------------------------------------------------------\n| Run The Application\n|--------------------------------------------------------------------------\n|\n| Once we have the application, we can handle the incoming request\n| through the kernel, and send the associated response back to\n| the client's browser allowing them to enjoy the creative\n| and wonderful application we have prepared for them.\n|\n*/\n\n$kernel = $app->make(Illuminate\\Contracts\\Http\\Kernel::class);\n\n$response = $kernel->handle(\n    $request = Illuminate\\Http\\Request::capture()\n);\n\n$response->send();\n\n$kernel->terminate($request, $response);\n```\n\n\n# /bootstrap/autoload.php文件解析\n\n```\n<?php\n\n#定义记录时间的常量\ndefine('LARAVEL_START', microtime(true));\n\n/*\n|--------------------------------------------------------------------------\n| Register The Composer Auto Loader\n|--------------------------------------------------------------------------\n|\n| Composer provides a convenient, automatically generated class loader\n| for our application. We just need to utilize it! We'll require it\n| into the script here so that we do not have to worry about the\n| loading of any our classes \"manually\". Feels great to relax.\n|\n*/\n#引入外部库   自动加载文件\nrequire __DIR__.'/../vendor/autoload.php';\n\n/*\n|--------------------------------------------------------------------------\n| Include The Compiled Class File\n|--------------------------------------------------------------------------\n|\n| To dramatically increase your application's performance, you may use a\n| compiled class file which contains all of the classes commonly used\n| by a request. The Artisan \"optimize\" is used to create this file.\n|\n*/\n#引入laravel缓存文件\n$compiledPath = __DIR__.'/cache/compiled.php';\n\nif (file_exists($compiledPath)) {\n    require $compiledPath;\n}\n```\n","slug":"php开发-laravel源码学习1","published":1,"updated":"2024-06-29T01:34:06.858Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm04ukh89001b4koc97f8eyte","content":"<h1 id=\"public-index-php文件解析\"><a href=\"#public-index-php文件解析\" class=\"headerlink\" title=\"public/index.php文件解析\"></a>public/index.php文件解析</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 引入自动加载文件</span><br><span class=\"line\">require __DIR__.&#x27;/../bootstrap/autoload.php&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">| Turn On The Lights</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">|</span><br><span class=\"line\">| We need to illuminate PHP development, so let us turn on the lights.</span><br><span class=\"line\">| This bootstraps the framework and gets it ready for use, then it</span><br><span class=\"line\">| will load up this application so that we can run it and send</span><br><span class=\"line\">| the responses back to the browser and delight our users.</span><br><span class=\"line\">|</span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">$app = require_once __DIR__.&#x27;/../bootstrap/app.php&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">| Run The Application</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">|</span><br><span class=\"line\">| Once we have the application, we can handle the incoming request</span><br><span class=\"line\">| through the kernel, and send the associated response back to</span><br><span class=\"line\">| the client&#x27;s browser allowing them to enjoy the creative</span><br><span class=\"line\">| and wonderful application we have prepared for them.</span><br><span class=\"line\">|</span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">$kernel = $app-&gt;make(Illuminate\\Contracts\\Http\\Kernel::class);</span><br><span class=\"line\"></span><br><span class=\"line\">$response = $kernel-&gt;handle(</span><br><span class=\"line\">    $request = Illuminate\\Http\\Request::capture()</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\">$response-&gt;send();</span><br><span class=\"line\"></span><br><span class=\"line\">$kernel-&gt;terminate($request, $response);</span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"bootstrap-autoload-php文件解析\"><a href=\"#bootstrap-autoload-php文件解析\" class=\"headerlink\" title=\"/bootstrap/autoload.php文件解析\"></a>/bootstrap/autoload.php文件解析</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">#定义记录时间的常量</span><br><span class=\"line\">define(&#x27;LARAVEL_START&#x27;, microtime(true));</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">| Register The Composer Auto Loader</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">|</span><br><span class=\"line\">| Composer provides a convenient, automatically generated class loader</span><br><span class=\"line\">| for our application. We just need to utilize it! We&#x27;ll require it</span><br><span class=\"line\">| into the script here so that we do not have to worry about the</span><br><span class=\"line\">| loading of any our classes &quot;manually&quot;. Feels great to relax.</span><br><span class=\"line\">|</span><br><span class=\"line\">*/</span><br><span class=\"line\">#引入外部库   自动加载文件</span><br><span class=\"line\">require __DIR__.&#x27;/../vendor/autoload.php&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">| Include The Compiled Class File</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">|</span><br><span class=\"line\">| To dramatically increase your application&#x27;s performance, you may use a</span><br><span class=\"line\">| compiled class file which contains all of the classes commonly used</span><br><span class=\"line\">| by a request. The Artisan &quot;optimize&quot; is used to create this file.</span><br><span class=\"line\">|</span><br><span class=\"line\">*/</span><br><span class=\"line\">#引入laravel缓存文件</span><br><span class=\"line\">$compiledPath = __DIR__.&#x27;/cache/compiled.php&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">if (file_exists($compiledPath)) &#123;</span><br><span class=\"line\">    require $compiledPath;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"length":2314,"excerpt":"","more":"<h1 id=\"public-index-php文件解析\"><a href=\"#public-index-php文件解析\" class=\"headerlink\" title=\"public/index.php文件解析\"></a>public/index.php文件解析</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 引入自动加载文件</span><br><span class=\"line\">require __DIR__.&#x27;/../bootstrap/autoload.php&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">| Turn On The Lights</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">|</span><br><span class=\"line\">| We need to illuminate PHP development, so let us turn on the lights.</span><br><span class=\"line\">| This bootstraps the framework and gets it ready for use, then it</span><br><span class=\"line\">| will load up this application so that we can run it and send</span><br><span class=\"line\">| the responses back to the browser and delight our users.</span><br><span class=\"line\">|</span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">$app = require_once __DIR__.&#x27;/../bootstrap/app.php&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">| Run The Application</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">|</span><br><span class=\"line\">| Once we have the application, we can handle the incoming request</span><br><span class=\"line\">| through the kernel, and send the associated response back to</span><br><span class=\"line\">| the client&#x27;s browser allowing them to enjoy the creative</span><br><span class=\"line\">| and wonderful application we have prepared for them.</span><br><span class=\"line\">|</span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">$kernel = $app-&gt;make(Illuminate\\Contracts\\Http\\Kernel::class);</span><br><span class=\"line\"></span><br><span class=\"line\">$response = $kernel-&gt;handle(</span><br><span class=\"line\">    $request = Illuminate\\Http\\Request::capture()</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\">$response-&gt;send();</span><br><span class=\"line\"></span><br><span class=\"line\">$kernel-&gt;terminate($request, $response);</span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"bootstrap-autoload-php文件解析\"><a href=\"#bootstrap-autoload-php文件解析\" class=\"headerlink\" title=\"/bootstrap/autoload.php文件解析\"></a>/bootstrap/autoload.php文件解析</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">#定义记录时间的常量</span><br><span class=\"line\">define(&#x27;LARAVEL_START&#x27;, microtime(true));</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">| Register The Composer Auto Loader</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">|</span><br><span class=\"line\">| Composer provides a convenient, automatically generated class loader</span><br><span class=\"line\">| for our application. We just need to utilize it! We&#x27;ll require it</span><br><span class=\"line\">| into the script here so that we do not have to worry about the</span><br><span class=\"line\">| loading of any our classes &quot;manually&quot;. Feels great to relax.</span><br><span class=\"line\">|</span><br><span class=\"line\">*/</span><br><span class=\"line\">#引入外部库   自动加载文件</span><br><span class=\"line\">require __DIR__.&#x27;/../vendor/autoload.php&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">| Include The Compiled Class File</span><br><span class=\"line\">|--------------------------------------------------------------------------</span><br><span class=\"line\">|</span><br><span class=\"line\">| To dramatically increase your application&#x27;s performance, you may use a</span><br><span class=\"line\">| compiled class file which contains all of the classes commonly used</span><br><span class=\"line\">| by a request. The Artisan &quot;optimize&quot; is used to create this file.</span><br><span class=\"line\">|</span><br><span class=\"line\">*/</span><br><span class=\"line\">#引入laravel缓存文件</span><br><span class=\"line\">$compiledPath = __DIR__.&#x27;/cache/compiled.php&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">if (file_exists($compiledPath)) &#123;</span><br><span class=\"line\">    require $compiledPath;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"php开发-设计模式之容器(container)","abbrlink":"aa1b125a","date":"2024-08-15T11:58:22.000Z","_content":"\n# 控制反转(IOC)\n\n 含义：原来由人为（程序员）修改代码 控制流程，反转为由程序【框架】去控制\n 控制反转(Inversion of Control) 是一种设计思想\n\n\n没反转的情况(正转)\n```php\n class Application {\n      \n      public function commit($supplierName)\n      {\n         // 去判断需要用哪个上游供应商，然后实例化\n         if($supplierName == \"pushang\"){\n            $supplier = new PuShangSupplier(); \n            $supplier->commit();\n         }\n         \n      }\n     \n    }\n```\n\n反转后的情况（反转）\n```php\n    abstract class Supplier {\n      \n       abstract function commit();\n    }\n    \n    class PuShangSupplier extend Supplier\n    {\n        public function commit()\n        {\n            // 逻辑\n        }\n    }\n    \n    class Application {\n      \n      public function commit(Supplier $supplier)\n      {\n        $supplier->commit();\n      }\n     \n    }\n    $app = new Application();\n    $app->commit(new PuShangSupplier());\n```\n\n# 依赖注入(DI) \n\n依赖注入 是一种设计模式\n依赖注入是控制反转的一种实现方式/方法\n也就是依赖注入 实现了  控制反转\n\n依赖注入方式 1、构造方法注入；2、set属性注入__set；3、静态工厂方法注入；\n\n一旦换了平台，就要修改构造函数 即使你传参数 构造判断使用哪个类，新增了平台，你还有去修改A类构造方法\n```php\nclass A{\n    public $ob;\n    public function __construct(C $c){\n        $this->ob = new Aly();\n      //  $this->ob = new Txy();\n    }\n    \n    public function send(){\n        $this->ob->send();\n    }\n}\n// 实现阿里云\nclass Aly{}\n// 实现腾讯云\nclass Txy{}\n\n$a = new A();\n$a->send();\n```\n\n\n\n\n\n通过构造函数注入 依赖\n```php\nclass A{\n    public $ob;\n    public function __construct(C $c){\n        $this->ob = $c;\n    }\n    \n    public function send(){\n        $this->ob->send();\n    }\n}\nclass Aly{\n// 实现阿里云发送短信类\n}\n$notice = new A(new Aly());\n$notice->send();\n```\n\n# IoC容器\n\n将依赖的对象注入到容器中\n当需要某个对象的时候，就直接获取，不必关注其实例化需要些什么，容器自动实例化了\n运行时容器会自动解析依赖（存在子依赖也可以自动解析）\n\n ```php\n<?php\nclass Container\n{\n    public $i=1;\n    private $s = array();\n    public function __set($k, $c)\n    {\n        $this->s[$k] = $c;\n    }\n    public function __get($k)\n    {\n        return $this->build($this->s[$k]);\n    }\n    /**\n     * 自动绑定（Autowiring）自动解析（Automatic Resolution）\n     *\n     * @param string $className\n     * @return object\n     * @throws Exception\n     */\n    public function build($className)\n    {\n        // 如果是匿名函数（Anonymous functions），也叫闭包函数（closures）\n        if ($className instanceof Closure) {\n//            var_dump($className);exit;\n            // 执行闭包函数，并将结果\n            return $className($this);\n        }\n        /*通过反射获取类的内部结构，实例化类*/\n        $reflector = new ReflectionClass($className);\n        // 检查类是否可实例化, 排除抽象类abstract和对象接口interface\n        if (!$reflector->isInstantiable()) {\n            throw new Exception(\"Can't instantiate this.\");\n        }\n        /** @var ReflectionMethod $constructor 获取类的构造函数 */\n        $constructor = $reflector->getConstructor();\n        // 若无构造函数，直接实例化并返回\n        if (is_null($constructor)) {\n            return new $className;\n        }\n        // 取构造函数参数,通过 ReflectionParameter 数组返回参数列表\n        $parameters = $constructor->getParameters();\n\n        // 递归解析构造函数的参数\n        $dependencies = $this->getDependencies($parameters);\n        // 创建一个类的新实例，给出的参数将传递到类的构造函数。\n        return $reflector->newInstanceArgs($dependencies);\n    }\n    /**\n     * @param array $parameters\n     * @return array\n     * @throws Exception\n     */\n    public function getDependencies($parameters)\n    {\n        $dependencies = [];\n        /** @var ReflectionParameter $parameter */\n        foreach ($parameters as $parameter) {\n            /** @var ReflectionClass $dependency */\n            $dependency = $parameter->getClass();\n            if (is_null($dependency)) {\n                // 是变量,有默认值则设置默认值\n                $dependencies[] = $this->resolveNonClass($parameter);\n            } else {\n                // 是一个类，递归解析\n                $dependencies[] = $this->build($dependency->name);\n            }\n        }\n        return $dependencies;\n    }\n    /**\n     * @param ReflectionParameter $parameter\n     * @return mixed\n     * @throws Exception\n     */\n    public function resolveNonClass($parameter)\n    {\n        // 有默认值则返回默认值\n        if ($parameter->isDefaultValueAvailable()) {\n            return $parameter->getDefaultValue();\n        }\n        throw new Exception('I have no idea what to do here.');\n    }\n}\nrequire_once \"./testclass.php\"; //开始测试，先测试已知依赖关系的情况\n$c = new Container();\n$c->department = 'Department';// 赋值类名 或 匿名函数\n$c->company = function ($c) {\n    return new Company($c->department);\n};\n// 从容器中取得company\n$company = $c->company;\n$company->doSomething(); //输出: Group:hello|Department:hello|Company:hello|\n\n\n// 测试未知依赖关系，直接使用的方法\n$di = new Container();\n$di->company = 'Company';// 赋值类名 或 匿名函数\n$company = $di->company;\n$company->doSomething();//输出: Group:hello|Department:hello|Company:hello|\n\n```\n\n```php\n<?php //依赖关系：Company->Department->Group\nclass Group\n{\n    public function doSomething()\n    {\n        echo __CLASS__.\":\".'hello', '|';\n    }\n}\nclass Department\n{\n    private $group;\n    public function __construct(Group $group)\n    {\n        $this->group = $group;\n    }\n    public function doSomething()\n    {\n        $this->group->doSomething();\n        echo __CLASS__.\":\".'hello', '|';\n    }\n}\nclass Company\n{\n    private $department;\n    public function __construct(Department $department)\n    {\n        $this->department = $department;\n    }\n    public function doSomething()\n    {\n        $this->department->doSomething();\n        echo __CLASS__.\":\".'hello', '|';\n    }\n}\n```\n\n\n\n\n\n","source":"_posts/php开发-设计模式之容器(container).md","raw":"---\ntitle: php开发-设计模式之容器(container)\nabbrlink: aa1b125a\ndate: 2024-08-15 19:58:22\ntags:\ncategories:\n  - PHP开发\n---\n\n# 控制反转(IOC)\n\n 含义：原来由人为（程序员）修改代码 控制流程，反转为由程序【框架】去控制\n 控制反转(Inversion of Control) 是一种设计思想\n\n\n没反转的情况(正转)\n```php\n class Application {\n      \n      public function commit($supplierName)\n      {\n         // 去判断需要用哪个上游供应商，然后实例化\n         if($supplierName == \"pushang\"){\n            $supplier = new PuShangSupplier(); \n            $supplier->commit();\n         }\n         \n      }\n     \n    }\n```\n\n反转后的情况（反转）\n```php\n    abstract class Supplier {\n      \n       abstract function commit();\n    }\n    \n    class PuShangSupplier extend Supplier\n    {\n        public function commit()\n        {\n            // 逻辑\n        }\n    }\n    \n    class Application {\n      \n      public function commit(Supplier $supplier)\n      {\n        $supplier->commit();\n      }\n     \n    }\n    $app = new Application();\n    $app->commit(new PuShangSupplier());\n```\n\n# 依赖注入(DI) \n\n依赖注入 是一种设计模式\n依赖注入是控制反转的一种实现方式/方法\n也就是依赖注入 实现了  控制反转\n\n依赖注入方式 1、构造方法注入；2、set属性注入__set；3、静态工厂方法注入；\n\n一旦换了平台，就要修改构造函数 即使你传参数 构造判断使用哪个类，新增了平台，你还有去修改A类构造方法\n```php\nclass A{\n    public $ob;\n    public function __construct(C $c){\n        $this->ob = new Aly();\n      //  $this->ob = new Txy();\n    }\n    \n    public function send(){\n        $this->ob->send();\n    }\n}\n// 实现阿里云\nclass Aly{}\n// 实现腾讯云\nclass Txy{}\n\n$a = new A();\n$a->send();\n```\n\n\n\n\n\n通过构造函数注入 依赖\n```php\nclass A{\n    public $ob;\n    public function __construct(C $c){\n        $this->ob = $c;\n    }\n    \n    public function send(){\n        $this->ob->send();\n    }\n}\nclass Aly{\n// 实现阿里云发送短信类\n}\n$notice = new A(new Aly());\n$notice->send();\n```\n\n# IoC容器\n\n将依赖的对象注入到容器中\n当需要某个对象的时候，就直接获取，不必关注其实例化需要些什么，容器自动实例化了\n运行时容器会自动解析依赖（存在子依赖也可以自动解析）\n\n ```php\n<?php\nclass Container\n{\n    public $i=1;\n    private $s = array();\n    public function __set($k, $c)\n    {\n        $this->s[$k] = $c;\n    }\n    public function __get($k)\n    {\n        return $this->build($this->s[$k]);\n    }\n    /**\n     * 自动绑定（Autowiring）自动解析（Automatic Resolution）\n     *\n     * @param string $className\n     * @return object\n     * @throws Exception\n     */\n    public function build($className)\n    {\n        // 如果是匿名函数（Anonymous functions），也叫闭包函数（closures）\n        if ($className instanceof Closure) {\n//            var_dump($className);exit;\n            // 执行闭包函数，并将结果\n            return $className($this);\n        }\n        /*通过反射获取类的内部结构，实例化类*/\n        $reflector = new ReflectionClass($className);\n        // 检查类是否可实例化, 排除抽象类abstract和对象接口interface\n        if (!$reflector->isInstantiable()) {\n            throw new Exception(\"Can't instantiate this.\");\n        }\n        /** @var ReflectionMethod $constructor 获取类的构造函数 */\n        $constructor = $reflector->getConstructor();\n        // 若无构造函数，直接实例化并返回\n        if (is_null($constructor)) {\n            return new $className;\n        }\n        // 取构造函数参数,通过 ReflectionParameter 数组返回参数列表\n        $parameters = $constructor->getParameters();\n\n        // 递归解析构造函数的参数\n        $dependencies = $this->getDependencies($parameters);\n        // 创建一个类的新实例，给出的参数将传递到类的构造函数。\n        return $reflector->newInstanceArgs($dependencies);\n    }\n    /**\n     * @param array $parameters\n     * @return array\n     * @throws Exception\n     */\n    public function getDependencies($parameters)\n    {\n        $dependencies = [];\n        /** @var ReflectionParameter $parameter */\n        foreach ($parameters as $parameter) {\n            /** @var ReflectionClass $dependency */\n            $dependency = $parameter->getClass();\n            if (is_null($dependency)) {\n                // 是变量,有默认值则设置默认值\n                $dependencies[] = $this->resolveNonClass($parameter);\n            } else {\n                // 是一个类，递归解析\n                $dependencies[] = $this->build($dependency->name);\n            }\n        }\n        return $dependencies;\n    }\n    /**\n     * @param ReflectionParameter $parameter\n     * @return mixed\n     * @throws Exception\n     */\n    public function resolveNonClass($parameter)\n    {\n        // 有默认值则返回默认值\n        if ($parameter->isDefaultValueAvailable()) {\n            return $parameter->getDefaultValue();\n        }\n        throw new Exception('I have no idea what to do here.');\n    }\n}\nrequire_once \"./testclass.php\"; //开始测试，先测试已知依赖关系的情况\n$c = new Container();\n$c->department = 'Department';// 赋值类名 或 匿名函数\n$c->company = function ($c) {\n    return new Company($c->department);\n};\n// 从容器中取得company\n$company = $c->company;\n$company->doSomething(); //输出: Group:hello|Department:hello|Company:hello|\n\n\n// 测试未知依赖关系，直接使用的方法\n$di = new Container();\n$di->company = 'Company';// 赋值类名 或 匿名函数\n$company = $di->company;\n$company->doSomething();//输出: Group:hello|Department:hello|Company:hello|\n\n```\n\n```php\n<?php //依赖关系：Company->Department->Group\nclass Group\n{\n    public function doSomething()\n    {\n        echo __CLASS__.\":\".'hello', '|';\n    }\n}\nclass Department\n{\n    private $group;\n    public function __construct(Group $group)\n    {\n        $this->group = $group;\n    }\n    public function doSomething()\n    {\n        $this->group->doSomething();\n        echo __CLASS__.\":\".'hello', '|';\n    }\n}\nclass Company\n{\n    private $department;\n    public function __construct(Department $department)\n    {\n        $this->department = $department;\n    }\n    public function doSomething()\n    {\n        $this->department->doSomething();\n        echo __CLASS__.\":\".'hello', '|';\n    }\n}\n```\n\n\n\n\n\n","slug":"php开发-设计模式之容器(container)","published":1,"updated":"2024-11-25T11:34:20.218Z","_id":"cm04ukh8b001c4koc50469x8h","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"控制反转-IOC\"><a href=\"#控制反转-IOC\" class=\"headerlink\" title=\"控制反转(IOC)\"></a>控制反转(IOC)</h1><p> 含义：原来由人为（程序员）修改代码 控制流程，反转为由程序【框架】去控制<br> 控制反转(Inversion of Control) 是一种设计思想</p>\n<p>没反转的情况(正转)</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Application</span> </span>&#123;</span><br><span class=\"line\">     </span><br><span class=\"line\">     <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">commit</span>(<span class=\"params\"><span class=\"variable\">$supplierName</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">     </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 去判断需要用哪个上游供应商，然后实例化</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"variable\">$supplierName</span> == <span class=\"string\">&quot;pushang&quot;</span>)&#123;</span><br><span class=\"line\">           <span class=\"variable\">$supplier</span> = <span class=\"keyword\">new</span> PuShangSupplier(); </span><br><span class=\"line\">           <span class=\"variable\">$supplier</span>-&gt;commit();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p>反转后的情况（反转）</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Supplier</span> </span>&#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">   <span class=\"keyword\">abstract</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">commit</span>(<span class=\"params\"></span>)</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PuShangSupplier</span> <span class=\"title\">extend</span> <span class=\"title\">Supplier</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">commit</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 逻辑</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Application</span> </span>&#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">commit</span>(<span class=\"params\">Supplier <span class=\"variable\">$supplier</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">    <span class=\"variable\">$supplier</span>-&gt;commit();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$app</span> = <span class=\"keyword\">new</span> Application();</span><br><span class=\"line\"><span class=\"variable\">$app</span>-&gt;commit(<span class=\"keyword\">new</span> PuShangSupplier());</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"依赖注入-DI\"><a href=\"#依赖注入-DI\" class=\"headerlink\" title=\"依赖注入(DI)\"></a>依赖注入(DI)</h1><p>依赖注入 是一种设计模式<br>依赖注入是控制反转的一种实现方式/方法<br>也就是依赖注入 实现了  控制反转</p>\n<p>依赖注入方式 1、构造方法注入；2、set属性注入__set；3、静态工厂方法注入；</p>\n<p>一旦换了平台，就要修改构造函数 即使你传参数 构造判断使用哪个类，新增了平台，你还有去修改A类构造方法</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$ob</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\">C <span class=\"variable\">$c</span></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;ob = <span class=\"keyword\">new</span> Aly();</span><br><span class=\"line\">      <span class=\"comment\">//  $this-&gt;ob = new Txy();</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">send</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;ob-&gt;send();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 实现阿里云</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Aly</span></span>&#123;&#125;</span><br><span class=\"line\"><span class=\"comment\">// 实现腾讯云</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Txy</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$a</span> = <span class=\"keyword\">new</span> A();</span><br><span class=\"line\"><span class=\"variable\">$a</span>-&gt;send();</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<p>通过构造函数注入 依赖</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$ob</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\">C <span class=\"variable\">$c</span></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;ob = <span class=\"variable\">$c</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">send</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;ob-&gt;send();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Aly</span></span>&#123;</span><br><span class=\"line\"><span class=\"comment\">// 实现阿里云发送短信类</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$notice</span> = <span class=\"keyword\">new</span> A(<span class=\"keyword\">new</span> Aly());</span><br><span class=\"line\"><span class=\"variable\">$notice</span>-&gt;send();</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"IoC容器\"><a href=\"#IoC容器\" class=\"headerlink\" title=\"IoC容器\"></a>IoC容器</h1><p>将依赖的对象注入到容器中<br>当需要某个对象的时候，就直接获取，不必关注其实例化需要些什么，容器自动实例化了<br>运行时容器会自动解析依赖（存在子依赖也可以自动解析）</p>\n <figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Container</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$i</span>=<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$s</span> = <span class=\"keyword\">array</span>();</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__set</span>(<span class=\"params\"><span class=\"variable\">$k</span>, <span class=\"variable\">$c</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;s[<span class=\"variable\">$k</span>] = <span class=\"variable\">$c</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__get</span>(<span class=\"params\"><span class=\"variable\">$k</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>-&gt;build(<span class=\"keyword\">$this</span>-&gt;s[<span class=\"variable\">$k</span>]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 自动绑定（Autowiring）自动解析（Automatic Resolution）</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> string $className</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> object</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">build</span>(<span class=\"params\"><span class=\"variable\">$className</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 如果是匿名函数（Anonymous functions），也叫闭包函数（closures）</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable\">$className</span> <span class=\"keyword\">instanceof</span> <span class=\"built_in\">Closure</span>) &#123;</span><br><span class=\"line\"><span class=\"comment\">//            var_dump($className);exit;</span></span><br><span class=\"line\">            <span class=\"comment\">// 执行闭包函数，并将结果</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable\">$className</span>(<span class=\"keyword\">$this</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">/*通过反射获取类的内部结构，实例化类*/</span></span><br><span class=\"line\">        <span class=\"variable\">$reflector</span> = <span class=\"keyword\">new</span> ReflectionClass(<span class=\"variable\">$className</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 检查类是否可实例化, 排除抽象类abstract和对象接口interface</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"variable\">$reflector</span>-&gt;isInstantiable()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Exception</span>(<span class=\"string\">&quot;Can&#x27;t instantiate this.&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">/** <span class=\"doctag\">@var</span> ReflectionMethod $constructor 获取类的构造函数 */</span></span><br><span class=\"line\">        <span class=\"variable\">$constructor</span> = <span class=\"variable\">$reflector</span>-&gt;getConstructor();</span><br><span class=\"line\">        <span class=\"comment\">// 若无构造函数，直接实例化并返回</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (is_null(<span class=\"variable\">$constructor</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"variable\">$className</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 取构造函数参数,通过 ReflectionParameter 数组返回参数列表</span></span><br><span class=\"line\">        <span class=\"variable\">$parameters</span> = <span class=\"variable\">$constructor</span>-&gt;getParameters();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 递归解析构造函数的参数</span></span><br><span class=\"line\">        <span class=\"variable\">$dependencies</span> = <span class=\"keyword\">$this</span>-&gt;getDependencies(<span class=\"variable\">$parameters</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建一个类的新实例，给出的参数将传递到类的构造函数。</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable\">$reflector</span>-&gt;newInstanceArgs(<span class=\"variable\">$dependencies</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> array $parameters</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> array</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getDependencies</span>(<span class=\"params\"><span class=\"variable\">$parameters</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$dependencies</span> = [];</span><br><span class=\"line\">        <span class=\"comment\">/** <span class=\"doctag\">@var</span> ReflectionParameter $parameter */</span></span><br><span class=\"line\">        <span class=\"keyword\">foreach</span> (<span class=\"variable\">$parameters</span> <span class=\"keyword\">as</span> <span class=\"variable\">$parameter</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">/** <span class=\"doctag\">@var</span> ReflectionClass $dependency */</span></span><br><span class=\"line\">            <span class=\"variable\">$dependency</span> = <span class=\"variable\">$parameter</span>-&gt;getClass();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (is_null(<span class=\"variable\">$dependency</span>)) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 是变量,有默认值则设置默认值</span></span><br><span class=\"line\">                <span class=\"variable\">$dependencies</span>[] = <span class=\"keyword\">$this</span>-&gt;resolveNonClass(<span class=\"variable\">$parameter</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 是一个类，递归解析</span></span><br><span class=\"line\">                <span class=\"variable\">$dependencies</span>[] = <span class=\"keyword\">$this</span>-&gt;build(<span class=\"variable\">$dependency</span>-&gt;name);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable\">$dependencies</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ReflectionParameter $parameter</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> mixed</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolveNonClass</span>(<span class=\"params\"><span class=\"variable\">$parameter</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 有默认值则返回默认值</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable\">$parameter</span>-&gt;isDefaultValueAvailable()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable\">$parameter</span>-&gt;getDefaultValue();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Exception</span>(<span class=\"string\">&#x27;I have no idea what to do here.&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">require_once</span> <span class=\"string\">&quot;./testclass.php&quot;</span>; <span class=\"comment\">//开始测试，先测试已知依赖关系的情况</span></span><br><span class=\"line\"><span class=\"variable\">$c</span> = <span class=\"keyword\">new</span> Container();</span><br><span class=\"line\"><span class=\"variable\">$c</span>-&gt;department = <span class=\"string\">&#x27;Department&#x27;</span>;<span class=\"comment\">// 赋值类名 或 匿名函数</span></span><br><span class=\"line\"><span class=\"variable\">$c</span>-&gt;company = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"><span class=\"variable\">$c</span></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Company(<span class=\"variable\">$c</span>-&gt;department);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">// 从容器中取得company</span></span><br><span class=\"line\"><span class=\"variable\">$company</span> = <span class=\"variable\">$c</span>-&gt;company;</span><br><span class=\"line\"><span class=\"variable\">$company</span>-&gt;doSomething(); <span class=\"comment\">//输出: Group:hello|Department:hello|Company:hello|</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 测试未知依赖关系，直接使用的方法</span></span><br><span class=\"line\"><span class=\"variable\">$di</span> = <span class=\"keyword\">new</span> Container();</span><br><span class=\"line\"><span class=\"variable\">$di</span>-&gt;company = <span class=\"string\">&#x27;Company&#x27;</span>;<span class=\"comment\">// 赋值类名 或 匿名函数</span></span><br><span class=\"line\"><span class=\"variable\">$company</span> = <span class=\"variable\">$di</span>-&gt;company;</span><br><span class=\"line\"><span class=\"variable\">$company</span>-&gt;doSomething();<span class=\"comment\">//输出: Group:hello|Department:hello|Company:hello|</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span> <span class=\"comment\">//依赖关系：Company-&gt;Department-&gt;Group</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Group</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSomething</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"keyword\">__CLASS__</span>.<span class=\"string\">&quot;:&quot;</span>.<span class=\"string\">&#x27;hello&#x27;</span>, <span class=\"string\">&#x27;|&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Department</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$group</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\">Group <span class=\"variable\">$group</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;group = <span class=\"variable\">$group</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSomething</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;group-&gt;doSomething();</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"keyword\">__CLASS__</span>.<span class=\"string\">&quot;:&quot;</span>.<span class=\"string\">&#x27;hello&#x27;</span>, <span class=\"string\">&#x27;|&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Company</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$department</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\">Department <span class=\"variable\">$department</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;department = <span class=\"variable\">$department</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSomething</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;department-&gt;doSomething();</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"keyword\">__CLASS__</span>.<span class=\"string\">&quot;:&quot;</span>.<span class=\"string\">&#x27;hello&#x27;</span>, <span class=\"string\">&#x27;|&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n","site":{"data":{}},"length":4720,"excerpt":"","more":"<h1 id=\"控制反转-IOC\"><a href=\"#控制反转-IOC\" class=\"headerlink\" title=\"控制反转(IOC)\"></a>控制反转(IOC)</h1><p> 含义：原来由人为（程序员）修改代码 控制流程，反转为由程序【框架】去控制<br> 控制反转(Inversion of Control) 是一种设计思想</p>\n<p>没反转的情况(正转)</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Application</span> </span>&#123;</span><br><span class=\"line\">     </span><br><span class=\"line\">     <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">commit</span>(<span class=\"params\"><span class=\"variable\">$supplierName</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">     </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 去判断需要用哪个上游供应商，然后实例化</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"variable\">$supplierName</span> == <span class=\"string\">&quot;pushang&quot;</span>)&#123;</span><br><span class=\"line\">           <span class=\"variable\">$supplier</span> = <span class=\"keyword\">new</span> PuShangSupplier(); </span><br><span class=\"line\">           <span class=\"variable\">$supplier</span>-&gt;commit();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p>反转后的情况（反转）</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Supplier</span> </span>&#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">   <span class=\"keyword\">abstract</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">commit</span>(<span class=\"params\"></span>)</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PuShangSupplier</span> <span class=\"title\">extend</span> <span class=\"title\">Supplier</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">commit</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 逻辑</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Application</span> </span>&#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">commit</span>(<span class=\"params\">Supplier <span class=\"variable\">$supplier</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;</span><br><span class=\"line\">    <span class=\"variable\">$supplier</span>-&gt;commit();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$app</span> = <span class=\"keyword\">new</span> Application();</span><br><span class=\"line\"><span class=\"variable\">$app</span>-&gt;commit(<span class=\"keyword\">new</span> PuShangSupplier());</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"依赖注入-DI\"><a href=\"#依赖注入-DI\" class=\"headerlink\" title=\"依赖注入(DI)\"></a>依赖注入(DI)</h1><p>依赖注入 是一种设计模式<br>依赖注入是控制反转的一种实现方式/方法<br>也就是依赖注入 实现了  控制反转</p>\n<p>依赖注入方式 1、构造方法注入；2、set属性注入__set；3、静态工厂方法注入；</p>\n<p>一旦换了平台，就要修改构造函数 即使你传参数 构造判断使用哪个类，新增了平台，你还有去修改A类构造方法</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$ob</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\">C <span class=\"variable\">$c</span></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;ob = <span class=\"keyword\">new</span> Aly();</span><br><span class=\"line\">      <span class=\"comment\">//  $this-&gt;ob = new Txy();</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">send</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;ob-&gt;send();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 实现阿里云</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Aly</span></span>&#123;&#125;</span><br><span class=\"line\"><span class=\"comment\">// 实现腾讯云</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Txy</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$a</span> = <span class=\"keyword\">new</span> A();</span><br><span class=\"line\"><span class=\"variable\">$a</span>-&gt;send();</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<p>通过构造函数注入 依赖</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$ob</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\">C <span class=\"variable\">$c</span></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;ob = <span class=\"variable\">$c</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">send</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;ob-&gt;send();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Aly</span></span>&#123;</span><br><span class=\"line\"><span class=\"comment\">// 实现阿里云发送短信类</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$notice</span> = <span class=\"keyword\">new</span> A(<span class=\"keyword\">new</span> Aly());</span><br><span class=\"line\"><span class=\"variable\">$notice</span>-&gt;send();</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"IoC容器\"><a href=\"#IoC容器\" class=\"headerlink\" title=\"IoC容器\"></a>IoC容器</h1><p>将依赖的对象注入到容器中<br>当需要某个对象的时候，就直接获取，不必关注其实例化需要些什么，容器自动实例化了<br>运行时容器会自动解析依赖（存在子依赖也可以自动解析）</p>\n <figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Container</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$i</span>=<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$s</span> = <span class=\"keyword\">array</span>();</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__set</span>(<span class=\"params\"><span class=\"variable\">$k</span>, <span class=\"variable\">$c</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;s[<span class=\"variable\">$k</span>] = <span class=\"variable\">$c</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__get</span>(<span class=\"params\"><span class=\"variable\">$k</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>-&gt;build(<span class=\"keyword\">$this</span>-&gt;s[<span class=\"variable\">$k</span>]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 自动绑定（Autowiring）自动解析（Automatic Resolution）</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> string $className</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> object</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">build</span>(<span class=\"params\"><span class=\"variable\">$className</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 如果是匿名函数（Anonymous functions），也叫闭包函数（closures）</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable\">$className</span> <span class=\"keyword\">instanceof</span> <span class=\"built_in\">Closure</span>) &#123;</span><br><span class=\"line\"><span class=\"comment\">//            var_dump($className);exit;</span></span><br><span class=\"line\">            <span class=\"comment\">// 执行闭包函数，并将结果</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable\">$className</span>(<span class=\"keyword\">$this</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">/*通过反射获取类的内部结构，实例化类*/</span></span><br><span class=\"line\">        <span class=\"variable\">$reflector</span> = <span class=\"keyword\">new</span> ReflectionClass(<span class=\"variable\">$className</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 检查类是否可实例化, 排除抽象类abstract和对象接口interface</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"variable\">$reflector</span>-&gt;isInstantiable()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Exception</span>(<span class=\"string\">&quot;Can&#x27;t instantiate this.&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">/** <span class=\"doctag\">@var</span> ReflectionMethod $constructor 获取类的构造函数 */</span></span><br><span class=\"line\">        <span class=\"variable\">$constructor</span> = <span class=\"variable\">$reflector</span>-&gt;getConstructor();</span><br><span class=\"line\">        <span class=\"comment\">// 若无构造函数，直接实例化并返回</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (is_null(<span class=\"variable\">$constructor</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"variable\">$className</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 取构造函数参数,通过 ReflectionParameter 数组返回参数列表</span></span><br><span class=\"line\">        <span class=\"variable\">$parameters</span> = <span class=\"variable\">$constructor</span>-&gt;getParameters();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 递归解析构造函数的参数</span></span><br><span class=\"line\">        <span class=\"variable\">$dependencies</span> = <span class=\"keyword\">$this</span>-&gt;getDependencies(<span class=\"variable\">$parameters</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建一个类的新实例，给出的参数将传递到类的构造函数。</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable\">$reflector</span>-&gt;newInstanceArgs(<span class=\"variable\">$dependencies</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> array $parameters</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> array</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getDependencies</span>(<span class=\"params\"><span class=\"variable\">$parameters</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$dependencies</span> = [];</span><br><span class=\"line\">        <span class=\"comment\">/** <span class=\"doctag\">@var</span> ReflectionParameter $parameter */</span></span><br><span class=\"line\">        <span class=\"keyword\">foreach</span> (<span class=\"variable\">$parameters</span> <span class=\"keyword\">as</span> <span class=\"variable\">$parameter</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">/** <span class=\"doctag\">@var</span> ReflectionClass $dependency */</span></span><br><span class=\"line\">            <span class=\"variable\">$dependency</span> = <span class=\"variable\">$parameter</span>-&gt;getClass();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (is_null(<span class=\"variable\">$dependency</span>)) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 是变量,有默认值则设置默认值</span></span><br><span class=\"line\">                <span class=\"variable\">$dependencies</span>[] = <span class=\"keyword\">$this</span>-&gt;resolveNonClass(<span class=\"variable\">$parameter</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 是一个类，递归解析</span></span><br><span class=\"line\">                <span class=\"variable\">$dependencies</span>[] = <span class=\"keyword\">$this</span>-&gt;build(<span class=\"variable\">$dependency</span>-&gt;name);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable\">$dependencies</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ReflectionParameter $parameter</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> mixed</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolveNonClass</span>(<span class=\"params\"><span class=\"variable\">$parameter</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 有默认值则返回默认值</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable\">$parameter</span>-&gt;isDefaultValueAvailable()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable\">$parameter</span>-&gt;getDefaultValue();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Exception</span>(<span class=\"string\">&#x27;I have no idea what to do here.&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">require_once</span> <span class=\"string\">&quot;./testclass.php&quot;</span>; <span class=\"comment\">//开始测试，先测试已知依赖关系的情况</span></span><br><span class=\"line\"><span class=\"variable\">$c</span> = <span class=\"keyword\">new</span> Container();</span><br><span class=\"line\"><span class=\"variable\">$c</span>-&gt;department = <span class=\"string\">&#x27;Department&#x27;</span>;<span class=\"comment\">// 赋值类名 或 匿名函数</span></span><br><span class=\"line\"><span class=\"variable\">$c</span>-&gt;company = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"><span class=\"variable\">$c</span></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Company(<span class=\"variable\">$c</span>-&gt;department);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">// 从容器中取得company</span></span><br><span class=\"line\"><span class=\"variable\">$company</span> = <span class=\"variable\">$c</span>-&gt;company;</span><br><span class=\"line\"><span class=\"variable\">$company</span>-&gt;doSomething(); <span class=\"comment\">//输出: Group:hello|Department:hello|Company:hello|</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 测试未知依赖关系，直接使用的方法</span></span><br><span class=\"line\"><span class=\"variable\">$di</span> = <span class=\"keyword\">new</span> Container();</span><br><span class=\"line\"><span class=\"variable\">$di</span>-&gt;company = <span class=\"string\">&#x27;Company&#x27;</span>;<span class=\"comment\">// 赋值类名 或 匿名函数</span></span><br><span class=\"line\"><span class=\"variable\">$company</span> = <span class=\"variable\">$di</span>-&gt;company;</span><br><span class=\"line\"><span class=\"variable\">$company</span>-&gt;doSomething();<span class=\"comment\">//输出: Group:hello|Department:hello|Company:hello|</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span> <span class=\"comment\">//依赖关系：Company-&gt;Department-&gt;Group</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Group</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSomething</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"keyword\">__CLASS__</span>.<span class=\"string\">&quot;:&quot;</span>.<span class=\"string\">&#x27;hello&#x27;</span>, <span class=\"string\">&#x27;|&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Department</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$group</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\">Group <span class=\"variable\">$group</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;group = <span class=\"variable\">$group</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSomething</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;group-&gt;doSomething();</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"keyword\">__CLASS__</span>.<span class=\"string\">&quot;:&quot;</span>.<span class=\"string\">&#x27;hello&#x27;</span>, <span class=\"string\">&#x27;|&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Company</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$department</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\">Department <span class=\"variable\">$department</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;department = <span class=\"variable\">$department</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSomething</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;department-&gt;doSomething();</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"keyword\">__CLASS__</span>.<span class=\"string\">&quot;:&quot;</span>.<span class=\"string\">&#x27;hello&#x27;</span>, <span class=\"string\">&#x27;|&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n"},{"title":"wordpress相关","abbrlink":"4aea2b73","date":"2023-11-01T03:01:22.000Z","_content":"\n\n\n# wordpress 迁移后还是访问之前的域名\n    \n    1.找到 前缀_options 表修改 siteurl  home字段 \n    2.或者登录后台修改\n\n\n\n\n# wordpress 迁移后栏目打开是404\n\n    nginx加上如下配置\n    \n    location / {\n     try_files $uri $uri/ /index.php?$args;\n    }\n    # Add trailing slash to */wp-admin requests.\n    rewrite /wp-admin$ $scheme://$host$uri/ permanent;\n    \n    \n    \n#  修改忘记密码 修改\n    \n    修改 前缀_users 表    user_pass 字段 \n    MD5 加密\n\n\n    ","source":"_posts/php开发-wordpress相关.md","raw":"---\ntitle: wordpress相关\nabbrlink: 4aea2b73\ncategories:\n  - PHP开发\ndate: 2023-11-01 11:01:22\ntags:\n---\n\n\n\n# wordpress 迁移后还是访问之前的域名\n    \n    1.找到 前缀_options 表修改 siteurl  home字段 \n    2.或者登录后台修改\n\n\n\n\n# wordpress 迁移后栏目打开是404\n\n    nginx加上如下配置\n    \n    location / {\n     try_files $uri $uri/ /index.php?$args;\n    }\n    # Add trailing slash to */wp-admin requests.\n    rewrite /wp-admin$ $scheme://$host$uri/ permanent;\n    \n    \n    \n#  修改忘记密码 修改\n    \n    修改 前缀_users 表    user_pass 字段 \n    MD5 加密\n\n\n    ","slug":"php开发-wordpress相关","published":1,"updated":"2024-02-06T10:59:02.131Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm04ukh8d001f4kocfv9t2vf2","content":"<h1 id=\"wordpress-迁移后还是访问之前的域名\"><a href=\"#wordpress-迁移后还是访问之前的域名\" class=\"headerlink\" title=\"wordpress 迁移后还是访问之前的域名\"></a>wordpress 迁移后还是访问之前的域名</h1><pre><code>1.找到 前缀_options 表修改 siteurl  home字段 \n2.或者登录后台修改\n</code></pre>\n<h1 id=\"wordpress-迁移后栏目打开是404\"><a href=\"#wordpress-迁移后栏目打开是404\" class=\"headerlink\" title=\"wordpress 迁移后栏目打开是404\"></a>wordpress 迁移后栏目打开是404</h1><pre><code>nginx加上如下配置\n\nlocation / &#123;\n try_files $uri $uri/ /index.php?$args;\n&#125;\n# Add trailing slash to */wp-admin requests.\nrewrite /wp-admin$ $scheme://$host$uri/ permanent;\n</code></pre>\n<h1 id=\"修改忘记密码-修改\"><a href=\"#修改忘记密码-修改\" class=\"headerlink\" title=\"修改忘记密码 修改\"></a>修改忘记密码 修改</h1><pre><code>修改 前缀_users 表    user_pass 字段 \nMD5 加密\n</code></pre>\n","site":{"data":{}},"length":268,"excerpt":"","more":"<h1 id=\"wordpress-迁移后还是访问之前的域名\"><a href=\"#wordpress-迁移后还是访问之前的域名\" class=\"headerlink\" title=\"wordpress 迁移后还是访问之前的域名\"></a>wordpress 迁移后还是访问之前的域名</h1><pre><code>1.找到 前缀_options 表修改 siteurl  home字段 \n2.或者登录后台修改\n</code></pre>\n<h1 id=\"wordpress-迁移后栏目打开是404\"><a href=\"#wordpress-迁移后栏目打开是404\" class=\"headerlink\" title=\"wordpress 迁移后栏目打开是404\"></a>wordpress 迁移后栏目打开是404</h1><pre><code>nginx加上如下配置\n\nlocation / &#123;\n try_files $uri $uri/ /index.php?$args;\n&#125;\n# Add trailing slash to */wp-admin requests.\nrewrite /wp-admin$ $scheme://$host$uri/ permanent;\n</code></pre>\n<h1 id=\"修改忘记密码-修改\"><a href=\"#修改忘记密码-修改\" class=\"headerlink\" title=\"修改忘记密码 修改\"></a>修改忘记密码 修改</h1><pre><code>修改 前缀_users 表    user_pass 字段 \nMD5 加密\n</code></pre>\n"},{"title":"shell脚本学习2","abbrlink":"8a98ccfe","date":"2023-07-29T06:58:19.000Z","_content":"\n\n搜索出当前目录下包含某个字符串的文件  并替换文件中的xx字符串为bb字符串\n    sed -i \"s/xx/bb/g\" `grep -rl \"xx ./`\n    sed -i \"s/http:\\/\\/121.229.56.251:8082/https:\\/\\/zkzp.jyrcfzjt.com:8082/g\" `grep -rl \"http://121.229.56.251:8082\" ./`\n","source":"_posts/shell脚本-学习2.md","raw":"---\ntitle: shell脚本学习2\nabbrlink: 8a98ccfe\ndate: 2023-07-29 14:58:19\ncategories:\n  - 服务器相关\n  - shell\ntags:\n---\n\n\n搜索出当前目录下包含某个字符串的文件  并替换文件中的xx字符串为bb字符串\n    sed -i \"s/xx/bb/g\" `grep -rl \"xx ./`\n    sed -i \"s/http:\\/\\/121.229.56.251:8082/https:\\/\\/zkzp.jyrcfzjt.com:8082/g\" `grep -rl \"http://121.229.56.251:8082\" ./`\n","slug":"shell脚本-学习2","published":1,"updated":"2024-11-25T11:33:21.000Z","_id":"cm04ukh8f001g4koc53zp7el2","comments":1,"layout":"post","photos":[],"link":"","content":"<p>搜索出当前目录下包含某个字符串的文件  并替换文件中的xx字符串为bb字符串<br>    sed -i “s/xx/bb/g” <code>grep -rl &quot;xx ./</code><br>    sed -i “s/http://121.229.56.251:8082/https://zkzp.jyrcfzjt.com:8082/g” <code>grep -rl &quot;http://121.229.56.251:8082&quot; ./</code></p>\n","site":{"data":{}},"length":184,"excerpt":"","more":"<p>搜索出当前目录下包含某个字符串的文件  并替换文件中的xx字符串为bb字符串<br>    sed -i “s/xx/bb/g” <code>grep -rl &quot;xx ./</code><br>    sed -i “s/http://121.229.56.251:8082/https://zkzp.jyrcfzjt.com:8082/g” <code>grep -rl &quot;http://121.229.56.251:8082&quot; ./</code></p>\n"},{"title":"shell脚本学习1","abbrlink":"13919d44","date":"2023-07-13T11:57:19.000Z","_content":"\n开头声明\n\n    #!/bin/bash   表示使用bash作为解释器来执行shell脚本\n   \n    #!/bin/sh     表示使用默认的Unix shell解释器\n    \n    #!/usr/bin/perl表示使用Perl解释器\n\n赋值\n\n    语法：变量名=值\n    webpath=/apps/web  等号必须紧挨变量 不然会报错！\n    \n取变量值\n    \n    语法：$变量名  \n    例：$webpath\n    \n取命令执行的值\n\n       语法：$(命令) \n       例：\n            test=$(ls /apps/web)\n            projectnames=$(ls $webpath)\n            \n遍历\n\n    语法：   for  值 in 数组\n             do\n                执行代码\n             done    \n             \n     例：\n        for projectname in $projectnames\n        do\n            echo $projectname\n        done          \n        \n        \n逻辑判断\n    \n    语法\n        if [ 判断条件]\n        then\n           执行代码\n        fi   \n\n        if [ 判断条件];then\n            执行代码\n        fi\n        \n        \n        \n    if [ command ];then\n         符合该条件执行的语句\n    elif [ command ];then\n         符合该条件执行的语句\n    else\n         符合该条件执行的语句\n    fi\n\n\nif文件判断\n \n     -e：判断文件或目录是否存在；\n     \n     -d：判断是否为目录以及是否存在；\n     \n     -f：判断是否为普通文件以及是否存在；\n     \n     -r：判断是否有读权限；\n     \n     -w：判断是否有写权限；\n     \n     -x：判断是否有执行权限     \n     \nif字符串判断\n    \n    [ INT1 -eq INT2 ] INT1和INT2两数相等返回为真 ,=\n    [ INT1 -ne INT2 ] INT1和INT2两数不等返回为真 ,<>\n    [ INT1 -gt INT2 ] INT1大于INT2返回为真 ,>\n    [ INT1 -ge INT2 ] INT1大于等于INT2返回为真,>=\n    [ INT1 -lt INT2 ] INT1小于INT2返回为真 ,<\n    [ INT1 -le INT2 ] INT1小于等于INT2返回为真,<=\n\nif数值判断\n    \n    [ ! EXPR ] 逻辑非，如果 EXPR 是false则返回为真。\n    [ EXPR1 -a EXPR2 ] 逻辑与，如果 EXPR1 and EXPR2 全真则返回为真。\n    [ EXPR1 -o EXPR2 ] 逻辑或，如果 EXPR1 或者 EXPR2 为真则返回为真。\n    [ ] || [ ] 用OR来合并两个条件\n    [ ] && [ ] 用AND来合并两个条件\n\nif判断示例\n\n    if [ -f $replacefile1 ] && [ ! -f $replacefile1\".bak\" ]\n    then\n        执行代码\n    fi\n                 \n                 \n    if [ \"$(whoami)\" != 'root' ]; then\n       echo  \"You  have no permission to run $0 as non-root user.\"\n       exit  1;\n    fi             ","source":"_posts/shell脚本-学习1.md","raw":"---\ntitle: shell脚本学习1\nabbrlink: 13919d44\ndate: 2023-07-13 19:57:19\ncategories:\n  - 服务器相关\n  - shell\ntags:\n---\n\n开头声明\n\n    #!/bin/bash   表示使用bash作为解释器来执行shell脚本\n   \n    #!/bin/sh     表示使用默认的Unix shell解释器\n    \n    #!/usr/bin/perl表示使用Perl解释器\n\n赋值\n\n    语法：变量名=值\n    webpath=/apps/web  等号必须紧挨变量 不然会报错！\n    \n取变量值\n    \n    语法：$变量名  \n    例：$webpath\n    \n取命令执行的值\n\n       语法：$(命令) \n       例：\n            test=$(ls /apps/web)\n            projectnames=$(ls $webpath)\n            \n遍历\n\n    语法：   for  值 in 数组\n             do\n                执行代码\n             done    \n             \n     例：\n        for projectname in $projectnames\n        do\n            echo $projectname\n        done          \n        \n        \n逻辑判断\n    \n    语法\n        if [ 判断条件]\n        then\n           执行代码\n        fi   \n\n        if [ 判断条件];then\n            执行代码\n        fi\n        \n        \n        \n    if [ command ];then\n         符合该条件执行的语句\n    elif [ command ];then\n         符合该条件执行的语句\n    else\n         符合该条件执行的语句\n    fi\n\n\nif文件判断\n \n     -e：判断文件或目录是否存在；\n     \n     -d：判断是否为目录以及是否存在；\n     \n     -f：判断是否为普通文件以及是否存在；\n     \n     -r：判断是否有读权限；\n     \n     -w：判断是否有写权限；\n     \n     -x：判断是否有执行权限     \n     \nif字符串判断\n    \n    [ INT1 -eq INT2 ] INT1和INT2两数相等返回为真 ,=\n    [ INT1 -ne INT2 ] INT1和INT2两数不等返回为真 ,<>\n    [ INT1 -gt INT2 ] INT1大于INT2返回为真 ,>\n    [ INT1 -ge INT2 ] INT1大于等于INT2返回为真,>=\n    [ INT1 -lt INT2 ] INT1小于INT2返回为真 ,<\n    [ INT1 -le INT2 ] INT1小于等于INT2返回为真,<=\n\nif数值判断\n    \n    [ ! EXPR ] 逻辑非，如果 EXPR 是false则返回为真。\n    [ EXPR1 -a EXPR2 ] 逻辑与，如果 EXPR1 and EXPR2 全真则返回为真。\n    [ EXPR1 -o EXPR2 ] 逻辑或，如果 EXPR1 或者 EXPR2 为真则返回为真。\n    [ ] || [ ] 用OR来合并两个条件\n    [ ] && [ ] 用AND来合并两个条件\n\nif判断示例\n\n    if [ -f $replacefile1 ] && [ ! -f $replacefile1\".bak\" ]\n    then\n        执行代码\n    fi\n                 \n                 \n    if [ \"$(whoami)\" != 'root' ]; then\n       echo  \"You  have no permission to run $0 as non-root user.\"\n       exit  1;\n    fi             ","slug":"shell脚本-学习1","published":1,"updated":"2024-11-25T11:33:12.227Z","_id":"cm04ukh8j001i4kocevcwce6m","comments":1,"layout":"post","photos":[],"link":"","content":"<p>开头声明</p>\n<pre><code>#!/bin/bash   表示使用bash作为解释器来执行shell脚本\n\n#!/bin/sh     表示使用默认的Unix shell解释器\n\n#!/usr/bin/perl表示使用Perl解释器\n</code></pre>\n<p>赋值</p>\n<pre><code>语法：变量名=值\nwebpath=/apps/web  等号必须紧挨变量 不然会报错！\n</code></pre>\n<p>取变量值</p>\n<pre><code>语法：$变量名  \n例：$webpath\n</code></pre>\n<p>取命令执行的值</p>\n<pre><code>   语法：$(命令) \n   例：\n        test=$(ls /apps/web)\n        projectnames=$(ls $webpath)\n        \n</code></pre>\n<p>遍历</p>\n<pre><code>语法：   for  值 in 数组\n         do\n            执行代码\n         done    \n         \n 例：\n    for projectname in $projectnames\n    do\n        echo $projectname\n    done          \n    \n    \n</code></pre>\n<p>逻辑判断</p>\n<pre><code>语法\n    if [ 判断条件]\n    then\n       执行代码\n    fi   \n\n    if [ 判断条件];then\n        执行代码\n    fi\n    \n    \n    \nif [ command ];then\n     符合该条件执行的语句\nelif [ command ];then\n     符合该条件执行的语句\nelse\n     符合该条件执行的语句\nfi\n</code></pre>\n<p>if文件判断</p>\n<pre><code> -e：判断文件或目录是否存在；\n \n -d：判断是否为目录以及是否存在；\n \n -f：判断是否为普通文件以及是否存在；\n \n -r：判断是否有读权限；\n \n -w：判断是否有写权限；\n \n -x：判断是否有执行权限     \n \n</code></pre>\n<p>if字符串判断</p>\n<pre><code>[ INT1 -eq INT2 ] INT1和INT2两数相等返回为真 ,=\n[ INT1 -ne INT2 ] INT1和INT2两数不等返回为真 ,&lt;&gt;\n[ INT1 -gt INT2 ] INT1大于INT2返回为真 ,&gt;\n[ INT1 -ge INT2 ] INT1大于等于INT2返回为真,&gt;=\n[ INT1 -lt INT2 ] INT1小于INT2返回为真 ,&lt;\n[ INT1 -le INT2 ] INT1小于等于INT2返回为真,&lt;=\n</code></pre>\n<p>if数值判断</p>\n<pre><code>[ ! EXPR ] 逻辑非，如果 EXPR 是false则返回为真。\n[ EXPR1 -a EXPR2 ] 逻辑与，如果 EXPR1 and EXPR2 全真则返回为真。\n[ EXPR1 -o EXPR2 ] 逻辑或，如果 EXPR1 或者 EXPR2 为真则返回为真。\n[ ] || [ ] 用OR来合并两个条件\n[ ] &amp;&amp; [ ] 用AND来合并两个条件\n</code></pre>\n<p>if判断示例</p>\n<pre><code>if [ -f $replacefile1 ] &amp;&amp; [ ! -f $replacefile1&quot;.bak&quot; ]\nthen\n    执行代码\nfi\n             \n             \nif [ &quot;$(whoami)&quot; != &#39;root&#39; ]; then\n   echo  &quot;You  have no permission to run $0 as non-root user.&quot;\n   exit  1;\nfi             \n</code></pre>\n","site":{"data":{}},"length":1057,"excerpt":"","more":"<p>开头声明</p>\n<pre><code>#!/bin/bash   表示使用bash作为解释器来执行shell脚本\n\n#!/bin/sh     表示使用默认的Unix shell解释器\n\n#!/usr/bin/perl表示使用Perl解释器\n</code></pre>\n<p>赋值</p>\n<pre><code>语法：变量名=值\nwebpath=/apps/web  等号必须紧挨变量 不然会报错！\n</code></pre>\n<p>取变量值</p>\n<pre><code>语法：$变量名  \n例：$webpath\n</code></pre>\n<p>取命令执行的值</p>\n<pre><code>   语法：$(命令) \n   例：\n        test=$(ls /apps/web)\n        projectnames=$(ls $webpath)\n        \n</code></pre>\n<p>遍历</p>\n<pre><code>语法：   for  值 in 数组\n         do\n            执行代码\n         done    \n         \n 例：\n    for projectname in $projectnames\n    do\n        echo $projectname\n    done          \n    \n    \n</code></pre>\n<p>逻辑判断</p>\n<pre><code>语法\n    if [ 判断条件]\n    then\n       执行代码\n    fi   \n\n    if [ 判断条件];then\n        执行代码\n    fi\n    \n    \n    \nif [ command ];then\n     符合该条件执行的语句\nelif [ command ];then\n     符合该条件执行的语句\nelse\n     符合该条件执行的语句\nfi\n</code></pre>\n<p>if文件判断</p>\n<pre><code> -e：判断文件或目录是否存在；\n \n -d：判断是否为目录以及是否存在；\n \n -f：判断是否为普通文件以及是否存在；\n \n -r：判断是否有读权限；\n \n -w：判断是否有写权限；\n \n -x：判断是否有执行权限     \n \n</code></pre>\n<p>if字符串判断</p>\n<pre><code>[ INT1 -eq INT2 ] INT1和INT2两数相等返回为真 ,=\n[ INT1 -ne INT2 ] INT1和INT2两数不等返回为真 ,&lt;&gt;\n[ INT1 -gt INT2 ] INT1大于INT2返回为真 ,&gt;\n[ INT1 -ge INT2 ] INT1大于等于INT2返回为真,&gt;=\n[ INT1 -lt INT2 ] INT1小于INT2返回为真 ,&lt;\n[ INT1 -le INT2 ] INT1小于等于INT2返回为真,&lt;=\n</code></pre>\n<p>if数值判断</p>\n<pre><code>[ ! EXPR ] 逻辑非，如果 EXPR 是false则返回为真。\n[ EXPR1 -a EXPR2 ] 逻辑与，如果 EXPR1 and EXPR2 全真则返回为真。\n[ EXPR1 -o EXPR2 ] 逻辑或，如果 EXPR1 或者 EXPR2 为真则返回为真。\n[ ] || [ ] 用OR来合并两个条件\n[ ] &amp;&amp; [ ] 用AND来合并两个条件\n</code></pre>\n<p>if判断示例</p>\n<pre><code>if [ -f $replacefile1 ] &amp;&amp; [ ! -f $replacefile1&quot;.bak&quot; ]\nthen\n    执行代码\nfi\n             \n             \nif [ &quot;$(whoami)&quot; != &#39;root&#39; ]; then\n   echo  &quot;You  have no permission to run $0 as non-root user.&quot;\n   exit  1;\nfi             \n</code></pre>\n"},{"title":"php开发-ASN编码","abbrlink":"b6482428","date":"2024-09-03T09:03:54.000Z","_content":"","source":"_posts/php开发-ASN编码.md","raw":"---\ntitle: php开发-ASN编码\nabbrlink: b6482428\ndate: 2024-09-03 17:03:54\ntags: 加密技术\ncategories:\n  - PHP开发\n---\n","slug":"php开发-ASN编码","published":1,"updated":"2024-10-18T06:03:46.445Z","_id":"cm0m7pmpu0000vwoc7trh84he","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"php开发-国秘加密(sm2/sm3/sm4)","abbrlink":"6aa2955a","date":"2024-09-03T09:00:31.000Z","_content":"","source":"_posts/php开发-国秘加密-sm2-sm3-sm4.md","raw":"---\ntitle: php开发-国秘加密(sm2/sm3/sm4)\nabbrlink: 6aa2955a\ndate: 2024-09-03 17:00:31\ntags:\ncategories:\n  - PHP开发\n---\n","slug":"php开发-国秘加密-sm2-sm3-sm4","published":1,"updated":"2024-11-25T11:34:45.198Z","_id":"cm0m7pmq00001vwoc4pbo4n61","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"openEuler系统安装问题总结","abbrlink":"6c1c44d1","date":"2024-09-05T09:54:37.000Z","_content":"\n\n# 安装 zip 扩展失败报错\n\n报错如下\n\n```js\n    yum install php73-php-zip\n     \n    Last metadata expiration check: 2:08:24 ago on Thu 05 Sep 2024 03:23:50 PM CST.\n    Error: \n     Problem: package php73-php-pecl-zip-1.22.3-1.el7.remi.x86_64 requires libzip5(x86-64) >= 1.10.1, but none of the providers can be installed\n      - cannot install the best candidate for the job\n      - package libzip5-1.10.1-1.el7.remi.x86_64 is filtered out by modular filtering\n    (try to add '--skip-broken' to skip uninstallable packages or '--nobest' to use not only best candidate packages)   \n```\n\n解决方法：\n\n\n在/etc/yum.conf文件中追加设置默认platform id，‌如：‌module_platform_id=platform:f30。‌\n再次执行dnf makecache，‌错误不再出现。‌‌12\n‌Modular dependency problems 解决方案‌\n\n‌问题描述‌：‌存在模块依赖问题，‌如module(platform:el8)无法被提供。‌\n‌解决途径‌：‌\n检查并确保所有需要的模块和它们的依赖已正确安装。‌\n尝试在/etc/yum.repos.d/xx.repo中添加module_hotfixes=1，‌以解决模块依赖问题。‌‌2\n","source":"_posts/openEuler系统安装问题总结.md","raw":"---\ntitle: openEuler系统安装问题总结\nabbrlink: 6c1c44d1\ndate: 2024-09-05 17:54:37\ntags:\n---\n\n\n# 安装 zip 扩展失败报错\n\n报错如下\n\n```js\n    yum install php73-php-zip\n     \n    Last metadata expiration check: 2:08:24 ago on Thu 05 Sep 2024 03:23:50 PM CST.\n    Error: \n     Problem: package php73-php-pecl-zip-1.22.3-1.el7.remi.x86_64 requires libzip5(x86-64) >= 1.10.1, but none of the providers can be installed\n      - cannot install the best candidate for the job\n      - package libzip5-1.10.1-1.el7.remi.x86_64 is filtered out by modular filtering\n    (try to add '--skip-broken' to skip uninstallable packages or '--nobest' to use not only best candidate packages)   \n```\n\n解决方法：\n\n\n在/etc/yum.conf文件中追加设置默认platform id，‌如：‌module_platform_id=platform:f30。‌\n再次执行dnf makecache，‌错误不再出现。‌‌12\n‌Modular dependency problems 解决方案‌\n\n‌问题描述‌：‌存在模块依赖问题，‌如module(platform:el8)无法被提供。‌\n‌解决途径‌：‌\n检查并确保所有需要的模块和它们的依赖已正确安装。‌\n尝试在/etc/yum.repos.d/xx.repo中添加module_hotfixes=1，‌以解决模块依赖问题。‌‌2\n","slug":"openEuler系统安装问题总结","published":1,"updated":"2024-09-05T10:02:16.910Z","_id":"cm0p4buwz0000rgocdzkbeb3v","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"安装-zip-扩展失败报错\"><a href=\"#安装-zip-扩展失败报错\" class=\"headerlink\" title=\"安装 zip 扩展失败报错\"></a>安装 zip 扩展失败报错</h1><p>报错如下</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install php73-php-zip</span><br><span class=\"line\"> </span><br><span class=\"line\">Last metadata expiration check: <span class=\"number\">2</span>:<span class=\"number\">08</span>:<span class=\"number\">24</span> ago on Thu <span class=\"number\">05</span> Sep <span class=\"number\">2024</span> <span class=\"number\">03</span>:<span class=\"number\">23</span>:<span class=\"number\">50</span> PM CST.</span><br><span class=\"line\"><span class=\"attr\">Error</span>: </span><br><span class=\"line\"> Problem: package php73-php-pecl-zip-<span class=\"number\">1.22</span><span class=\"number\">.3</span>-<span class=\"number\">1.</span>el7.remi.x86_64 requires libzip5(x86-<span class=\"number\">64</span>) &gt;= <span class=\"number\">1.10</span><span class=\"number\">.1</span>, but none <span class=\"keyword\">of</span> the providers can be installed</span><br><span class=\"line\">  - cannot install the best candidate <span class=\"keyword\">for</span> the job</span><br><span class=\"line\">  - package libzip5-<span class=\"number\">1.10</span><span class=\"number\">.1</span>-<span class=\"number\">1.</span>el7.remi.x86_64 is filtered out by modular filtering</span><br><span class=\"line\">(<span class=\"keyword\">try</span> to add <span class=\"string\">&#x27;--skip-broken&#x27;</span> to skip uninstallable packages or <span class=\"string\">&#x27;--nobest&#x27;</span> to use not only best candidate packages)   </span><br></pre></td></tr></table></figure>\n\n<p>解决方法：</p>\n<p>在/etc/yum.conf文件中追加设置默认platform id，‌如：‌module_platform_id=platform:f30。‌<br>再次执行dnf makecache，‌错误不再出现。‌‌12<br>‌Modular dependency problems 解决方案‌</p>\n<p>‌问题描述‌：‌存在模块依赖问题，‌如module(platform:el8)无法被提供。‌<br>‌解决途径‌：‌<br>检查并确保所有需要的模块和它们的依赖已正确安装。‌<br>尝试在/etc/yum.repos.d/xx.repo中添加module_hotfixes=1，‌以解决模块依赖问题。‌‌2</p>\n","site":{"data":{}},"length":750,"excerpt":"","more":"<h1 id=\"安装-zip-扩展失败报错\"><a href=\"#安装-zip-扩展失败报错\" class=\"headerlink\" title=\"安装 zip 扩展失败报错\"></a>安装 zip 扩展失败报错</h1><p>报错如下</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install php73-php-zip</span><br><span class=\"line\"> </span><br><span class=\"line\">Last metadata expiration check: <span class=\"number\">2</span>:<span class=\"number\">08</span>:<span class=\"number\">24</span> ago on Thu <span class=\"number\">05</span> Sep <span class=\"number\">2024</span> <span class=\"number\">03</span>:<span class=\"number\">23</span>:<span class=\"number\">50</span> PM CST.</span><br><span class=\"line\"><span class=\"attr\">Error</span>: </span><br><span class=\"line\"> Problem: package php73-php-pecl-zip-<span class=\"number\">1.22</span><span class=\"number\">.3</span>-<span class=\"number\">1.</span>el7.remi.x86_64 requires libzip5(x86-<span class=\"number\">64</span>) &gt;= <span class=\"number\">1.10</span><span class=\"number\">.1</span>, but none <span class=\"keyword\">of</span> the providers can be installed</span><br><span class=\"line\">  - cannot install the best candidate <span class=\"keyword\">for</span> the job</span><br><span class=\"line\">  - package libzip5-<span class=\"number\">1.10</span><span class=\"number\">.1</span>-<span class=\"number\">1.</span>el7.remi.x86_64 is filtered out by modular filtering</span><br><span class=\"line\">(<span class=\"keyword\">try</span> to add <span class=\"string\">&#x27;--skip-broken&#x27;</span> to skip uninstallable packages or <span class=\"string\">&#x27;--nobest&#x27;</span> to use not only best candidate packages)   </span><br></pre></td></tr></table></figure>\n\n<p>解决方法：</p>\n<p>在/etc/yum.conf文件中追加设置默认platform id，‌如：‌module_platform_id=platform:f30。‌<br>再次执行dnf makecache，‌错误不再出现。‌‌12<br>‌Modular dependency problems 解决方案‌</p>\n<p>‌问题描述‌：‌存在模块依赖问题，‌如module(platform:el8)无法被提供。‌<br>‌解决途径‌：‌<br>检查并确保所有需要的模块和它们的依赖已正确安装。‌<br>尝试在/etc/yum.repos.d/xx.repo中添加module_hotfixes=1，‌以解决模块依赖问题。‌‌2</p>\n"},{"title":"微信开发-授权登录（小程序登录/网页授权登录）","abbrlink":"71fe1155","date":"2024-10-18T05:51:41.000Z","_content":"\n# 微信网页授权登录\n\n##  用途\n\nH5、App 等微信授权登录\n\n## 接口文档地址\n \n https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html#0\n  \n  \n\n## 网页授权流程\n    \n一、引导用户进入授权页面同意授权，获取code\n\n二、通过code换取网页授权access_token（与基础支持中的access_token不同）\n    \n三、 如果需要，开发者可以刷新网页授权access_token，避免过期\n\n 四、通过网页授权access_token和openid获取用户基本信息（支持UnionID机制）  \n \n \n ## 接口设计\n \n第一步 用户授权页面 多是前端调起\n\n在确保微信公众账号拥有授权作用域（scope参数）的权限的前提下\n（已认证服务号，默认拥有scope参数中的snsapi_base和snsapi_userinfo 权限），引导关注者打开如下页面：\n\nhttps://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&redirect_uri=REDIRECT_URI&response_type=code&scope=SCOPE&state=STATE#wechat_redirect\n\n第二步就是跳到后端设计的接口 \n接口传参数就是code  grant_type\n后端接口中实现授权 流程中 2~4 步骤 实现授权登录\n\n\n\n# \n","source":"_posts/微信开发-授权登录（小程序登录-网页授权登录）.md","raw":"---\ntitle: 微信开发-授权登录（小程序登录/网页授权登录）\nabbrlink: 71fe1155\ndate: 2024-10-18 13:51:41\ntags:\ncategories:\n  - 微信开发\n---\n\n# 微信网页授权登录\n\n##  用途\n\nH5、App 等微信授权登录\n\n## 接口文档地址\n \n https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html#0\n  \n  \n\n## 网页授权流程\n    \n一、引导用户进入授权页面同意授权，获取code\n\n二、通过code换取网页授权access_token（与基础支持中的access_token不同）\n    \n三、 如果需要，开发者可以刷新网页授权access_token，避免过期\n\n 四、通过网页授权access_token和openid获取用户基本信息（支持UnionID机制）  \n \n \n ## 接口设计\n \n第一步 用户授权页面 多是前端调起\n\n在确保微信公众账号拥有授权作用域（scope参数）的权限的前提下\n（已认证服务号，默认拥有scope参数中的snsapi_base和snsapi_userinfo 权限），引导关注者打开如下页面：\n\nhttps://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&redirect_uri=REDIRECT_URI&response_type=code&scope=SCOPE&state=STATE#wechat_redirect\n\n第二步就是跳到后端设计的接口 \n接口传参数就是code  grant_type\n后端接口中实现授权 流程中 2~4 步骤 实现授权登录\n\n\n\n# \n","slug":"微信开发-授权登录（小程序登录-网页授权登录）","published":1,"updated":"2024-10-21T08:39:11.625Z","_id":"cm2ebdhy800003coc44d2gzio","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"微信网页授权登录\"><a href=\"#微信网页授权登录\" class=\"headerlink\" title=\"微信网页授权登录\"></a>微信网页授权登录</h1><h2 id=\"用途\"><a href=\"#用途\" class=\"headerlink\" title=\"用途\"></a>用途</h2><p>H5、App 等微信授权登录</p>\n<h2 id=\"接口文档地址\"><a href=\"#接口文档地址\" class=\"headerlink\" title=\"接口文档地址\"></a>接口文档地址</h2><p> <a href=\"https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html#0\">https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html#0</a></p>\n<h2 id=\"网页授权流程\"><a href=\"#网页授权流程\" class=\"headerlink\" title=\"网页授权流程\"></a>网页授权流程</h2><p>一、引导用户进入授权页面同意授权，获取code</p>\n<p>二、通过code换取网页授权access_token（与基础支持中的access_token不同）</p>\n<p>三、 如果需要，开发者可以刷新网页授权access_token，避免过期</p>\n<p> 四、通过网页授权access_token和openid获取用户基本信息（支持UnionID机制）  </p>\n<h2 id=\"接口设计\"><a href=\"#接口设计\" class=\"headerlink\" title=\"接口设计\"></a>接口设计</h2><p>第一步 用户授权页面 多是前端调起</p>\n<p>在确保微信公众账号拥有授权作用域（scope参数）的权限的前提下<br>（已认证服务号，默认拥有scope参数中的snsapi_base和snsapi_userinfo 权限），引导关注者打开如下页面：</p>\n<p><a href=\"https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE#wechat_redirect\">https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE#wechat_redirect</a></p>\n<p>第二步就是跳到后端设计的接口<br>接口传参数就是code  grant_type<br>后端接口中实现授权 流程中 2~4 步骤 实现授权登录</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>","site":{"data":{}},"length":623,"excerpt":"","more":"<h1 id=\"微信网页授权登录\"><a href=\"#微信网页授权登录\" class=\"headerlink\" title=\"微信网页授权登录\"></a>微信网页授权登录</h1><h2 id=\"用途\"><a href=\"#用途\" class=\"headerlink\" title=\"用途\"></a>用途</h2><p>H5、App 等微信授权登录</p>\n<h2 id=\"接口文档地址\"><a href=\"#接口文档地址\" class=\"headerlink\" title=\"接口文档地址\"></a>接口文档地址</h2><p> <a href=\"https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html#0\">https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html#0</a></p>\n<h2 id=\"网页授权流程\"><a href=\"#网页授权流程\" class=\"headerlink\" title=\"网页授权流程\"></a>网页授权流程</h2><p>一、引导用户进入授权页面同意授权，获取code</p>\n<p>二、通过code换取网页授权access_token（与基础支持中的access_token不同）</p>\n<p>三、 如果需要，开发者可以刷新网页授权access_token，避免过期</p>\n<p> 四、通过网页授权access_token和openid获取用户基本信息（支持UnionID机制）  </p>\n<h2 id=\"接口设计\"><a href=\"#接口设计\" class=\"headerlink\" title=\"接口设计\"></a>接口设计</h2><p>第一步 用户授权页面 多是前端调起</p>\n<p>在确保微信公众账号拥有授权作用域（scope参数）的权限的前提下<br>（已认证服务号，默认拥有scope参数中的snsapi_base和snsapi_userinfo 权限），引导关注者打开如下页面：</p>\n<p><a href=\"https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE#wechat_redirect\">https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE#wechat_redirect</a></p>\n<p>第二步就是跳到后端设计的接口<br>接口传参数就是code  grant_type<br>后端接口中实现授权 流程中 2~4 步骤 实现授权登录</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>"},{"title":"php开发-laravel中间件开发应用","abbrlink":"99fb5d5d","date":"2024-10-18T05:52:43.000Z","_content":"","source":"_posts/php开发-laravel中间件开发应用.md","raw":"---\ntitle: php开发-laravel中间件开发应用\nabbrlink: 99fb5d5d\ndate: 2024-10-18 13:52:43\ntags:\ncategories:\n  - PHP开发\n---\n","slug":"php开发-laravel中间件开发应用","published":1,"updated":"2024-10-18T05:57:10.602Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm2ebjhln0000dkoc9wupe6t9","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"php开发-fastadmin键值组件(Fieldlist)","abbrlink":"c70fd524","date":"2024-08-08T11:56:55.000Z","_content":"\n# fieldlist中有select\n\nselectpicker貌似不兼容的\n模版语法 art-template\nedit 页面select默认选中值 [先执行php代码 最后js取渲染模版的]\n\n\nart-template中使用if\n```js\n<%if(…){%>  html  <%}else{%> html  <%}%>\n```\n\nedit页面 代码示例\n```html\n   <script type=\"text/html\" id=\"testtpl\">\n        <dd class=\"form-inline\">\n            <input type=\"hidden\" name=\"row[<%=name%>][<%=index%>][id]\" class=\"form-control\" value=\"<%=row['id']%>\" size=\"2\">\n\n            <select   data-id=\"<%=index%>\" class=\"couponname form-control\"  name=\"row[<%=name%>][<%=index%>][coupon_id]\" class=\"form-control\" style=\"width: 111px\">\n                <option value=\"\">请选择</option>\n\n                <?php\n                                            foreach($coupon as $vo){\n                                               echo '<option name=\"'.$vo['name'].'\" value=\"'.$vo['id'].'\"     <% if (row[\"coupon_id\"]&&row[\"coupon_id\"].indexOf(\"'.$vo[\"id\"].'\")>-1) { %> selected <% } %>     >'.$vo['name'].'</option>';\n                }\n\n                ?>\n                <option value=\"-1\">谢谢参与</option>\n            </select>\n            <input type=\"text\"   id=\"num<%=index%>\"  name=\"row[<%=name%>][<%=index%>][num]\" readonly class=\"form-control\" value=\"<%=row['num']%>\" size=\"2\">\n            <input type=\"text\" name=\"row[<%=name%>][<%=index%>][scale]\" class=\"form-control\" value=\"<%=row['scale']%>\" size=\"1\">%\n            <input type=\"text\" name=\"<%=name%>[<%=index%>][icon]\" id=\"c-downloadurl-<%=index%>\" class=\"form-control\" value=\"<%=row.icon%>\" style=\"width:140px;\"/>\n            <div class=\"btn-group\">\n                <button type=\"button\" id=\"plupload-downloadurl-<%=index%>\" class=\"btn btn-danger plupload\" data-input-id=\"c-downloadurl-<%=index%>\" data-mimetype=\"*\" data-multiple=\"false\"><i class=\"fa fa-upload\"></i></button>\n            </div>\n        </dd>\n    </script>\n```","source":"_posts/php开发-fastadmin键值组件-Fieldlist.md","raw":"---\ntitle: php开发-fastadmin键值组件(Fieldlist)\nabbrlink: c70fd524\ndate: 2024-08-08 19:56:55\ntags: fastadmin\n---\n\n# fieldlist中有select\n\nselectpicker貌似不兼容的\n模版语法 art-template\nedit 页面select默认选中值 [先执行php代码 最后js取渲染模版的]\n\n\nart-template中使用if\n```js\n<%if(…){%>  html  <%}else{%> html  <%}%>\n```\n\nedit页面 代码示例\n```html\n   <script type=\"text/html\" id=\"testtpl\">\n        <dd class=\"form-inline\">\n            <input type=\"hidden\" name=\"row[<%=name%>][<%=index%>][id]\" class=\"form-control\" value=\"<%=row['id']%>\" size=\"2\">\n\n            <select   data-id=\"<%=index%>\" class=\"couponname form-control\"  name=\"row[<%=name%>][<%=index%>][coupon_id]\" class=\"form-control\" style=\"width: 111px\">\n                <option value=\"\">请选择</option>\n\n                <?php\n                                            foreach($coupon as $vo){\n                                               echo '<option name=\"'.$vo['name'].'\" value=\"'.$vo['id'].'\"     <% if (row[\"coupon_id\"]&&row[\"coupon_id\"].indexOf(\"'.$vo[\"id\"].'\")>-1) { %> selected <% } %>     >'.$vo['name'].'</option>';\n                }\n\n                ?>\n                <option value=\"-1\">谢谢参与</option>\n            </select>\n            <input type=\"text\"   id=\"num<%=index%>\"  name=\"row[<%=name%>][<%=index%>][num]\" readonly class=\"form-control\" value=\"<%=row['num']%>\" size=\"2\">\n            <input type=\"text\" name=\"row[<%=name%>][<%=index%>][scale]\" class=\"form-control\" value=\"<%=row['scale']%>\" size=\"1\">%\n            <input type=\"text\" name=\"<%=name%>[<%=index%>][icon]\" id=\"c-downloadurl-<%=index%>\" class=\"form-control\" value=\"<%=row.icon%>\" style=\"width:140px;\"/>\n            <div class=\"btn-group\">\n                <button type=\"button\" id=\"plupload-downloadurl-<%=index%>\" class=\"btn btn-danger plupload\" data-input-id=\"c-downloadurl-<%=index%>\" data-mimetype=\"*\" data-multiple=\"false\"><i class=\"fa fa-upload\"></i></button>\n            </div>\n        </dd>\n    </script>\n```","slug":"php开发-fastadmin键值组件-Fieldlist","published":1,"updated":"2024-10-18T06:04:02.835Z","_id":"cm2ebr4vw00058ooc35wrhcqh","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"fieldlist中有select\"><a href=\"#fieldlist中有select\" class=\"headerlink\" title=\"fieldlist中有select\"></a>fieldlist中有select</h1><p>selectpicker貌似不兼容的<br>模版语法 art-template<br>edit 页面select默认选中值 [先执行php代码 最后js取渲染模版的]</p>\n<p>art-template中使用if</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%<span class=\"keyword\">if</span>(…)&#123;%&gt;  html  &lt;%&#125;<span class=\"keyword\">else</span>&#123;%&gt; html  &lt;%&#125;%&gt;</span><br></pre></td></tr></table></figure>\n\n<p>edit页面 代码示例</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/html&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;testtpl&quot;</span>&gt;</span><span class=\"handlebars\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">     <span class=\"tag\">&lt;<span class=\"name\">dd</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;form-inline&quot;</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][id]&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;form-control&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&lt;%=row[&#x27;id&#x27;]%&gt;&quot;</span> <span class=\"attr\">size</span>=<span class=\"string\">&quot;2&quot;</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\"></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;<span class=\"name\">select</span>   <span class=\"attr\">data-id</span>=<span class=\"string\">&quot;&lt;%=index%&gt;&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;couponname form-control&quot;</span>  <span class=\"attr\">name</span>=<span class=\"string\">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][coupon_id]&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;form-control&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;width: 111px&quot;</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">             <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&quot;</span>&gt;</span>请选择<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\"></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">             &lt;?php</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">                                         foreach($coupon as $vo)&#123;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">                                            echo &#x27;<span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;&#x27;.$vo[&#x27;name&#x27;].&#x27;&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&#x27;.$vo[&#x27;id&#x27;].&#x27;&quot;</span>     &lt;% <span class=\"attr\">if</span> (<span class=\"attr\">row</span>[&quot;<span class=\"attr\">coupon_id</span>&quot;]&amp;&amp;<span class=\"attr\">row</span>[&quot;<span class=\"attr\">coupon_id</span>&quot;]<span class=\"attr\">.indexOf</span>(&quot;&#x27;<span class=\"attr\">.</span>$<span class=\"attr\">vo</span>[&quot;<span class=\"attr\">id</span>&quot;]<span class=\"attr\">.</span>&#x27;&quot;)&gt;</span>-1) &#123; %&gt; selected &lt;% &#125; %&gt;     &gt;&#x27;.$vo[&#x27;name&#x27;].&#x27;<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span>&#x27;;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">             &#125;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\"></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">             ?&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">             <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;-1&quot;</span>&gt;</span>谢谢参与<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span>   <span class=\"attr\">id</span>=<span class=\"string\">&quot;num&lt;%=index%&gt;&quot;</span>  <span class=\"attr\">name</span>=<span class=\"string\">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][num]&quot;</span> <span class=\"attr\">readonly</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;form-control&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&lt;%=row[&#x27;num&#x27;]%&gt;&quot;</span> <span class=\"attr\">size</span>=<span class=\"string\">&quot;2&quot;</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][scale]&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;form-control&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&lt;%=row[&#x27;scale&#x27;]%&gt;&quot;</span> <span class=\"attr\">size</span>=<span class=\"string\">&quot;1&quot;</span>&gt;</span>%</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;&lt;%=name%&gt;[&lt;%=index%&gt;][icon]&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;c-downloadurl-&lt;%=index%&gt;&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;form-control&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&lt;%=row.icon%&gt;&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;width:140px;&quot;</span>/&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;btn-group&quot;</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">             <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;button&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;plupload-downloadurl-&lt;%=index%&gt;&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;btn btn-danger plupload&quot;</span> <span class=\"attr\">data-input-id</span>=<span class=\"string\">&quot;c-downloadurl-&lt;%=index%&gt;&quot;</span> <span class=\"attr\">data-mimetype</span>=<span class=\"string\">&quot;*&quot;</span> <span class=\"attr\">data-multiple</span>=<span class=\"string\">&quot;false&quot;</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;fa fa-upload&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">     <span class=\"tag\">&lt;/<span class=\"name\">dd</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\"> </span></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"length":2289,"excerpt":"","more":"<h1 id=\"fieldlist中有select\"><a href=\"#fieldlist中有select\" class=\"headerlink\" title=\"fieldlist中有select\"></a>fieldlist中有select</h1><p>selectpicker貌似不兼容的<br>模版语法 art-template<br>edit 页面select默认选中值 [先执行php代码 最后js取渲染模版的]</p>\n<p>art-template中使用if</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%<span class=\"keyword\">if</span>(…)&#123;%&gt;  html  &lt;%&#125;<span class=\"keyword\">else</span>&#123;%&gt; html  &lt;%&#125;%&gt;</span><br></pre></td></tr></table></figure>\n\n<p>edit页面 代码示例</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/html&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;testtpl&quot;</span>&gt;</span><span class=\"handlebars\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">     <span class=\"tag\">&lt;<span class=\"name\">dd</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;form-inline&quot;</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][id]&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;form-control&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&lt;%=row[&#x27;id&#x27;]%&gt;&quot;</span> <span class=\"attr\">size</span>=<span class=\"string\">&quot;2&quot;</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\"></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;<span class=\"name\">select</span>   <span class=\"attr\">data-id</span>=<span class=\"string\">&quot;&lt;%=index%&gt;&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;couponname form-control&quot;</span>  <span class=\"attr\">name</span>=<span class=\"string\">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][coupon_id]&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;form-control&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;width: 111px&quot;</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">             <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&quot;</span>&gt;</span>请选择<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\"></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">             &lt;?php</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">                                         foreach($coupon as $vo)&#123;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">                                            echo &#x27;<span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;&#x27;.$vo[&#x27;name&#x27;].&#x27;&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&#x27;.$vo[&#x27;id&#x27;].&#x27;&quot;</span>     &lt;% <span class=\"attr\">if</span> (<span class=\"attr\">row</span>[&quot;<span class=\"attr\">coupon_id</span>&quot;]&amp;&amp;<span class=\"attr\">row</span>[&quot;<span class=\"attr\">coupon_id</span>&quot;]<span class=\"attr\">.indexOf</span>(&quot;&#x27;<span class=\"attr\">.</span>$<span class=\"attr\">vo</span>[&quot;<span class=\"attr\">id</span>&quot;]<span class=\"attr\">.</span>&#x27;&quot;)&gt;</span>-1) &#123; %&gt; selected &lt;% &#125; %&gt;     &gt;&#x27;.$vo[&#x27;name&#x27;].&#x27;<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span>&#x27;;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">             &#125;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\"></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">             ?&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">             <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;-1&quot;</span>&gt;</span>谢谢参与<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span>   <span class=\"attr\">id</span>=<span class=\"string\">&quot;num&lt;%=index%&gt;&quot;</span>  <span class=\"attr\">name</span>=<span class=\"string\">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][num]&quot;</span> <span class=\"attr\">readonly</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;form-control&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&lt;%=row[&#x27;num&#x27;]%&gt;&quot;</span> <span class=\"attr\">size</span>=<span class=\"string\">&quot;2&quot;</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][scale]&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;form-control&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&lt;%=row[&#x27;scale&#x27;]%&gt;&quot;</span> <span class=\"attr\">size</span>=<span class=\"string\">&quot;1&quot;</span>&gt;</span>%</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;&lt;%=name%&gt;[&lt;%=index%&gt;][icon]&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;c-downloadurl-&lt;%=index%&gt;&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;form-control&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&lt;%=row.icon%&gt;&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;width:140px;&quot;</span>/&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;btn-group&quot;</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">             <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;button&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;plupload-downloadurl-&lt;%=index%&gt;&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;btn btn-danger plupload&quot;</span> <span class=\"attr\">data-input-id</span>=<span class=\"string\">&quot;c-downloadurl-&lt;%=index%&gt;&quot;</span> <span class=\"attr\">data-mimetype</span>=<span class=\"string\">&quot;*&quot;</span> <span class=\"attr\">data-multiple</span>=<span class=\"string\">&quot;false&quot;</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;fa fa-upload&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">         <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\">     <span class=\"tag\">&lt;/<span class=\"name\">dd</span>&gt;</span></span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"handlebars\"> </span></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>"},{"title":"php开发-fastadmin中搜索日期时间的处理","abbrlink":"cb6a68f0","date":"2024-08-13T11:22:27.000Z","_content":"\n\n# 问题\n\n在使用FastAdmin时，遇到日期时间搜索的问题，JS中的RANGE或BETWEEN操作生成的SQL总是针对时间戳的区间查询。\n通过分析代码发现，RANGE操作符会自动转为BETWEEN TIME，而BETWEEN操作符在含有datetimepicker样式的输入框中会被强制转换为RANGE。\n为了解决这个问题，屏蔽了bootstrap-table-commonsearch.js中将operate置为RANGE的代码段，\n实现了对日期时间的正确搜索\n\n\n\n正常一般这么写\n```js\n  {field: 'notice_time',title: \"通知时间\",operate: 'Range',addclass: 'datetimerange',formatter: Table.api.formatter.datetime,data:'data-date-format=\"YYYY-MM-DD\"'},\n```\n\nfastadmin 后端处理 BETWEEN TIME\n\n也就是把搜索条件值转换为时间戳  进行between 搜索\n\n当notice_time 存的是“xxxx-xx-xx”格式 就搜索不到\n\n\n\n那就只能用\n```js\n  {field: 'notice_time',title: \"通知时间\",operate: 'BETWEEN',addclass: 'datetimepicker',formatter: Table.api.formatter.datetime,data:'data-date-format=\"YYYY-MM-DD\"'},\n```\n\n但是bootstrap-table-commonsearch.js 中有将datetimepicker样式的operate字段  强制转为Range了\n```js\n  if ($(\"[name='\" + name + \"']:first\", that.$commonsearch).hasClass(\"datetimepicker\")) {\n                       sym = 'RANGE';\n  }\n```\n\n\n# 解决方案\n\n## 方案一\nbootstrap-table-commonsearch.js 中这段代码注释\n\n\n重新生成bootstrap-table-commonsearch.min.js\n\n php think min -m backend -r all\n\n 或者直接修改bootstrap-table-commonsearch.min.js\n\n## 方案二\n\n修改数据库字段类型 存储时间戳\n","source":"_posts/php开发-fastadmin中搜索日期时间的处理.md","raw":"---\ntitle: php开发-fastadmin中搜索日期时间的处理\nabbrlink: cb6a68f0\ndate: 2024-08-13 19:22:27\ntags: fastadmin\ncategories:\n  - PHP开发\n---\n\n\n# 问题\n\n在使用FastAdmin时，遇到日期时间搜索的问题，JS中的RANGE或BETWEEN操作生成的SQL总是针对时间戳的区间查询。\n通过分析代码发现，RANGE操作符会自动转为BETWEEN TIME，而BETWEEN操作符在含有datetimepicker样式的输入框中会被强制转换为RANGE。\n为了解决这个问题，屏蔽了bootstrap-table-commonsearch.js中将operate置为RANGE的代码段，\n实现了对日期时间的正确搜索\n\n\n\n正常一般这么写\n```js\n  {field: 'notice_time',title: \"通知时间\",operate: 'Range',addclass: 'datetimerange',formatter: Table.api.formatter.datetime,data:'data-date-format=\"YYYY-MM-DD\"'},\n```\n\nfastadmin 后端处理 BETWEEN TIME\n\n也就是把搜索条件值转换为时间戳  进行between 搜索\n\n当notice_time 存的是“xxxx-xx-xx”格式 就搜索不到\n\n\n\n那就只能用\n```js\n  {field: 'notice_time',title: \"通知时间\",operate: 'BETWEEN',addclass: 'datetimepicker',formatter: Table.api.formatter.datetime,data:'data-date-format=\"YYYY-MM-DD\"'},\n```\n\n但是bootstrap-table-commonsearch.js 中有将datetimepicker样式的operate字段  强制转为Range了\n```js\n  if ($(\"[name='\" + name + \"']:first\", that.$commonsearch).hasClass(\"datetimepicker\")) {\n                       sym = 'RANGE';\n  }\n```\n\n\n# 解决方案\n\n## 方案一\nbootstrap-table-commonsearch.js 中这段代码注释\n\n\n重新生成bootstrap-table-commonsearch.min.js\n\n php think min -m backend -r all\n\n 或者直接修改bootstrap-table-commonsearch.min.js\n\n## 方案二\n\n修改数据库字段类型 存储时间戳\n","slug":"php开发-fastadmin中搜索日期时间的处理","published":1,"updated":"2024-10-18T06:05:08.772Z","_id":"cm2ebsd2l00008socdx5qc3po","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p>在使用FastAdmin时，遇到日期时间搜索的问题，JS中的RANGE或BETWEEN操作生成的SQL总是针对时间戳的区间查询。<br>通过分析代码发现，RANGE操作符会自动转为BETWEEN TIME，而BETWEEN操作符在含有datetimepicker样式的输入框中会被强制转换为RANGE。<br>为了解决这个问题，屏蔽了bootstrap-table-commonsearch.js中将operate置为RANGE的代码段，<br>实现了对日期时间的正确搜索</p>\n<p>正常一般这么写</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"attr\">field</span>: <span class=\"string\">&#x27;notice_time&#x27;</span>,<span class=\"attr\">title</span>: <span class=\"string\">&quot;通知时间&quot;</span>,<span class=\"attr\">operate</span>: <span class=\"string\">&#x27;Range&#x27;</span>,<span class=\"attr\">addclass</span>: <span class=\"string\">&#x27;datetimerange&#x27;</span>,<span class=\"attr\">formatter</span>: Table.api.formatter.datetime,<span class=\"attr\">data</span>:<span class=\"string\">&#x27;data-date-format=&quot;YYYY-MM-DD&quot;&#x27;</span>&#125;,</span><br></pre></td></tr></table></figure>\n\n<p>fastadmin 后端处理 BETWEEN TIME</p>\n<p>也就是把搜索条件值转换为时间戳  进行between 搜索</p>\n<p>当notice_time 存的是“xxxx-xx-xx”格式 就搜索不到</p>\n<p>那就只能用</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"attr\">field</span>: <span class=\"string\">&#x27;notice_time&#x27;</span>,<span class=\"attr\">title</span>: <span class=\"string\">&quot;通知时间&quot;</span>,<span class=\"attr\">operate</span>: <span class=\"string\">&#x27;BETWEEN&#x27;</span>,<span class=\"attr\">addclass</span>: <span class=\"string\">&#x27;datetimepicker&#x27;</span>,<span class=\"attr\">formatter</span>: Table.api.formatter.datetime,<span class=\"attr\">data</span>:<span class=\"string\">&#x27;data-date-format=&quot;YYYY-MM-DD&quot;&#x27;</span>&#125;,</span><br></pre></td></tr></table></figure>\n\n<p>但是bootstrap-table-commonsearch.js 中有将datetimepicker样式的operate字段  强制转为Range了</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> ($(<span class=\"string\">&quot;[name=&#x27;&quot;</span> + name + <span class=\"string\">&quot;&#x27;]:first&quot;</span>, that.$commonsearch).hasClass(<span class=\"string\">&quot;datetimepicker&quot;</span>)) &#123;</span><br><span class=\"line\">                     sym = <span class=\"string\">&#x27;RANGE&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h1><h2 id=\"方案一\"><a href=\"#方案一\" class=\"headerlink\" title=\"方案一\"></a>方案一</h2><p>bootstrap-table-commonsearch.js 中这段代码注释</p>\n<p>重新生成bootstrap-table-commonsearch.min.js</p>\n<p> php think min -m backend -r all</p>\n<p> 或者直接修改bootstrap-table-commonsearch.min.js</p>\n<h2 id=\"方案二\"><a href=\"#方案二\" class=\"headerlink\" title=\"方案二\"></a>方案二</h2><p>修改数据库字段类型 存储时间戳</p>\n","site":{"data":{}},"length":1164,"excerpt":"","more":"<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p>在使用FastAdmin时，遇到日期时间搜索的问题，JS中的RANGE或BETWEEN操作生成的SQL总是针对时间戳的区间查询。<br>通过分析代码发现，RANGE操作符会自动转为BETWEEN TIME，而BETWEEN操作符在含有datetimepicker样式的输入框中会被强制转换为RANGE。<br>为了解决这个问题，屏蔽了bootstrap-table-commonsearch.js中将operate置为RANGE的代码段，<br>实现了对日期时间的正确搜索</p>\n<p>正常一般这么写</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"attr\">field</span>: <span class=\"string\">&#x27;notice_time&#x27;</span>,<span class=\"attr\">title</span>: <span class=\"string\">&quot;通知时间&quot;</span>,<span class=\"attr\">operate</span>: <span class=\"string\">&#x27;Range&#x27;</span>,<span class=\"attr\">addclass</span>: <span class=\"string\">&#x27;datetimerange&#x27;</span>,<span class=\"attr\">formatter</span>: Table.api.formatter.datetime,<span class=\"attr\">data</span>:<span class=\"string\">&#x27;data-date-format=&quot;YYYY-MM-DD&quot;&#x27;</span>&#125;,</span><br></pre></td></tr></table></figure>\n\n<p>fastadmin 后端处理 BETWEEN TIME</p>\n<p>也就是把搜索条件值转换为时间戳  进行between 搜索</p>\n<p>当notice_time 存的是“xxxx-xx-xx”格式 就搜索不到</p>\n<p>那就只能用</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"attr\">field</span>: <span class=\"string\">&#x27;notice_time&#x27;</span>,<span class=\"attr\">title</span>: <span class=\"string\">&quot;通知时间&quot;</span>,<span class=\"attr\">operate</span>: <span class=\"string\">&#x27;BETWEEN&#x27;</span>,<span class=\"attr\">addclass</span>: <span class=\"string\">&#x27;datetimepicker&#x27;</span>,<span class=\"attr\">formatter</span>: Table.api.formatter.datetime,<span class=\"attr\">data</span>:<span class=\"string\">&#x27;data-date-format=&quot;YYYY-MM-DD&quot;&#x27;</span>&#125;,</span><br></pre></td></tr></table></figure>\n\n<p>但是bootstrap-table-commonsearch.js 中有将datetimepicker样式的operate字段  强制转为Range了</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> ($(<span class=\"string\">&quot;[name=&#x27;&quot;</span> + name + <span class=\"string\">&quot;&#x27;]:first&quot;</span>, that.$commonsearch).hasClass(<span class=\"string\">&quot;datetimepicker&quot;</span>)) &#123;</span><br><span class=\"line\">                     sym = <span class=\"string\">&#x27;RANGE&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h1><h2 id=\"方案一\"><a href=\"#方案一\" class=\"headerlink\" title=\"方案一\"></a>方案一</h2><p>bootstrap-table-commonsearch.js 中这段代码注释</p>\n<p>重新生成bootstrap-table-commonsearch.min.js</p>\n<p> php think min -m backend -r all</p>\n<p> 或者直接修改bootstrap-table-commonsearch.min.js</p>\n<h2 id=\"方案二\"><a href=\"#方案二\" class=\"headerlink\" title=\"方案二\"></a>方案二</h2><p>修改数据库字段类型 存储时间戳</p>\n"},{"title":"php开发-使用OpenSSL进程DES加密","abbrlink":"28dcf7b8","date":"2024-11-17T09:10:10.000Z","_content":"\n# 一、遇到问题DES 加密返回空\n\n## 1.1加密代码\n\n    bin2hex(openssl_encrypt($str, 'DES-ECB', $this->appSecret, OPENSSL_RAW_DATA));\n    \n## 1.2 解决方案\n    \n1.检查 openssl 库是否安装\n\n php -m|grep openssl\n \n2.过 <font color=\"red\">openssl_error_string() </font>调试代码 处理\n\n\n## 1.3报错 【error:0308010C:digital envelope routines::unsupported】\n\n<font color=\"red\">原因是: 服务器上的openssl是1.1版本, 本地是3.0版本</font>\n\n找到 openssl.cnf文件\n\n可以通过phpinfo找到openssl.cnf 或者 php -i|grep  openssl.cnf\n\n找到[provider_sect]并将其更改为以下内容\n```apacheconfig\n[provider_sect]\ndefault = default_sect\nlegacy = legacy_sect\n```\n\n找到[default_sect]并将其更改为以下内容\n```apacheconfig\n[default_sect]\nactivate = 1\n[legacy_sect]\nactivate = 1\n```\n\n# 二、DES加密、解密php中使用\n\n\n## 2.1\n\n加密模式：DES-ECB\n填充模式：PKCS#7 \n\n\n```php\n// pkcs#7\nbin2hex(openssl_encrypt(\"加密字符串\", 'DES-ECB', \"key字符串\", OPENSSL_RAW_DATA));\n```\n\n\n\n```php\n$key = str_pad($key,24,'0');\nbin2hex(openssl_encrypt(\"加密字符串\", 'DES-ECB', \"key字符串\", OPENSSL_RAW_DATA));\n\n$encrypted = pack('H*', $info);\n$key = str_pad($key,24,'0');\n\n```\n## 2.2      ","source":"_posts/php开发-使用OpenSSL进程DES加密.md","raw":"---\ntitle: php开发-使用OpenSSL进程DES加密\nabbrlink: 28dcf7b8\ndate: 2024-11-17 17:10:10\ntags:\n---\n\n# 一、遇到问题DES 加密返回空\n\n## 1.1加密代码\n\n    bin2hex(openssl_encrypt($str, 'DES-ECB', $this->appSecret, OPENSSL_RAW_DATA));\n    \n## 1.2 解决方案\n    \n1.检查 openssl 库是否安装\n\n php -m|grep openssl\n \n2.过 <font color=\"red\">openssl_error_string() </font>调试代码 处理\n\n\n## 1.3报错 【error:0308010C:digital envelope routines::unsupported】\n\n<font color=\"red\">原因是: 服务器上的openssl是1.1版本, 本地是3.0版本</font>\n\n找到 openssl.cnf文件\n\n可以通过phpinfo找到openssl.cnf 或者 php -i|grep  openssl.cnf\n\n找到[provider_sect]并将其更改为以下内容\n```apacheconfig\n[provider_sect]\ndefault = default_sect\nlegacy = legacy_sect\n```\n\n找到[default_sect]并将其更改为以下内容\n```apacheconfig\n[default_sect]\nactivate = 1\n[legacy_sect]\nactivate = 1\n```\n\n# 二、DES加密、解密php中使用\n\n\n## 2.1\n\n加密模式：DES-ECB\n填充模式：PKCS#7 \n\n\n```php\n// pkcs#7\nbin2hex(openssl_encrypt(\"加密字符串\", 'DES-ECB', \"key字符串\", OPENSSL_RAW_DATA));\n```\n\n\n\n```php\n$key = str_pad($key,24,'0');\nbin2hex(openssl_encrypt(\"加密字符串\", 'DES-ECB', \"key字符串\", OPENSSL_RAW_DATA));\n\n$encrypted = pack('H*', $info);\n$key = str_pad($key,24,'0');\n\n```\n## 2.2      ","slug":"php开发-使用OpenSSL进程DES加密","published":1,"updated":"2024-11-18T11:12:11.497Z","_id":"cm3mtzs990000bcoc2ew16atu","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、遇到问题DES-加密返回空\"><a href=\"#一、遇到问题DES-加密返回空\" class=\"headerlink\" title=\"一、遇到问题DES 加密返回空\"></a>一、遇到问题DES 加密返回空</h1><h2 id=\"1-1加密代码\"><a href=\"#1-1加密代码\" class=\"headerlink\" title=\"1.1加密代码\"></a>1.1加密代码</h2><pre><code>bin2hex(openssl_encrypt($str, &#39;DES-ECB&#39;, $this-&gt;appSecret, OPENSSL_RAW_DATA));\n</code></pre>\n<h2 id=\"1-2-解决方案\"><a href=\"#1-2-解决方案\" class=\"headerlink\" title=\"1.2 解决方案\"></a>1.2 解决方案</h2><p>1.检查 openssl 库是否安装</p>\n<p> php -m|grep openssl</p>\n<p>2.过 <font color=\"red\">openssl_error_string() </font>调试代码 处理</p>\n<h2 id=\"1-3报错-【error-0308010C-digital-envelope-routines-unsupported】\"><a href=\"#1-3报错-【error-0308010C-digital-envelope-routines-unsupported】\" class=\"headerlink\" title=\"1.3报错 【error:0308010C:digital envelope routines::unsupported】\"></a>1.3报错 【error:0308010C:digital envelope routines::unsupported】</h2><p><font color=\"red\">原因是: 服务器上的openssl是1.1版本, 本地是3.0版本</font></p>\n<p>找到 openssl.cnf文件</p>\n<p>可以通过phpinfo找到openssl.cnf 或者 php -i|grep  openssl.cnf</p>\n<p>找到[provider_sect]并将其更改为以下内容</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[provider_sect]</span><br><span class=\"line\">default = default_sect</span><br><span class=\"line\">legacy = legacy_sect</span><br></pre></td></tr></table></figure>\n\n<p>找到[default_sect]并将其更改为以下内容</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[default_sect]</span><br><span class=\"line\">activate = 1</span><br><span class=\"line\">[legacy_sect]</span><br><span class=\"line\">activate = 1</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"二、DES加密、解密php中使用\"><a href=\"#二、DES加密、解密php中使用\" class=\"headerlink\" title=\"二、DES加密、解密php中使用\"></a>二、DES加密、解密php中使用</h1><h2 id=\"2-1\"><a href=\"#2-1\" class=\"headerlink\" title=\"2.1\"></a>2.1</h2><p>加密模式：DES-ECB<br>填充模式：PKCS#7 </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pkcs#7</span></span><br><span class=\"line\">bin2hex(openssl_encrypt(<span class=\"string\">&quot;加密字符串&quot;</span>, <span class=\"string\">&#x27;DES-ECB&#x27;</span>, <span class=\"string\">&quot;key字符串&quot;</span>, OPENSSL_RAW_DATA));</span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$key</span> = str_pad(<span class=\"variable\">$key</span>,<span class=\"number\">24</span>,<span class=\"string\">&#x27;0&#x27;</span>);</span><br><span class=\"line\">bin2hex(openssl_encrypt(<span class=\"string\">&quot;加密字符串&quot;</span>, <span class=\"string\">&#x27;DES-ECB&#x27;</span>, <span class=\"string\">&quot;key字符串&quot;</span>, OPENSSL_RAW_DATA));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$encrypted</span> = pack(<span class=\"string\">&#x27;H*&#x27;</span>, <span class=\"variable\">$info</span>);</span><br><span class=\"line\"><span class=\"variable\">$key</span> = str_pad(<span class=\"variable\">$key</span>,<span class=\"number\">24</span>,<span class=\"string\">&#x27;0&#x27;</span>);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2\"><a href=\"#2-2\" class=\"headerlink\" title=\"2.2\"></a>2.2</h2>","site":{"data":{}},"length":860,"excerpt":"","more":"<h1 id=\"一、遇到问题DES-加密返回空\"><a href=\"#一、遇到问题DES-加密返回空\" class=\"headerlink\" title=\"一、遇到问题DES 加密返回空\"></a>一、遇到问题DES 加密返回空</h1><h2 id=\"1-1加密代码\"><a href=\"#1-1加密代码\" class=\"headerlink\" title=\"1.1加密代码\"></a>1.1加密代码</h2><pre><code>bin2hex(openssl_encrypt($str, &#39;DES-ECB&#39;, $this-&gt;appSecret, OPENSSL_RAW_DATA));\n</code></pre>\n<h2 id=\"1-2-解决方案\"><a href=\"#1-2-解决方案\" class=\"headerlink\" title=\"1.2 解决方案\"></a>1.2 解决方案</h2><p>1.检查 openssl 库是否安装</p>\n<p> php -m|grep openssl</p>\n<p>2.过 <font color=\"red\">openssl_error_string() </font>调试代码 处理</p>\n<h2 id=\"1-3报错-【error-0308010C-digital-envelope-routines-unsupported】\"><a href=\"#1-3报错-【error-0308010C-digital-envelope-routines-unsupported】\" class=\"headerlink\" title=\"1.3报错 【error:0308010C:digital envelope routines::unsupported】\"></a>1.3报错 【error:0308010C:digital envelope routines::unsupported】</h2><p><font color=\"red\">原因是: 服务器上的openssl是1.1版本, 本地是3.0版本</font></p>\n<p>找到 openssl.cnf文件</p>\n<p>可以通过phpinfo找到openssl.cnf 或者 php -i|grep  openssl.cnf</p>\n<p>找到[provider_sect]并将其更改为以下内容</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[provider_sect]</span><br><span class=\"line\">default = default_sect</span><br><span class=\"line\">legacy = legacy_sect</span><br></pre></td></tr></table></figure>\n\n<p>找到[default_sect]并将其更改为以下内容</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[default_sect]</span><br><span class=\"line\">activate = 1</span><br><span class=\"line\">[legacy_sect]</span><br><span class=\"line\">activate = 1</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"二、DES加密、解密php中使用\"><a href=\"#二、DES加密、解密php中使用\" class=\"headerlink\" title=\"二、DES加密、解密php中使用\"></a>二、DES加密、解密php中使用</h1><h2 id=\"2-1\"><a href=\"#2-1\" class=\"headerlink\" title=\"2.1\"></a>2.1</h2><p>加密模式：DES-ECB<br>填充模式：PKCS#7 </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pkcs#7</span></span><br><span class=\"line\">bin2hex(openssl_encrypt(<span class=\"string\">&quot;加密字符串&quot;</span>, <span class=\"string\">&#x27;DES-ECB&#x27;</span>, <span class=\"string\">&quot;key字符串&quot;</span>, OPENSSL_RAW_DATA));</span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$key</span> = str_pad(<span class=\"variable\">$key</span>,<span class=\"number\">24</span>,<span class=\"string\">&#x27;0&#x27;</span>);</span><br><span class=\"line\">bin2hex(openssl_encrypt(<span class=\"string\">&quot;加密字符串&quot;</span>, <span class=\"string\">&#x27;DES-ECB&#x27;</span>, <span class=\"string\">&quot;key字符串&quot;</span>, OPENSSL_RAW_DATA));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$encrypted</span> = pack(<span class=\"string\">&#x27;H*&#x27;</span>, <span class=\"variable\">$info</span>);</span><br><span class=\"line\"><span class=\"variable\">$key</span> = str_pad(<span class=\"variable\">$key</span>,<span class=\"number\">24</span>,<span class=\"string\">&#x27;0&#x27;</span>);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2\"><a href=\"#2-2\" class=\"headerlink\" title=\"2.2\"></a>2.2</h2>"},{"title":"linux-screen软件应用","abbrlink":"87fcad5d","date":"2024-11-25T11:00:26.000Z","_content":"\n\n#screen 简介\n\nscreen被称之为一个全屏窗口管理器, 用户可以通过该软件同时连接多个本地或远程的命令行会话，并在其间自由切换。\n注意有会话(session)和窗口(window)两个概念。 进入screen会话后，可在会话中创建多个窗口（window）\n\n\n\n\n# 相关使用命令\n\n\n方式一: 创建有名字的screen任务\n\nscreen -S {task_name}\n\n方式二: 创建没有名字的screen任务\n\nscreen\n\n\n\n查看screen任务\n执行-ls 可以查看到系统中所有的screen任务的信息（如pid）\n\nscreen -ls\n\n\n将screen任务放到后台\n快捷键 ctrl+a+d     此时,程序仍在后台执行;\n\n另外一种方式：再打开一个终端\n\nscreen -d {pid}\n或者\nscreen -d {task_name}\n\n\n\n进入screen任务\nscreen -r {pid}\n或者\nscreen -r {task_name}\n\n\n\n暂离当前screen:\n这个也是screen命令的精髓，用组合键Ctrl+a+d 就能detached当前的screen，回到默认界面。\n\n\n\n杀死当前窗口：\n使用Ctrl+a+k命令\n\n\n关闭当前窗口：\n这个可以直接用Ctrl+d 或者exit 来关闭，当这个窗口是现有screen的最后一个窗口时，\n就会触发上面讲的关闭当前screen的事件了 。\n\n查看当前是否在screen中\necho $STY\n","source":"_posts/linux-screen软件应用.md","raw":"---\ntitle: linux-screen软件应用\nabbrlink: 87fcad5d\ndate: 2024-11-25 19:00:26\ntags:\n  - linux\ncategories:\n  - 服务器相关  \n---\n\n\n#screen 简介\n\nscreen被称之为一个全屏窗口管理器, 用户可以通过该软件同时连接多个本地或远程的命令行会话，并在其间自由切换。\n注意有会话(session)和窗口(window)两个概念。 进入screen会话后，可在会话中创建多个窗口（window）\n\n\n\n\n# 相关使用命令\n\n\n方式一: 创建有名字的screen任务\n\nscreen -S {task_name}\n\n方式二: 创建没有名字的screen任务\n\nscreen\n\n\n\n查看screen任务\n执行-ls 可以查看到系统中所有的screen任务的信息（如pid）\n\nscreen -ls\n\n\n将screen任务放到后台\n快捷键 ctrl+a+d     此时,程序仍在后台执行;\n\n另外一种方式：再打开一个终端\n\nscreen -d {pid}\n或者\nscreen -d {task_name}\n\n\n\n进入screen任务\nscreen -r {pid}\n或者\nscreen -r {task_name}\n\n\n\n暂离当前screen:\n这个也是screen命令的精髓，用组合键Ctrl+a+d 就能detached当前的screen，回到默认界面。\n\n\n\n杀死当前窗口：\n使用Ctrl+a+k命令\n\n\n关闭当前窗口：\n这个可以直接用Ctrl+d 或者exit 来关闭，当这个窗口是现有screen的最后一个窗口时，\n就会触发上面讲的关闭当前screen的事件了 。\n\n查看当前是否在screen中\necho $STY\n","slug":"linux-screen软件应用","published":1,"updated":"2025-07-26T06:06:04.328Z","_id":"cm3wx34t90000ywoce0rt8ufj","comments":1,"layout":"post","photos":[],"link":"","content":"<p>#screen 简介</p>\n<p>screen被称之为一个全屏窗口管理器, 用户可以通过该软件同时连接多个本地或远程的命令行会话，并在其间自由切换。<br>注意有会话(session)和窗口(window)两个概念。 进入screen会话后，可在会话中创建多个窗口（window）</p>\n<h1 id=\"相关使用命令\"><a href=\"#相关使用命令\" class=\"headerlink\" title=\"相关使用命令\"></a>相关使用命令</h1><p>方式一: 创建有名字的screen任务</p>\n<p>screen -S {task_name}</p>\n<p>方式二: 创建没有名字的screen任务</p>\n<p>screen</p>\n<p>查看screen任务<br>执行-ls 可以查看到系统中所有的screen任务的信息（如pid）</p>\n<p>screen -ls</p>\n<p>将screen任务放到后台<br>快捷键 ctrl+a+d     此时,程序仍在后台执行;</p>\n<p>另外一种方式：再打开一个终端</p>\n<p>screen -d {pid}<br>或者<br>screen -d {task_name}</p>\n<p>进入screen任务<br>screen -r {pid}<br>或者<br>screen -r {task_name}</p>\n<p>暂离当前screen:<br>这个也是screen命令的精髓，用组合键Ctrl+a+d 就能detached当前的screen，回到默认界面。</p>\n<p>杀死当前窗口：<br>使用Ctrl+a+k命令</p>\n<p>关闭当前窗口：<br>这个可以直接用Ctrl+d 或者exit 来关闭，当这个窗口是现有screen的最后一个窗口时，<br>就会触发上面讲的关闭当前screen的事件了 。</p>\n<p>查看当前是否在screen中<br>echo $STY</p>\n","site":{"data":{}},"length":557,"excerpt":"","more":"<p>#screen 简介</p>\n<p>screen被称之为一个全屏窗口管理器, 用户可以通过该软件同时连接多个本地或远程的命令行会话，并在其间自由切换。<br>注意有会话(session)和窗口(window)两个概念。 进入screen会话后，可在会话中创建多个窗口（window）</p>\n<h1 id=\"相关使用命令\"><a href=\"#相关使用命令\" class=\"headerlink\" title=\"相关使用命令\"></a>相关使用命令</h1><p>方式一: 创建有名字的screen任务</p>\n<p>screen -S {task_name}</p>\n<p>方式二: 创建没有名字的screen任务</p>\n<p>screen</p>\n<p>查看screen任务<br>执行-ls 可以查看到系统中所有的screen任务的信息（如pid）</p>\n<p>screen -ls</p>\n<p>将screen任务放到后台<br>快捷键 ctrl+a+d     此时,程序仍在后台执行;</p>\n<p>另外一种方式：再打开一个终端</p>\n<p>screen -d {pid}<br>或者<br>screen -d {task_name}</p>\n<p>进入screen任务<br>screen -r {pid}<br>或者<br>screen -r {task_name}</p>\n<p>暂离当前screen:<br>这个也是screen命令的精髓，用组合键Ctrl+a+d 就能detached当前的screen，回到默认界面。</p>\n<p>杀死当前窗口：<br>使用Ctrl+a+k命令</p>\n<p>关闭当前窗口：<br>这个可以直接用Ctrl+d 或者exit 来关闭，当这个窗口是现有screen的最后一个窗口时，<br>就会触发上面讲的关闭当前screen的事件了 。</p>\n<p>查看当前是否在screen中<br>echo $STY</p>\n"},{"title":"linux-防火墙相关","abbrlink":"10974f2f","date":"2024-03-25T10:55:25.000Z","_content":"# 基础\n\nUFW是Debian系列的默认防火墙\n\nfirewall 是红帽系列7及以上的防火墙（如CentOS7.x）\n\niptables是红帽系列6及以下（如CentOS6.x）的防火墙\n\n\nfirewalld、ufw 与iptables的关系，可以理解为两者只是对iptables其进行了一层``封装，\n它们在用户交互方面做了非常多的改进，使其对用户更加友好，不需要再记住原来那么多命令了\n\n\n# ufw相关命令\n\n\n\n# firewalld相关命令\n\n\n\n# 记奇葩问题\n\n    配置了ufw \n    vim /etc/ufw/before.rules\n    \n    *nat\n    :PREROUTING ACCEPT [0:0]\n    :POSTROUTING ACCEPT [0:0]\n    -A PREROUTING -p tcp --dport 63301 -j REDIRECT --to-port 22\n    #-A PREROUTING -p tcp -m tcp --dport 63306 -j DNAT --to-destination 127.0.0.1:22\n    #-A POSTROUTING -j MASQUERADE\n    COMMIT\n\n    生效后iptables 即使ufw 删除 nat 记录还是存在\n    \n    查看iptables nat表\n    sudo iptables -t nat -L -n --line-numbers\n","source":"_posts/linux-防火墙相关.md","raw":"---\ntitle: linux-防火墙相关\nabbrlink: 10974f2f\ndate: 2024-03-25 18:55:25\ntags:\n - linux\ncategories:\n  - 服务器相关  \n  - 防火墙\n---\n# 基础\n\nUFW是Debian系列的默认防火墙\n\nfirewall 是红帽系列7及以上的防火墙（如CentOS7.x）\n\niptables是红帽系列6及以下（如CentOS6.x）的防火墙\n\n\nfirewalld、ufw 与iptables的关系，可以理解为两者只是对iptables其进行了一层``封装，\n它们在用户交互方面做了非常多的改进，使其对用户更加友好，不需要再记住原来那么多命令了\n\n\n# ufw相关命令\n\n\n\n# firewalld相关命令\n\n\n\n# 记奇葩问题\n\n    配置了ufw \n    vim /etc/ufw/before.rules\n    \n    *nat\n    :PREROUTING ACCEPT [0:0]\n    :POSTROUTING ACCEPT [0:0]\n    -A PREROUTING -p tcp --dport 63301 -j REDIRECT --to-port 22\n    #-A PREROUTING -p tcp -m tcp --dport 63306 -j DNAT --to-destination 127.0.0.1:22\n    #-A POSTROUTING -j MASQUERADE\n    COMMIT\n\n    生效后iptables 即使ufw 删除 nat 记录还是存在\n    \n    查看iptables nat表\n    sudo iptables -t nat -L -n --line-numbers\n","slug":"linux-防火墙相关","published":1,"updated":"2025-01-20T01:54:07.893Z","_id":"cm3wxd2km0001ywocdipc8v2c","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"基础\"><a href=\"#基础\" class=\"headerlink\" title=\"基础\"></a>基础</h1><p>UFW是Debian系列的默认防火墙</p>\n<p>firewall 是红帽系列7及以上的防火墙（如CentOS7.x）</p>\n<p>iptables是红帽系列6及以下（如CentOS6.x）的防火墙</p>\n<p>firewalld、ufw 与iptables的关系，可以理解为两者只是对iptables其进行了一层``封装，<br>它们在用户交互方面做了非常多的改进，使其对用户更加友好，不需要再记住原来那么多命令了</p>\n<h1 id=\"ufw相关命令\"><a href=\"#ufw相关命令\" class=\"headerlink\" title=\"ufw相关命令\"></a>ufw相关命令</h1><h1 id=\"firewalld相关命令\"><a href=\"#firewalld相关命令\" class=\"headerlink\" title=\"firewalld相关命令\"></a>firewalld相关命令</h1><h1 id=\"记奇葩问题\"><a href=\"#记奇葩问题\" class=\"headerlink\" title=\"记奇葩问题\"></a>记奇葩问题</h1><pre><code>配置了ufw \nvim /etc/ufw/before.rules\n\n*nat\n:PREROUTING ACCEPT [0:0]\n:POSTROUTING ACCEPT [0:0]\n-A PREROUTING -p tcp --dport 63301 -j REDIRECT --to-port 22\n#-A PREROUTING -p tcp -m tcp --dport 63306 -j DNAT --to-destination 127.0.0.1:22\n#-A POSTROUTING -j MASQUERADE\nCOMMIT\n\n生效后iptables 即使ufw 删除 nat 记录还是存在\n\n查看iptables nat表\nsudo iptables -t nat -L -n --line-numbers\n</code></pre>\n","site":{"data":{}},"length":514,"excerpt":"","more":"<h1 id=\"基础\"><a href=\"#基础\" class=\"headerlink\" title=\"基础\"></a>基础</h1><p>UFW是Debian系列的默认防火墙</p>\n<p>firewall 是红帽系列7及以上的防火墙（如CentOS7.x）</p>\n<p>iptables是红帽系列6及以下（如CentOS6.x）的防火墙</p>\n<p>firewalld、ufw 与iptables的关系，可以理解为两者只是对iptables其进行了一层``封装，<br>它们在用户交互方面做了非常多的改进，使其对用户更加友好，不需要再记住原来那么多命令了</p>\n<h1 id=\"ufw相关命令\"><a href=\"#ufw相关命令\" class=\"headerlink\" title=\"ufw相关命令\"></a>ufw相关命令</h1><h1 id=\"firewalld相关命令\"><a href=\"#firewalld相关命令\" class=\"headerlink\" title=\"firewalld相关命令\"></a>firewalld相关命令</h1><h1 id=\"记奇葩问题\"><a href=\"#记奇葩问题\" class=\"headerlink\" title=\"记奇葩问题\"></a>记奇葩问题</h1><pre><code>配置了ufw \nvim /etc/ufw/before.rules\n\n*nat\n:PREROUTING ACCEPT [0:0]\n:POSTROUTING ACCEPT [0:0]\n-A PREROUTING -p tcp --dport 63301 -j REDIRECT --to-port 22\n#-A PREROUTING -p tcp -m tcp --dport 63306 -j DNAT --to-destination 127.0.0.1:22\n#-A POSTROUTING -j MASQUERADE\nCOMMIT\n\n生效后iptables 即使ufw 删除 nat 记录还是存在\n\n查看iptables nat表\nsudo iptables -t nat -L -n --line-numbers\n</code></pre>\n"},{"title":"Linux服务之crond","abbrlink":"ceed82ea","date":"2023-07-19T06:20:19.000Z","_content":"\n\n# 一、Cron介绍\n\nCron被用来进行Linux系统的计划任务执行\n\n\n# 二、相关目录\n\ncron.d/*用来存放一些软件的Cron设置\n\ncron.daily/每天执行一次的任务\n\ncron.hourly/每小时执行一次的任务\n\ncron.monthly/每个月执行一次的任务\n\ncron.weekly/，每周执行一次的任务\n\n每分钟执行一次脚本\n\n    crontab -e\n    \n# 三、crontab使用\n\n    *  *  *   *  *  命令/脚本\n    分 时 日 月 周\n\n    1  *  *   *  *  命令/脚本   指的是每个小时的第一分钟\n    */1 * * * *     命令/脚本   每分钟执行脚本\n    \n\n    crontab -l\n    查看计划任务列表   \n# 四、/etc/cron.daily 与crontab -e 定义的区别\n    \n   \n    /etc/cron.daily 和 crontab -e 都是用来设置定时任务的方式，但它们有一些不同之处。\n    \n    /etc/cron.daily 是一个目录，里面存放着以 \"cron\" 格式命名的脚本文件。这些脚本会每天执行一次，通常在系统闲置时执行。这个目录中的脚本是全局的，适用于整个系统的所有用户。\n    \n    而 crontab -e 则是一个命令，用于编辑和管理用户个人的 crontab 文件。crontab 文件中定义了用户的定时任务计划。通过编辑 crontab 文件，用户可以设置自己的定时任务，包括每天、每周、每月或其他时间间隔的执行。\n    \n    因此，主要区别在于：\n    \n    /etc/cron.daily 适用于全局系统级别的定时任务，而 crontab -e 是用户级别的定时任务。\n    /etc/cron.daily 中的脚本在每天执行一次，而 crontab -e 可以更精确地设置时间间隔。\n    /etc/cron.daily 中的脚本对所有用户有效，而 crontab -e 只对当前用户有效。\n    需要注意的是，修改 /etc/cron.daily 目录中的文件需要 root 权限，而 crontab -e 只需要用户自己的权限\n    \n # 五、Linux anacron\n \n 执行由于关机  忘记执行的任务\n \n 配置好 /etc/anacrontab 文件\n \n 更具体学习参考http://c.biancheng.net/view/1095.html\n \n \n# 六        ","source":"_posts/linux-crond服务.md","raw":"---\ntitle: Linux服务之crond\nabbrlink: ceed82ea\ndate: 2023-07-19 14:20:19\ntags:\n  - linux\ncategories:\n  - 服务器相关  \n---\n\n\n# 一、Cron介绍\n\nCron被用来进行Linux系统的计划任务执行\n\n\n# 二、相关目录\n\ncron.d/*用来存放一些软件的Cron设置\n\ncron.daily/每天执行一次的任务\n\ncron.hourly/每小时执行一次的任务\n\ncron.monthly/每个月执行一次的任务\n\ncron.weekly/，每周执行一次的任务\n\n每分钟执行一次脚本\n\n    crontab -e\n    \n# 三、crontab使用\n\n    *  *  *   *  *  命令/脚本\n    分 时 日 月 周\n\n    1  *  *   *  *  命令/脚本   指的是每个小时的第一分钟\n    */1 * * * *     命令/脚本   每分钟执行脚本\n    \n\n    crontab -l\n    查看计划任务列表   \n# 四、/etc/cron.daily 与crontab -e 定义的区别\n    \n   \n    /etc/cron.daily 和 crontab -e 都是用来设置定时任务的方式，但它们有一些不同之处。\n    \n    /etc/cron.daily 是一个目录，里面存放着以 \"cron\" 格式命名的脚本文件。这些脚本会每天执行一次，通常在系统闲置时执行。这个目录中的脚本是全局的，适用于整个系统的所有用户。\n    \n    而 crontab -e 则是一个命令，用于编辑和管理用户个人的 crontab 文件。crontab 文件中定义了用户的定时任务计划。通过编辑 crontab 文件，用户可以设置自己的定时任务，包括每天、每周、每月或其他时间间隔的执行。\n    \n    因此，主要区别在于：\n    \n    /etc/cron.daily 适用于全局系统级别的定时任务，而 crontab -e 是用户级别的定时任务。\n    /etc/cron.daily 中的脚本在每天执行一次，而 crontab -e 可以更精确地设置时间间隔。\n    /etc/cron.daily 中的脚本对所有用户有效，而 crontab -e 只对当前用户有效。\n    需要注意的是，修改 /etc/cron.daily 目录中的文件需要 root 权限，而 crontab -e 只需要用户自己的权限\n    \n # 五、Linux anacron\n \n 执行由于关机  忘记执行的任务\n \n 配置好 /etc/anacrontab 文件\n \n 更具体学习参考http://c.biancheng.net/view/1095.html\n \n \n# 六        ","slug":"linux-crond服务","published":1,"updated":"2024-11-25T11:18:01.135Z","_id":"cm3wxlnzr0002qcoc7387g7a9","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、Cron介绍\"><a href=\"#一、Cron介绍\" class=\"headerlink\" title=\"一、Cron介绍\"></a>一、Cron介绍</h1><p>Cron被用来进行Linux系统的计划任务执行</p>\n<h1 id=\"二、相关目录\"><a href=\"#二、相关目录\" class=\"headerlink\" title=\"二、相关目录\"></a>二、相关目录</h1><p>cron.d/*用来存放一些软件的Cron设置</p>\n<p>cron.daily/每天执行一次的任务</p>\n<p>cron.hourly/每小时执行一次的任务</p>\n<p>cron.monthly/每个月执行一次的任务</p>\n<p>cron.weekly/，每周执行一次的任务</p>\n<p>每分钟执行一次脚本</p>\n<pre><code>crontab -e\n</code></pre>\n<h1 id=\"三、crontab使用\"><a href=\"#三、crontab使用\" class=\"headerlink\" title=\"三、crontab使用\"></a>三、crontab使用</h1><pre><code>*  *  *   *  *  命令/脚本\n分 时 日 月 周\n\n1  *  *   *  *  命令/脚本   指的是每个小时的第一分钟\n*/1 * * * *     命令/脚本   每分钟执行脚本\n\n\ncrontab -l\n查看计划任务列表   \n</code></pre>\n<h1 id=\"四、-etc-cron-daily-与crontab-e-定义的区别\"><a href=\"#四、-etc-cron-daily-与crontab-e-定义的区别\" class=\"headerlink\" title=\"四、/etc/cron.daily 与crontab -e 定义的区别\"></a>四、/etc/cron.daily 与crontab -e 定义的区别</h1><pre><code>/etc/cron.daily 和 crontab -e 都是用来设置定时任务的方式，但它们有一些不同之处。\n\n/etc/cron.daily 是一个目录，里面存放着以 &quot;cron&quot; 格式命名的脚本文件。这些脚本会每天执行一次，通常在系统闲置时执行。这个目录中的脚本是全局的，适用于整个系统的所有用户。\n\n而 crontab -e 则是一个命令，用于编辑和管理用户个人的 crontab 文件。crontab 文件中定义了用户的定时任务计划。通过编辑 crontab 文件，用户可以设置自己的定时任务，包括每天、每周、每月或其他时间间隔的执行。\n\n因此，主要区别在于：\n\n/etc/cron.daily 适用于全局系统级别的定时任务，而 crontab -e 是用户级别的定时任务。\n/etc/cron.daily 中的脚本在每天执行一次，而 crontab -e 可以更精确地设置时间间隔。\n/etc/cron.daily 中的脚本对所有用户有效，而 crontab -e 只对当前用户有效。\n需要注意的是，修改 /etc/cron.daily 目录中的文件需要 root 权限，而 crontab -e 只需要用户自己的权限\n</code></pre>\n<h1 id=\"五、Linux-anacron\"><a href=\"#五、Linux-anacron\" class=\"headerlink\" title=\"五、Linux anacron\"></a>五、Linux anacron</h1><p> 执行由于关机  忘记执行的任务</p>\n<p> 配置好 /etc/anacrontab 文件</p>\n<p> 更具体学习参考<a href=\"http://c.biancheng.net/view/1095.html\">http://c.biancheng.net/view/1095.html</a></p>\n<h1 id=\"六\"><a href=\"#六\" class=\"headerlink\" title=\"六\"></a>六</h1>","site":{"data":{}},"length":852,"excerpt":"","more":"<h1 id=\"一、Cron介绍\"><a href=\"#一、Cron介绍\" class=\"headerlink\" title=\"一、Cron介绍\"></a>一、Cron介绍</h1><p>Cron被用来进行Linux系统的计划任务执行</p>\n<h1 id=\"二、相关目录\"><a href=\"#二、相关目录\" class=\"headerlink\" title=\"二、相关目录\"></a>二、相关目录</h1><p>cron.d/*用来存放一些软件的Cron设置</p>\n<p>cron.daily/每天执行一次的任务</p>\n<p>cron.hourly/每小时执行一次的任务</p>\n<p>cron.monthly/每个月执行一次的任务</p>\n<p>cron.weekly/，每周执行一次的任务</p>\n<p>每分钟执行一次脚本</p>\n<pre><code>crontab -e\n</code></pre>\n<h1 id=\"三、crontab使用\"><a href=\"#三、crontab使用\" class=\"headerlink\" title=\"三、crontab使用\"></a>三、crontab使用</h1><pre><code>*  *  *   *  *  命令/脚本\n分 时 日 月 周\n\n1  *  *   *  *  命令/脚本   指的是每个小时的第一分钟\n*/1 * * * *     命令/脚本   每分钟执行脚本\n\n\ncrontab -l\n查看计划任务列表   \n</code></pre>\n<h1 id=\"四、-etc-cron-daily-与crontab-e-定义的区别\"><a href=\"#四、-etc-cron-daily-与crontab-e-定义的区别\" class=\"headerlink\" title=\"四、/etc/cron.daily 与crontab -e 定义的区别\"></a>四、/etc/cron.daily 与crontab -e 定义的区别</h1><pre><code>/etc/cron.daily 和 crontab -e 都是用来设置定时任务的方式，但它们有一些不同之处。\n\n/etc/cron.daily 是一个目录，里面存放着以 &quot;cron&quot; 格式命名的脚本文件。这些脚本会每天执行一次，通常在系统闲置时执行。这个目录中的脚本是全局的，适用于整个系统的所有用户。\n\n而 crontab -e 则是一个命令，用于编辑和管理用户个人的 crontab 文件。crontab 文件中定义了用户的定时任务计划。通过编辑 crontab 文件，用户可以设置自己的定时任务，包括每天、每周、每月或其他时间间隔的执行。\n\n因此，主要区别在于：\n\n/etc/cron.daily 适用于全局系统级别的定时任务，而 crontab -e 是用户级别的定时任务。\n/etc/cron.daily 中的脚本在每天执行一次，而 crontab -e 可以更精确地设置时间间隔。\n/etc/cron.daily 中的脚本对所有用户有效，而 crontab -e 只对当前用户有效。\n需要注意的是，修改 /etc/cron.daily 目录中的文件需要 root 权限，而 crontab -e 只需要用户自己的权限\n</code></pre>\n<h1 id=\"五、Linux-anacron\"><a href=\"#五、Linux-anacron\" class=\"headerlink\" title=\"五、Linux anacron\"></a>五、Linux anacron</h1><p> 执行由于关机  忘记执行的任务</p>\n<p> 配置好 /etc/anacrontab 文件</p>\n<p> 更具体学习参考<a href=\"http://c.biancheng.net/view/1095.html\">http://c.biancheng.net/view/1095.html</a></p>\n<h1 id=\"六\"><a href=\"#六\" class=\"headerlink\" title=\"六\"></a>六</h1>"},{"title":"linux-firewalld使用总结","abbrlink":"34fa5185","date":"2024-01-09T08:27:09.000Z","_content":"\n\n# 查看放开端口\n\n    firewall-cmd --list-ports\n    \n    \n# 添加放开的端口 \n\n    firewall-cmd --permanent --add-port=8001/tcp   ","source":"_posts/linux-firewalld使用总结.md","raw":"---\ntitle: linux-firewalld使用总结\nabbrlink: 34fa5185\ndate: 2024-01-09 16:27:09\ntags:\n  - linux\ncategories:\n  - 服务器相关  \n---\n\n\n# 查看放开端口\n\n    firewall-cmd --list-ports\n    \n    \n# 添加放开的端口 \n\n    firewall-cmd --permanent --add-port=8001/tcp   ","slug":"linux-firewalld使用总结","published":1,"updated":"2024-11-25T11:18:11.945Z","_id":"cm3wxm6ah0005qcocgv083rvy","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"查看放开端口\"><a href=\"#查看放开端口\" class=\"headerlink\" title=\"查看放开端口\"></a>查看放开端口</h1><pre><code>firewall-cmd --list-ports\n</code></pre>\n<h1 id=\"添加放开的端口\"><a href=\"#添加放开的端口\" class=\"headerlink\" title=\"添加放开的端口\"></a>添加放开的端口</h1><pre><code>firewall-cmd --permanent --add-port=8001/tcp   \n</code></pre>\n","site":{"data":{}},"length":79,"excerpt":"","more":"<h1 id=\"查看放开端口\"><a href=\"#查看放开端口\" class=\"headerlink\" title=\"查看放开端口\"></a>查看放开端口</h1><pre><code>firewall-cmd --list-ports\n</code></pre>\n<h1 id=\"添加放开的端口\"><a href=\"#添加放开的端口\" class=\"headerlink\" title=\"添加放开的端口\"></a>添加放开的端口</h1><pre><code>firewall-cmd --permanent --add-port=8001/tcp   \n</code></pre>\n"},{"title":"linux-LVM逻辑卷管理","abbrlink":"427bdc6a","date":"2023-10-19T04:50:58.000Z","_content":"\n# 一、基础\n    \n一个  分区 对应 一个PV <font color=\"red\">【pvcreate /dev/sdb1 /dev/sdb2 /dev/sdc1 /dev/sdc2】</font>\n\n多个PV 对应 一个VG <font color=\"red\">【 vgcreate vgdata /dev/sdb1 /dev/sdb2 /dev/sdc1 /dev/sdc2】 </font>\n\n一个VG 中可以  分出多个LV <font color=\"red\">【 lvcreate -L 11G -n lv001 vgdata 】</font>\n \n<font color=\"red\">查看命令 【pvdisplay vgdisplay lvdisplay】</font>\n    \n     PV(Physical Volume)：物理卷，处于LVM最底层，可以是物理硬盘或者分区。\n\n     VG(Volume Group)：卷组，建立在PV之上，可以含有一个到多个PV  \n     \n     LV(Logical Volume)：逻辑卷，建立在VG之上，相当于原来分区的概念。不过大小可以动态改变。  \n     \n     \n  \n     \n     创建PV   pvcreate /dev/sdb1\n     \n     查看PV   pvscan\n     \n     创建一个名为vgdata的VG，并且将所有的新建的PV加入vgdata\n     vgcreate vgdata /dev/sdb1 \n     \n     从VG vgdata中创建一个大小为11G的名为lv001的LV\n     lvcreate -L 11G -n lv001 vgdata\n     \n     格式化\n     mkfs.ext3    mkfs.ext4    mkfs.xfs\n     mkfs.ext4  /dev/mapper/【vg名称】-【lv名称】\n     示例mkfs.ext4 /dev/mapper/vgdata-lv001\n     \n     挂载\n     mount /dev/mapper/vgdata-lv001 /data\n     \n     卸载\n      umount 【设备名】\n      \n     xfs格式不支持缩容，只支持扩容\n     \n# 二、新硬盘 扩容 根目录 /\n\n## lsblk查看\n\n         NAME               MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS\n         sda                  8:0    0   60G  0 disk \n         ├─sda1               8:1    0    1G  0 part /boot\n         └─sda2               8:2    0   59G  0 part \n           ├─openeuler-root 253:0    0 40.4G  0 lvm  /\n           ├─openeuler-swap 253:1    0    6G  0 lvm  \n           └─openeuler-home 253:2    0 17.4G  0 lvm  /home\n         sdb                  8:16   0    5G  0 disk \n         ├─sdb1               8:17   0  1.9G  0 part \n         └─sdb2               8:18   0  3.1G  0 part \n           └─vgdata-lv001   253:3    0    8G  0 lvm  \n         sdc                  8:32   0    5G  0 disk \n         ├─sdc1               8:33   0  2.5G  0 part \n         │ └─vgdata-lv001   253:3    0    8G  0 lvm  \n         └─sdc2               8:34   0  2.5G  0 part \n           └─vgdata-lv001   253:3    0    8G  0 lvm  \n         sdd                  8:48   0    5G  0 disk \n         └─sdd1               8:49   0    5G  0 part \n           └─openeuler-root 253:0    0 40.4G  0 lvm  /\n         sr0                 11:0    1  3.5G  0 rom\n\n    \n    \n    \n## 分区新的硬盘\n\n    fdisk /dev/sdd\n    默认值 回车 就可以了\n    \n## 查看vg\n   \n    vgscan      \n    \n    [root@k8snode-2 ~]# vgscan\n    Found volume group \"vgdata\" using metadata type lvm2\n    Found volume group \"openeuler\" using metadata type lvm2\n    \n    vgdisplay  查看vg还有多少空余空间\n    \n##  扩展 vg\n    \n    #将新建的分区/dev/sdd1  加入openeuler vg中\n    vgextend openeuler /dev/sdd1   \n\n##  扩充逻辑卷\n    \n    lvextend -L +5G /dev/mapper/openeuler-root\n    \n    df -h 可以查看目录挂载的 逻辑卷\n    \n    [root@k8snode-2 ~]# df -h\n    文件系统                    容量  已用  可用 已用% 挂载点\n    devtmpfs                    4.0M     0  4.0M    0% /dev\n    tmpfs                       3.7G     0  3.7G    0% /dev/shm\n    tmpfs                       1.5G  147M  1.4G   10% /run\n    tmpfs                       4.0M     0  4.0M    0% /sys/fs/cgroup\n    /dev/mapper/openeuler-root   40G  5.0G   33G   14% /\n    tmpfs                       3.7G     0  3.7G    0% /tmp\n    /dev/sda1                   974M  151M  756M   17% /boot\n    /dev/mapper/openeuler-home   17G  709M   16G    5% /home\n    \n      \n## 更新文件系统（争对不同的文件系统，其更新的命令也不一样   \n\n    e2fsck -f /dev/datavg/lvdata1 #ext4文件系统，检查lv的文件系统\n    \n    resize2fs /dev/VG/LV01 #ext4文件系统命令，该命令后面接lv的设备名就行\n    \n    xfs_growfs /nas #xfs文件系统，该命令后面直接跟的是挂载点\n    \n    当更新文件系统后，你就会发现，df -h正常了\n    \n# 删除其他逻辑券扩容到根目录\n\n         lvremove /dev/centos/home\n         lvextend -L +101.12G /dev/centos/root\n         xfs_growfs  /dev/centos/root","source":"_posts/linux-LVM逻辑卷管理.md","raw":"---\ntitle: linux-LVM逻辑卷管理\nabbrlink: 427bdc6a\ndate: 2023-10-19 12:50:58\ntags:\n  - linux\ncategories:\n  - 服务器相关  \n---\n\n# 一、基础\n    \n一个  分区 对应 一个PV <font color=\"red\">【pvcreate /dev/sdb1 /dev/sdb2 /dev/sdc1 /dev/sdc2】</font>\n\n多个PV 对应 一个VG <font color=\"red\">【 vgcreate vgdata /dev/sdb1 /dev/sdb2 /dev/sdc1 /dev/sdc2】 </font>\n\n一个VG 中可以  分出多个LV <font color=\"red\">【 lvcreate -L 11G -n lv001 vgdata 】</font>\n \n<font color=\"red\">查看命令 【pvdisplay vgdisplay lvdisplay】</font>\n    \n     PV(Physical Volume)：物理卷，处于LVM最底层，可以是物理硬盘或者分区。\n\n     VG(Volume Group)：卷组，建立在PV之上，可以含有一个到多个PV  \n     \n     LV(Logical Volume)：逻辑卷，建立在VG之上，相当于原来分区的概念。不过大小可以动态改变。  \n     \n     \n  \n     \n     创建PV   pvcreate /dev/sdb1\n     \n     查看PV   pvscan\n     \n     创建一个名为vgdata的VG，并且将所有的新建的PV加入vgdata\n     vgcreate vgdata /dev/sdb1 \n     \n     从VG vgdata中创建一个大小为11G的名为lv001的LV\n     lvcreate -L 11G -n lv001 vgdata\n     \n     格式化\n     mkfs.ext3    mkfs.ext4    mkfs.xfs\n     mkfs.ext4  /dev/mapper/【vg名称】-【lv名称】\n     示例mkfs.ext4 /dev/mapper/vgdata-lv001\n     \n     挂载\n     mount /dev/mapper/vgdata-lv001 /data\n     \n     卸载\n      umount 【设备名】\n      \n     xfs格式不支持缩容，只支持扩容\n     \n# 二、新硬盘 扩容 根目录 /\n\n## lsblk查看\n\n         NAME               MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS\n         sda                  8:0    0   60G  0 disk \n         ├─sda1               8:1    0    1G  0 part /boot\n         └─sda2               8:2    0   59G  0 part \n           ├─openeuler-root 253:0    0 40.4G  0 lvm  /\n           ├─openeuler-swap 253:1    0    6G  0 lvm  \n           └─openeuler-home 253:2    0 17.4G  0 lvm  /home\n         sdb                  8:16   0    5G  0 disk \n         ├─sdb1               8:17   0  1.9G  0 part \n         └─sdb2               8:18   0  3.1G  0 part \n           └─vgdata-lv001   253:3    0    8G  0 lvm  \n         sdc                  8:32   0    5G  0 disk \n         ├─sdc1               8:33   0  2.5G  0 part \n         │ └─vgdata-lv001   253:3    0    8G  0 lvm  \n         └─sdc2               8:34   0  2.5G  0 part \n           └─vgdata-lv001   253:3    0    8G  0 lvm  \n         sdd                  8:48   0    5G  0 disk \n         └─sdd1               8:49   0    5G  0 part \n           └─openeuler-root 253:0    0 40.4G  0 lvm  /\n         sr0                 11:0    1  3.5G  0 rom\n\n    \n    \n    \n## 分区新的硬盘\n\n    fdisk /dev/sdd\n    默认值 回车 就可以了\n    \n## 查看vg\n   \n    vgscan      \n    \n    [root@k8snode-2 ~]# vgscan\n    Found volume group \"vgdata\" using metadata type lvm2\n    Found volume group \"openeuler\" using metadata type lvm2\n    \n    vgdisplay  查看vg还有多少空余空间\n    \n##  扩展 vg\n    \n    #将新建的分区/dev/sdd1  加入openeuler vg中\n    vgextend openeuler /dev/sdd1   \n\n##  扩充逻辑卷\n    \n    lvextend -L +5G /dev/mapper/openeuler-root\n    \n    df -h 可以查看目录挂载的 逻辑卷\n    \n    [root@k8snode-2 ~]# df -h\n    文件系统                    容量  已用  可用 已用% 挂载点\n    devtmpfs                    4.0M     0  4.0M    0% /dev\n    tmpfs                       3.7G     0  3.7G    0% /dev/shm\n    tmpfs                       1.5G  147M  1.4G   10% /run\n    tmpfs                       4.0M     0  4.0M    0% /sys/fs/cgroup\n    /dev/mapper/openeuler-root   40G  5.0G   33G   14% /\n    tmpfs                       3.7G     0  3.7G    0% /tmp\n    /dev/sda1                   974M  151M  756M   17% /boot\n    /dev/mapper/openeuler-home   17G  709M   16G    5% /home\n    \n      \n## 更新文件系统（争对不同的文件系统，其更新的命令也不一样   \n\n    e2fsck -f /dev/datavg/lvdata1 #ext4文件系统，检查lv的文件系统\n    \n    resize2fs /dev/VG/LV01 #ext4文件系统命令，该命令后面接lv的设备名就行\n    \n    xfs_growfs /nas #xfs文件系统，该命令后面直接跟的是挂载点\n    \n    当更新文件系统后，你就会发现，df -h正常了\n    \n# 删除其他逻辑券扩容到根目录\n\n         lvremove /dev/centos/home\n         lvextend -L +101.12G /dev/centos/root\n         xfs_growfs  /dev/centos/root","slug":"linux-LVM逻辑卷管理","published":1,"updated":"2024-11-25T11:18:30.482Z","_id":"cm3wxpwnp0003q4ocbhtrbuca","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、基础\"><a href=\"#一、基础\" class=\"headerlink\" title=\"一、基础\"></a>一、基础</h1><p>一个  分区 对应 一个PV <font color=\"red\">【pvcreate /dev/sdb1 /dev/sdb2 /dev/sdc1 /dev/sdc2】</font></p>\n<p>多个PV 对应 一个VG <font color=\"red\">【 vgcreate vgdata /dev/sdb1 /dev/sdb2 /dev/sdc1 /dev/sdc2】 </font></p>\n<p>一个VG 中可以  分出多个LV <font color=\"red\">【 lvcreate -L 11G -n lv001 vgdata 】</font></p>\n<p><font color=\"red\">查看命令 【pvdisplay vgdisplay lvdisplay】</font></p>\n<pre><code> PV(Physical Volume)：物理卷，处于LVM最底层，可以是物理硬盘或者分区。\n\n VG(Volume Group)：卷组，建立在PV之上，可以含有一个到多个PV  \n \n LV(Logical Volume)：逻辑卷，建立在VG之上，相当于原来分区的概念。不过大小可以动态改变。  \n \n \n\n \n 创建PV   pvcreate /dev/sdb1\n \n 查看PV   pvscan\n \n 创建一个名为vgdata的VG，并且将所有的新建的PV加入vgdata\n vgcreate vgdata /dev/sdb1 \n \n 从VG vgdata中创建一个大小为11G的名为lv001的LV\n lvcreate -L 11G -n lv001 vgdata\n \n 格式化\n mkfs.ext3    mkfs.ext4    mkfs.xfs\n mkfs.ext4  /dev/mapper/【vg名称】-【lv名称】\n 示例mkfs.ext4 /dev/mapper/vgdata-lv001\n \n 挂载\n mount /dev/mapper/vgdata-lv001 /data\n \n 卸载\n  umount 【设备名】\n  \n xfs格式不支持缩容，只支持扩容\n \n</code></pre>\n<h1 id=\"二、新硬盘-扩容-根目录\"><a href=\"#二、新硬盘-扩容-根目录\" class=\"headerlink\" title=\"二、新硬盘 扩容 根目录 /\"></a>二、新硬盘 扩容 根目录 /</h1><h2 id=\"lsblk查看\"><a href=\"#lsblk查看\" class=\"headerlink\" title=\"lsblk查看\"></a>lsblk查看</h2><pre><code>     NAME               MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS\n     sda                  8:0    0   60G  0 disk \n     ├─sda1               8:1    0    1G  0 part /boot\n     └─sda2               8:2    0   59G  0 part \n       ├─openeuler-root 253:0    0 40.4G  0 lvm  /\n       ├─openeuler-swap 253:1    0    6G  0 lvm  \n       └─openeuler-home 253:2    0 17.4G  0 lvm  /home\n     sdb                  8:16   0    5G  0 disk \n     ├─sdb1               8:17   0  1.9G  0 part \n     └─sdb2               8:18   0  3.1G  0 part \n       └─vgdata-lv001   253:3    0    8G  0 lvm  \n     sdc                  8:32   0    5G  0 disk \n     ├─sdc1               8:33   0  2.5G  0 part \n     │ └─vgdata-lv001   253:3    0    8G  0 lvm  \n     └─sdc2               8:34   0  2.5G  0 part \n       └─vgdata-lv001   253:3    0    8G  0 lvm  \n     sdd                  8:48   0    5G  0 disk \n     └─sdd1               8:49   0    5G  0 part \n       └─openeuler-root 253:0    0 40.4G  0 lvm  /\n     sr0                 11:0    1  3.5G  0 rom\n</code></pre>\n<h2 id=\"分区新的硬盘\"><a href=\"#分区新的硬盘\" class=\"headerlink\" title=\"分区新的硬盘\"></a>分区新的硬盘</h2><pre><code>fdisk /dev/sdd\n默认值 回车 就可以了\n</code></pre>\n<h2 id=\"查看vg\"><a href=\"#查看vg\" class=\"headerlink\" title=\"查看vg\"></a>查看vg</h2><pre><code>vgscan      \n\n[root@k8snode-2 ~]# vgscan\nFound volume group &quot;vgdata&quot; using metadata type lvm2\nFound volume group &quot;openeuler&quot; using metadata type lvm2\n\nvgdisplay  查看vg还有多少空余空间\n</code></pre>\n<h2 id=\"扩展-vg\"><a href=\"#扩展-vg\" class=\"headerlink\" title=\"扩展 vg\"></a>扩展 vg</h2><pre><code>#将新建的分区/dev/sdd1  加入openeuler vg中\nvgextend openeuler /dev/sdd1   \n</code></pre>\n<h2 id=\"扩充逻辑卷\"><a href=\"#扩充逻辑卷\" class=\"headerlink\" title=\"扩充逻辑卷\"></a>扩充逻辑卷</h2><pre><code>lvextend -L +5G /dev/mapper/openeuler-root\n\ndf -h 可以查看目录挂载的 逻辑卷\n\n[root@k8snode-2 ~]# df -h\n文件系统                    容量  已用  可用 已用% 挂载点\ndevtmpfs                    4.0M     0  4.0M    0% /dev\ntmpfs                       3.7G     0  3.7G    0% /dev/shm\ntmpfs                       1.5G  147M  1.4G   10% /run\ntmpfs                       4.0M     0  4.0M    0% /sys/fs/cgroup\n/dev/mapper/openeuler-root   40G  5.0G   33G   14% /\ntmpfs                       3.7G     0  3.7G    0% /tmp\n/dev/sda1                   974M  151M  756M   17% /boot\n/dev/mapper/openeuler-home   17G  709M   16G    5% /home\n\n  \n</code></pre>\n<h2 id=\"更新文件系统（争对不同的文件系统，其更新的命令也不一样\"><a href=\"#更新文件系统（争对不同的文件系统，其更新的命令也不一样\" class=\"headerlink\" title=\"更新文件系统（争对不同的文件系统，其更新的命令也不一样\"></a>更新文件系统（争对不同的文件系统，其更新的命令也不一样</h2><pre><code>e2fsck -f /dev/datavg/lvdata1 #ext4文件系统，检查lv的文件系统\n\nresize2fs /dev/VG/LV01 #ext4文件系统命令，该命令后面接lv的设备名就行\n\nxfs_growfs /nas #xfs文件系统，该命令后面直接跟的是挂载点\n\n当更新文件系统后，你就会发现，df -h正常了\n</code></pre>\n<h1 id=\"删除其他逻辑券扩容到根目录\"><a href=\"#删除其他逻辑券扩容到根目录\" class=\"headerlink\" title=\"删除其他逻辑券扩容到根目录\"></a>删除其他逻辑券扩容到根目录</h1><pre><code>     lvremove /dev/centos/home\n     lvextend -L +101.12G /dev/centos/root\n     xfs_growfs  /dev/centos/root\n</code></pre>\n","site":{"data":{}},"length":1974,"excerpt":"","more":"<h1 id=\"一、基础\"><a href=\"#一、基础\" class=\"headerlink\" title=\"一、基础\"></a>一、基础</h1><p>一个  分区 对应 一个PV <font color=\"red\">【pvcreate /dev/sdb1 /dev/sdb2 /dev/sdc1 /dev/sdc2】</font></p>\n<p>多个PV 对应 一个VG <font color=\"red\">【 vgcreate vgdata /dev/sdb1 /dev/sdb2 /dev/sdc1 /dev/sdc2】 </font></p>\n<p>一个VG 中可以  分出多个LV <font color=\"red\">【 lvcreate -L 11G -n lv001 vgdata 】</font></p>\n<p><font color=\"red\">查看命令 【pvdisplay vgdisplay lvdisplay】</font></p>\n<pre><code> PV(Physical Volume)：物理卷，处于LVM最底层，可以是物理硬盘或者分区。\n\n VG(Volume Group)：卷组，建立在PV之上，可以含有一个到多个PV  \n \n LV(Logical Volume)：逻辑卷，建立在VG之上，相当于原来分区的概念。不过大小可以动态改变。  \n \n \n\n \n 创建PV   pvcreate /dev/sdb1\n \n 查看PV   pvscan\n \n 创建一个名为vgdata的VG，并且将所有的新建的PV加入vgdata\n vgcreate vgdata /dev/sdb1 \n \n 从VG vgdata中创建一个大小为11G的名为lv001的LV\n lvcreate -L 11G -n lv001 vgdata\n \n 格式化\n mkfs.ext3    mkfs.ext4    mkfs.xfs\n mkfs.ext4  /dev/mapper/【vg名称】-【lv名称】\n 示例mkfs.ext4 /dev/mapper/vgdata-lv001\n \n 挂载\n mount /dev/mapper/vgdata-lv001 /data\n \n 卸载\n  umount 【设备名】\n  \n xfs格式不支持缩容，只支持扩容\n \n</code></pre>\n<h1 id=\"二、新硬盘-扩容-根目录\"><a href=\"#二、新硬盘-扩容-根目录\" class=\"headerlink\" title=\"二、新硬盘 扩容 根目录 /\"></a>二、新硬盘 扩容 根目录 /</h1><h2 id=\"lsblk查看\"><a href=\"#lsblk查看\" class=\"headerlink\" title=\"lsblk查看\"></a>lsblk查看</h2><pre><code>     NAME               MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS\n     sda                  8:0    0   60G  0 disk \n     ├─sda1               8:1    0    1G  0 part /boot\n     └─sda2               8:2    0   59G  0 part \n       ├─openeuler-root 253:0    0 40.4G  0 lvm  /\n       ├─openeuler-swap 253:1    0    6G  0 lvm  \n       └─openeuler-home 253:2    0 17.4G  0 lvm  /home\n     sdb                  8:16   0    5G  0 disk \n     ├─sdb1               8:17   0  1.9G  0 part \n     └─sdb2               8:18   0  3.1G  0 part \n       └─vgdata-lv001   253:3    0    8G  0 lvm  \n     sdc                  8:32   0    5G  0 disk \n     ├─sdc1               8:33   0  2.5G  0 part \n     │ └─vgdata-lv001   253:3    0    8G  0 lvm  \n     └─sdc2               8:34   0  2.5G  0 part \n       └─vgdata-lv001   253:3    0    8G  0 lvm  \n     sdd                  8:48   0    5G  0 disk \n     └─sdd1               8:49   0    5G  0 part \n       └─openeuler-root 253:0    0 40.4G  0 lvm  /\n     sr0                 11:0    1  3.5G  0 rom\n</code></pre>\n<h2 id=\"分区新的硬盘\"><a href=\"#分区新的硬盘\" class=\"headerlink\" title=\"分区新的硬盘\"></a>分区新的硬盘</h2><pre><code>fdisk /dev/sdd\n默认值 回车 就可以了\n</code></pre>\n<h2 id=\"查看vg\"><a href=\"#查看vg\" class=\"headerlink\" title=\"查看vg\"></a>查看vg</h2><pre><code>vgscan      \n\n[root@k8snode-2 ~]# vgscan\nFound volume group &quot;vgdata&quot; using metadata type lvm2\nFound volume group &quot;openeuler&quot; using metadata type lvm2\n\nvgdisplay  查看vg还有多少空余空间\n</code></pre>\n<h2 id=\"扩展-vg\"><a href=\"#扩展-vg\" class=\"headerlink\" title=\"扩展 vg\"></a>扩展 vg</h2><pre><code>#将新建的分区/dev/sdd1  加入openeuler vg中\nvgextend openeuler /dev/sdd1   \n</code></pre>\n<h2 id=\"扩充逻辑卷\"><a href=\"#扩充逻辑卷\" class=\"headerlink\" title=\"扩充逻辑卷\"></a>扩充逻辑卷</h2><pre><code>lvextend -L +5G /dev/mapper/openeuler-root\n\ndf -h 可以查看目录挂载的 逻辑卷\n\n[root@k8snode-2 ~]# df -h\n文件系统                    容量  已用  可用 已用% 挂载点\ndevtmpfs                    4.0M     0  4.0M    0% /dev\ntmpfs                       3.7G     0  3.7G    0% /dev/shm\ntmpfs                       1.5G  147M  1.4G   10% /run\ntmpfs                       4.0M     0  4.0M    0% /sys/fs/cgroup\n/dev/mapper/openeuler-root   40G  5.0G   33G   14% /\ntmpfs                       3.7G     0  3.7G    0% /tmp\n/dev/sda1                   974M  151M  756M   17% /boot\n/dev/mapper/openeuler-home   17G  709M   16G    5% /home\n\n  \n</code></pre>\n<h2 id=\"更新文件系统（争对不同的文件系统，其更新的命令也不一样\"><a href=\"#更新文件系统（争对不同的文件系统，其更新的命令也不一样\" class=\"headerlink\" title=\"更新文件系统（争对不同的文件系统，其更新的命令也不一样\"></a>更新文件系统（争对不同的文件系统，其更新的命令也不一样</h2><pre><code>e2fsck -f /dev/datavg/lvdata1 #ext4文件系统，检查lv的文件系统\n\nresize2fs /dev/VG/LV01 #ext4文件系统命令，该命令后面接lv的设备名就行\n\nxfs_growfs /nas #xfs文件系统，该命令后面直接跟的是挂载点\n\n当更新文件系统后，你就会发现，df -h正常了\n</code></pre>\n<h1 id=\"删除其他逻辑券扩容到根目录\"><a href=\"#删除其他逻辑券扩容到根目录\" class=\"headerlink\" title=\"删除其他逻辑券扩容到根目录\"></a>删除其他逻辑券扩容到根目录</h1><pre><code>     lvremove /dev/centos/home\n     lvextend -L +101.12G /dev/centos/root\n     xfs_growfs  /dev/centos/root\n</code></pre>\n"},{"title":"linux-sftp服务配置","abbrlink":"8e2962f3","date":"2024-08-02T02:34:24.000Z","_content":"\n# sftp 配置\n\n\n创建用户\nuseradd -m ftp_ip_user-g sftp -s /sbin/nologin -d\n\n\n配置 sftp\nvim /etc/ssh/ssh_config\n\nSubsystem sftp internal-sftp\nMatch Group sftp\n        ChrootDirectory /www/wwwroot/ftp_ip_user\n        X11Forwarding no\n        AllowTcpForwarding no\n        ForceCommand internal-sftp\n        \n        \n\nfatal: bad ownership or modes for chroot directory \"/www/wwwroot/ftp_ip_user\" \n\n这个错误通常发生在使用SSH服务进行远程登录时，特别是当你尝试为特定用户设置chroot环境时。\nchroot是一种安全机制，它将用户的根目录更改为另一个目录，从而限制用户只能在该目录及其子目录下操作。\n报错信息fatal: bad ownership or modes意味着chroot目录的所有权或权限设置不正确，SSH服务无法以安全的方式访问该目录。\n\n\n\n#sftp问题排查解决：\n\n查看日志命令\ntail -f /var/log/secure\n\n排查用户账号是否过期命令\nchage -l ftp_ip_user\n\n修改密码\npasswd ftp_ip_user\n\n设置为永久不过期\nchage -M -1 ftp_ip_user\n\n\n检查/www/wwwroot/ftp_ip_user目录的所有权和权限。它应该只有root用户有写权限。可以使用以下命令来修复：\n\nsudo chown root:root /www/wwwroot/ftp_ip_user\nsudo chmod 0755 /www/wwwroot/ftp_ip_user\n\n确保目录中没有任何不必要的文件或目录，特别是不应该有写权限给其他用户。\n\n如果你使用的是sshd_config文件中的ChrootDirectory指令，确保指定的目录是你想要chroot jail的目录。\n\n如果你在使用sftp服务，确保sshd_config文件中的Subsystem sftp指令指向正确的internal-sftp路径。\n\n重启SSH服务以使更改生效。\n\n\n#","source":"_posts/linux-sftp服务配置.md","raw":"---\ntitle: linux-sftp服务配置\nabbrlink: 8e2962f3\ndate: 2024-08-02 10:34:24\ntags:\n  - linux\n  - sftp\ncategories:\n  - 服务器相关  \n---\n\n# sftp 配置\n\n\n创建用户\nuseradd -m ftp_ip_user-g sftp -s /sbin/nologin -d\n\n\n配置 sftp\nvim /etc/ssh/ssh_config\n\nSubsystem sftp internal-sftp\nMatch Group sftp\n        ChrootDirectory /www/wwwroot/ftp_ip_user\n        X11Forwarding no\n        AllowTcpForwarding no\n        ForceCommand internal-sftp\n        \n        \n\nfatal: bad ownership or modes for chroot directory \"/www/wwwroot/ftp_ip_user\" \n\n这个错误通常发生在使用SSH服务进行远程登录时，特别是当你尝试为特定用户设置chroot环境时。\nchroot是一种安全机制，它将用户的根目录更改为另一个目录，从而限制用户只能在该目录及其子目录下操作。\n报错信息fatal: bad ownership or modes意味着chroot目录的所有权或权限设置不正确，SSH服务无法以安全的方式访问该目录。\n\n\n\n#sftp问题排查解决：\n\n查看日志命令\ntail -f /var/log/secure\n\n排查用户账号是否过期命令\nchage -l ftp_ip_user\n\n修改密码\npasswd ftp_ip_user\n\n设置为永久不过期\nchage -M -1 ftp_ip_user\n\n\n检查/www/wwwroot/ftp_ip_user目录的所有权和权限。它应该只有root用户有写权限。可以使用以下命令来修复：\n\nsudo chown root:root /www/wwwroot/ftp_ip_user\nsudo chmod 0755 /www/wwwroot/ftp_ip_user\n\n确保目录中没有任何不必要的文件或目录，特别是不应该有写权限给其他用户。\n\n如果你使用的是sshd_config文件中的ChrootDirectory指令，确保指定的目录是你想要chroot jail的目录。\n\n如果你在使用sftp服务，确保sshd_config文件中的Subsystem sftp指令指向正确的internal-sftp路径。\n\n重启SSH服务以使更改生效。\n\n\n#","slug":"linux-sftp服务配置","published":1,"updated":"2025-02-05T02:44:45.139Z","_id":"cm3wxqnd10008q4ocdb4yfgwl","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"sftp-配置\"><a href=\"#sftp-配置\" class=\"headerlink\" title=\"sftp 配置\"></a>sftp 配置</h1><p>创建用户<br>useradd -m ftp_ip_user-g sftp -s /sbin/nologin -d</p>\n<p>配置 sftp<br>vim /etc/ssh/ssh_config</p>\n<p>Subsystem sftp internal-sftp<br>Match Group sftp<br>        ChrootDirectory /www/wwwroot/ftp_ip_user<br>        X11Forwarding no<br>        AllowTcpForwarding no<br>        ForceCommand internal-sftp</p>\n<p>fatal: bad ownership or modes for chroot directory “/www/wwwroot/ftp_ip_user” </p>\n<p>这个错误通常发生在使用SSH服务进行远程登录时，特别是当你尝试为特定用户设置chroot环境时。<br>chroot是一种安全机制，它将用户的根目录更改为另一个目录，从而限制用户只能在该目录及其子目录下操作。<br>报错信息fatal: bad ownership or modes意味着chroot目录的所有权或权限设置不正确，SSH服务无法以安全的方式访问该目录。</p>\n<p>#sftp问题排查解决：</p>\n<p>查看日志命令<br>tail -f /var/log/secure</p>\n<p>排查用户账号是否过期命令<br>chage -l ftp_ip_user</p>\n<p>修改密码<br>passwd ftp_ip_user</p>\n<p>设置为永久不过期<br>chage -M -1 ftp_ip_user</p>\n<p>检查/www/wwwroot/ftp_ip_user目录的所有权和权限。它应该只有root用户有写权限。可以使用以下命令来修复：</p>\n<p>sudo chown root:root /www/wwwroot/ftp_ip_user<br>sudo chmod 0755 /www/wwwroot/ftp_ip_user</p>\n<p>确保目录中没有任何不必要的文件或目录，特别是不应该有写权限给其他用户。</p>\n<p>如果你使用的是sshd_config文件中的ChrootDirectory指令，确保指定的目录是你想要chroot jail的目录。</p>\n<p>如果你在使用sftp服务，确保sshd_config文件中的Subsystem sftp指令指向正确的internal-sftp路径。</p>\n<p>重启SSH服务以使更改生效。</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>","site":{"data":{}},"length":902,"excerpt":"","more":"<h1 id=\"sftp-配置\"><a href=\"#sftp-配置\" class=\"headerlink\" title=\"sftp 配置\"></a>sftp 配置</h1><p>创建用户<br>useradd -m ftp_ip_user-g sftp -s /sbin/nologin -d</p>\n<p>配置 sftp<br>vim /etc/ssh/ssh_config</p>\n<p>Subsystem sftp internal-sftp<br>Match Group sftp<br>        ChrootDirectory /www/wwwroot/ftp_ip_user<br>        X11Forwarding no<br>        AllowTcpForwarding no<br>        ForceCommand internal-sftp</p>\n<p>fatal: bad ownership or modes for chroot directory “/www/wwwroot/ftp_ip_user” </p>\n<p>这个错误通常发生在使用SSH服务进行远程登录时，特别是当你尝试为特定用户设置chroot环境时。<br>chroot是一种安全机制，它将用户的根目录更改为另一个目录，从而限制用户只能在该目录及其子目录下操作。<br>报错信息fatal: bad ownership or modes意味着chroot目录的所有权或权限设置不正确，SSH服务无法以安全的方式访问该目录。</p>\n<p>#sftp问题排查解决：</p>\n<p>查看日志命令<br>tail -f /var/log/secure</p>\n<p>排查用户账号是否过期命令<br>chage -l ftp_ip_user</p>\n<p>修改密码<br>passwd ftp_ip_user</p>\n<p>设置为永久不过期<br>chage -M -1 ftp_ip_user</p>\n<p>检查/www/wwwroot/ftp_ip_user目录的所有权和权限。它应该只有root用户有写权限。可以使用以下命令来修复：</p>\n<p>sudo chown root:root /www/wwwroot/ftp_ip_user<br>sudo chmod 0755 /www/wwwroot/ftp_ip_user</p>\n<p>确保目录中没有任何不必要的文件或目录，特别是不应该有写权限给其他用户。</p>\n<p>如果你使用的是sshd_config文件中的ChrootDirectory指令，确保指定的目录是你想要chroot jail的目录。</p>\n<p>如果你在使用sftp服务，确保sshd_config文件中的Subsystem sftp指令指向正确的internal-sftp路径。</p>\n<p>重启SSH服务以使更改生效。</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>"},{"title":"nginx-配置rewrite","abbrlink":"a0181459","date":"2024-06-29T04:04:32.000Z","_content":"\n\n# rewrite 作用\n\n用于实现URL的重写，URL的重写是非常有用的功能，\n比如它可以在我们改变网站结构之后，不需要客户端修改原来的书签，\n也无需其他网站修改我们的链接，就可以设置为自动访问，另外还可以在一定程度上提高网站的安全性\n\n示例  \n浏览器访问url http://www.example.com/abc/file/a.jpg \n实际访问 http://www.example.com/bb/a.jpg\n\n浏览器访问url http://www.example.com/index/abc.html\n实际访问 http://www.example.com/index.php?r=index/abc\n\n\n\n# rewrite应用场景\n\n1、URL看起来更规范、合理\n2、企业会将动态URL地址伪装成静态地址提供服务\n3、网址换新域名后，让旧的访问跳转到新的域名上\n4、服务端某些业务调整\n\n\n# rewrite调试\nrewrite 日志记录指令\n指令\trewrite_log \n作用域 http, server, location     \n指令值选项\ton 或 off\n当指令值为 on 时，rewrite 的执行结果会以 notice 级别记录到 Nginx 的 error 日志文件中\n\n示例：\n```nginx\n  http{\n        rewrite_log on;\n  }\n```\n  \n\n\n# nginx正则表达式\n\n\n常用的正则表达式元字符\n^：匹配输入字符串的起始位置\n$：匹配输入字符串的结束位置\n*****：匹配前面的字符零次或多次\n+：匹配前面的字符一次或多次\n?：匹配前面的字符零次或一次\n.：匹配除\\n之外的任何单个字符 使用[.\\n]可以匹配包括\\n在内的任意字符\n****：转义符\n\\d：匹配纯数字\n{n}：重复n次\n{n,}：重复n次或更多次\n[c]：匹配单个字符c\n[a-z]：匹配a-z小写字母的任意一个\n[a-zA-Z]：匹配a-z小写字母或A-Z大写字母的任意一个\n（）：表达式的开始和结束位置\n|：或运算符\n\n\n\n\n# 实际应用\n\n\n    location ~* .*\\.(mp4|avi|wmv|mpg|flv|rm|mov) {\n      \n      add_header Accept-Ranges bytes;\n      if ($request_uri ~* ^(.*)file/Image/annex/(.*)/(.*)){\n        set $file_name $3;\n        rewrite (.*) $scheme://$host/$file_name;\n      }\n      #视频保存的目录\n      root /www/wwwroot/tjproject-resources/WebAnnexFile/451772413496005765/;\n      mp4;\n      mp4_buffer_size 1m;#处理mp4初始内存大小\n      mp4_max_buffer_size 50m;#处理mp4最大内存大小\n    }\n    \n    \n    location ~ .*\\.(mp4|avi|wmv|mpg|flv|rm|mov) {\n      if ($request_uri ~* ^/monitor_videos/(.*)){\n        set $file_name $1;\n        rewrite (.*) $scheme://$host/$file_name;\n      }\n      # #视频保存的目录\n      root /www/wwwroot/aigis_resources_yzc/monitor_videos/;\n      mp4;\n      mp4_buffer_size 1m;#处理mp4初始内存大小\n      mp4_max_buffer_size 50m;#处理mp4最大内存大小\n    }\n    \n    \n    location ~* /upload/。*\\.php${\n    \n        rewrite (.+) http://www.index.com permanent\n    }\n    \n    \n    server { \n        listen 80; \n        server_name example.com www.example.com; \n            if ($server_port !~ 443){\n             rewrite ^(/.*)$ https://$host$1 permanent; \n            } \n            # 其他配置... \n    }\n    \n    \n    if ($scheme = http ) {\n        return 301 https://$host$request_uri;\n    }","source":"_posts/nginx-配置rewrite.md","raw":"---\ntitle: nginx-配置rewrite\nabbrlink: a0181459\ncategories:\n  - 服务器相关\n  - nginx\ndate: 2024-06-29 12:04:32\ntags:\n---\n\n\n# rewrite 作用\n\n用于实现URL的重写，URL的重写是非常有用的功能，\n比如它可以在我们改变网站结构之后，不需要客户端修改原来的书签，\n也无需其他网站修改我们的链接，就可以设置为自动访问，另外还可以在一定程度上提高网站的安全性\n\n示例  \n浏览器访问url http://www.example.com/abc/file/a.jpg \n实际访问 http://www.example.com/bb/a.jpg\n\n浏览器访问url http://www.example.com/index/abc.html\n实际访问 http://www.example.com/index.php?r=index/abc\n\n\n\n# rewrite应用场景\n\n1、URL看起来更规范、合理\n2、企业会将动态URL地址伪装成静态地址提供服务\n3、网址换新域名后，让旧的访问跳转到新的域名上\n4、服务端某些业务调整\n\n\n# rewrite调试\nrewrite 日志记录指令\n指令\trewrite_log \n作用域 http, server, location     \n指令值选项\ton 或 off\n当指令值为 on 时，rewrite 的执行结果会以 notice 级别记录到 Nginx 的 error 日志文件中\n\n示例：\n```nginx\n  http{\n        rewrite_log on;\n  }\n```\n  \n\n\n# nginx正则表达式\n\n\n常用的正则表达式元字符\n^：匹配输入字符串的起始位置\n$：匹配输入字符串的结束位置\n*****：匹配前面的字符零次或多次\n+：匹配前面的字符一次或多次\n?：匹配前面的字符零次或一次\n.：匹配除\\n之外的任何单个字符 使用[.\\n]可以匹配包括\\n在内的任意字符\n****：转义符\n\\d：匹配纯数字\n{n}：重复n次\n{n,}：重复n次或更多次\n[c]：匹配单个字符c\n[a-z]：匹配a-z小写字母的任意一个\n[a-zA-Z]：匹配a-z小写字母或A-Z大写字母的任意一个\n（）：表达式的开始和结束位置\n|：或运算符\n\n\n\n\n# 实际应用\n\n\n    location ~* .*\\.(mp4|avi|wmv|mpg|flv|rm|mov) {\n      \n      add_header Accept-Ranges bytes;\n      if ($request_uri ~* ^(.*)file/Image/annex/(.*)/(.*)){\n        set $file_name $3;\n        rewrite (.*) $scheme://$host/$file_name;\n      }\n      #视频保存的目录\n      root /www/wwwroot/tjproject-resources/WebAnnexFile/451772413496005765/;\n      mp4;\n      mp4_buffer_size 1m;#处理mp4初始内存大小\n      mp4_max_buffer_size 50m;#处理mp4最大内存大小\n    }\n    \n    \n    location ~ .*\\.(mp4|avi|wmv|mpg|flv|rm|mov) {\n      if ($request_uri ~* ^/monitor_videos/(.*)){\n        set $file_name $1;\n        rewrite (.*) $scheme://$host/$file_name;\n      }\n      # #视频保存的目录\n      root /www/wwwroot/aigis_resources_yzc/monitor_videos/;\n      mp4;\n      mp4_buffer_size 1m;#处理mp4初始内存大小\n      mp4_max_buffer_size 50m;#处理mp4最大内存大小\n    }\n    \n    \n    location ~* /upload/。*\\.php${\n    \n        rewrite (.+) http://www.index.com permanent\n    }\n    \n    \n    server { \n        listen 80; \n        server_name example.com www.example.com; \n            if ($server_port !~ 443){\n             rewrite ^(/.*)$ https://$host$1 permanent; \n            } \n            # 其他配置... \n    }\n    \n    \n    if ($scheme = http ) {\n        return 301 https://$host$request_uri;\n    }","slug":"nginx-配置rewrite","published":1,"updated":"2024-11-25T11:22:53.829Z","_id":"cm3wxvju7000sq4ocf9qx4os1","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"rewrite-作用\"><a href=\"#rewrite-作用\" class=\"headerlink\" title=\"rewrite 作用\"></a>rewrite 作用</h1><p>用于实现URL的重写，URL的重写是非常有用的功能，<br>比如它可以在我们改变网站结构之后，不需要客户端修改原来的书签，<br>也无需其他网站修改我们的链接，就可以设置为自动访问，另外还可以在一定程度上提高网站的安全性</p>\n<p>示例<br>浏览器访问url <a href=\"http://www.example.com/abc/file/a.jpg\">http://www.example.com/abc/file/a.jpg</a><br>实际访问 <a href=\"http://www.example.com/bb/a.jpg\">http://www.example.com/bb/a.jpg</a></p>\n<p>浏览器访问url <a href=\"http://www.example.com/index/abc.html\">http://www.example.com/index/abc.html</a><br>实际访问 <a href=\"http://www.example.com/index.php?r=index/abc\">http://www.example.com/index.php?r=index/abc</a></p>\n<h1 id=\"rewrite应用场景\"><a href=\"#rewrite应用场景\" class=\"headerlink\" title=\"rewrite应用场景\"></a>rewrite应用场景</h1><p>1、URL看起来更规范、合理<br>2、企业会将动态URL地址伪装成静态地址提供服务<br>3、网址换新域名后，让旧的访问跳转到新的域名上<br>4、服务端某些业务调整</p>\n<h1 id=\"rewrite调试\"><a href=\"#rewrite调试\" class=\"headerlink\" title=\"rewrite调试\"></a>rewrite调试</h1><p>rewrite 日志记录指令<br>指令    rewrite_log<br>作用域 http, server, location<br>指令值选项    on 或 off<br>当指令值为 on 时，rewrite 的执行结果会以 notice 级别记录到 Nginx 的 error 日志文件中</p>\n<p>示例：</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http&#123;</span><br><span class=\"line\">      <span class=\"attribute\">rewrite_log</span> <span class=\"literal\">on</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"nginx正则表达式\"><a href=\"#nginx正则表达式\" class=\"headerlink\" title=\"nginx正则表达式\"></a>nginx正则表达式</h1><p>常用的正则表达式元字符<br>^：匹配输入字符串的起始位置<br>$：匹配输入字符串的结束位置<br>*****：匹配前面的字符零次或多次<br>+：匹配前面的字符一次或多次<br>?：匹配前面的字符零次或一次<br>.：匹配除\\n之外的任何单个字符 使用[.\\n]可以匹配包括\\n在内的任意字符<br>****：转义符<br>\\d：匹配纯数字<br>{n}：重复n次<br>{n,}：重复n次或更多次<br>[c]：匹配单个字符c<br>[a-z]：匹配a-z小写字母的任意一个<br>[a-zA-Z]：匹配a-z小写字母或A-Z大写字母的任意一个<br>（）：表达式的开始和结束位置<br>|：或运算符</p>\n<h1 id=\"实际应用\"><a href=\"#实际应用\" class=\"headerlink\" title=\"实际应用\"></a>实际应用</h1><pre><code>location ~* .*\\.(mp4|avi|wmv|mpg|flv|rm|mov) &#123;\n  \n  add_header Accept-Ranges bytes;\n  if ($request_uri ~* ^(.*)file/Image/annex/(.*)/(.*))&#123;\n    set $file_name $3;\n    rewrite (.*) $scheme://$host/$file_name;\n  &#125;\n  #视频保存的目录\n  root /www/wwwroot/tjproject-resources/WebAnnexFile/451772413496005765/;\n  mp4;\n  mp4_buffer_size 1m;#处理mp4初始内存大小\n  mp4_max_buffer_size 50m;#处理mp4最大内存大小\n&#125;\n\n\nlocation ~ .*\\.(mp4|avi|wmv|mpg|flv|rm|mov) &#123;\n  if ($request_uri ~* ^/monitor_videos/(.*))&#123;\n    set $file_name $1;\n    rewrite (.*) $scheme://$host/$file_name;\n  &#125;\n  # #视频保存的目录\n  root /www/wwwroot/aigis_resources_yzc/monitor_videos/;\n  mp4;\n  mp4_buffer_size 1m;#处理mp4初始内存大小\n  mp4_max_buffer_size 50m;#处理mp4最大内存大小\n&#125;\n\n\nlocation ~* /upload/。*\\.php$&#123;\n\n    rewrite (.+) http://www.index.com permanent\n&#125;\n\n\nserver &#123; \n    listen 80; \n    server_name example.com www.example.com; \n        if ($server_port !~ 443)&#123;\n         rewrite ^(/.*)$ https://$host$1 permanent; \n        &#125; \n        # 其他配置... \n&#125;\n\n\nif ($scheme = http ) &#123;\n    return 301 https://$host$request_uri;\n&#125;\n</code></pre>\n","site":{"data":{}},"length":1700,"excerpt":"","more":"<h1 id=\"rewrite-作用\"><a href=\"#rewrite-作用\" class=\"headerlink\" title=\"rewrite 作用\"></a>rewrite 作用</h1><p>用于实现URL的重写，URL的重写是非常有用的功能，<br>比如它可以在我们改变网站结构之后，不需要客户端修改原来的书签，<br>也无需其他网站修改我们的链接，就可以设置为自动访问，另外还可以在一定程度上提高网站的安全性</p>\n<p>示例<br>浏览器访问url <a href=\"http://www.example.com/abc/file/a.jpg\">http://www.example.com/abc/file/a.jpg</a><br>实际访问 <a href=\"http://www.example.com/bb/a.jpg\">http://www.example.com/bb/a.jpg</a></p>\n<p>浏览器访问url <a href=\"http://www.example.com/index/abc.html\">http://www.example.com/index/abc.html</a><br>实际访问 <a href=\"http://www.example.com/index.php?r=index/abc\">http://www.example.com/index.php?r=index/abc</a></p>\n<h1 id=\"rewrite应用场景\"><a href=\"#rewrite应用场景\" class=\"headerlink\" title=\"rewrite应用场景\"></a>rewrite应用场景</h1><p>1、URL看起来更规范、合理<br>2、企业会将动态URL地址伪装成静态地址提供服务<br>3、网址换新域名后，让旧的访问跳转到新的域名上<br>4、服务端某些业务调整</p>\n<h1 id=\"rewrite调试\"><a href=\"#rewrite调试\" class=\"headerlink\" title=\"rewrite调试\"></a>rewrite调试</h1><p>rewrite 日志记录指令<br>指令    rewrite_log<br>作用域 http, server, location<br>指令值选项    on 或 off<br>当指令值为 on 时，rewrite 的执行结果会以 notice 级别记录到 Nginx 的 error 日志文件中</p>\n<p>示例：</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http&#123;</span><br><span class=\"line\">      <span class=\"attribute\">rewrite_log</span> <span class=\"literal\">on</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"nginx正则表达式\"><a href=\"#nginx正则表达式\" class=\"headerlink\" title=\"nginx正则表达式\"></a>nginx正则表达式</h1><p>常用的正则表达式元字符<br>^：匹配输入字符串的起始位置<br>$：匹配输入字符串的结束位置<br>*****：匹配前面的字符零次或多次<br>+：匹配前面的字符一次或多次<br>?：匹配前面的字符零次或一次<br>.：匹配除\\n之外的任何单个字符 使用[.\\n]可以匹配包括\\n在内的任意字符<br>****：转义符<br>\\d：匹配纯数字<br>{n}：重复n次<br>{n,}：重复n次或更多次<br>[c]：匹配单个字符c<br>[a-z]：匹配a-z小写字母的任意一个<br>[a-zA-Z]：匹配a-z小写字母或A-Z大写字母的任意一个<br>（）：表达式的开始和结束位置<br>|：或运算符</p>\n<h1 id=\"实际应用\"><a href=\"#实际应用\" class=\"headerlink\" title=\"实际应用\"></a>实际应用</h1><pre><code>location ~* .*\\.(mp4|avi|wmv|mpg|flv|rm|mov) &#123;\n  \n  add_header Accept-Ranges bytes;\n  if ($request_uri ~* ^(.*)file/Image/annex/(.*)/(.*))&#123;\n    set $file_name $3;\n    rewrite (.*) $scheme://$host/$file_name;\n  &#125;\n  #视频保存的目录\n  root /www/wwwroot/tjproject-resources/WebAnnexFile/451772413496005765/;\n  mp4;\n  mp4_buffer_size 1m;#处理mp4初始内存大小\n  mp4_max_buffer_size 50m;#处理mp4最大内存大小\n&#125;\n\n\nlocation ~ .*\\.(mp4|avi|wmv|mpg|flv|rm|mov) &#123;\n  if ($request_uri ~* ^/monitor_videos/(.*))&#123;\n    set $file_name $1;\n    rewrite (.*) $scheme://$host/$file_name;\n  &#125;\n  # #视频保存的目录\n  root /www/wwwroot/aigis_resources_yzc/monitor_videos/;\n  mp4;\n  mp4_buffer_size 1m;#处理mp4初始内存大小\n  mp4_max_buffer_size 50m;#处理mp4最大内存大小\n&#125;\n\n\nlocation ~* /upload/。*\\.php$&#123;\n\n    rewrite (.+) http://www.index.com permanent\n&#125;\n\n\nserver &#123; \n    listen 80; \n    server_name example.com www.example.com; \n        if ($server_port !~ 443)&#123;\n         rewrite ^(/.*)$ https://$host$1 permanent; \n        &#125; \n        # 其他配置... \n&#125;\n\n\nif ($scheme = http ) &#123;\n    return 301 https://$host$request_uri;\n&#125;\n</code></pre>\n"},{"title":"linux-搭建mysql服务","abbrlink":"ca8fa022","date":"2022-04-17T14:53:37.000Z","_content":"# centos mysql安装\n\n1.网站：https://downloads.mysql.com/archives/community/\n\n2.mysql官网找到相应版本安装包\n\n3.然后下载本地 tar -xvf mysql-5.7.21-1.el7.x86_64.rpm-bundle.tar\n\n4.rpm -qa|grep mariadb 查看是否安装mariadb数据库，有就卸载  yum remove 包名 <font color='red'>不卸载干净，会报错哦</font>\n\n5.按下列包顺序安装\n    \n    rpm -ivh mysql-community-common-5.7.19-1.el7.x86_64.rpm\n    \n    rpm -ivh mysql-community-libs-5.7.19-1.el7.x86_64.rpm\n    \n    rpm -ivh mysql-community-devel-5.7.19-1.el7.x86_64.rpm\n    \n    rpm -ivh mysql-community-libs-compat-5.7.19-1.el7.x86_64.rpm\n    \n    rpm -ivh mysql-community-client-5.7.19-1.el7.x86_64.rpm\n\n    rpm -ivh mysql-community-server-5.7.19-1.el7.x86_64.rpm\n    \n6.优化配置   \n\n  6.1 /data/mysql/logs/相关目录需要创建\n    \n    mkdir -p  /data/mysql/logs/\n  \n  6.2  my.cnf 配置文件\n  \n    port=3306\n    设置端口号\n    \n    datadir=/data/mysqldata\n    #数据存在目录\n        \n    ############## Slow Log   ######################\n    slow_query_log=ON\n    # 开启慢查询日志\n    \n    slow_query_log_file=/data/mysql/logs/slow.log\n    # # 慢查询日志存放路径\n    \n    long_query_time=10\n    # # 超过10秒的查询，记录到慢查询日志，默认值10\n    \n    log_queries_not_using_indexes=ON\n    # # 没有使用索引的查询，记录到慢查询日志，可能引起慢查询日志快速增长\n    \n    log_slow_admin_statements=ON\n    # # 执行缓慢的管理语句，记录到慢查询日志\n    # # 例如 ALTER TABLE, ANALYZE TABLE, CHECK TABLE, CREATE INDEX, DROP INDEX, OPTIMIZE TABLE, and REPAIR TABLE.\n    \n    \n    ###################     Error Log   ####################\n    log_error=/data/mysql/logs/mysqld.log\n    ## 错误日志存放路径\n    log_error_verbosity = 2\n    ## 全局动态变量，默认3，范围：1～3\n    \n    \n    ###################     Bin Log    ######################\n    server_id = 6\n    ###################     Error Log   ####################\n    log_error=/data/mysql/logs/mysqld.log    \n    \n7.  启动 systemctl start mysqld\n    安装完毕 初始密码一般在/var/log/mysqld.log文件中   \n    cat   /var/log/mysqld.log |grep password\n\n8.登录数据库 修改密码 mysql -u root -p\n\n\n9.登录后修改密码 \n\n    SET PASSWORD = PASSWORD('xxx@520Flzx3qc');\n    \n    允许远程root用户连接\n    GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'your_password' WITH GRANT OPTION;\n    FLUSH PRIVILEGES;\n    \n\n10.相关命令\n    \n    开机启动\n    systemctl enable mysqld\n    \n    systemctl stop mysqld\n    systemctl start mysqld\n    systemctl restart mysqld\n    \n \n#安装报错解决\n\n    Error: \n     Problem: cannot install the best candidate for the job\n      - nothing provides libcrypto.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libssl.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libcrypto.so.10(libcrypto.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libssl.so.10(libssl.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libcrypto.so.10(OPENSSL_1.0.1_EC)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libcrypto.so.10(OPENSSL_1.0.2)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n    \n    \n    \n    \n    解决方案\n\n    wget https://rpmfind.net/linux/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-4.el8.x86_64.rpm\n    yum install compat-openssl10\n    或者\n    yum install http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-3.el8.x86_64.rpm\n    或者\n    yum install -y ./compat-openssl10-1.0.2o-4.el8.x86_64.rpm\n    \n    \n    \n    [root@ecs-41618143 ~]# rpm -ivh mysql-community-client-5.7.34-1.el7.x86_64.rpm \n    warning: mysql-community-client-5.7.34-1.el7.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY\n    error: Failed dependencies:\n    \tlibncurses.so.5()(64bit) is needed by mysql-community-client-5.7.34-1.el7.x86_64\n    \tlibtinfo.so.5()(64bit) is needed by mysql-community-client-5.7.34-1.el7.x86_64\n    \t\n    \t\n     解决方案\t\n     \n     yum install libncurses*\n","source":"_posts/linux-搭建mysql服务.md","raw":"---\ntitle: linux-搭建mysql服务\nabbrlink: ca8fa022\ndate: 2022-04-17 22:53:37\ntags:\n  - linux\n  - mysql\ncategories:\n  - 服务器相关 \n  - mysql  \n---\n# centos mysql安装\n\n1.网站：https://downloads.mysql.com/archives/community/\n\n2.mysql官网找到相应版本安装包\n\n3.然后下载本地 tar -xvf mysql-5.7.21-1.el7.x86_64.rpm-bundle.tar\n\n4.rpm -qa|grep mariadb 查看是否安装mariadb数据库，有就卸载  yum remove 包名 <font color='red'>不卸载干净，会报错哦</font>\n\n5.按下列包顺序安装\n    \n    rpm -ivh mysql-community-common-5.7.19-1.el7.x86_64.rpm\n    \n    rpm -ivh mysql-community-libs-5.7.19-1.el7.x86_64.rpm\n    \n    rpm -ivh mysql-community-devel-5.7.19-1.el7.x86_64.rpm\n    \n    rpm -ivh mysql-community-libs-compat-5.7.19-1.el7.x86_64.rpm\n    \n    rpm -ivh mysql-community-client-5.7.19-1.el7.x86_64.rpm\n\n    rpm -ivh mysql-community-server-5.7.19-1.el7.x86_64.rpm\n    \n6.优化配置   \n\n  6.1 /data/mysql/logs/相关目录需要创建\n    \n    mkdir -p  /data/mysql/logs/\n  \n  6.2  my.cnf 配置文件\n  \n    port=3306\n    设置端口号\n    \n    datadir=/data/mysqldata\n    #数据存在目录\n        \n    ############## Slow Log   ######################\n    slow_query_log=ON\n    # 开启慢查询日志\n    \n    slow_query_log_file=/data/mysql/logs/slow.log\n    # # 慢查询日志存放路径\n    \n    long_query_time=10\n    # # 超过10秒的查询，记录到慢查询日志，默认值10\n    \n    log_queries_not_using_indexes=ON\n    # # 没有使用索引的查询，记录到慢查询日志，可能引起慢查询日志快速增长\n    \n    log_slow_admin_statements=ON\n    # # 执行缓慢的管理语句，记录到慢查询日志\n    # # 例如 ALTER TABLE, ANALYZE TABLE, CHECK TABLE, CREATE INDEX, DROP INDEX, OPTIMIZE TABLE, and REPAIR TABLE.\n    \n    \n    ###################     Error Log   ####################\n    log_error=/data/mysql/logs/mysqld.log\n    ## 错误日志存放路径\n    log_error_verbosity = 2\n    ## 全局动态变量，默认3，范围：1～3\n    \n    \n    ###################     Bin Log    ######################\n    server_id = 6\n    ###################     Error Log   ####################\n    log_error=/data/mysql/logs/mysqld.log    \n    \n7.  启动 systemctl start mysqld\n    安装完毕 初始密码一般在/var/log/mysqld.log文件中   \n    cat   /var/log/mysqld.log |grep password\n\n8.登录数据库 修改密码 mysql -u root -p\n\n\n9.登录后修改密码 \n\n    SET PASSWORD = PASSWORD('xxx@520Flzx3qc');\n    \n    允许远程root用户连接\n    GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'your_password' WITH GRANT OPTION;\n    FLUSH PRIVILEGES;\n    \n\n10.相关命令\n    \n    开机启动\n    systemctl enable mysqld\n    \n    systemctl stop mysqld\n    systemctl start mysqld\n    systemctl restart mysqld\n    \n \n#安装报错解决\n\n    Error: \n     Problem: cannot install the best candidate for the job\n      - nothing provides libcrypto.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libssl.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libcrypto.so.10(libcrypto.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libssl.so.10(libssl.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libcrypto.so.10(OPENSSL_1.0.1_EC)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n      - nothing provides libcrypto.so.10(OPENSSL_1.0.2)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n    \n    \n    \n    \n    解决方案\n\n    wget https://rpmfind.net/linux/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-4.el8.x86_64.rpm\n    yum install compat-openssl10\n    或者\n    yum install http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-3.el8.x86_64.rpm\n    或者\n    yum install -y ./compat-openssl10-1.0.2o-4.el8.x86_64.rpm\n    \n    \n    \n    [root@ecs-41618143 ~]# rpm -ivh mysql-community-client-5.7.34-1.el7.x86_64.rpm \n    warning: mysql-community-client-5.7.34-1.el7.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY\n    error: Failed dependencies:\n    \tlibncurses.so.5()(64bit) is needed by mysql-community-client-5.7.34-1.el7.x86_64\n    \tlibtinfo.so.5()(64bit) is needed by mysql-community-client-5.7.34-1.el7.x86_64\n    \t\n    \t\n     解决方案\t\n     \n     yum install libncurses*\n","slug":"linux-搭建mysql服务","published":1,"updated":"2024-11-25T11:27:48.412Z","_id":"cm3wxzq050011q4oc9nro2i81","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"centos-mysql安装\"><a href=\"#centos-mysql安装\" class=\"headerlink\" title=\"centos mysql安装\"></a>centos mysql安装</h1><p>1.网站：<a href=\"https://downloads.mysql.com/archives/community/\">https://downloads.mysql.com/archives/community/</a></p>\n<p>2.mysql官网找到相应版本安装包</p>\n<p>3.然后下载本地 tar -xvf mysql-5.7.21-1.el7.x86_64.rpm-bundle.tar</p>\n<p>4.rpm -qa|grep mariadb 查看是否安装mariadb数据库，有就卸载  yum remove 包名 <font color='red'>不卸载干净，会报错哦</font></p>\n<p>5.按下列包顺序安装</p>\n<pre><code>rpm -ivh mysql-community-common-5.7.19-1.el7.x86_64.rpm\n\nrpm -ivh mysql-community-libs-5.7.19-1.el7.x86_64.rpm\n\nrpm -ivh mysql-community-devel-5.7.19-1.el7.x86_64.rpm\n\nrpm -ivh mysql-community-libs-compat-5.7.19-1.el7.x86_64.rpm\n\nrpm -ivh mysql-community-client-5.7.19-1.el7.x86_64.rpm\n\nrpm -ivh mysql-community-server-5.7.19-1.el7.x86_64.rpm\n</code></pre>\n<p>6.优化配置   </p>\n<p>  6.1 /data/mysql/logs/相关目录需要创建</p>\n<pre><code>mkdir -p  /data/mysql/logs/\n</code></pre>\n<p>  6.2  my.cnf 配置文件</p>\n<pre><code>port=3306\n设置端口号\n\ndatadir=/data/mysqldata\n#数据存在目录\n    \n############## Slow Log   ######################\nslow_query_log=ON\n# 开启慢查询日志\n\nslow_query_log_file=/data/mysql/logs/slow.log\n# # 慢查询日志存放路径\n\nlong_query_time=10\n# # 超过10秒的查询，记录到慢查询日志，默认值10\n\nlog_queries_not_using_indexes=ON\n# # 没有使用索引的查询，记录到慢查询日志，可能引起慢查询日志快速增长\n\nlog_slow_admin_statements=ON\n# # 执行缓慢的管理语句，记录到慢查询日志\n# # 例如 ALTER TABLE, ANALYZE TABLE, CHECK TABLE, CREATE INDEX, DROP INDEX, OPTIMIZE TABLE, and REPAIR TABLE.\n\n\n###################     Error Log   ####################\nlog_error=/data/mysql/logs/mysqld.log\n## 错误日志存放路径\nlog_error_verbosity = 2\n## 全局动态变量，默认3，范围：1～3\n\n\n###################     Bin Log    ######################\nserver_id = 6\n###################     Error Log   ####################\nlog_error=/data/mysql/logs/mysqld.log    \n</code></pre>\n<ol start=\"7\">\n<li>启动 systemctl start mysqld<br> 安装完毕 初始密码一般在/var/log/mysqld.log文件中<br> cat   /var/log/mysqld.log |grep password</li>\n</ol>\n<p>8.登录数据库 修改密码 mysql -u root -p</p>\n<p>9.登录后修改密码 </p>\n<pre><code>SET PASSWORD = PASSWORD(&#39;xxx@520Flzx3qc&#39;);\n\n允许远程root用户连接\nGRANT ALL PRIVILEGES ON *.* TO &#39;root&#39;@&#39;%&#39; IDENTIFIED BY &#39;your_password&#39; WITH GRANT OPTION;\nFLUSH PRIVILEGES;\n</code></pre>\n<p>10.相关命令</p>\n<pre><code>开机启动\nsystemctl enable mysqld\n\nsystemctl stop mysqld\nsystemctl start mysqld\nsystemctl restart mysqld\n</code></pre>\n<p>#安装报错解决</p>\n<pre><code>Error: \n Problem: cannot install the best candidate for the job\n  - nothing provides libcrypto.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libssl.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libcrypto.so.10(libcrypto.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libssl.so.10(libssl.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libcrypto.so.10(OPENSSL_1.0.1_EC)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libcrypto.so.10(OPENSSL_1.0.2)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n\n\n\n\n解决方案\n\nwget https://rpmfind.net/linux/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-4.el8.x86_64.rpm\nyum install compat-openssl10\n或者\nyum install http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-3.el8.x86_64.rpm\n或者\nyum install -y ./compat-openssl10-1.0.2o-4.el8.x86_64.rpm\n\n\n\n[root@ecs-41618143 ~]# rpm -ivh mysql-community-client-5.7.34-1.el7.x86_64.rpm \nwarning: mysql-community-client-5.7.34-1.el7.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY\nerror: Failed dependencies:\n    libncurses.so.5()(64bit) is needed by mysql-community-client-5.7.34-1.el7.x86_64\n    libtinfo.so.5()(64bit) is needed by mysql-community-client-5.7.34-1.el7.x86_64\n    \n    \n 解决方案    \n \n yum install libncurses*\n</code></pre>\n","site":{"data":{}},"length":3013,"excerpt":"","more":"<h1 id=\"centos-mysql安装\"><a href=\"#centos-mysql安装\" class=\"headerlink\" title=\"centos mysql安装\"></a>centos mysql安装</h1><p>1.网站：<a href=\"https://downloads.mysql.com/archives/community/\">https://downloads.mysql.com/archives/community/</a></p>\n<p>2.mysql官网找到相应版本安装包</p>\n<p>3.然后下载本地 tar -xvf mysql-5.7.21-1.el7.x86_64.rpm-bundle.tar</p>\n<p>4.rpm -qa|grep mariadb 查看是否安装mariadb数据库，有就卸载  yum remove 包名 <font color='red'>不卸载干净，会报错哦</font></p>\n<p>5.按下列包顺序安装</p>\n<pre><code>rpm -ivh mysql-community-common-5.7.19-1.el7.x86_64.rpm\n\nrpm -ivh mysql-community-libs-5.7.19-1.el7.x86_64.rpm\n\nrpm -ivh mysql-community-devel-5.7.19-1.el7.x86_64.rpm\n\nrpm -ivh mysql-community-libs-compat-5.7.19-1.el7.x86_64.rpm\n\nrpm -ivh mysql-community-client-5.7.19-1.el7.x86_64.rpm\n\nrpm -ivh mysql-community-server-5.7.19-1.el7.x86_64.rpm\n</code></pre>\n<p>6.优化配置   </p>\n<p>  6.1 /data/mysql/logs/相关目录需要创建</p>\n<pre><code>mkdir -p  /data/mysql/logs/\n</code></pre>\n<p>  6.2  my.cnf 配置文件</p>\n<pre><code>port=3306\n设置端口号\n\ndatadir=/data/mysqldata\n#数据存在目录\n    \n############## Slow Log   ######################\nslow_query_log=ON\n# 开启慢查询日志\n\nslow_query_log_file=/data/mysql/logs/slow.log\n# # 慢查询日志存放路径\n\nlong_query_time=10\n# # 超过10秒的查询，记录到慢查询日志，默认值10\n\nlog_queries_not_using_indexes=ON\n# # 没有使用索引的查询，记录到慢查询日志，可能引起慢查询日志快速增长\n\nlog_slow_admin_statements=ON\n# # 执行缓慢的管理语句，记录到慢查询日志\n# # 例如 ALTER TABLE, ANALYZE TABLE, CHECK TABLE, CREATE INDEX, DROP INDEX, OPTIMIZE TABLE, and REPAIR TABLE.\n\n\n###################     Error Log   ####################\nlog_error=/data/mysql/logs/mysqld.log\n## 错误日志存放路径\nlog_error_verbosity = 2\n## 全局动态变量，默认3，范围：1～3\n\n\n###################     Bin Log    ######################\nserver_id = 6\n###################     Error Log   ####################\nlog_error=/data/mysql/logs/mysqld.log    \n</code></pre>\n<ol start=\"7\">\n<li>启动 systemctl start mysqld<br> 安装完毕 初始密码一般在/var/log/mysqld.log文件中<br> cat   /var/log/mysqld.log |grep password</li>\n</ol>\n<p>8.登录数据库 修改密码 mysql -u root -p</p>\n<p>9.登录后修改密码 </p>\n<pre><code>SET PASSWORD = PASSWORD(&#39;xxx@520Flzx3qc&#39;);\n\n允许远程root用户连接\nGRANT ALL PRIVILEGES ON *.* TO &#39;root&#39;@&#39;%&#39; IDENTIFIED BY &#39;your_password&#39; WITH GRANT OPTION;\nFLUSH PRIVILEGES;\n</code></pre>\n<p>10.相关命令</p>\n<pre><code>开机启动\nsystemctl enable mysqld\n\nsystemctl stop mysqld\nsystemctl start mysqld\nsystemctl restart mysqld\n</code></pre>\n<p>#安装报错解决</p>\n<pre><code>Error: \n Problem: cannot install the best candidate for the job\n  - nothing provides libcrypto.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libssl.so.10()(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libcrypto.so.10(libcrypto.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libssl.so.10(libssl.so.10)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libcrypto.so.10(OPENSSL_1.0.1_EC)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n  - nothing provides libcrypto.so.10(OPENSSL_1.0.2)(64bit) needed by php73-php-fpm-7.3.33-10.el7.remi.x86_64\n\n\n\n\n解决方案\n\nwget https://rpmfind.net/linux/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-4.el8.x86_64.rpm\nyum install compat-openssl10\n或者\nyum install http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/Packages/compat-openssl10-1.0.2o-3.el8.x86_64.rpm\n或者\nyum install -y ./compat-openssl10-1.0.2o-4.el8.x86_64.rpm\n\n\n\n[root@ecs-41618143 ~]# rpm -ivh mysql-community-client-5.7.34-1.el7.x86_64.rpm \nwarning: mysql-community-client-5.7.34-1.el7.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY\nerror: Failed dependencies:\n    libncurses.so.5()(64bit) is needed by mysql-community-client-5.7.34-1.el7.x86_64\n    libtinfo.so.5()(64bit) is needed by mysql-community-client-5.7.34-1.el7.x86_64\n    \n    \n 解决方案    \n \n yum install libncurses*\n</code></pre>\n"},{"title":"windows2012-R2发布asp网站","abbrlink":"dd0146de","date":"2024-06-25T12:22:20.000Z","_content":"# 一 、安装asp.net 3.5 总是失败\n\n卸载相关补丁KB5027141  KB5028872  KB5028970  KB5029915\n![lena](../pic/win2012-net.png)\n\n\n# 二、 应用程序池\n\n    设置为 集成  2.0 的版本【安装.net 3.5 后 这边就是只有2.0的选项哦】\n\n# 三、总是显示500，开启报错 方便调试\n\n双击ASP 设置\n\n    将错误发送到浏览器  true\n    \n![lena](../pic/iis-2.png)  \n    \n# 四、设置文件夹权限\n\n everyone  读写就可以了\n \n ![lena](../pic/win2012-1.png)     \n \n \n# 五、Win2012  Microsoft JET Database Engine 错误 '80004005' \n\n    access 数据库没有权限访问\n    \n    设置c:/windows/temp或者%windir%/temp/\n    \n    erveryone  读写权限就可以了\n\n\n# 六、IIS给网站配置https证书\n## 6.1导入入证书\n![lena](../pic/iis-3.png)\n\n## 6.2配置证书\n![lena](../pic/iis-1.png)\n\n\n# 七、IIS限制上传配置\n修改ASP 配置中 限制属性\n![lena](../pic/iis8-file-3.png)\n\n网站中的配置修改(没配置项，可不配置) \n在“节”选项下找到system.webServer/security/requestFiltering节。\n![lena](../pic/iis8-file-1.png)\n\n![lena](../pic/iis8-file-2.png)","source":"_posts/windows2012-R2发布asp网站.md","raw":"---\ntitle: windows2012-R2发布asp网站\nabbrlink: dd0146de\ncategories:\n  - 服务器相关\n  - windows\ndate: 2024-06-25 20:22:20\n---\n# 一 、安装asp.net 3.5 总是失败\n\n卸载相关补丁KB5027141  KB5028872  KB5028970  KB5029915\n![lena](../pic/win2012-net.png)\n\n\n# 二、 应用程序池\n\n    设置为 集成  2.0 的版本【安装.net 3.5 后 这边就是只有2.0的选项哦】\n\n# 三、总是显示500，开启报错 方便调试\n\n双击ASP 设置\n\n    将错误发送到浏览器  true\n    \n![lena](../pic/iis-2.png)  \n    \n# 四、设置文件夹权限\n\n everyone  读写就可以了\n \n ![lena](../pic/win2012-1.png)     \n \n \n# 五、Win2012  Microsoft JET Database Engine 错误 '80004005' \n\n    access 数据库没有权限访问\n    \n    设置c:/windows/temp或者%windir%/temp/\n    \n    erveryone  读写权限就可以了\n\n\n# 六、IIS给网站配置https证书\n## 6.1导入入证书\n![lena](../pic/iis-3.png)\n\n## 6.2配置证书\n![lena](../pic/iis-1.png)\n\n\n# 七、IIS限制上传配置\n修改ASP 配置中 限制属性\n![lena](../pic/iis8-file-3.png)\n\n网站中的配置修改(没配置项，可不配置) \n在“节”选项下找到system.webServer/security/requestFiltering节。\n![lena](../pic/iis8-file-1.png)\n\n![lena](../pic/iis8-file-2.png)","slug":"windows2012-R2发布asp网站","published":1,"updated":"2024-11-25T11:32:20.430Z","_id":"cm3wy7gko001hq4oc9bfu4h1y","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一-、安装asp-net-3-5-总是失败\"><a href=\"#一-、安装asp-net-3-5-总是失败\" class=\"headerlink\" title=\"一 、安装asp.net 3.5 总是失败\"></a>一 、安装asp.net 3.5 总是失败</h1><p>卸载相关补丁KB5027141  KB5028872  KB5028970  KB5029915<br><img src=\"../pic/win2012-net.png\" alt=\"lena\"></p>\n<h1 id=\"二、-应用程序池\"><a href=\"#二、-应用程序池\" class=\"headerlink\" title=\"二、 应用程序池\"></a>二、 应用程序池</h1><pre><code>设置为 集成  2.0 的版本【安装.net 3.5 后 这边就是只有2.0的选项哦】\n</code></pre>\n<h1 id=\"三、总是显示500，开启报错-方便调试\"><a href=\"#三、总是显示500，开启报错-方便调试\" class=\"headerlink\" title=\"三、总是显示500，开启报错 方便调试\"></a>三、总是显示500，开启报错 方便调试</h1><p>双击ASP 设置</p>\n<pre><code>将错误发送到浏览器  true\n</code></pre>\n<p><img src=\"../pic/iis-2.png\" alt=\"lena\">  </p>\n<h1 id=\"四、设置文件夹权限\"><a href=\"#四、设置文件夹权限\" class=\"headerlink\" title=\"四、设置文件夹权限\"></a>四、设置文件夹权限</h1><p> everyone  读写就可以了</p>\n<p> <img src=\"../pic/win2012-1.png\" alt=\"lena\">     </p>\n<h1 id=\"五、Win2012-Microsoft-JET-Database-Engine-错误-‘80004005’\"><a href=\"#五、Win2012-Microsoft-JET-Database-Engine-错误-‘80004005’\" class=\"headerlink\" title=\"五、Win2012  Microsoft JET Database Engine 错误 ‘80004005’\"></a>五、Win2012  Microsoft JET Database Engine 错误 ‘80004005’</h1><pre><code>access 数据库没有权限访问\n\n设置c:/windows/temp或者%windir%/temp/\n\nerveryone  读写权限就可以了\n</code></pre>\n<h1 id=\"六、IIS给网站配置https证书\"><a href=\"#六、IIS给网站配置https证书\" class=\"headerlink\" title=\"六、IIS给网站配置https证书\"></a>六、IIS给网站配置https证书</h1><h2 id=\"6-1导入入证书\"><a href=\"#6-1导入入证书\" class=\"headerlink\" title=\"6.1导入入证书\"></a>6.1导入入证书</h2><p><img src=\"../pic/iis-3.png\" alt=\"lena\"></p>\n<h2 id=\"6-2配置证书\"><a href=\"#6-2配置证书\" class=\"headerlink\" title=\"6.2配置证书\"></a>6.2配置证书</h2><p><img src=\"../pic/iis-1.png\" alt=\"lena\"></p>\n<h1 id=\"七、IIS限制上传配置\"><a href=\"#七、IIS限制上传配置\" class=\"headerlink\" title=\"七、IIS限制上传配置\"></a>七、IIS限制上传配置</h1><p>修改ASP 配置中 限制属性<br><img src=\"../pic/iis8-file-3.png\" alt=\"lena\"></p>\n<p>网站中的配置修改(没配置项，可不配置)<br>在“节”选项下找到system.webServer/security/requestFiltering节。<br><img src=\"../pic/iis8-file-1.png\" alt=\"lena\"></p>\n<p><img src=\"../pic/iis8-file-2.png\" alt=\"lena\"></p>\n","site":{"data":{}},"length":403,"excerpt":"","more":"<h1 id=\"一-、安装asp-net-3-5-总是失败\"><a href=\"#一-、安装asp-net-3-5-总是失败\" class=\"headerlink\" title=\"一 、安装asp.net 3.5 总是失败\"></a>一 、安装asp.net 3.5 总是失败</h1><p>卸载相关补丁KB5027141  KB5028872  KB5028970  KB5029915<br><img src=\"../pic/win2012-net.png\" alt=\"lena\"></p>\n<h1 id=\"二、-应用程序池\"><a href=\"#二、-应用程序池\" class=\"headerlink\" title=\"二、 应用程序池\"></a>二、 应用程序池</h1><pre><code>设置为 集成  2.0 的版本【安装.net 3.5 后 这边就是只有2.0的选项哦】\n</code></pre>\n<h1 id=\"三、总是显示500，开启报错-方便调试\"><a href=\"#三、总是显示500，开启报错-方便调试\" class=\"headerlink\" title=\"三、总是显示500，开启报错 方便调试\"></a>三、总是显示500，开启报错 方便调试</h1><p>双击ASP 设置</p>\n<pre><code>将错误发送到浏览器  true\n</code></pre>\n<p><img src=\"../pic/iis-2.png\" alt=\"lena\">  </p>\n<h1 id=\"四、设置文件夹权限\"><a href=\"#四、设置文件夹权限\" class=\"headerlink\" title=\"四、设置文件夹权限\"></a>四、设置文件夹权限</h1><p> everyone  读写就可以了</p>\n<p> <img src=\"../pic/win2012-1.png\" alt=\"lena\">     </p>\n<h1 id=\"五、Win2012-Microsoft-JET-Database-Engine-错误-‘80004005’\"><a href=\"#五、Win2012-Microsoft-JET-Database-Engine-错误-‘80004005’\" class=\"headerlink\" title=\"五、Win2012  Microsoft JET Database Engine 错误 ‘80004005’\"></a>五、Win2012  Microsoft JET Database Engine 错误 ‘80004005’</h1><pre><code>access 数据库没有权限访问\n\n设置c:/windows/temp或者%windir%/temp/\n\nerveryone  读写权限就可以了\n</code></pre>\n<h1 id=\"六、IIS给网站配置https证书\"><a href=\"#六、IIS给网站配置https证书\" class=\"headerlink\" title=\"六、IIS给网站配置https证书\"></a>六、IIS给网站配置https证书</h1><h2 id=\"6-1导入入证书\"><a href=\"#6-1导入入证书\" class=\"headerlink\" title=\"6.1导入入证书\"></a>6.1导入入证书</h2><p><img src=\"../pic/iis-3.png\" alt=\"lena\"></p>\n<h2 id=\"6-2配置证书\"><a href=\"#6-2配置证书\" class=\"headerlink\" title=\"6.2配置证书\"></a>6.2配置证书</h2><p><img src=\"../pic/iis-1.png\" alt=\"lena\"></p>\n<h1 id=\"七、IIS限制上传配置\"><a href=\"#七、IIS限制上传配置\" class=\"headerlink\" title=\"七、IIS限制上传配置\"></a>七、IIS限制上传配置</h1><p>修改ASP 配置中 限制属性<br><img src=\"../pic/iis8-file-3.png\" alt=\"lena\"></p>\n<p>网站中的配置修改(没配置项，可不配置)<br>在“节”选项下找到system.webServer/security/requestFiltering节。<br><img src=\"../pic/iis8-file-1.png\" alt=\"lena\"></p>\n<p><img src=\"../pic/iis8-file-2.png\" alt=\"lena\"></p>\n"},{"title":"php开发-thinkphp钩子与行为","abbrlink":"9d1b4110","date":"2024-03-19T03:11:00.000Z","_content":"\n\n# 系统预留钩子\n\n    app_init        应用初始化标签位\n    app_dispatch    应用调度标签位\n    app_begin       应用开始标签位\n    module_init     模块初始化标签位\n    action_begin    控制器开始标签位\n    view_filter     视图输出过滤标签位\n    app_end         应用结束标签位\n    log_write       日志write方法标签位\n    log_wrire_done  日志写入完成标签位\n    reponse_send    响应发送标签位\n    reponse_end     输出结束标签位\n# 绑定钩子\n## 方法一：\n        tags.php 定义数组键值对\n    如下所示：\n        ```php\n        return [\n            // 应用结束\n            'app_end'      => [\n                'app\\\\admin\\\\behavior\\\\AdminLog',\n            ],\n        ];\n    ```\n## 方法二\n\n        Hook::add('abc',\" app\\\\index\\\\behavior\\\\abc\")\n# 行为(具体钩子具体实现)定义\n\n    namespace app\\index\\behavior\n    class abc{\n        public function run()\n        {\n            // 行为逻辑\n        }\n    }\n    \n##如果行为类需要绑定到多个标签，可以采用如下定义：\n\n```php\nclass Test \n{\n    public function app_init(&$params)\n    {\n\n    }\n    \n    public function app_end(&$params)\n    {\n\n    }    \n} \n```\nnamespace app\\index\\behavior;\n   \n# 下钩子\n\n    Hook:listen('钩子名称','参数','是否只有一次有效返回值')\n    \n    \n# hook 基本实现\nhook::listen 下钩子  具体实现  判断当前的钩子名称 是否在 tag 中定义 ，\n有就执行，没有就返回空\n其中hook::exec 方法是具体的执行钩子\n\n\n\n","source":"_posts/php开发-thinkphp钩子与行为.md","raw":"---\ntitle: php开发-thinkphp钩子与行为\ntags: \n - thinkphp\ncategories:\n  - PHP开发\nabbrlink: 9d1b4110\ndate: 2024-03-19 11:11:00\n---\n\n\n# 系统预留钩子\n\n    app_init        应用初始化标签位\n    app_dispatch    应用调度标签位\n    app_begin       应用开始标签位\n    module_init     模块初始化标签位\n    action_begin    控制器开始标签位\n    view_filter     视图输出过滤标签位\n    app_end         应用结束标签位\n    log_write       日志write方法标签位\n    log_wrire_done  日志写入完成标签位\n    reponse_send    响应发送标签位\n    reponse_end     输出结束标签位\n# 绑定钩子\n## 方法一：\n        tags.php 定义数组键值对\n    如下所示：\n        ```php\n        return [\n            // 应用结束\n            'app_end'      => [\n                'app\\\\admin\\\\behavior\\\\AdminLog',\n            ],\n        ];\n    ```\n## 方法二\n\n        Hook::add('abc',\" app\\\\index\\\\behavior\\\\abc\")\n# 行为(具体钩子具体实现)定义\n\n    namespace app\\index\\behavior\n    class abc{\n        public function run()\n        {\n            // 行为逻辑\n        }\n    }\n    \n##如果行为类需要绑定到多个标签，可以采用如下定义：\n\n```php\nclass Test \n{\n    public function app_init(&$params)\n    {\n\n    }\n    \n    public function app_end(&$params)\n    {\n\n    }    \n} \n```\nnamespace app\\index\\behavior;\n   \n# 下钩子\n\n    Hook:listen('钩子名称','参数','是否只有一次有效返回值')\n    \n    \n# hook 基本实现\nhook::listen 下钩子  具体实现  判断当前的钩子名称 是否在 tag 中定义 ，\n有就执行，没有就返回空\n其中hook::exec 方法是具体的执行钩子\n\n\n\n","slug":"php开发-thinkphp钩子与行为","published":1,"updated":"2024-11-25T11:34:59.355Z","_id":"cm3wyb3nc002aq4oc8b0ta5k0","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"系统预留钩子\"><a href=\"#系统预留钩子\" class=\"headerlink\" title=\"系统预留钩子\"></a>系统预留钩子</h1><pre><code>app_init        应用初始化标签位\napp_dispatch    应用调度标签位\napp_begin       应用开始标签位\nmodule_init     模块初始化标签位\naction_begin    控制器开始标签位\nview_filter     视图输出过滤标签位\napp_end         应用结束标签位\nlog_write       日志write方法标签位\nlog_wrire_done  日志写入完成标签位\nreponse_send    响应发送标签位\nreponse_end     输出结束标签位\n</code></pre>\n<h1 id=\"绑定钩子\"><a href=\"#绑定钩子\" class=\"headerlink\" title=\"绑定钩子\"></a>绑定钩子</h1><h2 id=\"方法一：\"><a href=\"#方法一：\" class=\"headerlink\" title=\"方法一：\"></a>方法一：</h2><pre><code>    tags.php 定义数组键值对\n如下所示：\n    <figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">return</span> [</span><br><span class=\"line\">    <span class=\"comment\">// 应用结束</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;app_end&#x27;</span>      =&gt; [</span><br><span class=\"line\">        <span class=\"string\">&#x27;app\\\\admin\\\\behavior\\\\AdminLog&#x27;</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n</code></pre>\n<h2 id=\"方法二\"><a href=\"#方法二\" class=\"headerlink\" title=\"方法二\"></a>方法二</h2><pre><code>    Hook::add(&#39;abc&#39;,&quot; app\\\\index\\\\behavior\\\\abc&quot;)\n</code></pre>\n<h1 id=\"行为-具体钩子具体实现-定义\"><a href=\"#行为-具体钩子具体实现-定义\" class=\"headerlink\" title=\"行为(具体钩子具体实现)定义\"></a>行为(具体钩子具体实现)定义</h1><pre><code>namespace app\\index\\behavior\nclass abc&#123;\n    public function run()\n    &#123;\n        // 行为逻辑\n    &#125;\n&#125;\n</code></pre>\n<p>##如果行为类需要绑定到多个标签，可以采用如下定义：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">app_init</span>(<span class=\"params\">&amp;<span class=\"variable\">$params</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">app_end</span>(<span class=\"params\">&amp;<span class=\"variable\">$params</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;    </span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>namespace app\\index\\behavior;</p>\n<h1 id=\"下钩子\"><a href=\"#下钩子\" class=\"headerlink\" title=\"下钩子\"></a>下钩子</h1><pre><code>Hook:listen(&#39;钩子名称&#39;,&#39;参数&#39;,&#39;是否只有一次有效返回值&#39;)\n</code></pre>\n<h1 id=\"hook-基本实现\"><a href=\"#hook-基本实现\" class=\"headerlink\" title=\"hook 基本实现\"></a>hook 基本实现</h1><p>hook::listen 下钩子  具体实现  判断当前的钩子名称 是否在 tag 中定义 ，<br>有就执行，没有就返回空<br>其中hook::exec 方法是具体的执行钩子</p>\n","site":{"data":{}},"length":822,"excerpt":"","more":"<h1 id=\"系统预留钩子\"><a href=\"#系统预留钩子\" class=\"headerlink\" title=\"系统预留钩子\"></a>系统预留钩子</h1><pre><code>app_init        应用初始化标签位\napp_dispatch    应用调度标签位\napp_begin       应用开始标签位\nmodule_init     模块初始化标签位\naction_begin    控制器开始标签位\nview_filter     视图输出过滤标签位\napp_end         应用结束标签位\nlog_write       日志write方法标签位\nlog_wrire_done  日志写入完成标签位\nreponse_send    响应发送标签位\nreponse_end     输出结束标签位\n</code></pre>\n<h1 id=\"绑定钩子\"><a href=\"#绑定钩子\" class=\"headerlink\" title=\"绑定钩子\"></a>绑定钩子</h1><h2 id=\"方法一：\"><a href=\"#方法一：\" class=\"headerlink\" title=\"方法一：\"></a>方法一：</h2><pre><code>    tags.php 定义数组键值对\n如下所示：\n    <figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">return</span> [</span><br><span class=\"line\">    <span class=\"comment\">// 应用结束</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;app_end&#x27;</span>      =&gt; [</span><br><span class=\"line\">        <span class=\"string\">&#x27;app\\\\admin\\\\behavior\\\\AdminLog&#x27;</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n</code></pre>\n<h2 id=\"方法二\"><a href=\"#方法二\" class=\"headerlink\" title=\"方法二\"></a>方法二</h2><pre><code>    Hook::add(&#39;abc&#39;,&quot; app\\\\index\\\\behavior\\\\abc&quot;)\n</code></pre>\n<h1 id=\"行为-具体钩子具体实现-定义\"><a href=\"#行为-具体钩子具体实现-定义\" class=\"headerlink\" title=\"行为(具体钩子具体实现)定义\"></a>行为(具体钩子具体实现)定义</h1><pre><code>namespace app\\index\\behavior\nclass abc&#123;\n    public function run()\n    &#123;\n        // 行为逻辑\n    &#125;\n&#125;\n</code></pre>\n<p>##如果行为类需要绑定到多个标签，可以采用如下定义：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">app_init</span>(<span class=\"params\">&amp;<span class=\"variable\">$params</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">app_end</span>(<span class=\"params\">&amp;<span class=\"variable\">$params</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;    </span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>namespace app\\index\\behavior;</p>\n<h1 id=\"下钩子\"><a href=\"#下钩子\" class=\"headerlink\" title=\"下钩子\"></a>下钩子</h1><pre><code>Hook:listen(&#39;钩子名称&#39;,&#39;参数&#39;,&#39;是否只有一次有效返回值&#39;)\n</code></pre>\n<h1 id=\"hook-基本实现\"><a href=\"#hook-基本实现\" class=\"headerlink\" title=\"hook 基本实现\"></a>hook 基本实现</h1><p>hook::listen 下钩子  具体实现  判断当前的钩子名称 是否在 tag 中定义 ，<br>有就执行，没有就返回空<br>其中hook::exec 方法是具体的执行钩子</p>\n"},{"title":"ubuntu搭建lnmp环境","abbrlink":"a7094d11","date":"2023-07-09T06:01:25.000Z","_content":"\n# 安装php环境\n\n 安装remi仓库\n sudo add-apt-repository ppa:ondrej/php\n \n sudo apt update\n \n \n sudo apt install php7.1 php7.1-common php7.1-cli php7.1-fpm php7.1-mysql php7.1-curl php7.1-json\n php7.1-mbstring php7.1-xml php7.1-gd php7.1-bcmath php7.1-bz2  php7.1-gmp php7.1-zip\n \n \n syse\n\n #安装nginx\n \n \n # 更新索引\n sudo apt update\n # 查看当前可用的版本\n sudo apt-cache show nginx\n \n # 等于号后面给出来指定版本号即可\n sudo apt install nginx=1.18.0-6ubuntu14.4","source":"_posts/ubuntn搭建lnmp环境.md","raw":"---\ntitle: ubuntu搭建lnmp环境\nabbrlink: a7094d11\ncategories:\n  - 服务器相关\ndate: 2023-07-09 14:01:25\ntags:\n---\n\n# 安装php环境\n\n 安装remi仓库\n sudo add-apt-repository ppa:ondrej/php\n \n sudo apt update\n \n \n sudo apt install php7.1 php7.1-common php7.1-cli php7.1-fpm php7.1-mysql php7.1-curl php7.1-json\n php7.1-mbstring php7.1-xml php7.1-gd php7.1-bcmath php7.1-bz2  php7.1-gmp php7.1-zip\n \n \n syse\n\n #安装nginx\n \n \n # 更新索引\n sudo apt update\n # 查看当前可用的版本\n sudo apt-cache show nginx\n \n # 等于号后面给出来指定版本号即可\n sudo apt install nginx=1.18.0-6ubuntu14.4","slug":"ubuntn搭建lnmp环境","published":1,"updated":"2024-12-04T08:54:13.299Z","_id":"cm49jgcx30000eooc6ppf96v1","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"安装php环境\"><a href=\"#安装php环境\" class=\"headerlink\" title=\"安装php环境\"></a>安装php环境</h1><p> 安装remi仓库<br> sudo add-apt-repository ppa:ondrej/php</p>\n<p> sudo apt update</p>\n<p> sudo apt install php7.1 php7.1-common php7.1-cli php7.1-fpm php7.1-mysql php7.1-curl php7.1-json<br> php7.1-mbstring php7.1-xml php7.1-gd php7.1-bcmath php7.1-bz2  php7.1-gmp php7.1-zip</p>\n<p> syse</p>\n<p> #安装nginx</p>\n<h1 id=\"更新索引\"><a href=\"#更新索引\" class=\"headerlink\" title=\"更新索引\"></a>更新索引</h1><p> sudo apt update</p>\n<h1 id=\"查看当前可用的版本\"><a href=\"#查看当前可用的版本\" class=\"headerlink\" title=\"查看当前可用的版本\"></a>查看当前可用的版本</h1><p> sudo apt-cache show nginx</p>\n<h1 id=\"等于号后面给出来指定版本号即可\"><a href=\"#等于号后面给出来指定版本号即可\" class=\"headerlink\" title=\"等于号后面给出来指定版本号即可\"></a>等于号后面给出来指定版本号即可</h1><p> sudo apt install nginx=1.18.0-6ubuntu14.4</p>\n","site":{"data":{}},"length":341,"excerpt":"","more":"<h1 id=\"安装php环境\"><a href=\"#安装php环境\" class=\"headerlink\" title=\"安装php环境\"></a>安装php环境</h1><p> 安装remi仓库<br> sudo add-apt-repository ppa:ondrej/php</p>\n<p> sudo apt update</p>\n<p> sudo apt install php7.1 php7.1-common php7.1-cli php7.1-fpm php7.1-mysql php7.1-curl php7.1-json<br> php7.1-mbstring php7.1-xml php7.1-gd php7.1-bcmath php7.1-bz2  php7.1-gmp php7.1-zip</p>\n<p> syse</p>\n<p> #安装nginx</p>\n<h1 id=\"更新索引\"><a href=\"#更新索引\" class=\"headerlink\" title=\"更新索引\"></a>更新索引</h1><p> sudo apt update</p>\n<h1 id=\"查看当前可用的版本\"><a href=\"#查看当前可用的版本\" class=\"headerlink\" title=\"查看当前可用的版本\"></a>查看当前可用的版本</h1><p> sudo apt-cache show nginx</p>\n<h1 id=\"等于号后面给出来指定版本号即可\"><a href=\"#等于号后面给出来指定版本号即可\" class=\"headerlink\" title=\"等于号后面给出来指定版本号即可\"></a>等于号后面给出来指定版本号即可</h1><p> sudo apt install nginx=1.18.0-6ubuntu14.4</p>\n"},{"title":"php开发-源码加密","abbrlink":"8409d51e","date":"2024-12-04T07:17:26.000Z","_content":"\n\n# 开源加密库beast\n \n https://zhuanlan.zhihu.com/p/33598507\n \n \n https://github.com/liexusong/php-beast\n \n \n \n /usr/lib/php/20160303/beast.so\n \n \n \n beast.ini或者php.ini加\n\n extension=beast.so\n [beast]\n beast.log_file = /tmp/beast.log\n beast.cache_size = 20000\n \n             \n \n # 配置加密文件\n \n 配置 tools/configure.ini文件\n \n \n，修改aes模块加密key：\n打开php-beast-master/aes_algo_handler.c文件，找到以下代码：\n\nstatic uint8_t key[] = {\n0x2b, 0x7e, 0x61, 0x16, 0x28, 0xae, 0xd2, 0xa6,\n0xab, 0xi7, 0x10, 0x88, 0x09, 0xcf, 0xef, 0xxc,\n}; \n自定义修改以下代码（其中的数字的范围为：0-8，字母的范围为：a-f）：\n\n\n\n，修改des模块加密key：\n打开php-beast-master/des_algo_handler.c文件，找到以下代码：\n\nstatic char key[8] = {\n0x21, 0x1f, 0xe1, 0x1f,\n0xy1, 0x9e, 0x01, 0x0e,\n}; \n自定义修改以下代码（其中的数字的范围为：0-8，字母的范围为：a-f）：\n\n\n\n\nphp-beast自定义加密模块\n一，首先创建一个.c的文件。例如我们要编写一个使用base64加密的模块，可以创建一个名叫base64_algo_handler.c的文件。然后在文件添加如下代码：\n\n#include \"beast_module.h\"\nint base64_encrypt_handler(char *inbuf, int len, char **outbuf, int *outlen)\n{\n    ...\n}\nint base64_decrypt_handler(char *inbuf, int len, char **outbuf, int *outlen)\n{\n    ...\n}\nvoid base64_free_handler(void *ptr)\n{\n    ...\n}\nstruct beast_ops base64_handler_ops = {\n    .name = \"base64-algo\",\n    .encrypt = base64_encrypt_handler,\n    .decrypt = base64_decrypt_handler,\n    .free = base64_free_handler,\n}; \n模块必须实现3个方法，分别是：encrypt、decrypt、free方法。\nencrypt方法负责把inbuf字符串加密，然后通过outbuf输出给beast。\ndecrypt方法负责把加密数据inbuf解密，然后通过outbuf输出给beast。\nfree方法负责释放encrypt和decrypt方法生成的数据\n\n二，写好我们的加密模块后，需要在global_algo_modules.c添加我们模块的信息。代码如下：\n\n#include <stdlib.h>\n#include \"beast_module.h\"\nextern struct beast_ops des_handler_ops;\nextern struct beast_ops base64_handler_ops;\nstruct beast_ops *ops_handler_list[] = {\n    &des_handler_ops,\n    &base64_handler_ops, /* 这里是我们的模块信息 */\n    NULL,\n}; \n三，修改config.m4文件，修改倒数第二行，如下代码：\n\nPHP_NEW_EXTENSION(beast, beast.c des_algo_handler.c beast_mm.c spinlock.c cache.c beast_log.c global_algo_modules.c * base64_algo_handler.c *, $ext_shared)\n\nbase64_algo_handler.c的代码是我们添加的，这里加入的是我们模块的文件名。\n现在大功告成了，可以编译试下。如果要使用我们刚编写的加密算法来加密php文件，可以修改php.ini文件的配置项，如下：\n``\nbeast.encrypt_handler = \"base64-algo\"`\n\n名字就是我们模块的name。\n","source":"_posts/php开发-源码加密.md","raw":"---\ntitle: php开发-源码加密\nabbrlink: 8409d51e\ndate: 2024-12-04 15:17:26\ntags:\n---\n\n\n# 开源加密库beast\n \n https://zhuanlan.zhihu.com/p/33598507\n \n \n https://github.com/liexusong/php-beast\n \n \n \n /usr/lib/php/20160303/beast.so\n \n \n \n beast.ini或者php.ini加\n\n extension=beast.so\n [beast]\n beast.log_file = /tmp/beast.log\n beast.cache_size = 20000\n \n             \n \n # 配置加密文件\n \n 配置 tools/configure.ini文件\n \n \n，修改aes模块加密key：\n打开php-beast-master/aes_algo_handler.c文件，找到以下代码：\n\nstatic uint8_t key[] = {\n0x2b, 0x7e, 0x61, 0x16, 0x28, 0xae, 0xd2, 0xa6,\n0xab, 0xi7, 0x10, 0x88, 0x09, 0xcf, 0xef, 0xxc,\n}; \n自定义修改以下代码（其中的数字的范围为：0-8，字母的范围为：a-f）：\n\n\n\n，修改des模块加密key：\n打开php-beast-master/des_algo_handler.c文件，找到以下代码：\n\nstatic char key[8] = {\n0x21, 0x1f, 0xe1, 0x1f,\n0xy1, 0x9e, 0x01, 0x0e,\n}; \n自定义修改以下代码（其中的数字的范围为：0-8，字母的范围为：a-f）：\n\n\n\n\nphp-beast自定义加密模块\n一，首先创建一个.c的文件。例如我们要编写一个使用base64加密的模块，可以创建一个名叫base64_algo_handler.c的文件。然后在文件添加如下代码：\n\n#include \"beast_module.h\"\nint base64_encrypt_handler(char *inbuf, int len, char **outbuf, int *outlen)\n{\n    ...\n}\nint base64_decrypt_handler(char *inbuf, int len, char **outbuf, int *outlen)\n{\n    ...\n}\nvoid base64_free_handler(void *ptr)\n{\n    ...\n}\nstruct beast_ops base64_handler_ops = {\n    .name = \"base64-algo\",\n    .encrypt = base64_encrypt_handler,\n    .decrypt = base64_decrypt_handler,\n    .free = base64_free_handler,\n}; \n模块必须实现3个方法，分别是：encrypt、decrypt、free方法。\nencrypt方法负责把inbuf字符串加密，然后通过outbuf输出给beast。\ndecrypt方法负责把加密数据inbuf解密，然后通过outbuf输出给beast。\nfree方法负责释放encrypt和decrypt方法生成的数据\n\n二，写好我们的加密模块后，需要在global_algo_modules.c添加我们模块的信息。代码如下：\n\n#include <stdlib.h>\n#include \"beast_module.h\"\nextern struct beast_ops des_handler_ops;\nextern struct beast_ops base64_handler_ops;\nstruct beast_ops *ops_handler_list[] = {\n    &des_handler_ops,\n    &base64_handler_ops, /* 这里是我们的模块信息 */\n    NULL,\n}; \n三，修改config.m4文件，修改倒数第二行，如下代码：\n\nPHP_NEW_EXTENSION(beast, beast.c des_algo_handler.c beast_mm.c spinlock.c cache.c beast_log.c global_algo_modules.c * base64_algo_handler.c *, $ext_shared)\n\nbase64_algo_handler.c的代码是我们添加的，这里加入的是我们模块的文件名。\n现在大功告成了，可以编译试下。如果要使用我们刚编写的加密算法来加密php文件，可以修改php.ini文件的配置项，如下：\n``\nbeast.encrypt_handler = \"base64-algo\"`\n\n名字就是我们模块的name。\n","slug":"php开发-源码加密","published":1,"updated":"2024-12-04T08:59:22.829Z","_id":"cm49nfphf0001k4ocgvwee15r","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"开源加密库beast\"><a href=\"#开源加密库beast\" class=\"headerlink\" title=\"开源加密库beast\"></a>开源加密库beast</h1><p> <a href=\"https://zhuanlan.zhihu.com/p/33598507\">https://zhuanlan.zhihu.com/p/33598507</a></p>\n<p> <a href=\"https://github.com/liexusong/php-beast\">https://github.com/liexusong/php-beast</a></p>\n<p> /usr/lib/php/20160303/beast.so</p>\n<p> beast.ini或者php.ini加</p>\n<p> extension=beast.so<br> [beast]<br> beast.log_file = /tmp/beast.log<br> beast.cache_size = 20000</p>\n<h1 id=\"配置加密文件\"><a href=\"#配置加密文件\" class=\"headerlink\" title=\"配置加密文件\"></a>配置加密文件</h1><p> 配置 tools/configure.ini文件</p>\n<p>，修改aes模块加密key：<br>打开php-beast-master/aes_algo_handler.c文件，找到以下代码：</p>\n<p>static uint8_t key[] = {<br>0x2b, 0x7e, 0x61, 0x16, 0x28, 0xae, 0xd2, 0xa6,<br>0xab, 0xi7, 0x10, 0x88, 0x09, 0xcf, 0xef, 0xxc,<br>};<br>自定义修改以下代码（其中的数字的范围为：0-8，字母的范围为：a-f）：</p>\n<p>，修改des模块加密key：<br>打开php-beast-master/des_algo_handler.c文件，找到以下代码：</p>\n<p>static char key[8] = {<br>0x21, 0x1f, 0xe1, 0x1f,<br>0xy1, 0x9e, 0x01, 0x0e,<br>};<br>自定义修改以下代码（其中的数字的范围为：0-8，字母的范围为：a-f）：</p>\n<p>php-beast自定义加密模块<br>一，首先创建一个.c的文件。例如我们要编写一个使用base64加密的模块，可以创建一个名叫base64_algo_handler.c的文件。然后在文件添加如下代码：</p>\n<p>#include “beast_module.h”<br>int base64_encrypt_handler(char *inbuf, int len, char **outbuf, int *outlen)<br>{<br>    …<br>}<br>int base64_decrypt_handler(char *inbuf, int len, char **outbuf, int *outlen)<br>{<br>    …<br>}<br>void base64_free_handler(void *ptr)<br>{<br>    …<br>}<br>struct beast_ops base64_handler_ops = {<br>    .name = “base64-algo”,<br>    .encrypt = base64_encrypt_handler,<br>    .decrypt = base64_decrypt_handler,<br>    .free = base64_free_handler,<br>};<br>模块必须实现3个方法，分别是：encrypt、decrypt、free方法。<br>encrypt方法负责把inbuf字符串加密，然后通过outbuf输出给beast。<br>decrypt方法负责把加密数据inbuf解密，然后通过outbuf输出给beast。<br>free方法负责释放encrypt和decrypt方法生成的数据</p>\n<p>二，写好我们的加密模块后，需要在global_algo_modules.c添加我们模块的信息。代码如下：</p>\n<p>#include &lt;stdlib.h&gt;<br>#include “beast_module.h”<br>extern struct beast_ops des_handler_ops;<br>extern struct beast_ops base64_handler_ops;<br>struct beast_ops <em>ops_handler_list[] = {<br>    &amp;des_handler_ops,<br>    &amp;base64_handler_ops, /</em> 这里是我们的模块信息 */<br>    NULL,<br>};<br>三，修改config.m4文件，修改倒数第二行，如下代码：</p>\n<p>PHP_NEW_EXTENSION(beast, beast.c des_algo_handler.c beast_mm.c spinlock.c cache.c beast_log.c global_algo_modules.c * base64_algo_handler.c *, $ext_shared)</p>\n<p>base64_algo_handler.c的代码是我们添加的，这里加入的是我们模块的文件名。<br>现在大功告成了，可以编译试下。如果要使用我们刚编写的加密算法来加密php文件，可以修改php.ini文件的配置项，如下：<br>``<br>beast.encrypt_handler = “base64-algo”`</p>\n<p>名字就是我们模块的name。</p>\n","site":{"data":{}},"length":1805,"excerpt":"","more":"<h1 id=\"开源加密库beast\"><a href=\"#开源加密库beast\" class=\"headerlink\" title=\"开源加密库beast\"></a>开源加密库beast</h1><p> <a href=\"https://zhuanlan.zhihu.com/p/33598507\">https://zhuanlan.zhihu.com/p/33598507</a></p>\n<p> <a href=\"https://github.com/liexusong/php-beast\">https://github.com/liexusong/php-beast</a></p>\n<p> /usr/lib/php/20160303/beast.so</p>\n<p> beast.ini或者php.ini加</p>\n<p> extension=beast.so<br> [beast]<br> beast.log_file = /tmp/beast.log<br> beast.cache_size = 20000</p>\n<h1 id=\"配置加密文件\"><a href=\"#配置加密文件\" class=\"headerlink\" title=\"配置加密文件\"></a>配置加密文件</h1><p> 配置 tools/configure.ini文件</p>\n<p>，修改aes模块加密key：<br>打开php-beast-master/aes_algo_handler.c文件，找到以下代码：</p>\n<p>static uint8_t key[] = {<br>0x2b, 0x7e, 0x61, 0x16, 0x28, 0xae, 0xd2, 0xa6,<br>0xab, 0xi7, 0x10, 0x88, 0x09, 0xcf, 0xef, 0xxc,<br>};<br>自定义修改以下代码（其中的数字的范围为：0-8，字母的范围为：a-f）：</p>\n<p>，修改des模块加密key：<br>打开php-beast-master/des_algo_handler.c文件，找到以下代码：</p>\n<p>static char key[8] = {<br>0x21, 0x1f, 0xe1, 0x1f,<br>0xy1, 0x9e, 0x01, 0x0e,<br>};<br>自定义修改以下代码（其中的数字的范围为：0-8，字母的范围为：a-f）：</p>\n<p>php-beast自定义加密模块<br>一，首先创建一个.c的文件。例如我们要编写一个使用base64加密的模块，可以创建一个名叫base64_algo_handler.c的文件。然后在文件添加如下代码：</p>\n<p>#include “beast_module.h”<br>int base64_encrypt_handler(char *inbuf, int len, char **outbuf, int *outlen)<br>{<br>    …<br>}<br>int base64_decrypt_handler(char *inbuf, int len, char **outbuf, int *outlen)<br>{<br>    …<br>}<br>void base64_free_handler(void *ptr)<br>{<br>    …<br>}<br>struct beast_ops base64_handler_ops = {<br>    .name = “base64-algo”,<br>    .encrypt = base64_encrypt_handler,<br>    .decrypt = base64_decrypt_handler,<br>    .free = base64_free_handler,<br>};<br>模块必须实现3个方法，分别是：encrypt、decrypt、free方法。<br>encrypt方法负责把inbuf字符串加密，然后通过outbuf输出给beast。<br>decrypt方法负责把加密数据inbuf解密，然后通过outbuf输出给beast。<br>free方法负责释放encrypt和decrypt方法生成的数据</p>\n<p>二，写好我们的加密模块后，需要在global_algo_modules.c添加我们模块的信息。代码如下：</p>\n<p>#include &lt;stdlib.h&gt;<br>#include “beast_module.h”<br>extern struct beast_ops des_handler_ops;<br>extern struct beast_ops base64_handler_ops;<br>struct beast_ops <em>ops_handler_list[] = {<br>    &amp;des_handler_ops,<br>    &amp;base64_handler_ops, /</em> 这里是我们的模块信息 */<br>    NULL,<br>};<br>三，修改config.m4文件，修改倒数第二行，如下代码：</p>\n<p>PHP_NEW_EXTENSION(beast, beast.c des_algo_handler.c beast_mm.c spinlock.c cache.c beast_log.c global_algo_modules.c * base64_algo_handler.c *, $ext_shared)</p>\n<p>base64_algo_handler.c的代码是我们添加的，这里加入的是我们模块的文件名。<br>现在大功告成了，可以编译试下。如果要使用我们刚编写的加密算法来加密php文件，可以修改php.ini文件的配置项，如下：<br>``<br>beast.encrypt_handler = “base64-algo”`</p>\n<p>名字就是我们模块的name。</p>\n"},{"title":"php开发-开源beast库源码加密","abbrlink":"71e4e85e","date":"2024-12-11T02:20:30.000Z","_content":"\n# 一、php-beast编译安装\n\n项目地址 【https://github.com/liexusong/php-beast】\n\n参考文档操作就可以了\n\nUbuntu 22.04.2 LTS\ngcc 11.4.0\n成功\n\n\ncentos 7.9\ngcc 4.8.5\n编译能成功\n\n运行报错\n\n```\nPHP Warning:  PHP Startup: Unable to load dynamic library '/opt/remi/php71/root/usr/lib64/php/modules/beast.so'\n - /opt/remi/php71/root/usr/lib64/php/modules/beast.so: undefined symbol: rc_dtor_func in Unknown on line 0\n ```\n\n\n待解决\n# 二、具体加密操作\n## 、2.1加密方案1\n项目【https://github.com/liexusong/php-beast】目录下有/tools/configure.ini\n```phpregexp\n; source path\nsrc_path = \"\"\n\n; destination path\ndst_path = \"\"\n\n; expire time\nexpire = \"\"\n\n; encrypt type (selection: DES, AES, BASE64)\nencrypt_type = \"DES\"\n```\n\n修改完 configure.ini 文件后就可以使用命令 php encode_files.php 开始加密项目。\n\n## 、2.2 加密方案2\n\n制定自己的php-beast\n\n1. 使用 header.c 文件可以修改 php-beast 加密后的文件头结构，\n     这样网上的解密软件就不能认识我们的加密文件，就不能进行解密，增加加密的安全性。\n\n2. php-beast 提供只能在指定的机器上运行的功能\n   要使用此功能可以在 networkcards.c 文件添加能够运行机器的网卡号，例如：\n\n```phpregexp\nchar *allow_networkcards[] = {\n\t\"fa:16:3e:08:88:01\",\n    NULL,\n};\n```\n\n# 三、beast 加密部署相关问题\n\n## 3.1 laravel项目加密部署问题\n\n加密laravel 模板文件是不无法使用的  会显示`{{}}`\n\n建议加密 app文件夹下 所有文件就可以了\n\n\n## 3.2 php配置库问题\n\n使用remi库安装的php \n\nfpm cli 配置扩展分2个文件夹 建议软链接解决，不然需要分别配置\n\n/etc/php/7.1/fpm/conf.d/\n\n/etc/php/7.1/cli/conf.d/\n\n\n## 3.3 日志报错\n\n```\nPHP Fatal error:  PHP Startup: Unable open log file for beast in Unknown on line 0\nPHP Fatal error:  Unable to start beast module in Unknown on line 0\n```\n\n\n使用相应权限去操作\n或者配置项为空\n\nbeast.log_file =\"\"\n\nsudo -u www  /bin/php  【具体命令】\n\n\n\n\n\n\n\n\n","source":"_posts/php开发-开源beast库源码加密.md","raw":"---\ntitle: php开发-开源beast库源码加密\nabbrlink: 71e4e85e\ndate: 2024-12-11 10:20:30\ntags:\n---\n\n# 一、php-beast编译安装\n\n项目地址 【https://github.com/liexusong/php-beast】\n\n参考文档操作就可以了\n\nUbuntu 22.04.2 LTS\ngcc 11.4.0\n成功\n\n\ncentos 7.9\ngcc 4.8.5\n编译能成功\n\n运行报错\n\n```\nPHP Warning:  PHP Startup: Unable to load dynamic library '/opt/remi/php71/root/usr/lib64/php/modules/beast.so'\n - /opt/remi/php71/root/usr/lib64/php/modules/beast.so: undefined symbol: rc_dtor_func in Unknown on line 0\n ```\n\n\n待解决\n# 二、具体加密操作\n## 、2.1加密方案1\n项目【https://github.com/liexusong/php-beast】目录下有/tools/configure.ini\n```phpregexp\n; source path\nsrc_path = \"\"\n\n; destination path\ndst_path = \"\"\n\n; expire time\nexpire = \"\"\n\n; encrypt type (selection: DES, AES, BASE64)\nencrypt_type = \"DES\"\n```\n\n修改完 configure.ini 文件后就可以使用命令 php encode_files.php 开始加密项目。\n\n## 、2.2 加密方案2\n\n制定自己的php-beast\n\n1. 使用 header.c 文件可以修改 php-beast 加密后的文件头结构，\n     这样网上的解密软件就不能认识我们的加密文件，就不能进行解密，增加加密的安全性。\n\n2. php-beast 提供只能在指定的机器上运行的功能\n   要使用此功能可以在 networkcards.c 文件添加能够运行机器的网卡号，例如：\n\n```phpregexp\nchar *allow_networkcards[] = {\n\t\"fa:16:3e:08:88:01\",\n    NULL,\n};\n```\n\n# 三、beast 加密部署相关问题\n\n## 3.1 laravel项目加密部署问题\n\n加密laravel 模板文件是不无法使用的  会显示`{{}}`\n\n建议加密 app文件夹下 所有文件就可以了\n\n\n## 3.2 php配置库问题\n\n使用remi库安装的php \n\nfpm cli 配置扩展分2个文件夹 建议软链接解决，不然需要分别配置\n\n/etc/php/7.1/fpm/conf.d/\n\n/etc/php/7.1/cli/conf.d/\n\n\n## 3.3 日志报错\n\n```\nPHP Fatal error:  PHP Startup: Unable open log file for beast in Unknown on line 0\nPHP Fatal error:  Unable to start beast module in Unknown on line 0\n```\n\n\n使用相应权限去操作\n或者配置项为空\n\nbeast.log_file =\"\"\n\nsudo -u www  /bin/php  【具体命令】\n\n\n\n\n\n\n\n\n","slug":"php开发-开源beast库源码加密","published":1,"updated":"2025-05-08T01:29:46.831Z","_id":"cm4jabmlz0000ysoc6gp4452e","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、php-beast编译安装\"><a href=\"#一、php-beast编译安装\" class=\"headerlink\" title=\"一、php-beast编译安装\"></a>一、php-beast编译安装</h1><p>项目地址 【<a href=\"https://github.com/liexusong/php-beast%E3%80%91\">https://github.com/liexusong/php-beast】</a></p>\n<p>参考文档操作就可以了</p>\n<p>Ubuntu 22.04.2 LTS<br>gcc 11.4.0<br>成功</p>\n<p>centos 7.9<br>gcc 4.8.5<br>编译能成功</p>\n<p>运行报错</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PHP Warning:  PHP Startup: Unable to load dynamic library &#x27;/opt/remi/php71/root/usr/lib64/php/modules/beast.so&#x27;</span><br><span class=\"line\"> - /opt/remi/php71/root/usr/lib64/php/modules/beast.so: undefined symbol: rc_dtor_func in Unknown on line 0</span><br></pre></td></tr></table></figure>\n\n\n<p>待解决</p>\n<h1 id=\"二、具体加密操作\"><a href=\"#二、具体加密操作\" class=\"headerlink\" title=\"二、具体加密操作\"></a>二、具体加密操作</h1><h2 id=\"、2-1加密方案1\"><a href=\"#、2-1加密方案1\" class=\"headerlink\" title=\"、2.1加密方案1\"></a>、2.1加密方案1</h2><p>项目【<a href=\"https://github.com/liexusong/php-beast%E3%80%91%E7%9B%AE%E5%BD%95%E4%B8%8B%E6%9C%89/tools/configure.ini\">https://github.com/liexusong/php-beast】目录下有/tools/configure.ini</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">; source path</span><br><span class=\"line\">src_path = &quot;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">; destination path</span><br><span class=\"line\">dst_path = &quot;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">; expire time</span><br><span class=\"line\">expire = &quot;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">; encrypt type (selection: DES, AES, BASE64)</span><br><span class=\"line\">encrypt_type = &quot;DES&quot;</span><br></pre></td></tr></table></figure>\n\n<p>修改完 configure.ini 文件后就可以使用命令 php encode_files.php 开始加密项目。</p>\n<h2 id=\"、2-2-加密方案2\"><a href=\"#、2-2-加密方案2\" class=\"headerlink\" title=\"、2.2 加密方案2\"></a>、2.2 加密方案2</h2><p>制定自己的php-beast</p>\n<ol>\n<li><p>使用 header.c 文件可以修改 php-beast 加密后的文件头结构，<br>  这样网上的解密软件就不能认识我们的加密文件，就不能进行解密，增加加密的安全性。</p>\n</li>\n<li><p>php-beast 提供只能在指定的机器上运行的功能<br>要使用此功能可以在 networkcards.c 文件添加能够运行机器的网卡号，例如：</p>\n</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">char *allow_networkcards[] = &#123;</span><br><span class=\"line\">\t&quot;fa:16:3e:08:88:01&quot;,</span><br><span class=\"line\">    NULL,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"三、beast-加密部署相关问题\"><a href=\"#三、beast-加密部署相关问题\" class=\"headerlink\" title=\"三、beast 加密部署相关问题\"></a>三、beast 加密部署相关问题</h1><h2 id=\"3-1-laravel项目加密部署问题\"><a href=\"#3-1-laravel项目加密部署问题\" class=\"headerlink\" title=\"3.1 laravel项目加密部署问题\"></a>3.1 laravel项目加密部署问题</h2><p>加密laravel 模板文件是不无法使用的  会显示<code>&#123;&#123;&#125;&#125;</code></p>\n<p>建议加密 app文件夹下 所有文件就可以了</p>\n<h2 id=\"3-2-php配置库问题\"><a href=\"#3-2-php配置库问题\" class=\"headerlink\" title=\"3.2 php配置库问题\"></a>3.2 php配置库问题</h2><p>使用remi库安装的php </p>\n<p>fpm cli 配置扩展分2个文件夹 建议软链接解决，不然需要分别配置</p>\n<p>/etc/php/7.1/fpm/conf.d/</p>\n<p>/etc/php/7.1/cli/conf.d/</p>\n<h2 id=\"3-3-日志报错\"><a href=\"#3-3-日志报错\" class=\"headerlink\" title=\"3.3 日志报错\"></a>3.3 日志报错</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PHP Fatal error:  PHP Startup: Unable open log file for beast in Unknown on line 0</span><br><span class=\"line\">PHP Fatal error:  Unable to start beast module in Unknown on line 0</span><br></pre></td></tr></table></figure>\n\n\n<p>使用相应权限去操作<br>或者配置项为空</p>\n<p>beast.log_file =””</p>\n<p>sudo -u www  /bin/php  【具体命令】</p>\n","site":{"data":{}},"length":1277,"excerpt":"","more":"<h1 id=\"一、php-beast编译安装\"><a href=\"#一、php-beast编译安装\" class=\"headerlink\" title=\"一、php-beast编译安装\"></a>一、php-beast编译安装</h1><p>项目地址 【<a href=\"https://github.com/liexusong/php-beast%E3%80%91\">https://github.com/liexusong/php-beast】</a></p>\n<p>参考文档操作就可以了</p>\n<p>Ubuntu 22.04.2 LTS<br>gcc 11.4.0<br>成功</p>\n<p>centos 7.9<br>gcc 4.8.5<br>编译能成功</p>\n<p>运行报错</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PHP Warning:  PHP Startup: Unable to load dynamic library &#x27;/opt/remi/php71/root/usr/lib64/php/modules/beast.so&#x27;</span><br><span class=\"line\"> - /opt/remi/php71/root/usr/lib64/php/modules/beast.so: undefined symbol: rc_dtor_func in Unknown on line 0</span><br></pre></td></tr></table></figure>\n\n\n<p>待解决</p>\n<h1 id=\"二、具体加密操作\"><a href=\"#二、具体加密操作\" class=\"headerlink\" title=\"二、具体加密操作\"></a>二、具体加密操作</h1><h2 id=\"、2-1加密方案1\"><a href=\"#、2-1加密方案1\" class=\"headerlink\" title=\"、2.1加密方案1\"></a>、2.1加密方案1</h2><p>项目【<a href=\"https://github.com/liexusong/php-beast%E3%80%91%E7%9B%AE%E5%BD%95%E4%B8%8B%E6%9C%89/tools/configure.ini\">https://github.com/liexusong/php-beast】目录下有/tools/configure.ini</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">; source path</span><br><span class=\"line\">src_path = &quot;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">; destination path</span><br><span class=\"line\">dst_path = &quot;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">; expire time</span><br><span class=\"line\">expire = &quot;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">; encrypt type (selection: DES, AES, BASE64)</span><br><span class=\"line\">encrypt_type = &quot;DES&quot;</span><br></pre></td></tr></table></figure>\n\n<p>修改完 configure.ini 文件后就可以使用命令 php encode_files.php 开始加密项目。</p>\n<h2 id=\"、2-2-加密方案2\"><a href=\"#、2-2-加密方案2\" class=\"headerlink\" title=\"、2.2 加密方案2\"></a>、2.2 加密方案2</h2><p>制定自己的php-beast</p>\n<ol>\n<li><p>使用 header.c 文件可以修改 php-beast 加密后的文件头结构，<br>  这样网上的解密软件就不能认识我们的加密文件，就不能进行解密，增加加密的安全性。</p>\n</li>\n<li><p>php-beast 提供只能在指定的机器上运行的功能<br>要使用此功能可以在 networkcards.c 文件添加能够运行机器的网卡号，例如：</p>\n</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">char *allow_networkcards[] = &#123;</span><br><span class=\"line\">\t&quot;fa:16:3e:08:88:01&quot;,</span><br><span class=\"line\">    NULL,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"三、beast-加密部署相关问题\"><a href=\"#三、beast-加密部署相关问题\" class=\"headerlink\" title=\"三、beast 加密部署相关问题\"></a>三、beast 加密部署相关问题</h1><h2 id=\"3-1-laravel项目加密部署问题\"><a href=\"#3-1-laravel项目加密部署问题\" class=\"headerlink\" title=\"3.1 laravel项目加密部署问题\"></a>3.1 laravel项目加密部署问题</h2><p>加密laravel 模板文件是不无法使用的  会显示<code>&#123;&#123;&#125;&#125;</code></p>\n<p>建议加密 app文件夹下 所有文件就可以了</p>\n<h2 id=\"3-2-php配置库问题\"><a href=\"#3-2-php配置库问题\" class=\"headerlink\" title=\"3.2 php配置库问题\"></a>3.2 php配置库问题</h2><p>使用remi库安装的php </p>\n<p>fpm cli 配置扩展分2个文件夹 建议软链接解决，不然需要分别配置</p>\n<p>/etc/php/7.1/fpm/conf.d/</p>\n<p>/etc/php/7.1/cli/conf.d/</p>\n<h2 id=\"3-3-日志报错\"><a href=\"#3-3-日志报错\" class=\"headerlink\" title=\"3.3 日志报错\"></a>3.3 日志报错</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PHP Fatal error:  PHP Startup: Unable open log file for beast in Unknown on line 0</span><br><span class=\"line\">PHP Fatal error:  Unable to start beast module in Unknown on line 0</span><br></pre></td></tr></table></figure>\n\n\n<p>使用相应权限去操作<br>或者配置项为空</p>\n<p>beast.log_file =””</p>\n<p>sudo -u www  /bin/php  【具体命令】</p>\n"},{"title":"java开发-配置idea运行银行包","abbrlink":"9a132a59","date":"2025-02-27T01:05:43.000Z","_content":"# 一、项目目录\n![lena](../pic/javaee-running-1.png)\n\n# 二、设置项\n![lena](../pic/javaee-running-2.png)\n\n# 三、配置包相关信息\n![lena](../pic/javaee-running-3.png)\n\n# 四、配置用到的库（jar包）\n![lena](../pic/javaee-running-4.png)","source":"_posts/java开发-idea配置运行银行包.md","raw":"---\ntitle: java开发-配置idea运行银行包\nabbrlink: 9a132a59\ndate: 2025-02-27 09:05:43\ntags:\n---\n# 一、项目目录\n![lena](../pic/javaee-running-1.png)\n\n# 二、设置项\n![lena](../pic/javaee-running-2.png)\n\n# 三、配置包相关信息\n![lena](../pic/javaee-running-3.png)\n\n# 四、配置用到的库（jar包）\n![lena](../pic/javaee-running-4.png)","slug":"java开发-idea配置运行银行包","published":1,"updated":"2025-02-27T01:55:50.863Z","_id":"cm7moqo4k0000owochhhm08jp","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、项目目录\"><a href=\"#一、项目目录\" class=\"headerlink\" title=\"一、项目目录\"></a>一、项目目录</h1><p><img src=\"../pic/javaee-running-1.png\" alt=\"lena\"></p>\n<h1 id=\"二、设置项\"><a href=\"#二、设置项\" class=\"headerlink\" title=\"二、设置项\"></a>二、设置项</h1><p><img src=\"../pic/javaee-running-2.png\" alt=\"lena\"></p>\n<h1 id=\"三、配置包相关信息\"><a href=\"#三、配置包相关信息\" class=\"headerlink\" title=\"三、配置包相关信息\"></a>三、配置包相关信息</h1><p><img src=\"../pic/javaee-running-3.png\" alt=\"lena\"></p>\n<h1 id=\"四、配置用到的库（jar包）\"><a href=\"#四、配置用到的库（jar包）\" class=\"headerlink\" title=\"四、配置用到的库（jar包）\"></a>四、配置用到的库（jar包）</h1><p><img src=\"../pic/javaee-running-4.png\" alt=\"lena\"></p>\n","site":{"data":{}},"length":34,"excerpt":"","more":"<h1 id=\"一、项目目录\"><a href=\"#一、项目目录\" class=\"headerlink\" title=\"一、项目目录\"></a>一、项目目录</h1><p><img src=\"../pic/javaee-running-1.png\" alt=\"lena\"></p>\n<h1 id=\"二、设置项\"><a href=\"#二、设置项\" class=\"headerlink\" title=\"二、设置项\"></a>二、设置项</h1><p><img src=\"../pic/javaee-running-2.png\" alt=\"lena\"></p>\n<h1 id=\"三、配置包相关信息\"><a href=\"#三、配置包相关信息\" class=\"headerlink\" title=\"三、配置包相关信息\"></a>三、配置包相关信息</h1><p><img src=\"../pic/javaee-running-3.png\" alt=\"lena\"></p>\n<h1 id=\"四、配置用到的库（jar包）\"><a href=\"#四、配置用到的库（jar包）\" class=\"headerlink\" title=\"四、配置用到的库（jar包）\"></a>四、配置用到的库（jar包）</h1><p><img src=\"../pic/javaee-running-4.png\" alt=\"lena\"></p>\n"},{"title":"php开发-对接南京银行接口","abbrlink":"38689ecd","date":"2025-02-27T01:06:51.000Z","_content":"","source":"_posts/php开发-对接南京银行接口.md","raw":"---\ntitle: php开发-对接南京银行接口\nabbrlink: 38689ecd\ndate: 2025-02-27 09:06:51\ntags:\ncategories:\n  - PHP开发\n---\n","slug":"php开发-对接南京银行接口","published":1,"updated":"2025-04-22T03:48:27.752Z","_id":"cm7moqo4z0001owocezihaj6a","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"java开发-配置idea调试线上的程序","abbrlink":"4e8d42b6","date":"2025-02-27T02:01:02.000Z","_content":"![lena](../pic/java-remote-debug-1.png)\n\n![lena](../pic/java-remote-debug-2.png)\n\n![lena](../pic/java-remote-debug-3.png)\n\n![lena](../pic/java-remote-debug-4.png)","source":"_posts/java开发-配置idea调试线上的程序.md","raw":"---\ntitle: java开发-配置idea调试线上的程序\nabbrlink: 4e8d42b6\ndate: 2025-02-27 10:01:02\ntags:\n---\n![lena](../pic/java-remote-debug-1.png)\n\n![lena](../pic/java-remote-debug-2.png)\n\n![lena](../pic/java-remote-debug-3.png)\n\n![lena](../pic/java-remote-debug-4.png)","slug":"java开发-配置idea调试线上的程序","published":1,"updated":"2025-02-27T02:20:52.532Z","_id":"cm7mpwkcp0000mcoc1ndx5n26","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"../pic/java-remote-debug-1.png\" alt=\"lena\"></p>\n<p><img src=\"../pic/java-remote-debug-2.png\" alt=\"lena\"></p>\n<p><img src=\"../pic/java-remote-debug-3.png\" alt=\"lena\"></p>\n<p><img src=\"../pic/java-remote-debug-4.png\" alt=\"lena\"></p>\n","site":{"data":{}},"length":0,"excerpt":"","more":"<p><img src=\"../pic/java-remote-debug-1.png\" alt=\"lena\"></p>\n<p><img src=\"../pic/java-remote-debug-2.png\" alt=\"lena\"></p>\n<p><img src=\"../pic/java-remote-debug-3.png\" alt=\"lena\"></p>\n<p><img src=\"../pic/java-remote-debug-4.png\" alt=\"lena\"></p>\n"},{"title":"php开发-docker环境搭建","abbrlink":"f4cbc520","date":"2025-04-17T00:49:45.000Z","_content":"# 一、php环境搭建\n\n```dockerfile\nFROM php:7.4-fpm\nRUN apt-get update\nRUN apt-get  install -y  vim  libfreetype6-dev libjpeg64-turbo-dev libpng-dev\nRUN docker-php-ext-install -j$(nproc) iconv && docker-php-ext-configure gd --with-freetype-dir=/user/include/ --with-jpeg-dir=/usr/include/ &&  docker-php-ext-install -j$(nproc) gd\nRUN  docker-php-ext-configure pdo_mysql &&docker-php-ext-install pdo-mysql\nRUN pecl install swoole && pecl install redis-4.3.0\nRUN docker-php-ext-enable redis swoole\nRUN groupadd www && \\\nuseradd -g www -s /sbin/nologin www && \\\nusermod -u 8002 www && groupmod -g 8002 www\n\n```\n\n```bash\ndocker run  \\\n-v /docker/php/etc:/usr/local/etc \\\n-v /docker/nginx/www:/var/www/html  \\\n--privileged=true \\\n--restart=always \\\n--name php71 \\\n-d php71:1.3\n```\n\n\n\n\n# 二、nginx环境搭建\n\n```dockerfile\nFROM  nginx:1.24\nRUN groupadd www && \\\nuseradd -g www -s /sbin/nologin www && \\\nusermod -u 8002 www && groupmod -g 8002 www\n```\n\n\n```bash\ndocker run  -p 8088:8088 -v /docker/nginx/www:/usr/share/nginx/html  \\\n-v /docker/nginx/nginx.conf:/etc/nginx/nginx.conf  \\\n-v /docker/nginx/logs/:/var/log/nginx  \\\n-v /docker/nginx/conf.d:/etc/nginx/conf.d  \\\n--link php74 \\\n--privileged=true \\\n--restart=always \\\n--name nginx \\\n-d nginx:1.24\n```\n\n\n\n# 三、MySQL环境搭建","source":"_posts/php开发-docker环境.md","raw":"---\ntitle: php开发-docker环境搭建\nabbrlink: f4cbc520\ndate: 2025-04-17 08:49:45\ntags:\n---\n# 一、php环境搭建\n\n```dockerfile\nFROM php:7.4-fpm\nRUN apt-get update\nRUN apt-get  install -y  vim  libfreetype6-dev libjpeg64-turbo-dev libpng-dev\nRUN docker-php-ext-install -j$(nproc) iconv && docker-php-ext-configure gd --with-freetype-dir=/user/include/ --with-jpeg-dir=/usr/include/ &&  docker-php-ext-install -j$(nproc) gd\nRUN  docker-php-ext-configure pdo_mysql &&docker-php-ext-install pdo-mysql\nRUN pecl install swoole && pecl install redis-4.3.0\nRUN docker-php-ext-enable redis swoole\nRUN groupadd www && \\\nuseradd -g www -s /sbin/nologin www && \\\nusermod -u 8002 www && groupmod -g 8002 www\n\n```\n\n```bash\ndocker run  \\\n-v /docker/php/etc:/usr/local/etc \\\n-v /docker/nginx/www:/var/www/html  \\\n--privileged=true \\\n--restart=always \\\n--name php71 \\\n-d php71:1.3\n```\n\n\n\n\n# 二、nginx环境搭建\n\n```dockerfile\nFROM  nginx:1.24\nRUN groupadd www && \\\nuseradd -g www -s /sbin/nologin www && \\\nusermod -u 8002 www && groupmod -g 8002 www\n```\n\n\n```bash\ndocker run  -p 8088:8088 -v /docker/nginx/www:/usr/share/nginx/html  \\\n-v /docker/nginx/nginx.conf:/etc/nginx/nginx.conf  \\\n-v /docker/nginx/logs/:/var/log/nginx  \\\n-v /docker/nginx/conf.d:/etc/nginx/conf.d  \\\n--link php74 \\\n--privileged=true \\\n--restart=always \\\n--name nginx \\\n-d nginx:1.24\n```\n\n\n\n# 三、MySQL环境搭建","slug":"php开发-docker环境","published":1,"updated":"2025-04-17T02:02:25.478Z","_id":"cm9kptktk0000rsoc9qtx3cus","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、php环境搭建\"><a href=\"#一、php环境搭建\" class=\"headerlink\" title=\"一、php环境搭建\"></a>一、php环境搭建</h1><figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> php:<span class=\"number\">7.4</span>-fpm</span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> apt-get update</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> apt-get  install -y  vim  libfreetype6-dev libjpeg64-turbo-dev libpng-dev</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> docker-php-ext-install -j$(nproc) iconv &amp;&amp; docker-php-ext-configure gd --with-freetype-dir=/user/include/ --with-jpeg-dir=/usr/include/ &amp;&amp;  docker-php-ext-install -j$(nproc) gd</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\">  docker-php-ext-configure pdo_mysql &amp;&amp;docker-php-ext-install pdo-mysql</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> pecl install swoole &amp;&amp; pecl install redis-4.3.0</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> docker-php-ext-enable redis swoole</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> groupadd www &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"bash\">useradd -g www -s /sbin/nologin www &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"bash\">usermod -u 8002 www &amp;&amp; groupmod -g 8002 www</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run  \\</span><br><span class=\"line\">-v /docker/php/etc:/usr/<span class=\"built_in\">local</span>/etc \\</span><br><span class=\"line\">-v /docker/nginx/www:/var/www/html  \\</span><br><span class=\"line\">--privileged=<span class=\"literal\">true</span> \\</span><br><span class=\"line\">--restart=always \\</span><br><span class=\"line\">--name php71 \\</span><br><span class=\"line\">-d php71:1.3</span><br></pre></td></tr></table></figure>\n\n\n\n\n<h1 id=\"二、nginx环境搭建\"><a href=\"#二、nginx环境搭建\" class=\"headerlink\" title=\"二、nginx环境搭建\"></a>二、nginx环境搭建</h1><figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span>  nginx:<span class=\"number\">1.24</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> groupadd www &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"bash\">useradd -g www -s /sbin/nologin www &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"bash\">usermod -u 8002 www &amp;&amp; groupmod -g 8002 www</span></span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run  -p 8088:8088 -v /docker/nginx/www:/usr/share/nginx/html  \\</span><br><span class=\"line\">-v /docker/nginx/nginx.conf:/etc/nginx/nginx.conf  \\</span><br><span class=\"line\">-v /docker/nginx/logs/:/var/<span class=\"built_in\">log</span>/nginx  \\</span><br><span class=\"line\">-v /docker/nginx/conf.d:/etc/nginx/conf.d  \\</span><br><span class=\"line\">--link php74 \\</span><br><span class=\"line\">--privileged=<span class=\"literal\">true</span> \\</span><br><span class=\"line\">--restart=always \\</span><br><span class=\"line\">--name nginx \\</span><br><span class=\"line\">-d nginx:1.24</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"三、MySQL环境搭建\"><a href=\"#三、MySQL环境搭建\" class=\"headerlink\" title=\"三、MySQL环境搭建\"></a>三、MySQL环境搭建</h1>","site":{"data":{}},"length":1136,"excerpt":"","more":"<h1 id=\"一、php环境搭建\"><a href=\"#一、php环境搭建\" class=\"headerlink\" title=\"一、php环境搭建\"></a>一、php环境搭建</h1><figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> php:<span class=\"number\">7.4</span>-fpm</span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> apt-get update</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> apt-get  install -y  vim  libfreetype6-dev libjpeg64-turbo-dev libpng-dev</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> docker-php-ext-install -j$(nproc) iconv &amp;&amp; docker-php-ext-configure gd --with-freetype-dir=/user/include/ --with-jpeg-dir=/usr/include/ &amp;&amp;  docker-php-ext-install -j$(nproc) gd</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\">  docker-php-ext-configure pdo_mysql &amp;&amp;docker-php-ext-install pdo-mysql</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> pecl install swoole &amp;&amp; pecl install redis-4.3.0</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> docker-php-ext-enable redis swoole</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> groupadd www &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"bash\">useradd -g www -s /sbin/nologin www &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"bash\">usermod -u 8002 www &amp;&amp; groupmod -g 8002 www</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run  \\</span><br><span class=\"line\">-v /docker/php/etc:/usr/<span class=\"built_in\">local</span>/etc \\</span><br><span class=\"line\">-v /docker/nginx/www:/var/www/html  \\</span><br><span class=\"line\">--privileged=<span class=\"literal\">true</span> \\</span><br><span class=\"line\">--restart=always \\</span><br><span class=\"line\">--name php71 \\</span><br><span class=\"line\">-d php71:1.3</span><br></pre></td></tr></table></figure>\n\n\n\n\n<h1 id=\"二、nginx环境搭建\"><a href=\"#二、nginx环境搭建\" class=\"headerlink\" title=\"二、nginx环境搭建\"></a>二、nginx环境搭建</h1><figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span>  nginx:<span class=\"number\">1.24</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> groupadd www &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"bash\">useradd -g www -s /sbin/nologin www &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"bash\">usermod -u 8002 www &amp;&amp; groupmod -g 8002 www</span></span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run  -p 8088:8088 -v /docker/nginx/www:/usr/share/nginx/html  \\</span><br><span class=\"line\">-v /docker/nginx/nginx.conf:/etc/nginx/nginx.conf  \\</span><br><span class=\"line\">-v /docker/nginx/logs/:/var/<span class=\"built_in\">log</span>/nginx  \\</span><br><span class=\"line\">-v /docker/nginx/conf.d:/etc/nginx/conf.d  \\</span><br><span class=\"line\">--link php74 \\</span><br><span class=\"line\">--privileged=<span class=\"literal\">true</span> \\</span><br><span class=\"line\">--restart=always \\</span><br><span class=\"line\">--name nginx \\</span><br><span class=\"line\">-d nginx:1.24</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"三、MySQL环境搭建\"><a href=\"#三、MySQL环境搭建\" class=\"headerlink\" title=\"三、MySQL环境搭建\"></a>三、MySQL环境搭建</h1>"},{"title":"php开发-微信支付配置","abbrlink":"b1a60784","date":"2025-04-22T03:32:50.000Z","_content":"\n# 支付Api相关参数申请\n\n![lena](../pic/wx-pay-1.png)\n\n【账号中心】-》 【API安全】\n\n\n商户API证书  对应   privateKeyPath\n\n商户APIv2秘钥  对应 mchKey\n\n验证微信支付身份  可以不启用 ，若启用 需要修改请求方式  加入这个公钥\n\n平台证书\n\n解密回调-》APIv3秘钥     对应 apiV3Key\n\n\n ```bash\n pay:\n    mchId: 商户号\n    mchKey: 0E93E73BCFF80D67D676289957A9B274                        商户秘钥/商户APIv2秘钥\n    apiV3Key: 8D55C3D951565A8C6CF1792D37D0C445                      APIv3秘钥 \n    privateKeyPath: cert/apiclient_key.pem                          平台证书这边获取\n    publicKeyPath: cert/pub_key.pem                                 验证微信支付身份\n    publicKeyId: PUB_KEY_ID_0117104098032025031900389200002398      验证微信支付身份\n    merchantSerialNumber: 1D554C3725C800F4CE3F1544426F7100A3FD99DA  API证书的序列号\n\n```","source":"_posts/php开发-微信支付配置.md","raw":"---\ntitle: php开发-微信支付配置\ntags:\n  - 微信\ncategories:\n  - PHP开发\nabbrlink: b1a60784\ndate: 2025-04-22 11:32:50\n---\n\n# 支付Api相关参数申请\n\n![lena](../pic/wx-pay-1.png)\n\n【账号中心】-》 【API安全】\n\n\n商户API证书  对应   privateKeyPath\n\n商户APIv2秘钥  对应 mchKey\n\n验证微信支付身份  可以不启用 ，若启用 需要修改请求方式  加入这个公钥\n\n平台证书\n\n解密回调-》APIv3秘钥     对应 apiV3Key\n\n\n ```bash\n pay:\n    mchId: 商户号\n    mchKey: 0E93E73BCFF80D67D676289957A9B274                        商户秘钥/商户APIv2秘钥\n    apiV3Key: 8D55C3D951565A8C6CF1792D37D0C445                      APIv3秘钥 \n    privateKeyPath: cert/apiclient_key.pem                          平台证书这边获取\n    publicKeyPath: cert/pub_key.pem                                 验证微信支付身份\n    publicKeyId: PUB_KEY_ID_0117104098032025031900389200002398      验证微信支付身份\n    merchantSerialNumber: 1D554C3725C800F4CE3F1544426F7100A3FD99DA  API证书的序列号\n\n```","slug":"php开发-微信支付配置","published":1,"updated":"2025-04-22T05:52:10.134Z","_id":"cm9s38af90000vooc38gmgaaa","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"支付Api相关参数申请\"><a href=\"#支付Api相关参数申请\" class=\"headerlink\" title=\"支付Api相关参数申请\"></a>支付Api相关参数申请</h1><p><img src=\"../pic/wx-pay-1.png\" alt=\"lena\"></p>\n<p>【账号中心】-》 【API安全】</p>\n<p>商户API证书  对应   privateKeyPath</p>\n<p>商户APIv2秘钥  对应 mchKey</p>\n<p>验证微信支付身份  可以不启用 ，若启用 需要修改请求方式  加入这个公钥</p>\n<p>平台证书</p>\n<p>解密回调-》APIv3秘钥     对应 apiV3Key</p>\n <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pay:</span><br><span class=\"line\">   mchId: 商户号</span><br><span class=\"line\">   mchKey: 0E93E73BCFF80D67D676289957A9B274                        商户秘钥/商户APIv2秘钥</span><br><span class=\"line\">   apiV3Key: 8D55C3D951565A8C6CF1792D37D0C445                      APIv3秘钥 </span><br><span class=\"line\">   privateKeyPath: cert/apiclient_key.pem                          平台证书这边获取</span><br><span class=\"line\">   publicKeyPath: cert/pub_key.pem                                 验证微信支付身份</span><br><span class=\"line\">   publicKeyId: PUB_KEY_ID_0117104098032025031900389200002398      验证微信支付身份</span><br><span class=\"line\">   merchantSerialNumber: 1D554C3725C800F4CE3F1544426F7100A3FD99DA  API证书的序列号</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>","site":{"data":{}},"length":465,"excerpt":"","more":"<h1 id=\"支付Api相关参数申请\"><a href=\"#支付Api相关参数申请\" class=\"headerlink\" title=\"支付Api相关参数申请\"></a>支付Api相关参数申请</h1><p><img src=\"../pic/wx-pay-1.png\" alt=\"lena\"></p>\n<p>【账号中心】-》 【API安全】</p>\n<p>商户API证书  对应   privateKeyPath</p>\n<p>商户APIv2秘钥  对应 mchKey</p>\n<p>验证微信支付身份  可以不启用 ，若启用 需要修改请求方式  加入这个公钥</p>\n<p>平台证书</p>\n<p>解密回调-》APIv3秘钥     对应 apiV3Key</p>\n <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pay:</span><br><span class=\"line\">   mchId: 商户号</span><br><span class=\"line\">   mchKey: 0E93E73BCFF80D67D676289957A9B274                        商户秘钥/商户APIv2秘钥</span><br><span class=\"line\">   apiV3Key: 8D55C3D951565A8C6CF1792D37D0C445                      APIv3秘钥 </span><br><span class=\"line\">   privateKeyPath: cert/apiclient_key.pem                          平台证书这边获取</span><br><span class=\"line\">   publicKeyPath: cert/pub_key.pem                                 验证微信支付身份</span><br><span class=\"line\">   publicKeyId: PUB_KEY_ID_0117104098032025031900389200002398      验证微信支付身份</span><br><span class=\"line\">   merchantSerialNumber: 1D554C3725C800F4CE3F1544426F7100A3FD99DA  API证书的序列号</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>"},{"title":"linux-ntp时间服务","abbrlink":"dd9c94d0","date":"2025-06-11T01:02:52.000Z","_content":"# 相关常用命令\n    \n    timedatectl  #查看 当前 系统时间 时区 \n    \n    timedatectl set-time \"2025-06-11 09:02:52\" #设置时间\n\n    timedatectl set-timezone \"Asia/Shanghai\" \t\t##设定系统时区\n\n\n# chrony与ntp\n\n## 简介\n    chrony\n    chrony 是一个开源的 NTP 时间同步服务，\n    ntp 是一个开源的 NTP 时间同步服务，\n    ntp 服务是 chrony 的一个 fork 项目。\n    chrony 网络环境差，chrony 更适合\n\n\n## 安装chrony服务\n\n    yum install -y chrony       #redhat 系统\n    \n    apt-get install -y chrony   #ubuntu 系统\n\n    systemctl enable chronyd\n    systemctl status chronyd\n\n    配置文件  /etc/chrony.conf\n\n    配置文件添加ntp服务器地址\n```text\n    server ntp1.aliyun.com iburst\n    server ntp2.aliyun.com iburst\n```\n\n    chronyc sources   #查看同步源\n\n    chronyc -a makestep #立即手动同步\n\n\n\n\n##  安装ntp服务\n\n    yum -y install ntp  ntpdate\n\n    apt-get install -y chronyd\n\n    systemctl status ntp\n\n    sudo ntpdate -u ntp1.aliyun.com   #手动同步\n\n    配置文件\n    /etc/ntp.conf\n\n    显示 NTP 服务器和客户端的同步状态\n    ntpq -p ","source":"_posts/linux-ntp时间服务.md","raw":"---\ntitle: linux-ntp时间服务\ncategories:\n  - 服务器相关\ntags:\n  - linux\nabbrlink: dd9c94d0\ndate: 2025-06-11 09:02:52\n---\n# 相关常用命令\n    \n    timedatectl  #查看 当前 系统时间 时区 \n    \n    timedatectl set-time \"2025-06-11 09:02:52\" #设置时间\n\n    timedatectl set-timezone \"Asia/Shanghai\" \t\t##设定系统时区\n\n\n# chrony与ntp\n\n## 简介\n    chrony\n    chrony 是一个开源的 NTP 时间同步服务，\n    ntp 是一个开源的 NTP 时间同步服务，\n    ntp 服务是 chrony 的一个 fork 项目。\n    chrony 网络环境差，chrony 更适合\n\n\n## 安装chrony服务\n\n    yum install -y chrony       #redhat 系统\n    \n    apt-get install -y chrony   #ubuntu 系统\n\n    systemctl enable chronyd\n    systemctl status chronyd\n\n    配置文件  /etc/chrony.conf\n\n    配置文件添加ntp服务器地址\n```text\n    server ntp1.aliyun.com iburst\n    server ntp2.aliyun.com iburst\n```\n\n    chronyc sources   #查看同步源\n\n    chronyc -a makestep #立即手动同步\n\n\n\n\n##  安装ntp服务\n\n    yum -y install ntp  ntpdate\n\n    apt-get install -y chronyd\n\n    systemctl status ntp\n\n    sudo ntpdate -u ntp1.aliyun.com   #手动同步\n\n    配置文件\n    /etc/ntp.conf\n\n    显示 NTP 服务器和客户端的同步状态\n    ntpq -p ","slug":"linux-ntp时间服务","published":1,"updated":"2025-06-11T12:01:05.616Z","_id":"cmbrwe15t0000g4oc7ulwfo4g","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"相关常用命令\"><a href=\"#相关常用命令\" class=\"headerlink\" title=\"相关常用命令\"></a>相关常用命令</h1><pre><code>timedatectl  #查看 当前 系统时间 时区 \n\ntimedatectl set-time &quot;2025-06-11 09:02:52&quot; #设置时间\n\ntimedatectl set-timezone &quot;Asia/Shanghai&quot;         ##设定系统时区\n</code></pre>\n<h1 id=\"chrony与ntp\"><a href=\"#chrony与ntp\" class=\"headerlink\" title=\"chrony与ntp\"></a>chrony与ntp</h1><h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><pre><code>chrony\nchrony 是一个开源的 NTP 时间同步服务，\nntp 是一个开源的 NTP 时间同步服务，\nntp 服务是 chrony 的一个 fork 项目。\nchrony 网络环境差，chrony 更适合\n</code></pre>\n<h2 id=\"安装chrony服务\"><a href=\"#安装chrony服务\" class=\"headerlink\" title=\"安装chrony服务\"></a>安装chrony服务</h2><pre><code>yum install -y chrony       #redhat 系统\n\napt-get install -y chrony   #ubuntu 系统\n\nsystemctl enable chronyd\nsystemctl status chronyd\n\n配置文件  /etc/chrony.conf\n\n配置文件添加ntp服务器地址\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server ntp1.aliyun.com iburst</span><br><span class=\"line\">server ntp2.aliyun.com iburst</span><br></pre></td></tr></table></figure>\n\n<pre><code>chronyc sources   #查看同步源\n\nchronyc -a makestep #立即手动同步\n</code></pre>\n<h2 id=\"安装ntp服务\"><a href=\"#安装ntp服务\" class=\"headerlink\" title=\"安装ntp服务\"></a>安装ntp服务</h2><pre><code>yum -y install ntp  ntpdate\n\napt-get install -y chronyd\n\nsystemctl status ntp\n\nsudo ntpdate -u ntp1.aliyun.com   #手动同步\n\n配置文件\n/etc/ntp.conf\n\n显示 NTP 服务器和客户端的同步状态\nntpq -p \n</code></pre>\n","site":{"data":{}},"length":629,"excerpt":"","more":"<h1 id=\"相关常用命令\"><a href=\"#相关常用命令\" class=\"headerlink\" title=\"相关常用命令\"></a>相关常用命令</h1><pre><code>timedatectl  #查看 当前 系统时间 时区 \n\ntimedatectl set-time &quot;2025-06-11 09:02:52&quot; #设置时间\n\ntimedatectl set-timezone &quot;Asia/Shanghai&quot;         ##设定系统时区\n</code></pre>\n<h1 id=\"chrony与ntp\"><a href=\"#chrony与ntp\" class=\"headerlink\" title=\"chrony与ntp\"></a>chrony与ntp</h1><h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><pre><code>chrony\nchrony 是一个开源的 NTP 时间同步服务，\nntp 是一个开源的 NTP 时间同步服务，\nntp 服务是 chrony 的一个 fork 项目。\nchrony 网络环境差，chrony 更适合\n</code></pre>\n<h2 id=\"安装chrony服务\"><a href=\"#安装chrony服务\" class=\"headerlink\" title=\"安装chrony服务\"></a>安装chrony服务</h2><pre><code>yum install -y chrony       #redhat 系统\n\napt-get install -y chrony   #ubuntu 系统\n\nsystemctl enable chronyd\nsystemctl status chronyd\n\n配置文件  /etc/chrony.conf\n\n配置文件添加ntp服务器地址\n</code></pre>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server ntp1.aliyun.com iburst</span><br><span class=\"line\">server ntp2.aliyun.com iburst</span><br></pre></td></tr></table></figure>\n\n<pre><code>chronyc sources   #查看同步源\n\nchronyc -a makestep #立即手动同步\n</code></pre>\n<h2 id=\"安装ntp服务\"><a href=\"#安装ntp服务\" class=\"headerlink\" title=\"安装ntp服务\"></a>安装ntp服务</h2><pre><code>yum -y install ntp  ntpdate\n\napt-get install -y chronyd\n\nsystemctl status ntp\n\nsudo ntpdate -u ntp1.aliyun.com   #手动同步\n\n配置文件\n/etc/ntp.conf\n\n显示 NTP 服务器和客户端的同步状态\nntpq -p \n</code></pre>\n"},{"title":"php开发-单点登录sso","abbrlink":"65c877ca","date":"2025-07-08T01:08:19.000Z","_content":"","source":"_posts/php开发-单点登录sso.md","raw":"---\ntitle: php开发-单点登录sso\nabbrlink: 65c877ca\ndate: 2025-07-08 09:08:19\ntags:\n---\n","slug":"php开发-单点登录sso","published":1,"updated":"2025-08-12T02:55:45.284Z","_id":"cme7y8ttp0000w0ochdct1f97","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"内网部署-政务网","abbrlink":"cd152417","date":"2025-08-12T02:30:08.000Z","_content":"\n# 一、通过安装包的方式安装\n\n## 下载安装包\n   \n    本地有台与内网服务器一样的操作系统的外网服务器\n\n### redhat类系统\n    \n1.有外网的系统操作如下\n\n    yum install yum-utils -y\n\n    #--resolve 关键参数，自动解析并下载目标软件包（ffmpeg）的所有依赖包\n    #--destdir=/home/ffmpeg指定下载文件的存储目录\n\n    yumdownloader --resolve --destdir=/home/ffmpeg ffmpeg\n\n2.内网系统操作如下\n    拷贝安装包到内网服务器，如何目录下操作如下命令\n\n    rpm -Uvh --force --nodeps *.rpm  #--force --nodeps忽略依赖检查和版本冲突\n\n\n### ubuntu类系统\n\n1.有外网的系统操作如下\n\n    sudo apt search openjdk-8-jdk  #查询包\n\n    sudo apt-get install -d -o Dir::Cache::archives=\"/soft/mysqlc\" mysql-client\n\n2.内网系统操作如下\n    拷贝安装包到内网服务器，如何目录下操作如下命令:\n\n    sudo dpkg -i  /home/ffmpeg/*.deb\n\n    sudo apt-get install -f          # 自动修复依赖关系 有时候有问题 可不用\n\n## 示例操作命令\n\n安装java1.8\n\n    sudo apt update  #更新\n    sudo apt search openjdk-8-jdk  #查询包    \n    sudo apt-get install -d -o Dir::Cache::archives=\"/soft/java\" openjdk-8-jdk\n   \n    sudo dpkg -i  /home/java/*.deb\n    sudo apt-get install -f\n安装nginx\n\n    echo \"deb http://nginx.org/packages/mainline/ubuntu bionic nginx\" | sudo tee /etc/apt/sources.list.d/nginx.list\n    curl -fsSL https://nginx.org/keys/nginx_signing.key | sudo apt-key add -\n    sudo apt update\n    sudo apt-get install -d -o Dir::Cache::archives=\"/soft/nginx\" nginx\n    \n\n    sudo dpkg -i  /home/nginx/*.deb\n    sudo apt-get install -f\n\n# 二、通过docker方式安装\n\n# 三、通过源码的方式安装\n\n\n","source":"_posts/内网部署-政务网.md","raw":"---\ntitle: 内网部署-政务网\ncategories:\n  - 服务器相关\nabbrlink: cd152417\ndate: 2025-08-12 10:30:08\ntags:\n---\n\n# 一、通过安装包的方式安装\n\n## 下载安装包\n   \n    本地有台与内网服务器一样的操作系统的外网服务器\n\n### redhat类系统\n    \n1.有外网的系统操作如下\n\n    yum install yum-utils -y\n\n    #--resolve 关键参数，自动解析并下载目标软件包（ffmpeg）的所有依赖包\n    #--destdir=/home/ffmpeg指定下载文件的存储目录\n\n    yumdownloader --resolve --destdir=/home/ffmpeg ffmpeg\n\n2.内网系统操作如下\n    拷贝安装包到内网服务器，如何目录下操作如下命令\n\n    rpm -Uvh --force --nodeps *.rpm  #--force --nodeps忽略依赖检查和版本冲突\n\n\n### ubuntu类系统\n\n1.有外网的系统操作如下\n\n    sudo apt search openjdk-8-jdk  #查询包\n\n    sudo apt-get install -d -o Dir::Cache::archives=\"/soft/mysqlc\" mysql-client\n\n2.内网系统操作如下\n    拷贝安装包到内网服务器，如何目录下操作如下命令:\n\n    sudo dpkg -i  /home/ffmpeg/*.deb\n\n    sudo apt-get install -f          # 自动修复依赖关系 有时候有问题 可不用\n\n## 示例操作命令\n\n安装java1.8\n\n    sudo apt update  #更新\n    sudo apt search openjdk-8-jdk  #查询包    \n    sudo apt-get install -d -o Dir::Cache::archives=\"/soft/java\" openjdk-8-jdk\n   \n    sudo dpkg -i  /home/java/*.deb\n    sudo apt-get install -f\n安装nginx\n\n    echo \"deb http://nginx.org/packages/mainline/ubuntu bionic nginx\" | sudo tee /etc/apt/sources.list.d/nginx.list\n    curl -fsSL https://nginx.org/keys/nginx_signing.key | sudo apt-key add -\n    sudo apt update\n    sudo apt-get install -d -o Dir::Cache::archives=\"/soft/nginx\" nginx\n    \n\n    sudo dpkg -i  /home/nginx/*.deb\n    sudo apt-get install -f\n\n# 二、通过docker方式安装\n\n# 三、通过源码的方式安装\n\n\n","slug":"内网部署-政务网","published":1,"updated":"2025-08-12T03:05:55.097Z","_id":"cme7y8tts0001w0oc2k9hgj8q","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"一、通过安装包的方式安装\"><a href=\"#一、通过安装包的方式安装\" class=\"headerlink\" title=\"一、通过安装包的方式安装\"></a>一、通过安装包的方式安装</h1><h2 id=\"下载安装包\"><a href=\"#下载安装包\" class=\"headerlink\" title=\"下载安装包\"></a>下载安装包</h2><pre><code>本地有台与内网服务器一样的操作系统的外网服务器\n</code></pre>\n<h3 id=\"redhat类系统\"><a href=\"#redhat类系统\" class=\"headerlink\" title=\"redhat类系统\"></a>redhat类系统</h3><p>1.有外网的系统操作如下</p>\n<pre><code>yum install yum-utils -y\n\n#--resolve 关键参数，自动解析并下载目标软件包（ffmpeg）的所有依赖包\n#--destdir=/home/ffmpeg指定下载文件的存储目录\n\nyumdownloader --resolve --destdir=/home/ffmpeg ffmpeg\n</code></pre>\n<p>2.内网系统操作如下<br>    拷贝安装包到内网服务器，如何目录下操作如下命令</p>\n<pre><code>rpm -Uvh --force --nodeps *.rpm  #--force --nodeps忽略依赖检查和版本冲突\n</code></pre>\n<h3 id=\"ubuntu类系统\"><a href=\"#ubuntu类系统\" class=\"headerlink\" title=\"ubuntu类系统\"></a>ubuntu类系统</h3><p>1.有外网的系统操作如下</p>\n<pre><code>sudo apt search openjdk-8-jdk  #查询包\n\nsudo apt-get install -d -o Dir::Cache::archives=&quot;/soft/mysqlc&quot; mysql-client\n</code></pre>\n<p>2.内网系统操作如下<br>    拷贝安装包到内网服务器，如何目录下操作如下命令:</p>\n<pre><code>sudo dpkg -i  /home/ffmpeg/*.deb\n\nsudo apt-get install -f          # 自动修复依赖关系 有时候有问题 可不用\n</code></pre>\n<h2 id=\"示例操作命令\"><a href=\"#示例操作命令\" class=\"headerlink\" title=\"示例操作命令\"></a>示例操作命令</h2><p>安装java1.8</p>\n<pre><code>sudo apt update  #更新\nsudo apt search openjdk-8-jdk  #查询包    \nsudo apt-get install -d -o Dir::Cache::archives=&quot;/soft/java&quot; openjdk-8-jdk\n\nsudo dpkg -i  /home/java/*.deb\nsudo apt-get install -f\n</code></pre>\n<p>安装nginx</p>\n<pre><code>echo &quot;deb http://nginx.org/packages/mainline/ubuntu bionic nginx&quot; | sudo tee /etc/apt/sources.list.d/nginx.list\ncurl -fsSL https://nginx.org/keys/nginx_signing.key | sudo apt-key add -\nsudo apt update\nsudo apt-get install -d -o Dir::Cache::archives=&quot;/soft/nginx&quot; nginx\n\n\nsudo dpkg -i  /home/nginx/*.deb\nsudo apt-get install -f\n</code></pre>\n<h1 id=\"二、通过docker方式安装\"><a href=\"#二、通过docker方式安装\" class=\"headerlink\" title=\"二、通过docker方式安装\"></a>二、通过docker方式安装</h1><h1 id=\"三、通过源码的方式安装\"><a href=\"#三、通过源码的方式安装\" class=\"headerlink\" title=\"三、通过源码的方式安装\"></a>三、通过源码的方式安装</h1>","site":{"data":{}},"length":1050,"excerpt":"","more":"<h1 id=\"一、通过安装包的方式安装\"><a href=\"#一、通过安装包的方式安装\" class=\"headerlink\" title=\"一、通过安装包的方式安装\"></a>一、通过安装包的方式安装</h1><h2 id=\"下载安装包\"><a href=\"#下载安装包\" class=\"headerlink\" title=\"下载安装包\"></a>下载安装包</h2><pre><code>本地有台与内网服务器一样的操作系统的外网服务器\n</code></pre>\n<h3 id=\"redhat类系统\"><a href=\"#redhat类系统\" class=\"headerlink\" title=\"redhat类系统\"></a>redhat类系统</h3><p>1.有外网的系统操作如下</p>\n<pre><code>yum install yum-utils -y\n\n#--resolve 关键参数，自动解析并下载目标软件包（ffmpeg）的所有依赖包\n#--destdir=/home/ffmpeg指定下载文件的存储目录\n\nyumdownloader --resolve --destdir=/home/ffmpeg ffmpeg\n</code></pre>\n<p>2.内网系统操作如下<br>    拷贝安装包到内网服务器，如何目录下操作如下命令</p>\n<pre><code>rpm -Uvh --force --nodeps *.rpm  #--force --nodeps忽略依赖检查和版本冲突\n</code></pre>\n<h3 id=\"ubuntu类系统\"><a href=\"#ubuntu类系统\" class=\"headerlink\" title=\"ubuntu类系统\"></a>ubuntu类系统</h3><p>1.有外网的系统操作如下</p>\n<pre><code>sudo apt search openjdk-8-jdk  #查询包\n\nsudo apt-get install -d -o Dir::Cache::archives=&quot;/soft/mysqlc&quot; mysql-client\n</code></pre>\n<p>2.内网系统操作如下<br>    拷贝安装包到内网服务器，如何目录下操作如下命令:</p>\n<pre><code>sudo dpkg -i  /home/ffmpeg/*.deb\n\nsudo apt-get install -f          # 自动修复依赖关系 有时候有问题 可不用\n</code></pre>\n<h2 id=\"示例操作命令\"><a href=\"#示例操作命令\" class=\"headerlink\" title=\"示例操作命令\"></a>示例操作命令</h2><p>安装java1.8</p>\n<pre><code>sudo apt update  #更新\nsudo apt search openjdk-8-jdk  #查询包    \nsudo apt-get install -d -o Dir::Cache::archives=&quot;/soft/java&quot; openjdk-8-jdk\n\nsudo dpkg -i  /home/java/*.deb\nsudo apt-get install -f\n</code></pre>\n<p>安装nginx</p>\n<pre><code>echo &quot;deb http://nginx.org/packages/mainline/ubuntu bionic nginx&quot; | sudo tee /etc/apt/sources.list.d/nginx.list\ncurl -fsSL https://nginx.org/keys/nginx_signing.key | sudo apt-key add -\nsudo apt update\nsudo apt-get install -d -o Dir::Cache::archives=&quot;/soft/nginx&quot; nginx\n\n\nsudo dpkg -i  /home/nginx/*.deb\nsudo apt-get install -f\n</code></pre>\n<h1 id=\"二、通过docker方式安装\"><a href=\"#二、通过docker方式安装\" class=\"headerlink\" title=\"二、通过docker方式安装\"></a>二、通过docker方式安装</h1><h1 id=\"三、通过源码的方式安装\"><a href=\"#三、通过源码的方式安装\" class=\"headerlink\" title=\"三、通过源码的方式安装\"></a>三、通过源码的方式安装</h1>"}],"PostAsset":[],"PostCategory":[{"post_id":"clxb4gv42000cpcocc1rs1kk1","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv47000hpcocgwaj07fr"},{"post_id":"clxb4gv3y0008pcoc73so0mtm","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv48000kpcocegd906bw"},{"post_id":"clxb4gv43000dpcoc5gvta9vl","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv49000mpcoc0xyy2rfb"},{"post_id":"clxb4gv3y0009pcoc56xqaxqv","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv49000ppcoc0k2g90sb"},{"post_id":"clxb4gv48000jpcochqgketk1","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv4a000tpcocahcibe4k"},{"post_id":"clxb4gv40000bpcocdm0mgs9x","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv4b000wpcocd17v1x6j"},{"post_id":"clxb4gv4a000spcoc6myrbkg4","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv4d0013pcoc5nko6oxh"},{"post_id":"clxb4gv4c000zpcoc85zk0742","category_id":"clxb4gv4d0014pcoc61746nsw","_id":"clxb4gv4h001apcoc3jq8f42e"},{"post_id":"clxb4gv4g0018pcoc70d6063s","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv4i001dpcoc9p2t3hyw"},{"post_id":"clxb4gv4o001mpcoc5wczb1wu","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv4q001tpcoc98pu2a9d"},{"post_id":"clxb4gv4r001wpcoc1dxvbp8f","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv4t0024pcochdwocgq9"},{"post_id":"clxb4gv4s0020pcocca1600da","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"clxb4gv4w002apcoc49v69ohs"},{"post_id":"clxb4gv4t0023pcoc1m6rbqat","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"clxb4gv4w002dpcochoaiajjz"},{"post_id":"clxb4gv4w002cpcoc24220y0c","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"clxb4gv4x002lpcocbg4vbbfd"},{"post_id":"clxb4gv4w002fpcoc7ammdg8y","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"clxb4gv4y002npcochw1c8fx5"},{"post_id":"clxb4gv51002vpcoch6qre4qt","category_id":"clxb4gv4d0014pcoc61746nsw","_id":"clxb4gv550030pcoca5nk9i8k"},{"post_id":"clxb4gv55002zpcocdr80875l","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv570035pcoce6u02u32"},{"post_id":"clxb4gv550031pcoch82reip5","category_id":"clxb4gv4d0014pcoc61746nsw","_id":"clxb4gv580037pcocavk2gysr"},{"post_id":"clxb4gv59003apcoc7yzreos2","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv5a003fpcocgwqx5s1n"},{"post_id":"clxb4gv5a003cpcocb12d3xus","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv5c003ipcoc9j0ad66g"},{"post_id":"clxb4gv5h003opcocdhl9dnff","category_id":"clxb4gv5f003lpcocdvs5co5p","_id":"clxb4gv5j003upcoc42sc61l9"},{"post_id":"clxb4gv5c003jpcoc5og807bd","category_id":"clxb4gv5f003lpcocdvs5co5p","_id":"clxb4gv5l003wpcocfijn703r"},{"post_id":"clxb4gv5i003rpcocg7l8bnz1","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"clxb4gv5l003ypcoc9zukeq7n"},{"post_id":"clxsm9q1u000110oc790icdbb","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"clxsm9q1x000810oc96gd2xz4"},{"post_id":"clxsm9q1v000210oc566badl8","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"clxsm9q1y000a10ocdtya1f5l"},{"post_id":"clxsm9q1w000410oc5nkh9q4s","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"clxsm9q1y000c10oc4yangt3b"},{"post_id":"clxsm9q1w000710ocdcguazm2","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"clxsm9q1y000d10oc7vz99ouc"},{"post_id":"clxys1z570000s4b1h6w34t8n","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"clxys1z6p0002s4b1eo2g1n5z"},{"post_id":"clzl9c9dk000018oc7ivk5sap","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"clzl9c9dl000118occtjvfs00"},{"post_id":"clzqfyf10000148oc75bj7qhp","category_id":"clxb4gv4d0014pcoc61746nsw","_id":"clzqfyf15000348oc98vc1839"},{"post_id":"cm04ukh5p00004koccz7dd3ie","category_id":"clxb4gv55002ypcoc8cwd78j0","_id":"cm04ukh6e00044kocb41h8xxf"},{"post_id":"cm04ukh6g00074koc74dt6708","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm04ukh6o000b4koc7c6w5i86"},{"post_id":"cm04ukh6i00094kocemjuhft4","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm04ukh6s000e4koc8v0v8nyz"},{"post_id":"cm04ukh6k000a4koc9jwc4lbn","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm04ukh6w000g4koc2ytqdo06"},{"post_id":"cm04ukh6u000f4koc2rmk1l3c","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm04ukh73000k4koc4gpe4g4x"},{"post_id":"cm04ukh75000m4koc843e81sv","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm04ukh7b000q4kocbajzhccm"},{"post_id":"cm04ukh76000n4koce89503wu","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm04ukh7c000s4koc5jvc12ff"},{"post_id":"cm04ukh7j000y4koccp0k7ius","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm04ukh7q00124koc3i6tdm4q"},{"post_id":"cm04ukh7k000z4koc8u759m42","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm04ukh7y00154koc11cb64hz"},{"post_id":"cm04ukh7l00104kocanb61nce","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm04ukh8600164kocbkdf2yy1"},{"post_id":"cm04ukh7m00114koc47tredb9","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm04ukh8700184kocgm1i5tno"},{"post_id":"cm04ukh8600174kocdmavcyhv","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm04ukh8d001d4kocbovs53f5"},{"post_id":"cm04ukh89001b4koc97f8eyte","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm04ukh8j001h4koc9caqcb9m"},{"post_id":"cm04ukh8d001f4kocfv9t2vf2","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm04ukh8k001j4kocg2d2hmfs"},{"post_id":"cm2ebjhln0000dkoc9wupe6t9","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm2ebjhlr0001dkocelfl8z8x"},{"post_id":"cm2ebdhy800003coc44d2gzio","category_id":"cm2ebk5cj0003dkocbmus9fpa","_id":"cm2ebk5ck0004dkocg0zzewaf"},{"post_id":"cm0m7pmpu0000vwoc7trh84he","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm2ebkgzb0005dkoc3qar9jf8"},{"post_id":"cm04ukh7t00144koc1h5oh3nb","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm2ebrapy00098ooc47lfaov3"},{"post_id":"cm2ebsd2l00008socdx5qc3po","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm2ebsjrb00028socg7e2bxv6"},{"post_id":"cm3wx34t90000ywoce0rt8ufj","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxnymv000mqcocgabkaczb"},{"post_id":"cm3wxlnzr0002qcoc7387g7a9","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxp9y10000q4oc53bq2n4t"},{"post_id":"cm3wxm6ah0005qcocgv083rvy","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxpiam0001q4oc7jiicp0f"},{"post_id":"clxb4gv4d0012pcocbmuo9icl","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxppj30002q4oc3mvgcdda"},{"post_id":"cm3wxpwnp0003q4ocbhtrbuca","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxpwnq0005q4oc8p5j8mdn"},{"post_id":"cm3wxqnd10008q4ocdb4yfgwl","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxqnd3000aq4occvrbgjfg"},{"post_id":"cm04ukh74000l4koc6ui687e3","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxr018000dq4ocakdl7rq0"},{"post_id":"cm04ukh6z000i4koc2gs4gses","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxr992000eq4ocf6q02fly"},{"post_id":"cm04ukh70000j4koce5ttfen8","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxrcpb000fq4oc3ezr4rxz"},{"post_id":"cm04ukh79000o4kocfq86h4l5","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxrpc6000gq4oc24feax56"},{"post_id":"cm04ukh7c000r4koc0aht3pqb","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxrwky000hq4ocdqxx02e3"},{"post_id":"cm04ukh7f000u4koc3hvt3qa6","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxs5m5000iq4occ4ci2v1l"},{"post_id":"cm3wxd2km0001ywocdipc8v2c","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxsdjk000jq4ochoyne487"},{"post_id":"clyye6e9g0000f0ocb5b5heao","category_id":"cm3wxt649000lq4oc4dwr1ah1","_id":"cm3wxt64a000mq4ocfkkidcsq"},{"post_id":"cm04ukh7j000y4koccp0k7ius","category_id":"cm3wxv4ey000pq4oc25944hem","_id":"cm3wxv4ey000qq4ocbdykhqw2"},{"post_id":"cm04ukh7k000z4koc8u759m42","category_id":"cm3wxv4ey000pq4oc25944hem","_id":"cm3wxvbc9000rq4ocha0rho7k"},{"post_id":"cm3wxvju7000sq4ocf9qx4os1","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxvju8000tq4och3om6i2x"},{"post_id":"cm3wxvju7000sq4ocf9qx4os1","category_id":"cm3wxv4ey000pq4oc25944hem","_id":"cm3wxvju8000uq4oc457z8dfy"},{"post_id":"cm04ukh7m00114koc47tredb9","category_id":"cm3wxv4ey000pq4oc25944hem","_id":"cm3wxw3i8000vq4ocea2w8esr"},{"post_id":"clxb4gv4o001mpcoc5wczb1wu","category_id":"cm3wxxb0x000wq4oc09u0db3q","_id":"cm3wxxb0y000xq4ocb5pzbp8z"},{"post_id":"cm04ukh6o000c4koc4axigsam","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm3wxyre8000zq4ocb7dwhnel"},{"post_id":"cm3wxzq050011q4oc9nro2i81","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wxzq080014q4oc8ohkhn65"},{"post_id":"cm3wxzq050011q4oc9nro2i81","category_id":"cm3wxzq070013q4oc4cc8f3av","_id":"cm3wxzq080015q4oce1jvfiy8"},{"post_id":"cm3wxd2km0001ywocdipc8v2c","category_id":"cm3wy0qk60016q4oce4dobbvx","_id":"cm3wy0qk70017q4ocg0341mdt"},{"post_id":"clxb4gv5i003ppcocezx48n1z","category_id":"cm3wxt649000lq4oc4dwr1ah1","_id":"cm3wy4b8q0019q4ocfsq1cdgq"},{"post_id":"clxb4gv51002vpcoch6qre4qt","category_id":"cm3wy4vbr001aq4ocbyqz3qjv","_id":"cm3wy6bkb001cq4ocgbzv586q"},{"post_id":"clxb4gv550031pcoch82reip5","category_id":"cm3wy6qz3001fq4ocgc0pblrd","_id":"cm3wy6qz3001gq4ocg6sy4re0"},{"post_id":"cm3wy7gko001hq4oc9bfu4h1y","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wy7gkp001jq4occhqx34ku"},{"post_id":"clxb4gv59003apcoc7yzreos2","category_id":"cm3wy7mfg001lq4oc4w0gaa4w","_id":"cm3wy7mfh001mq4oc1k9v0ih2"},{"post_id":"cm3wy7gko001hq4oc9bfu4h1y","category_id":"cm3wy7mfg001lq4oc4w0gaa4w","_id":"cm3wy7oz9001nq4oc0lti0yr5"},{"post_id":"clxb4gv5k003vpcoc8iyda74i","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wy8aoz001oq4ocgg5yclzo"},{"post_id":"cm04ukh8j001i4kocevcwce6m","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wy8q0f001rq4oc5rxg9750"},{"post_id":"cm04ukh8j001i4kocevcwce6m","category_id":"cm3wy8sy3001sq4oc02qad1cr","_id":"cm3wy8sy4001tq4ocf5mb3yk8"},{"post_id":"cm04ukh8f001g4koc53zp7el2","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wy8zpl001uq4oc19f88viq"},{"post_id":"cm04ukh8f001g4koc53zp7el2","category_id":"cm3wy8sy3001sq4oc02qad1cr","_id":"cm3wy8zpm001vq4ocbzfwb1gd"},{"post_id":"cm04ukh8b001c4koc50469x8h","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm3wya9ev0021q4oce2wdautg"},{"post_id":"clzwc5gob0003nkocez9xcsop","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm3wyabmd0022q4ocaxcxb2j3"},{"post_id":"clxb4gv4x002hpcocdyk89f1i","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm3wyadzx0023q4oc6rfzha6b"},{"post_id":"cly77ll0b00005kocczqi3ftg","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm3wyagzg0024q4ocezvhfj7n"},{"post_id":"clxb4gv4x002kpcoc4sc38ix6","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm3wyajco0025q4ocf2ci8r9w"},{"post_id":"clzwc5go90001nkoc4n00c7l5","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm3wyalis0026q4ocfnw4fexf"},{"post_id":"clzwdjjq900003cocbmc053hx","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm3wyaqct0027q4oc5a8m0k0i"},{"post_id":"cm0m7pmq00001vwoc4pbo4n61","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm3wyasor0028q4ochu9deueq"},{"post_id":"clzwc5go60000nkocc2k52xpv","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm3wyavc20029q4oc9ire4c0j"},{"post_id":"cm3wyb3nc002aq4oc8b0ta5k0","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm3wyb3nd002cq4ocbd5ghx0f"},{"post_id":"cm04ukh8800194kocg1dx4u04","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm3wybgtg002dq4oc39hx5kuw"},{"post_id":"clxys3eci0000ubb18aijcc5m","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm3wyfbor0001bwoc6lpk9iwy"},{"post_id":"cm49jgcx30000eooc6ppf96v1","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cm49jgcx70001eoocd85s522a"},{"post_id":"cm7moqo4z0001owocezihaj6a","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm9s38afp0002vooc0khi60no"},{"post_id":"cm9s38af90000vooc38gmgaaa","category_id":"clxb4gv49000npcoc2ms19ohq","_id":"cm9s38afp0003vooc2jj38asn"},{"post_id":"cmbrwe15t0000g4oc7ulwfo4g","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cmbrwe15w0002g4ochspa7sqr"},{"post_id":"cme7y8tts0001w0oc2k9hgj8q","category_id":"clxb4gv3z000apcocgi5a3x1i","_id":"cme7y8ttt0002w0oc8g9n5x4g"}],"PostTag":[{"post_id":"clxb4gv4t0023pcoc1m6rbqat","tag_id":"clxb4gv4b000upcoc7r648i0s","_id":"clxb4gv4v0028pcoch1ke7vto"},{"post_id":"clxb4gv4w002fpcoc7ammdg8y","tag_id":"clxb4gv4b000upcoc7r648i0s","_id":"clxb4gv4x002jpcoc4d741fez"},{"post_id":"clxsm9q1u000110oc790icdbb","tag_id":"clxb4gv4b000upcoc7r648i0s","_id":"clxsm9q1w000310occ5uc1qgt"},{"post_id":"clxsm9q1w000410oc5nkh9q4s","tag_id":"clxb4gv4b000upcoc7r648i0s","_id":"clxsm9q1x000910oceu3j6nfi"},{"post_id":"clxsm9q1w000710ocdcguazm2","tag_id":"clxb4gv4b000upcoc7r648i0s","_id":"clxsm9q1y000b10ocee2v636s"},{"post_id":"clxb4gv4s0020pcocca1600da","tag_id":"clxys1z6s0007s4b18ix57laf","_id":"clxys1z6t0009s4b164q11vzi"},{"post_id":"clyye6e9g0000f0ocb5b5heao","tag_id":"clxys1z6s0007s4b18ix57laf","_id":"clyz8mh8900003koce6vlgo6n"},{"post_id":"cm04ukh7l00104kocanb61nce","tag_id":"clxb4gv4b000upcoc7r648i0s","_id":"cm04ukh7t00134kochddee2tq"},{"post_id":"cm04ukh8600174kocdmavcyhv","tag_id":"clxys1z6p0003s4b15xi8em2d","_id":"cm04ukh89001a4koc47b0cmd2"},{"post_id":"cm04ukh89001b4koc97f8eyte","tag_id":"clxys1z6p0003s4b15xi8em2d","_id":"cm04ukh8d001e4kocd9e10h9d"},{"post_id":"clzl9c9dk000018oc7ivk5sap","tag_id":"clxys1z680001s4b13wn70h36","_id":"cm2ebqnrf00008ooc0znqcgfm"},{"post_id":"cm0m7pmpu0000vwoc7trh84he","tag_id":"cm2ebqs8t00018ooc1wsvey1b","_id":"cm2ebqs8t00028oocg3sz3z5m"},{"post_id":"clxys1z570000s4b1h6w34t8n","tag_id":"clxys1z680001s4b13wn70h36","_id":"cm2ebqyw600038oocbcashve7"},{"post_id":"clzl9bjix0000cwoc3o8phlov","tag_id":"clxys1z680001s4b13wn70h36","_id":"cm2ebr2fz00048ooc8nuhct22"},{"post_id":"cm2ebr4vw00058ooc35wrhcqh","tag_id":"clxys1z680001s4b13wn70h36","_id":"cm2ebr4vx00068oocdhgg8tek"},{"post_id":"clzqfyf10000148oc75bj7qhp","tag_id":"clxys1z680001s4b13wn70h36","_id":"cm2ebr7qc00078ooca38qf0af"},{"post_id":"cm04ukh7t00144koc1h5oh3nb","tag_id":"clxys1z6p0003s4b15xi8em2d","_id":"cm2ebrapy00088oocaqx50ho2"},{"post_id":"cm2ebsd2l00008socdx5qc3po","tag_id":"clxys1z680001s4b13wn70h36","_id":"cm2ebsd2n00018soc69sddv76"},{"post_id":"cm3wxd2km0001ywocdipc8v2c","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxd2ko0003ywochx601bjy"},{"post_id":"cm04ukh7f000u4koc3hvt3qa6","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxd7q00004ywocgpft8nvq"},{"post_id":"cm04ukh7d000t4koc2xgy7u4z","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxdbx40005ywocghlx5moz"},{"post_id":"cm04ukh7c000r4koc0aht3pqb","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxdfpg0006ywoc19wd1qbr"},{"post_id":"cm04ukh76000n4koce89503wu","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxdkei0007ywocbpt82g6o"},{"post_id":"cm04ukh79000o4kocfq86h4l5","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxdpte0008ywoc8dxs2lyc"},{"post_id":"cm3wxlnzr0002qcoc7387g7a9","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxlnzr0003qcoc41n76fgi"},{"post_id":"cm04ukh6g00074koc74dt6708","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxlu0z0004qcoceten34ik"},{"post_id":"cm3wxm6ah0005qcocgv083rvy","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxm6ai0006qcoc8rdp2x3t"},{"post_id":"clxb4gv4d0012pcocbmuo9icl","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxm95e0007qcocdbjugs3u"},{"post_id":"cm04ukh6i00094kocemjuhft4","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxmcml0008qcoc3ea85umr"},{"post_id":"cm04ukh6k000a4koc9jwc4lbn","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxmigt000aqcocavxzgdsm"},{"post_id":"cm04ukh6o000c4koc4axigsam","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxmmaj000bqcoc0l82cbop"},{"post_id":"cm04ukh6u000f4koc2rmk1l3c","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxmq0s000cqcocd0xx2ebi"},{"post_id":"cm04ukh74000l4koc6ui687e3","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxmvxd000eqcoc95zlblgc"},{"post_id":"cm04ukh6z000i4koc2gs4gses","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxmyfe000fqcoc3o18f3ok"},{"post_id":"cm04ukh70000j4koce5ttfen8","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxn41m000gqcocacrg7md8"},{"post_id":"cm04ukh75000m4koc843e81sv","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxn8az000hqcocbcl3a9we"},{"post_id":"cm3wx34t90000ywoce0rt8ufj","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxnhay000lqcocfgod6wa1"},{"post_id":"cm3wxpwnp0003q4ocbhtrbuca","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxpwnq0004q4ocexx43rtf"},{"post_id":"cm3wxqnd10008q4ocdb4yfgwl","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxqnd4000bq4ocgd8wgbp5"},{"post_id":"cm3wxqnd10008q4ocdb4yfgwl","tag_id":"cm3wxqnd20009q4oc4qnwewga","_id":"cm3wxqnd4000cq4oc75k6047q"},{"post_id":"cm04ukh7h000x4kocax7a0sja","tag_id":"clxys1z6s0007s4b18ix57laf","_id":"cm3wxszd2000kq4oc1zm08gnr"},{"post_id":"cm3wxzq050011q4oc9nro2i81","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cm3wxzq070012q4ocfrv2hurs"},{"post_id":"cm3wxzq050011q4oc9nro2i81","tag_id":"clxys1z6s0007s4b18ix57laf","_id":"cm3wy1v3i0018q4ocgke92hvz"},{"post_id":"clxb4gv51002vpcoch6qre4qt","tag_id":"cm3wy6fnk001dq4oc1soof6tj","_id":"cm3wy6fnl001eq4oca8g0eo7b"},{"post_id":"clxb4gv5k003vpcoc8iyda74i","tag_id":"cm3wy8g1i001pq4ocd7iz3mdn","_id":"cm3wy8g1i001qq4oc8fc5etw1"},{"post_id":"clxb4gv4y002opcoc3xet5y4t","tag_id":"cm3wy9er9001wq4oc8ywcdha6","_id":"cm3wy9er9001xq4ocbzm894oz"},{"post_id":"clxb4gv4y002ppcoc8s5e2l6o","tag_id":"cm3wy9er9001wq4oc8ywcdha6","_id":"cm3wy9jjx001yq4ocdvp1f9tp"},{"post_id":"clxsm9q1v000210oc566badl8","tag_id":"cm3wya4zv001zq4oc7j2v5dk9","_id":"cm3wya4zw0020q4ocbbd52jfx"},{"post_id":"cm3wyb3nc002aq4oc8b0ta5k0","tag_id":"cm2ebn9qb0006dkoc25p8h8e9","_id":"cm3wyb3nd002bq4ocae6eazym"},{"post_id":"clxys3eci0000ubb18aijcc5m","tag_id":"cm3wyfboe0000bwoc2w1w15e3","_id":"cm3wyfbor0002bwocblwhaeap"},{"post_id":"clxb4gv4f0017pcocdu3x9s3l","tag_id":"cm49k1odf0002eoocf3fwfftc","_id":"cm49k1odg0003eoocfr6xdh6e"},{"post_id":"cm9s38af90000vooc38gmgaaa","tag_id":"cm9s38afe0001vooca2em98w0","_id":"cm9s38afs0005voocgvjrhlwo"},{"post_id":"clxb4gv4x002kpcoc4sc38ix6","tag_id":"cm9s38afe0001vooca2em98w0","_id":"cm9s38afs0006vooc5sj75p2h"},{"post_id":"cmbrwe15t0000g4oc7ulwfo4g","tag_id":"cm3wxd2kn0002ywocfuqeavbj","_id":"cmbrwe15w0001g4occgzn7u3j"}],"Tag":[{"name":"PHP开发","_id":"clxb4gv4b000upcoc7r648i0s"},{"name":"fastadmin","_id":"clxys1z680001s4b13wn70h36"},{"name":"laravel","_id":"clxys1z6p0003s4b15xi8em2d"},{"name":"mysql","_id":"clxys1z6s0007s4b18ix57laf"},{"name":"thinkphp","_id":"cm2ebn9qb0006dkoc25p8h8e9"},{"name":"加密技术","_id":"cm2ebqs8t00018ooc1wsvey1b"},{"name":"linux","_id":"cm3wxd2kn0002ywocfuqeavbj"},{"name":"服务器相关","_id":"cm3wxljtn0000qcocasiz67fb"},{"name":"sftp","_id":"cm3wxqnd20009q4oc4qnwewga"},{"name":"vue","_id":"cm3wy6fnk001dq4oc1soof6tj"},{"name":"ubuntu","_id":"cm3wy8g1i001pq4ocd7iz3mdn"},{"name":"redis","_id":"cm3wy9er9001wq4oc8ywcdha6"},{"name":"php","_id":"cm3wya4zv001zq4oc7j2v5dk9"},{"name":"-gitlab","_id":"cm3wyfboe0000bwoc2w1w15e3"},{"name":"k8s","_id":"cm49k1odf0002eoocf3fwfftc"},{"name":"微信","_id":"cm9s38afe0001vooca2em98w0"}]}}