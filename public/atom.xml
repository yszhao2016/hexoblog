<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>yszhao的博客</title>
  
  <subtitle>记录我的生活 学习</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-09-03T09:03:54.919Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>yszhao</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>php开发-ASN编码</title>
    <link href="http://example.com/posts/b6482428.html"/>
    <id>http://example.com/posts/b6482428.html</id>
    <published>2024-09-03T09:03:54.000Z</published>
    <updated>2024-09-03T09:03:54.919Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-国秘加密(sm2/sm3/sm4)</title>
    <link href="http://example.com/posts/6aa2955a.html"/>
    <id>http://example.com/posts/6aa2955a.html</id>
    <published>2024-09-03T09:00:31.000Z</published>
    <updated>2024-09-03T09:00:31.821Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-laravel中的服务容器</title>
    <link href="http://example.com/posts/b61a700f.html"/>
    <id>http://example.com/posts/b61a700f.html</id>
    <published>2024-08-16T07:18:09.000Z</published>
    <updated>2024-08-20T02:40:48.699Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-多进程应用</title>
    <link href="http://example.com/posts/fef50030.html"/>
    <id>http://example.com/posts/fef50030.html</id>
    <published>2024-08-16T06:46:15.000Z</published>
    <updated>2024-08-16T07:14:52.898Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-设计模式之容器(container)</title>
    <link href="http://example.com/posts/aa1b125a.html"/>
    <id>http://example.com/posts/aa1b125a.html</id>
    <published>2024-08-15T11:58:22.000Z</published>
    <updated>2024-08-20T02:48:05.969Z</updated>
    
    <content type="html"><![CDATA[<h1 id="控制反转-IOC"><a href="#控制反转-IOC" class="headerlink" title="控制反转(IOC)"></a>控制反转(IOC)</h1><p> 含义：原来由人为（程序员）修改代码 控制流程，反转为由程序【框架】去控制<br> 控制反转(Inversion of Control) 是一种设计思想</p><p>没反转的情况(正转)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">commit</span>(<span class="params"><span class="variable">$supplierName</span></span>)</span></span><br><span class="line"><span class="function">     </span>&#123;</span><br><span class="line">        <span class="comment">// 去判断需要用哪个上游供应商，然后实例化</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$supplierName</span> == <span class="string">&quot;pushang&quot;</span>)&#123;</span><br><span class="line">           <span class="variable">$supplier</span> = <span class="keyword">new</span> PuShangSupplier(); </span><br><span class="line">           <span class="variable">$supplier</span>-&gt;commit();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">     &#125;</span><br><span class="line">    </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>反转后的情况（反转）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Supplier</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">   <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">commit</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PuShangSupplier</span> <span class="title">extend</span> <span class="title">Supplier</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">commit</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 逻辑</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">commit</span>(<span class="params">Supplier <span class="variable">$supplier</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable">$supplier</span>-&gt;commit();</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$app</span> = <span class="keyword">new</span> Application();</span><br><span class="line"><span class="variable">$app</span>-&gt;commit(<span class="keyword">new</span> PuShangSupplier());</span><br></pre></td></tr></table></figure><h1 id="依赖注入-DI"><a href="#依赖注入-DI" class="headerlink" title="依赖注入(DI)"></a>依赖注入(DI)</h1><p>依赖注入 是一种设计模式<br>依赖注入是控制反转的一种实现方式/方法<br>也就是依赖注入 实现了  控制反转</p><p>依赖注入方式 1、构造方法注入；2、set属性注入__set；3、静态工厂方法注入；</p><p>一旦换了平台，就要修改构造函数 即使你传参数 构造判断使用哪个类，新增了平台，你还有去修改A类构造方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ob</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">C <span class="variable">$c</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ob = <span class="keyword">new</span> Aly();</span><br><span class="line">      <span class="comment">//  $this-&gt;ob = new Txy();</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">send</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ob-&gt;send();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 实现阿里云</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Aly</span></span>&#123;&#125;</span><br><span class="line"><span class="comment">// 实现腾讯云</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Txy</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> A();</span><br><span class="line"><span class="variable">$a</span>-&gt;send();</span><br></pre></td></tr></table></figure><p>通过构造函数注入 依赖</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ob</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">C <span class="variable">$c</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ob = <span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">send</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ob-&gt;send();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Aly</span></span>&#123;</span><br><span class="line"><span class="comment">// 实现阿里云发送短信类</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$notice</span> = <span class="keyword">new</span> A(<span class="keyword">new</span> Aly());</span><br><span class="line"><span class="variable">$notice</span>-&gt;send();</span><br></pre></td></tr></table></figure><h1 id="IoC容器"><a href="#IoC容器" class="headerlink" title="IoC容器"></a>IoC容器</h1><p>将依赖的对象注入到容器中<br>当需要某个对象的时候，就直接获取，不必关注其实例化需要些什么，容器自动实例化了<br>运行时容器会自动解析依赖（存在子依赖也可以自动解析）</p> <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Container</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$i</span>=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$s</span> = <span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$k</span>, <span class="variable">$c</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;s[<span class="variable">$k</span>] = <span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$k</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;build(<span class="keyword">$this</span>-&gt;s[<span class="variable">$k</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 自动绑定（Autowiring）自动解析（Automatic Resolution）</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $className</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> object</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">build</span>(<span class="params"><span class="variable">$className</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 如果是匿名函数（Anonymous functions），也叫闭包函数（closures）</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$className</span> <span class="keyword">instanceof</span> <span class="built_in">Closure</span>) &#123;</span><br><span class="line"><span class="comment">//            var_dump($className);exit;</span></span><br><span class="line">            <span class="comment">// 执行闭包函数，并将结果</span></span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$className</span>(<span class="keyword">$this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*通过反射获取类的内部结构，实例化类*/</span></span><br><span class="line">        <span class="variable">$reflector</span> = <span class="keyword">new</span> ReflectionClass(<span class="variable">$className</span>);</span><br><span class="line">        <span class="comment">// 检查类是否可实例化, 排除抽象类abstract和对象接口interface</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$reflector</span>-&gt;isInstantiable()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Can&#x27;t instantiate this.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/** <span class="doctag">@var</span> ReflectionMethod $constructor 获取类的构造函数 */</span></span><br><span class="line">        <span class="variable">$constructor</span> = <span class="variable">$reflector</span>-&gt;getConstructor();</span><br><span class="line">        <span class="comment">// 若无构造函数，直接实例化并返回</span></span><br><span class="line">        <span class="keyword">if</span> (is_null(<span class="variable">$constructor</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="variable">$className</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 取构造函数参数,通过 ReflectionParameter 数组返回参数列表</span></span><br><span class="line">        <span class="variable">$parameters</span> = <span class="variable">$constructor</span>-&gt;getParameters();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 递归解析构造函数的参数</span></span><br><span class="line">        <span class="variable">$dependencies</span> = <span class="keyword">$this</span>-&gt;getDependencies(<span class="variable">$parameters</span>);</span><br><span class="line">        <span class="comment">// 创建一个类的新实例，给出的参数将传递到类的构造函数。</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$reflector</span>-&gt;newInstanceArgs(<span class="variable">$dependencies</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $parameters</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDependencies</span>(<span class="params"><span class="variable">$parameters</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$dependencies</span> = [];</span><br><span class="line">        <span class="comment">/** <span class="doctag">@var</span> ReflectionParameter $parameter */</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$parameters</span> <span class="keyword">as</span> <span class="variable">$parameter</span>) &#123;</span><br><span class="line">            <span class="comment">/** <span class="doctag">@var</span> ReflectionClass $dependency */</span></span><br><span class="line">            <span class="variable">$dependency</span> = <span class="variable">$parameter</span>-&gt;getClass();</span><br><span class="line">            <span class="keyword">if</span> (is_null(<span class="variable">$dependency</span>)) &#123;</span><br><span class="line">                <span class="comment">// 是变量,有默认值则设置默认值</span></span><br><span class="line">                <span class="variable">$dependencies</span>[] = <span class="keyword">$this</span>-&gt;resolveNonClass(<span class="variable">$parameter</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 是一个类，递归解析</span></span><br><span class="line">                <span class="variable">$dependencies</span>[] = <span class="keyword">$this</span>-&gt;build(<span class="variable">$dependency</span>-&gt;name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$dependencies</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ReflectionParameter $parameter</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> mixed</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">resolveNonClass</span>(<span class="params"><span class="variable">$parameter</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 有默认值则返回默认值</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$parameter</span>-&gt;isDefaultValueAvailable()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$parameter</span>-&gt;getDefaultValue();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;I have no idea what to do here.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&quot;./testclass.php&quot;</span>; <span class="comment">//开始测试，先测试已知依赖关系的情况</span></span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> Container();</span><br><span class="line"><span class="variable">$c</span>-&gt;department = <span class="string">&#x27;Department&#x27;</span>;<span class="comment">// 赋值类名 或 匿名函数</span></span><br><span class="line"><span class="variable">$c</span>-&gt;company = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$c</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Company(<span class="variable">$c</span>-&gt;department);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 从容器中取得company</span></span><br><span class="line"><span class="variable">$company</span> = <span class="variable">$c</span>-&gt;company;</span><br><span class="line"><span class="variable">$company</span>-&gt;doSomething(); <span class="comment">//输出: Group:hello|Department:hello|Company:hello|</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试未知依赖关系，直接使用的方法</span></span><br><span class="line"><span class="variable">$di</span> = <span class="keyword">new</span> Container();</span><br><span class="line"><span class="variable">$di</span>-&gt;company = <span class="string">&#x27;Company&#x27;</span>;<span class="comment">// 赋值类名 或 匿名函数</span></span><br><span class="line"><span class="variable">$company</span> = <span class="variable">$di</span>-&gt;company;</span><br><span class="line"><span class="variable">$company</span>-&gt;doSomething();<span class="comment">//输出: Group:hello|Department:hello|Company:hello|</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="comment">//依赖关系：Company-&gt;Department-&gt;Group</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Group</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">__CLASS__</span>.<span class="string">&quot;:&quot;</span>.<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;|&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Department</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$group</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Group <span class="variable">$group</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;group = <span class="variable">$group</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;group-&gt;doSomething();</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">__CLASS__</span>.<span class="string">&quot;:&quot;</span>.<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;|&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Company</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$department</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Department <span class="variable">$department</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;department = <span class="variable">$department</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;department-&gt;doSomething();</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">__CLASS__</span>.<span class="string">&quot;:&quot;</span>.<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;|&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;控制反转-IOC&quot;&gt;&lt;a href=&quot;#控制反转-IOC&quot; class=&quot;headerlink&quot; title=&quot;控制反转(IOC)&quot;&gt;&lt;/a&gt;控制反转(IOC)&lt;/h1&gt;&lt;p&gt; 含义：原来由人为（程序员）修改代码 控制流程，反转为由程序【框架】去控制&lt;br&gt; 控制</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-工行支付接口对接</title>
    <link href="http://example.com/posts/11955b14.html"/>
    <id>http://example.com/posts/11955b14.html</id>
    <published>2024-08-15T11:10:02.000Z</published>
    <updated>2024-08-16T06:35:56.115Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-海康视频接口对接</title>
    <link href="http://example.com/posts/cc90e6c9.html"/>
    <id>http://example.com/posts/cc90e6c9.html</id>
    <published>2024-08-15T11:09:37.000Z</published>
    <updated>2024-08-16T06:35:56.119Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-根据设置的概率抽奖</title>
    <link href="http://example.com/posts/84d7639f.html"/>
    <id>http://example.com/posts/84d7639f.html</id>
    <published>2024-08-15T10:48:19.000Z</published>
    <updated>2024-08-16T06:35:56.117Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-fastAdmin中搜索日期时间的处理</title>
    <link href="http://example.com/posts/cb6a68f0.html"/>
    <id>http://example.com/posts/cb6a68f0.html</id>
    <published>2024-08-13T11:22:27.000Z</published>
    <updated>2024-08-13T11:54:32.308Z</updated>
    
    <content type="html"><![CDATA[<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>在使用FastAdmin时，遇到日期时间搜索的问题，JS中的RANGE或BETWEEN操作生成的SQL总是针对时间戳的区间查询。<br>通过分析代码发现，RANGE操作符会自动转为BETWEEN TIME，而BETWEEN操作符在含有datetimepicker样式的输入框中会被强制转换为RANGE。<br>为了解决这个问题，屏蔽了bootstrap-table-commonsearch.js中将operate置为RANGE的代码段，<br>实现了对日期时间的正确搜索</p><p>正常一般这么写</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">field</span>: <span class="string">&#x27;notice_time&#x27;</span>,<span class="attr">title</span>: <span class="string">&quot;通知时间&quot;</span>,<span class="attr">operate</span>: <span class="string">&#x27;Range&#x27;</span>,<span class="attr">addclass</span>: <span class="string">&#x27;datetimerange&#x27;</span>,<span class="attr">formatter</span>: Table.api.formatter.datetime,<span class="attr">data</span>:<span class="string">&#x27;data-date-format=&quot;YYYY-MM-DD&quot;&#x27;</span>&#125;,</span><br></pre></td></tr></table></figure><p>fastadmin 后端处理 BETWEEN TIME</p><p>也就是把搜索条件值转换为时间戳  进行between 搜索</p><p>当notice_time 存的是“xxxx-xx-xx”格式 就搜索不到</p><p>那就只能用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">field</span>: <span class="string">&#x27;notice_time&#x27;</span>,<span class="attr">title</span>: <span class="string">&quot;通知时间&quot;</span>,<span class="attr">operate</span>: <span class="string">&#x27;BETWEEN&#x27;</span>,<span class="attr">addclass</span>: <span class="string">&#x27;datetimepicker&#x27;</span>,<span class="attr">formatter</span>: Table.api.formatter.datetime,<span class="attr">data</span>:<span class="string">&#x27;data-date-format=&quot;YYYY-MM-DD&quot;&#x27;</span>&#125;,</span><br></pre></td></tr></table></figure><p>但是bootstrap-table-commonsearch.js 中有将datetimepicker样式的operate字段  强制转为Range了</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ($(<span class="string">&quot;[name=&#x27;&quot;</span> + name + <span class="string">&quot;&#x27;]:first&quot;</span>, that.$commonsearch).hasClass(<span class="string">&quot;datetimepicker&quot;</span>)) &#123;</span><br><span class="line">                     sym = <span class="string">&#x27;RANGE&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><h2 id="方案一"><a href="#方案一" class="headerlink" title="方案一"></a>方案一</h2><p>bootstrap-table-commonsearch.js 中这段代码注释</p><p>重新生成bootstrap-table-commonsearch.min.js</p><p> php think min -m backend -r all</p><p> 或者直接修改bootstrap-table-commonsearch.min.js</p><h2 id="方案二"><a href="#方案二" class="headerlink" title="方案二"></a>方案二</h2><p>修改数据库字段类型 存储时间戳</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;问题&quot;&gt;&lt;a href=&quot;#问题&quot; class=&quot;headerlink&quot; title=&quot;问题&quot;&gt;&lt;/a&gt;问题&lt;/h1&gt;&lt;p&gt;在使用FastAdmin时，遇到日期时间搜索的问题，JS中的RANGE或BETWEEN操作生成的SQL总是针对时间戳的区间查询。&lt;br&gt;通过</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>商城开发-拼团功能开发设计</title>
    <link href="http://example.com/posts/701fec33.html"/>
    <id>http://example.com/posts/701fec33.html</id>
    <published>2024-08-12T07:24:12.000Z</published>
    <updated>2024-08-12T07:42:56.263Z</updated>
    
    <content type="html"><![CDATA[<h1 id="功能需求描述"><a href="#功能需求描述" class="headerlink" title="功能需求描述"></a>功能需求描述</h1><h1 id="数据库表设计"><a href="#数据库表设计" class="headerlink" title="数据库表设计"></a>数据库表设计</h1><p>fa_wanlshop_groups  拼团表</p><p>id    int    10    0    0    0    -1    0                ID                    0    0    0    0    -1    -1    0<br>group_no    varchar    32    0    0    0    0    0                拼团号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>user_id    int    10    0    0    0    0    0            0    团长ID                    0    0    0    0    0    0    0<br>shop_id    int    10    0    0    0    0    0            0    所属商家                    0    0    0    0    0    0    0<br>goods_id    int    10    0    0    0    0    0            0    所属商品                    0    0    0    0    0    0    0<br>group_type    enum    0    0    0    0    0    0        ‘alone’,’group’,’ladder’        拼团类型:alone=直购,group=拼团,ladder=阶梯拼团            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>is_ladder    tinyint    1    0    0    0    0    0            0    是否阶梯拼团                    0    0    0    0    0    0    0<br>ladder_id    int    10    0    0    0    0    0            0    阶梯ID                    0    0    0    0    0    0    0<br>people_num    int    10    0    0    0    0    0            0    成团人数                    0    0    0    0    0    0    0<br>join_num    int    10    0    0    0    0    0            0    参团人数                    0    0    0    0    0    0    0<br>state    enum    0    0    0    0    0    0        ‘ready’,’start’,’success’,’fail’,’auto’    ‘ready’    拼团状态:ready=准备中,start=拼团中,success=已成团,fail=拼团失败,auto=自动成团            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>createtime    int    10    0    -1    0    0    0                开团时间                    0    0    0    0    0    0    0<br>grouptime    int    10    0    -1    0    0    0                成团时间                    0    0    0    0    0    0    0<br>validitytime    int    10    0    -1    0    0    0                有效时间                    0    0    0    0    0    0    0<br>updatetime    int    10    0    -1    0    0    0                更新时间                    0    0    0    0    0    0    0<br>deletetime    int    10    0    -1    0    0    0                删除时间                    0    0    0    0    0    0    0<br>status    enum    0    0    -1    0    0    0        ‘normal’,’hidden’    ‘normal’    状态            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0</p><p>fa_wanlshop_groups_goods 拼团商品表</p><p>id    int    10    0    0    0    -1    0                ID                    0    0    0    0    -1    -1    0<br>shop_id    int    10    0    -1    0    0    0            0    店铺ID                    0    0    0    0    0    -1    0<br>shop_category_id    varchar    100    0    -1    0    0    0                店铺内类目            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>category_id    int    10    0    0    0    0    0            0    商品类目                    0    0    0    0    0    -1    0<br>brand_id    int    10    0    -1    0    0    0            0    品牌ID                    0    0    0    0    0    -1    0<br>category_attribute    longtext    0    0    -1    0    0    0                类目属性            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>title    varchar    100    0    0    0    0    0                商品标题            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>image    varchar    100    0    0    0    0    0                商品主图            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>images    varchar    1500    0    0    0    0    0                产品相册            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>description    varchar    255    0    0    0    0    0                商品描述            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>is_alone    tinyint    1    0    0    0    0    0            1    是否显示单购是:0=否,1=是                    0    0    0    0    0    0    0<br>people_num    int    3    0    -1    0    0    0            0    组团人数                    0    0    0    0    0    0    0<br>groups_num    int    3    0    -1    0    0    0            0    成团人数                    0    0    0    0    0    0    0<br>is_ladder    tinyint    1    0    0    0    0    0            0    开启阶梯团:0=否,1=是                    0    0    0    0    0    0    0<br>group_hour    int    10    0    0    0    0    0            24    组团限时(小时)                    0    0    0    0    0    0    0<br>purchase_limit    int    6    0    0    0    0    0            0    个人购买次数限制，默认是0，没有次数限制                    0    0    0    0    0    0    0<br>is_discount    tinyint    1    0    0    0    0    0            0    是否显示团长优惠是:0=否,1=是                    0    0    0    0    0    0    0<br>discount_type    tinyint    1    0    0    0    0    0            0    团长优惠类型:0=金额,1=百分百                    0    0    0    0    0    0    0<br>discount    float    10    2    -1    0    0    0            0.00    优惠金额/折扣                    0    0    0    0    0    0    0<br>flag    set    0    0    0    0    0    0        ‘hot’,’index’,’recommend’        标志(多选):hot=热门,index=首页,recommend=推荐            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>stock    enum    0    0    0    0    0    0        ‘porder’,’payment’    ‘porder’    库存计算方式:porder=下单减库存,payment=付款减库存            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>content    longtext    0    0    0    0    0    0                商品详情            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>freight_id    int    10    0    0    0    0    0            0    运费模板                    0    0    0    0    0    -1    0<br>grounding    tinyint    1    0    0    0    0    0            0    上架状态                    0    0    0    0    0    0    0<br>specs    enum    0    0    0    0    0    0        ‘single’,’multi’    ‘single’    商品规格:single=单规格,multi=多规格            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>distribution    enum    0    0    0    0    0    0        ‘true’,’false’    ‘false’    是否独立分销:true=开启,false=关闭            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>activity    enum    0    0    0    0    0    0        ‘true’,’false’    ‘false’    是否活动中:true=是,false=否            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>views    int    10    0    0    0    0    0            0    点击                    0    0    0    0    0    -1    0<br>price    decimal    10    2    -1    0    0    0            0.00    产品价格                    0    0    0    0    0    0    0<br>sales    int    10    0    0    0    0    0            0    销量                    0    0    0    0    0    -1    0<br>payment    int    10    0    0    0    0    0            0    付款人数                    0    0    0    0    0    -1    0<br>comment    int    10    0    0    0    0    0            0    评论                    0    0    0    0    0    -1    0<br>praise    int    10    0    0    0    0    0            0    好评                    0    0    0    0    0    -1    0<br>moderate    int    10    0    0    0    0    0            0    中评                    0    0    0    0    0    -1    0<br>negative    int    10    0    0    0    0    0            0    差评                    0    0    0    0    0    -1    0<br>like    int    10    0    0    0    0    0            0    收藏                    0    0    0    0    0    -1    0<br>weigh    int    10    0    0    0    0    0            0    权重                    0    0    0    0    0    0    0<br>createtime    int    10    0    -1    0    0    0                创建时间                    0    0    0    0    0    0    0<br>updatetime    int    10    0    -1    0    0    0                更新时间                    0    0    0    0    0    0    0<br>deletetime    int    10    0    -1    0    0    0                删除时间                    0    0    0    0    0    0    0<br>status    enum    0    0    -1    0    0    0        ‘normal’,’hidden’    ‘normal’    状态            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0</p><p>fa_wanlshop_groups_team  拼团记录表</p><p>id    int    10    0    0    0    -1    0                ID                    0    0    0    0    -1    -1    0<br>group_no    varchar    32    0    0    0    0    0                拼团号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>user_id    int    10    0    0    0    0    0            0    用户ID                    0    0    0    0    0    0    0<br>shop_id    int    10    0    0    0    0    0            0    所属商家ID                    0    0    0    0    0    0    0<br>order_id    int    10    0    0    0    0    0            0    订单ID                    0    0    0    0    0    0    0<br>order_goods_id    int    10    0    0    0    0    0            0    订单商品ID                    0    0    0    0    0    0    0<br>username    varchar    32    0    -1    0    0    0                快递号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>nickname    varchar    50    0    -1    0    0    0                快递号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>avatar    varchar    255    0    -1    0    0    0                快递号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>createtime    int    10    0    -1    0    0    0                参团时间                    0    0    0    0    0    0    0<br>updatetime    int    10    0    -1    0    0    0                更新时间                    0    0    0    0    0    0    0<br>deletetime    int    10    0    -1    0    0    0                删除时间                    0    0    0    0    0    0    0</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;功能需求描述&quot;&gt;&lt;a href=&quot;#功能需求描述&quot; class=&quot;headerlink&quot; title=&quot;功能需求描述&quot;&gt;&lt;/a&gt;功能需求描述&lt;/h1&gt;&lt;h1 id=&quot;数据库表设计&quot;&gt;&lt;a href=&quot;#数据库表设计&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>商城开发-SPU和SKU数据结构设计</title>
    <link href="http://example.com/posts/ce3caa74.html"/>
    <id>http://example.com/posts/ce3caa74.html</id>
    <published>2024-08-12T06:24:31.000Z</published>
    <updated>2024-08-12T07:25:41.240Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、SPU和SKU"><a href="#一、SPU和SKU" class="headerlink" title="一、SPU和SKU"></a>一、SPU和SKU</h1><p>SPU：Standard Product Unit （标准产品单位） ，一组具有共同属性的商品集</p><p>示例 如奶茶商品中的 容量  大 、中 、小 杯<br>     如奶茶商品中   甜度  少糖 标准  加糖</p><p>SKU：Stock Keeping Unit（库存量单位），SPU商品集因具体特性不同而细分的每个商品</p><p>示例 如奶茶商品中 【就是 容量 与 甜度 的排列组合】</p><pre><code>    大杯  少糖    中杯  少糖    小杯  少糖    大杯  标准    中杯  标准    小杯  标准    。。。</code></pre><h1 id="二、数据库设计"><a href="#二、数据库设计" class="headerlink" title="二、数据库设计"></a>二、数据库设计</h1><h2 id="2-1-spu表"><a href="#2-1-spu表" class="headerlink" title="2.1 spu表"></a>2.1 spu表</h2><table><thead><tr><th align="left">字段</th><th align="center">类型</th><th align="right">描述</th></tr></thead><tbody><tr><td align="left">id</td><td align="center">int</td><td align="right">ID</td></tr><tr><td align="left">goods_id</td><td align="center">int</td><td align="right">商品ID</td></tr><tr><td align="left">name</td><td align="center">varchar</td><td align="right">规格名称</td></tr><tr><td align="left">item</td><td align="center">text</td><td align="right">规格</td></tr><tr><td align="left">status</td><td align="center">tinty</td><td align="right">状态</td></tr><tr><td align="left">createtime</td><td align="center">int</td><td align="right">创建时间</td></tr><tr><td align="left">updatetime</td><td align="center">int</td><td align="right">更新时间</td></tr></tbody></table><p>6    2    口味    微辣,中辣,特辣    1723441719    1723441719        0</p><h2 id="2-2sku-表"><a href="#2-2sku-表" class="headerlink" title="2.2sku 表"></a>2.2sku 表</h2><table><thead><tr><th align="left">字段</th><th align="center">类型</th><th align="right">描述</th></tr></thead><tbody><tr><td align="left">id</td><td align="center">int</td><td align="right">ID</td></tr><tr><td align="left">goods_id</td><td align="center">int</td><td align="right">商品ID</td></tr><tr><td align="left">thumbnail</td><td align="center">text</td><td align="right">缩略图</td></tr><tr><td align="left">difference</td><td align="center">text</td><td align="right">规格</td></tr><tr><td align="left">price</td><td align="center">decimal(10,2)</td><td align="right">价格</td></tr><tr><td align="left">stock</td><td align="center">int</td><td align="right">库存</td></tr><tr><td align="left">sn</td><td align="center">varchar(200)</td><td align="right">商品标号</td></tr><tr><td align="left">createtime</td><td align="center">int</td><td align="right">创建时间</td></tr><tr><td align="left">updatetime</td><td align="center">int</td><td align="right">更新时间</td></tr></tbody></table><p>2    2        微辣,小份    1    11    11    1    11    0    1    1723441530    1723441600        normal</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;一、SPU和SKU&quot;&gt;&lt;a href=&quot;#一、SPU和SKU&quot; class=&quot;headerlink&quot; title=&quot;一、SPU和SKU&quot;&gt;&lt;/a&gt;一、SPU和SKU&lt;/h1&gt;&lt;p&gt;SPU：Standard Product Unit （标准产品单位） ，一组具有共同</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-fastadmin表格操作列自定义按钮</title>
    <link href="http://example.com/posts/5f9fc809.html"/>
    <id>http://example.com/posts/5f9fc809.html</id>
    <published>2024-08-08T12:30:54.000Z</published>
    <updated>2024-08-12T03:14:39.903Z</updated>
    
    <content type="html"><![CDATA[<h1 id="自定义弹框效果按钮"><a href="#自定义弹框效果按钮" class="headerlink" title="自定义弹框效果按钮"></a>自定义弹框效果按钮</h1><p>classname字段控制 btn-dialog</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;changerecord&#x27;</span>,</span><br><span class="line">   <span class="attr">text</span>: <span class="string">&#x27;动账记录查询&#x27;</span>,</span><br><span class="line">   <span class="attr">icon</span>: <span class="string">&#x27;fa fa-search&#x27;</span>,</span><br><span class="line">   <span class="attr">classname</span>: <span class="string">&#x27;btn btn-info btn-xs btn-dialog&#x27;</span>,</span><br><span class="line">   <span class="attr">url</span>: <span class="string">&#x27;cms/bank/changeRecord&#x27;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h1 id="需要确认后再处理"><a href="#需要确认后再处理" class="headerlink" title="需要确认后再处理"></a>需要确认后再处理</h1><p>visible 字段可根据数据判断 是否显示按钮</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">         &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;jy&#x27;</span>,</span><br><span class="line">            <span class="attr">text</span>: <span class="string">&#x27;解约&#x27;</span>,</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&#x27;fa fa-search&#x27;</span>,</span><br><span class="line">            <span class="attr">classname</span>: <span class="string">&#x27;btn btn-info btn-xs btn-danger btn-ajax&#x27;</span>,</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;cms/bank/unwind&#x27;</span>,</span><br><span class="line">            <span class="attr">visible</span>: <span class="function"><span class="keyword">function</span> (<span class="params">row</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (row.status == <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">confirm</span>: <span class="string">&#x27;确定要解约吗?&#x27;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">data, ret</span>) </span>&#123;</span><br><span class="line">                $(<span class="string">&quot;a.btn-refresh&quot;</span>).trigger(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">                layer.alert(ret.msg);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//如果需要阻止成功提示，则必须使用return false;</span></span><br><span class="line">                <span class="comment">//return false;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">error</span>: <span class="function"><span class="keyword">function</span> (<span class="params">data, ret</span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(data, ret);</span><br><span class="line">                layer.alert(ret.msg);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line"><span class="string">``</span><span class="string">`    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 控制字段的显示</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">formatter字段中处理</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>js </span><br><span class="line"> &#123;</span><br><span class="line">    <span class="attr">field</span>: <span class="string">&#x27;status&#x27;</span>, <span class="attr">title</span>: <span class="string">&#x27;状态&#x27;</span>,<span class="attr">operate</span>: <span class="literal">false</span>, <span class="attr">formatter</span>: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (value == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;已签约&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;未签约&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">field</span>: <span class="string">&#x27;grant&#x27;</span>, <span class="attr">title</span>: __(<span class="string">&#x27;Grant&#x27;</span>), <span class="attr">operate</span>: <span class="string">&#x27;LIKE&#x27;</span>,<span class="attr">formatter</span>: Controller.api.formatter.grant&#125;</span><br></pre></td></tr></table></figure><h1 id="自定义编辑删除按钮"><a href="#自定义编辑删除按钮" class="headerlink" title="自定义编辑删除按钮"></a>自定义编辑删除按钮</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;edit&#x27;</span>,</span><br><span class="line">     <span class="attr">icon</span>: <span class="string">&#x27;fa fa-pencil&#x27;</span>,</span><br><span class="line">     <span class="attr">title</span>: __(<span class="string">&#x27;Edit&#x27;</span>),</span><br><span class="line">     <span class="attr">extend</span>: <span class="string">&#x27;data-toggle=&quot;tooltip&quot;&#x27;</span>,</span><br><span class="line">     <span class="attr">classname</span>: <span class="string">&#x27;btn btn-xs btn-success btn-editone&#x27;</span>,</span><br><span class="line">     <span class="attr">visible</span>: <span class="function"><span class="keyword">function</span> (<span class="params">row</span>) </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> row.status === <span class="number">0</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;,</span><br><span class="line">&#123;</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;del&#x27;</span>,</span><br><span class="line">     <span class="attr">icon</span>: <span class="string">&#x27;fa fa-trash&#x27;</span>,</span><br><span class="line">     <span class="attr">title</span>: __(<span class="string">&#x27;Del&#x27;</span>),</span><br><span class="line">     <span class="attr">extend</span>: <span class="string">&#x27;data-toggle=&quot;tooltip&quot;&#x27;</span>,</span><br><span class="line">     <span class="attr">classname</span>: <span class="string">&#x27;btn btn-xs btn-danger btn-delone&#x27;</span>,</span><br><span class="line">     <span class="attr">visible</span>: <span class="function"><span class="keyword">function</span> (<span class="params">row</span>) </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> row.status === <span class="number">0</span>;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="自定义提交处理"><a href="#自定义提交处理" class="headerlink" title="自定义提交处理"></a>自定义提交处理</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">add: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          Controller.api.selectcoupon();</span><br><span class="line">          Controller.api.selectusers();</span><br><span class="line">          </span><br><span class="line">          Form.api.bindevent($(<span class="string">&quot;form[role=form]&quot;</span>), <span class="function"><span class="keyword">function</span>(<span class="params">data, ret</span>)</span>&#123;</span><br><span class="line">              <span class="comment">//如果我们需要在提交表单成功后做跳转，可以在此使用location.href=&quot;链接&quot;;进行跳转</span></span><br><span class="line">          &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">data, ret</span>)</span>&#123;</span><br><span class="line">              <span class="comment">// 错误处理</span></span><br><span class="line">              Fast.api.close();</span><br><span class="line">          &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">success, error</span>)</span>&#123;</span><br><span class="line">              <span class="comment">//bindevent的第三个参数为提交前的回调</span></span><br><span class="line">              <span class="comment">//如果我们需要在表单提交前做一些数据处理，则可以在此方法处理</span></span><br><span class="line">              <span class="comment">//注意如果我们需要阻止表单，可以在此使用return false;即可</span></span><br><span class="line">              <span class="comment">//如果我们处理完成需要再次提交表单则可以使用submit提交,如下</span></span><br><span class="line">              <span class="keyword">if</span>(!$(<span class="string">&quot;#user_ids&quot;</span>).val())&#123;</span><br><span class="line">                  Toastr.error(<span class="string">&quot;请选择发放用户&quot;</span>);</span><br><span class="line">                  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span>(!$(<span class="string">&quot;#couponid&quot;</span>).val())&#123;</span><br><span class="line">                  Toastr.error(<span class="string">&quot;请选择发放卡券&quot;</span>);</span><br><span class="line">                  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h1 id="完整-示例代码"><a href="#完整-示例代码" class="headerlink" title="完整 示例代码"></a>完整 示例代码</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">columns: [</span><br><span class="line">                [</span><br><span class="line">                    &#123;checkbox: true&#125;,</span><br><span class="line">                    &#123;field: &#x27;id&#x27;, title: &quot;ID&quot;,operate: false&#125;,</span><br><span class="line">                    &#123;field: &#x27;account&#x27;, title: &quot;账号&quot;, operate: &#x27;like&#x27;&#125;,</span><br><span class="line">                    &#123;field: &#x27;school.school_name&#x27;, title: &quot;学校&quot;, operate: &#x27;like&#x27;&#125;,</span><br><span class="line">                    &#123;field: &#x27;balance&#x27;, title: &quot;余额/元&quot;, operate: false&#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        field: &#x27;status&#x27;, title: &#x27;状态&#x27;,operate: false, formatter: function (value) &#123;</span><br><span class="line">                            if (value == 0) &#123;</span><br><span class="line">                                return &quot;已签约&quot;;</span><br><span class="line">                            &#125; else if (value == 1) &#123;</span><br><span class="line">                                return &quot;未签约&quot;;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        field: &#x27;operate&#x27;, title: __(&#x27;Operate&#x27;), table: table,</span><br><span class="line">                        events: Table.api.events.operate,</span><br><span class="line">                        buttons: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;changerecord&#x27;,</span><br><span class="line">                                text: &#x27;动账记录查询&#x27;,</span><br><span class="line">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class="line">                                classname: &#x27;btn btn-info btn-xs btn-dialog&#x27;,</span><br><span class="line">                                url: &#x27;cms/bank/changeRecord&#x27;</span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;freezerecord&#x27;,</span><br><span class="line">                                text: &#x27;冻结/解冻记录&#x27;,</span><br><span class="line">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class="line">                                classname: &#x27;btn btn-info btn-xs btn-detail btn-dialog&#x27;,</span><br><span class="line">                                url: &#x27;cms/bank/freezeRecord&#x27;,</span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;balance&#x27;,</span><br><span class="line">                                text: &#x27;查询余额&#x27;,</span><br><span class="line">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class="line">                                classname: &#x27;btn btn-info btn-xs btn-balance&#x27;,</span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;qy&#x27;,</span><br><span class="line">                                text: &#x27;签约&#x27;,</span><br><span class="line">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class="line">                                classname: &#x27;btn btn-info btn-xs btn-success btn-ajax&#x27;,</span><br><span class="line">                                url: &#x27;cms/bank/sign&#x27;,</span><br><span class="line">                                visible: function (row) &#123;</span><br><span class="line">                                    if (row.status == 1) &#123;</span><br><span class="line">                                        return true;</span><br><span class="line">                                    &#125; else &#123;</span><br><span class="line">                                        return false;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;,</span><br><span class="line">                                success: function (data, ret) &#123;</span><br><span class="line">                                    $(&quot;a.btn-refresh&quot;).trigger(&quot;click&quot;);</span><br><span class="line">                                    layer.alert(ret.msg);</span><br><span class="line">                                    //如果需要阻止成功提示，则必须使用return false;</span><br><span class="line">                                    //return false;</span><br><span class="line">                                &#125;,</span><br><span class="line">                                error: function (data, ret) &#123;</span><br><span class="line">                                    console.log(data, ret);</span><br><span class="line">                                    layer.alert(ret.msg);</span><br><span class="line">                                    return false;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;jy&#x27;,</span><br><span class="line">                                text: &#x27;解约&#x27;,</span><br><span class="line">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class="line">                                classname: &#x27;btn btn-info btn-xs btn-danger btn-ajax&#x27;,</span><br><span class="line">                                url: &#x27;cms/bank/unwind&#x27;,</span><br><span class="line">                                visible: function (row) &#123;</span><br><span class="line">                                    if (row.status == 0) &#123;</span><br><span class="line">                                        return true;</span><br><span class="line">                                    &#125; else &#123;</span><br><span class="line">                                        return false;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;,</span><br><span class="line">                                confirm: &#x27;确定要解约吗?&#x27;,</span><br><span class="line">                                success: function (data, ret) &#123;</span><br><span class="line">                                    $(&quot;a.btn-refresh&quot;).trigger(&quot;click&quot;);</span><br><span class="line">                                    layer.alert(ret.msg);</span><br><span class="line"></span><br><span class="line">                                    //如果需要阻止成功提示，则必须使用return false;</span><br><span class="line">                                    //return false;</span><br><span class="line">                                &#125;,</span><br><span class="line">                                error: function (data, ret) &#123;</span><br><span class="line">                                    console.log(data, ret);</span><br><span class="line">                                    layer.alert(ret.msg);</span><br><span class="line">                                    return false;</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;dj&#x27;,</span><br><span class="line">                                text: &#x27;冻结&#x27;,</span><br><span class="line">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class="line">                                classname: &#x27;btn btn-info btn-xs btn-danger btn-ajax&#x27;,</span><br><span class="line">                                url: &#x27;cms/bank/frozen&#x27;,</span><br><span class="line">                                confirm: &#x27;确定要冻结吗?&#x27;,</span><br><span class="line">                                success: function (data, ret) &#123;</span><br><span class="line">                                    $(&quot;a.btn-refresh&quot;).trigger(&quot;click&quot;);</span><br><span class="line">                                    layer.alert(ret.msg);</span><br><span class="line"></span><br><span class="line">                                    //如果需要阻止成功提示，则必须使用return false;</span><br><span class="line">                                    //return false;</span><br><span class="line">                                &#125;,</span><br><span class="line">                                error: function (data, ret) &#123;</span><br><span class="line">                                    console.log(data, ret);</span><br><span class="line">                                    layer.alert(ret.msg);</span><br><span class="line">                                    return false;</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                            &#125;,</span><br><span class="line">                         &#123;</span><br><span class="line">                            name: &#x27;edit&#x27;,</span><br><span class="line">                            icon: &#x27;fa fa-pencil&#x27;,</span><br><span class="line">                            title: __(&#x27;Edit&#x27;),</span><br><span class="line">                            extend: &#x27;data-toggle=&quot;tooltip&quot;&#x27;,</span><br><span class="line">                            classname: &#x27;btn btn-xs btn-success btn-editone&#x27;,</span><br><span class="line">                            visible: function (row) &#123;</span><br><span class="line">                                return row.status === 0;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            name: &#x27;del&#x27;,</span><br><span class="line">                            icon: &#x27;fa fa-trash&#x27;,</span><br><span class="line">                            title: __(&#x27;Del&#x27;),</span><br><span class="line">                            extend: &#x27;data-toggle=&quot;tooltip&quot;&#x27;,</span><br><span class="line">                            classname: &#x27;btn btn-xs btn-danger btn-delone&#x27;,</span><br><span class="line">                            visible: function (row) &#123;</span><br><span class="line">                                return row.status === 0;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    ], formatter: Table.api.formatter.operate&#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                ]</span><br><span class="line">            ]</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;自定义弹框效果按钮&quot;&gt;&lt;a href=&quot;#自定义弹框效果按钮&quot; class=&quot;headerlink&quot; title=&quot;自定义弹框效果按钮&quot;&gt;&lt;/a&gt;自定义弹框效果按钮&lt;/h1&gt;&lt;p&gt;classname字段控制 btn-dialog&lt;/p&gt;
&lt;figure class</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-fastadmin键值组件(Fieldlist)</title>
    <link href="http://example.com/posts/c70fd524.html"/>
    <id>http://example.com/posts/c70fd524.html</id>
    <published>2024-08-08T11:56:55.000Z</published>
    <updated>2024-08-08T12:10:20.703Z</updated>
    
    <content type="html"><![CDATA[<h1 id="fieldlist中有select"><a href="#fieldlist中有select" class="headerlink" title="fieldlist中有select"></a>fieldlist中有select</h1><p>selectpicker貌似不兼容的<br>模版语法 art-template<br>edit 页面select默认选中值 [先执行php代码 最后js取渲染模版的]</p><p>art-template中使用if</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="keyword">if</span>(…)&#123;%&gt;  html  &lt;%&#125;<span class="keyword">else</span>&#123;%&gt; html  &lt;%&#125;%&gt;</span><br></pre></td></tr></table></figure><p>edit页面 代码示例</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/html&quot;</span> <span class="attr">id</span>=<span class="string">&quot;testtpl&quot;</span>&gt;</span><span class="handlebars"><span class="xml"></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">     <span class="tag">&lt;<span class="name">dd</span> <span class="attr">class</span>=<span class="string">&quot;form-inline&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][id]&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&lt;%=row[&#x27;id&#x27;]%&gt;&quot;</span> <span class="attr">size</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars"></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;<span class="name">select</span>   <span class="attr">data-id</span>=<span class="string">&quot;&lt;%=index%&gt;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;couponname form-control&quot;</span>  <span class="attr">name</span>=<span class="string">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][coupon_id]&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 111px&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">             <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>请选择<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars"></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">             &lt;?php</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">                                         foreach($coupon as $vo)&#123;</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">                                            echo &#x27;<span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">&quot;&#x27;.$vo[&#x27;name&#x27;].&#x27;&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#x27;.$vo[&#x27;id&#x27;].&#x27;&quot;</span>     &lt;% <span class="attr">if</span> (<span class="attr">row</span>[&quot;<span class="attr">coupon_id</span>&quot;]&amp;&amp;<span class="attr">row</span>[&quot;<span class="attr">coupon_id</span>&quot;]<span class="attr">.indexOf</span>(&quot;&#x27;<span class="attr">.</span>$<span class="attr">vo</span>[&quot;<span class="attr">id</span>&quot;]<span class="attr">.</span>&#x27;&quot;)&gt;</span>-1) &#123; %&gt; selected &lt;% &#125; %&gt;     &gt;&#x27;.$vo[&#x27;name&#x27;].&#x27;<span class="tag">&lt;/<span class="name">option</span>&gt;</span>&#x27;;</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">             &#125;</span></span></span><br><span class="line"><span class="xml"><span class="handlebars"></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">             ?&gt;</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">             <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;-1&quot;</span>&gt;</span>谢谢参与<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>   <span class="attr">id</span>=<span class="string">&quot;num&lt;%=index%&gt;&quot;</span>  <span class="attr">name</span>=<span class="string">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][num]&quot;</span> <span class="attr">readonly</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&lt;%=row[&#x27;num&#x27;]%&gt;&quot;</span> <span class="attr">size</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][scale]&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&lt;%=row[&#x27;scale&#x27;]%&gt;&quot;</span> <span class="attr">size</span>=<span class="string">&quot;1&quot;</span>&gt;</span>%</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&lt;%=name%&gt;[&lt;%=index%&gt;][icon]&quot;</span> <span class="attr">id</span>=<span class="string">&quot;c-downloadurl-&lt;%=index%&gt;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&lt;%=row.icon%&gt;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:140px;&quot;</span>/&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn-group&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">             <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&quot;plupload-downloadurl-&lt;%=index%&gt;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-danger plupload&quot;</span> <span class="attr">data-input-id</span>=<span class="string">&quot;c-downloadurl-&lt;%=index%&gt;&quot;</span> <span class="attr">data-mimetype</span>=<span class="string">&quot;*&quot;</span> <span class="attr">data-multiple</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-upload&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">     <span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars"> </span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;fieldlist中有select&quot;&gt;&lt;a href=&quot;#fieldlist中有select&quot; class=&quot;headerlink&quot; title=&quot;fieldlist中有select&quot;&gt;&lt;/a&gt;fieldlist中有select&lt;/h1&gt;&lt;p&gt;selectpick</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>linux-sftp服务配置</title>
    <link href="http://example.com/posts/8e2962f3.html"/>
    <id>http://example.com/posts/8e2962f3.html</id>
    <published>2024-08-02T02:34:24.000Z</published>
    <updated>2024-08-20T02:09:46.192Z</updated>
    
    <content type="html"><![CDATA[<p>vim /etc/ssh/ssh_config</p><p>Subsystem sftp internal-sftp<br>Match Group sftp<br>        ChrootDirectory /www/wwwroot/ftp_ip_user<br>        X11Forwarding no<br>        AllowTcpForwarding no<br>        ForceCommand internal-sftp</p><p>fatal: bad ownership or modes for chroot directory “/www/wwwroot/ftp_ip_user” </p><p>这个错误通常发生在使用SSH服务进行远程登录时，特别是当你尝试为特定用户设置chroot环境时。<br>chroot是一种安全机制，它将用户的根目录更改为另一个目录，从而限制用户只能在该目录及其子目录下操作。<br>报错信息fatal: bad ownership or modes意味着chroot目录的所有权或权限设置不正确，SSH服务无法以安全的方式访问该目录。</p><p>问题解决：</p><p>检查/www/wwwroot/ftp_ip_user目录的所有权和权限。它应该只有root用户有写权限。可以使用以下命令来修复：</p><p>sudo chown root:root /www/wwwroot/ftp_ip_user<br>sudo chmod 0755 /www/wwwroot/ftp_ip_user</p><p>确保目录中没有任何不必要的文件或目录，特别是不应该有写权限给其他用户。</p><p>如果你使用的是sshd_config文件中的ChrootDirectory指令，确保指定的目录是你想要chroot jail的目录。</p><p>如果你在使用sftp服务，确保sshd_config文件中的Subsystem sftp指令指向正确的internal-sftp路径。</p><p>重启SSH服务以使更改生效。</p><p>如果问题依然存在，检查系统日志以获取更多信息，可能会有额外的线索</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;vim /etc/ssh/ssh_config&lt;/p&gt;
&lt;p&gt;Subsystem sftp internal-sftp&lt;br&gt;Match Group sftp&lt;br&gt;        ChrootDirectory /www/wwwroot/ftp_ip_user&lt;br&gt;  </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>mysql-主从数据库</title>
    <link href="http://example.com/posts/585d050b.html"/>
    <id>http://example.com/posts/585d050b.html</id>
    <published>2024-07-23T02:33:22.000Z</published>
    <updated>2024-07-24T02:41:14.959Z</updated>
    
    <content type="html"><![CDATA[<h1 id="mysql主从的应用"><a href="#mysql主从的应用" class="headerlink" title="mysql主从的应用"></a>mysql主从的应用</h1><h2 id="用来数据迁移"><a href="#用来数据迁移" class="headerlink" title="用来数据迁移"></a>用来数据迁移</h2><pre><code>开启主从同步，将数据导入主节点，让从节点同步；将数据分别导入主从节点，让主从节点数据一致后，建立连接，开启同步</code></pre><h2 id="数据备份"><a href="#数据备份" class="headerlink" title="数据备份"></a>数据备份</h2><h2 id="读写分离"><a href="#读写分离" class="headerlink" title="读写分离"></a>读写分离</h2><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h2 id="主节点配置"><a href="#主节点配置" class="headerlink" title="主节点配置"></a>主节点配置</h2><h3 id="主节点-my-cnf配置"><a href="#主节点-my-cnf配置" class="headerlink" title="主节点 my.cnf配置"></a>主节点 my.cnf配置</h3><pre><code>my.cnf  mysqld    # 开启日志general_log = 1general_log_file = mysql.log# 主从复制配置server-id = 1# binlog日志格式，mysql默认采用statement，建议使用mixed# STATEMENT模式（SBR）# 每一条会修改数据的sql语句会记录到binlog中。优点是并不需要记录每一条sql语句和每一行的数据变化，减少了binlog日志量，节约IO，提高性能。缺点是在某些情况下会导致master-slave中的数据不一致(如sleep()函数， last_insert_id()，以及user-defined functions(udf)等会出现问题)# ROW模式（RBR）# 不记录每条sql语句的上下文信息，仅需记录哪条数据被修改了，修改成什么样了。而且不会出现某些特定情况下的存储过程、或function、或trigger的调用和触发无法被正确复制的问题。缺点是会产生大量的日志，尤其是alter table的时候会让日志暴涨。# MIXED模式（MBR）# 以上两种模式的混合使用，一般的复制使用STATEMENT模式保存binlog，对于STATEMENT模式无法复制的操作使用ROW模式保存binlog，MySQL会根据执行的SQL语句选择日志保存方式。binlog_format= MIXED# binlog日志文件log-bin=mysql-bin# 是否只读，1 代表只读，0代表读写，主数据库需要读写，设置0read-only=0# binlog过期清理时间expire_logs_days=7# binlog每个日志文件大小max_binlog_size= 100m# binlog缓存大小binlog_cache_size= 4m# 最大binlog缓存大小max_binlog_cache_size= 512m</code></pre><h3 id="相关sql操作"><a href="#相关sql操作" class="headerlink" title="相关sql操作"></a>相关sql操作</h3><pre><code>## 创建dd用户 授权只能ip 192.168.227.134 访问 密码设置为123456CREATE USER &#39;dd&#39;@&#39;192.168.227.134&#39; IDENTIFIED BY &#39;123456&#39;;## 设置一个从服务器（slave）来复制主服务器（master）的数据权限GRANT REPLICATION SLAVE ON *.* TO &#39;dd&#39;@&#39;192.168.227.134&#39;;show master status </code></pre><h3 id="从节点-my-cnf配置"><a href="#从节点-my-cnf配置" class="headerlink" title="从节点 my.cnf配置"></a>从节点 my.cnf配置</h3><pre><code>server-id=2#它指定了从服务器（slave）用于存储从中继日志（relay logs）#中读取并准备应用于本地数据库的事件的文件的路径和名称模式。relay-log=mysql-relay-binsql//配置并启动主从复制change master to    -&gt; master_host=&#39;192.168.227.133&#39;,        #主的ip地址    -&gt; master_user=&#39;dd&#39;,                    #创建的用户名    -&gt; master_password=&#39;123456&#39;,            #创建的密码    -&gt; master_log_file=&#39;mysql-bin.000001&#39;,    #日志文件    -&gt; master_log_pos=328;                    #数据的最新位置//开启奴隶模式start slave;    show slave status </code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;mysql主从的应用&quot;&gt;&lt;a href=&quot;#mysql主从的应用&quot; class=&quot;headerlink&quot; title=&quot;mysql主从的应用&quot;&gt;&lt;/a&gt;mysql主从的应用&lt;/h1&gt;&lt;h2 id=&quot;用来数据迁移&quot;&gt;&lt;a href=&quot;#用来数据迁移&quot; class=&quot;</summary>
      
    
    
    
    <category term="服务器相关" scheme="http://example.com/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3/"/>
    
    
    <category term="mysql" scheme="http://example.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>php开发-微信登录</title>
    <link href="http://example.com/posts/77054df3.html"/>
    <id>http://example.com/posts/77054df3.html</id>
    <published>2024-07-04T11:52:39.000Z</published>
    <updated>2024-07-04T11:54:33.210Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>nginx-配置rewrite</title>
    <link href="http://example.com/posts/a0181459.html"/>
    <id>http://example.com/posts/a0181459.html</id>
    <published>2024-06-29T04:04:32.000Z</published>
    <updated>2024-08-20T01:52:03.670Z</updated>
    
    <content type="html"><![CDATA[<h1 id="rewrite-作用"><a href="#rewrite-作用" class="headerlink" title="rewrite 作用"></a>rewrite 作用</h1><p>用于实现URL的重写，URL的重写是非常有用的功能，<br>比如它可以在我们改变网站结构之后，不需要客户端修改原来的书签，<br>也无需其他网站修改我们的链接，就可以设置为自动访问，另外还可以在一定程度上提高网站的安全性</p><p>示例<br>浏览器访问url <a href="http://www.example.com/abc/file/a.jpg">http://www.example.com/abc/file/a.jpg</a><br>实际访问 <a href="http://www.example.com/bb/a.jpg">http://www.example.com/bb/a.jpg</a></p><p>浏览器访问url <a href="http://www.example.com/index/abc.html">http://www.example.com/index/abc.html</a><br>实际访问 <a href="http://www.example.com/index.php?r=index/abc">http://www.example.com/index.php?r=index/abc</a></p><h1 id="rewrite应用场景"><a href="#rewrite应用场景" class="headerlink" title="rewrite应用场景"></a>rewrite应用场景</h1><p>1、URL看起来更规范、合理<br>2、企业会将动态URL地址伪装成静态地址提供服务<br>3、网址换新域名后，让旧的访问跳转到新的域名上<br>4、服务端某些业务调整</p><h1 id="rewrite调试"><a href="#rewrite调试" class="headerlink" title="rewrite调试"></a>rewrite调试</h1><p>rewrite 日志记录指令<br>指令    rewrite_log<br>作用域 http, server, location<br>指令值选项    on 或 off<br>当指令值为 on 时，rewrite 的执行结果会以 notice 级别记录到 Nginx 的 error 日志文件中</p><p>示例：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http&#123;</span><br><span class="line">      <span class="attribute">rewrite_log</span> <span class="literal">on</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="nginx正则表达式"><a href="#nginx正则表达式" class="headerlink" title="nginx正则表达式"></a>nginx正则表达式</h1><p>常用的正则表达式元字符<br>^：匹配输入字符串的起始位置<br>$：匹配输入字符串的结束位置<br>*****：匹配前面的字符零次或多次<br>+：匹配前面的字符一次或多次<br>?：匹配前面的字符零次或一次<br>.：匹配除\n之外的任何单个字符 使用[.\n]可以匹配包括\n在内的任意字符<br>****：转义符<br>\d：匹配纯数字<br>{n}：重复n次<br>{n,}：重复n次或更多次<br>[c]：匹配单个字符c<br>[a-z]：匹配a-z小写字母的任意一个<br>[a-zA-Z]：匹配a-z小写字母或A-Z大写字母的任意一个<br>（）：表达式的开始和结束位置<br>|：或运算符</p><h1 id="实际应用"><a href="#实际应用" class="headerlink" title="实际应用"></a>实际应用</h1><pre><code>location ~* .*\.(mp4|avi|wmv|mpg|flv|rm|mov) &#123;    add_header Accept-Ranges bytes;  if ($request_uri ~* ^(.*)file/Image/annex/(.*)/(.*))&#123;    set $file_name $3;    rewrite (.*) $scheme://$host/$file_name;  &#125;  #视频保存的目录  root /www/wwwroot/tjproject-resources/WebAnnexFile/451772413496005765/;  mp4;  mp4_buffer_size 1m;#处理mp4初始内存大小  mp4_max_buffer_size 50m;#处理mp4最大内存大小&#125;location ~ .*\.(mp4|avi|wmv|mpg|flv|rm|mov) &#123;  if ($request_uri ~* ^/monitor_videos/(.*))&#123;    set $file_name $1;    rewrite (.*) $scheme://$host/$file_name;  &#125;  # #视频保存的目录  root /www/wwwroot/aigis_resources_yzc/monitor_videos/;  mp4;  mp4_buffer_size 1m;#处理mp4初始内存大小  mp4_max_buffer_size 50m;#处理mp4最大内存大小&#125;location ~* /upload/。*\.php$&#123;    rewrite (.+) http://www.index.com permanent&#125;server &#123;     listen 80;     server_name example.com www.example.com;         if ($server_port !~ 443)&#123;         rewrite ^(/.*)$ https://$host$1 permanent;         &#125;         # 其他配置... &#125;if ($scheme = http ) &#123;    return 301 https://$host$request_uri;&#125;</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;rewrite-作用&quot;&gt;&lt;a href=&quot;#rewrite-作用&quot; class=&quot;headerlink&quot; title=&quot;rewrite 作用&quot;&gt;&lt;/a&gt;rewrite 作用&lt;/h1&gt;&lt;p&gt;用于实现URL的重写，URL的重写是非常有用的功能，&lt;br&gt;比如它可以在我们</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>gitlab备份恢复</title>
    <link href="http://example.com/posts/6551734d.html"/>
    <id>http://example.com/posts/6551734d.html</id>
    <published>2024-06-28T14:14:05.000Z</published>
    <updated>2024-07-01T06:06:34.510Z</updated>
    
    <content type="html"><![CDATA[<h1 id="gitlab-备份命令"><a href="#gitlab-备份命令" class="headerlink" title="gitlab 备份命令"></a>gitlab 备份命令</h1><h2 id="通过源码安装-备份命令"><a href="#通过源码安装-备份命令" class="headerlink" title="通过源码安装-备份命令"></a>通过源码安装-备份命令</h2><p>bundle exec rake gitlab:backup:create RAILS_ENV=production</p><pre><code>注   bundle exec 是一个用于执行 Rails 或其他 Ruby 项目的命令     bundle exec rake  是一个用于执行 Ruby on Rails 项目中的 Rake 任务的命令。     Rake 是 Ruby 中一个构建工具，用于自动化任务、数据库迁移、部署等操作          bundle exec rails s     这会在 Rails 项目中启动一个本地服务器               </code></pre><h2 id="有gitlab-rake-命令工具"><a href="#有gitlab-rake-命令工具" class="headerlink" title="有gitlab-rake 命令工具"></a>有gitlab-rake 命令工具</h2><p>gitlab-rake gitlab:backup:create</p><h2 id="安装在docker中-可以用"><a href="#安装在docker中-可以用" class="headerlink" title="安装在docker中 可以用"></a>安装在docker中 可以用</h2><p>后台运行<br>sudo docker exec -d a51fe5f513bc bundle exec rake gitlab:backup:create RAILS_ENV=production</p><p>sudo docker exec a51fe5f513bc  /bin/bash -c “bundle exec rake gitlab:backup:create RAILS_ENV=production”</p><h1 id="备份所在目录"><a href="#备份所在目录" class="headerlink" title="备份所在目录"></a>备份所在目录</h1><p>通常在/var/opt/gitlab/backups目录下</p><p>在gitlab 目录下 config/gitlab.yml 有个</p><p>backup:<br>    path: “/home/git/data/backups” </p><h1 id="恢复备份"><a href="#恢复备份" class="headerlink" title="恢复备份"></a>恢复备份</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;gitlab-备份命令&quot;&gt;&lt;a href=&quot;#gitlab-备份命令&quot; class=&quot;headerlink&quot; title=&quot;gitlab 备份命令&quot;&gt;&lt;/a&gt;gitlab 备份命令&lt;/h1&gt;&lt;h2 id=&quot;通过源码安装-备份命令&quot;&gt;&lt;a href=&quot;#通过源码安装</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-fastadmin按钮弹框传数据到列表</title>
    <link href="http://example.com/posts/6df754b5.html"/>
    <id>http://example.com/posts/6df754b5.html</id>
    <published>2024-06-28T14:13:59.000Z</published>
    <updated>2024-08-08T11:55:40.498Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、实现效果"><a href="#一、实现效果" class="headerlink" title="一、实现效果"></a>一、实现效果</h1><p>点击按钮 弹出选项列表，选择列表通过table 实现的<br>难点：<br>     1.点击弹框url中传值 怎么传到列表请求中，因为table 数据是通过ajax 试下的，就麻烦了<br>     2.点击选择按钮的实现 数据的回传 接收处理</p><p><img src="../pic/dialogbox.png" alt="lena"></p><h1 id="二、按钮页面-js代码"><a href="#二、按钮页面-js代码" class="headerlink" title="二、按钮页面 js代码"></a>二、按钮页面 js代码</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#select-coupon-btn&quot;</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            parent.Fast.api.open(<span class="string">&quot;wanlshop/street_coupon/select?select_use_type=2&quot;</span>, __(<span class="string">&#x27;选择卡券&#x27;</span>), &#123;</span><br><span class="line">                <span class="attr">area</span>: [<span class="string">&#x27;800px&#x27;</span>, <span class="string">&#x27;600px&#x27;</span>],</span><br><span class="line">                <span class="attr">callback</span>: <span class="function">(<span class="params">data</span>)=&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span>(data)&#123;</span><br><span class="line">                        $(<span class="string">&quot;#coupon-table tbody tr&quot;</span>).last().remove();</span><br><span class="line">                        $(<span class="string">&quot;#send_gift&quot;</span>).val(data.id);</span><br><span class="line">                        <span class="keyword">if</span> (data.grant == -<span class="number">1</span>) &#123;</span><br><span class="line">                            data.grant = <span class="string">&quot;不限&quot;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        $(<span class="string">&quot;#coupon-table tbody&quot;</span>).last().append(<span class="string">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span>+data.name+<span class="string">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>+data.type+<span class="string">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>+data.grant+<span class="string">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="三、弹框页面"><a href="#三、弹框页面" class="headerlink" title="三、弹框页面"></a>三、弹框页面</h1><p>通过Fast.api.query(‘select_use_type’); 获取 然后加到ajax请求中</p><p>弹框页面js代码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">select</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 初始化表格参数配置</span></span><br><span class="line">    Table.api.init(&#123;</span><br><span class="line">        <span class="attr">extend</span>: &#123;</span><br><span class="line">            <span class="attr">index_url</span>: <span class="string">&#x27;wanlshop/street_coupon/select&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> urlArr = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> table = $(<span class="string">&quot;#table&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 多选的 操作</span></span><br><span class="line">    table.on(<span class="string">&#x27;check.bs.table uncheck.bs.table check-all.bs.table uncheck-all.bs.table&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e, row</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (e.type == <span class="string">&#x27;check&#x27;</span> || e.type == <span class="string">&#x27;uncheck&#x27;</span>) &#123;</span><br><span class="line">            row = [row];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            urlArr = [];</span><br><span class="line">        &#125;</span><br><span class="line">        $.each(row, <span class="function"><span class="keyword">function</span> (<span class="params">i, j</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (e.type.indexOf(<span class="string">&quot;uncheck&quot;</span>) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> index = urlArr.indexOf(j.id);</span><br><span class="line">                <span class="keyword">if</span> (index &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">                    urlArr.splice(index, <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                urlArr.indexOf(j.id) == -<span class="number">1</span> &amp;&amp; urlArr.push(j.id);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化表格</span></span><br><span class="line">    table.bootstrapTable(&#123;</span><br><span class="line">        <span class="attr">url</span>: $.fn.bootstrapTable.defaults.extend.index_url,</span><br><span class="line">        <span class="attr">sortName</span>: <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">        <span class="attr">showToggle</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">showExport</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">//是否显示右上角的搜索框</span></span><br><span class="line">        <span class="attr">search</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="comment">//控制显示列开关</span></span><br><span class="line">        <span class="attr">showColumns</span>:<span class="literal">false</span>,</span><br><span class="line">        <span class="comment">//显示搜索字段框</span></span><br><span class="line">        <span class="attr">searchFormVisible</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">showExport</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">columns</span>: [</span><br><span class="line">            [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">field</span>: <span class="string">&#x27;type&#x27;</span>,</span><br><span class="line">                    <span class="attr">title</span>: __(<span class="string">&#x27;Type&#x27;</span>),</span><br><span class="line">                    <span class="attr">searchList</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;reduction&quot;</span>: <span class="string">&quot;满减券&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;discount&quot;</span>: <span class="string">&quot;折扣券&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;daijin&quot;</span>: <span class="string">&quot;代金券&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;stopcar&quot;</span>: <span class="string">&quot;停车券&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;gift&quot;</span>: <span class="string">&quot;礼品券&quot;</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">formatter</span>: Table.api.formatter.normal</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;<span class="attr">field</span>: <span class="string">&#x27;name&#x27;</span>, <span class="attr">title</span>: __(<span class="string">&#x27;Name&#x27;</span>), <span class="attr">operate</span>: <span class="string">&#x27;LIKE&#x27;</span>&#125;,</span><br><span class="line">                &#123;<span class="attr">field</span>: <span class="string">&#x27;drawlimit&#x27;</span>, <span class="attr">title</span>: __(<span class="string">&#x27;Drawlimit&#x27;</span>)&#125;,</span><br><span class="line">                &#123;<span class="attr">field</span>: <span class="string">&#x27;grant&#x27;</span>, <span class="attr">title</span>: __(<span class="string">&#x27;Grant&#x27;</span>), <span class="attr">operate</span>: <span class="string">&#x27;LIKE&#x27;</span>,<span class="attr">formatter</span>: Controller.api.formatter.grant&#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">field</span>: <span class="string">&#x27;operate&#x27;</span>, <span class="attr">title</span>: __(<span class="string">&#x27;Operate&#x27;</span>), <span class="attr">events</span>: &#123;</span><br><span class="line">                        <span class="string">&#x27;click .btn-chooseone&#x27;</span>: <span class="function"><span class="keyword">function</span> (<span class="params">e, value, row, index</span>) </span>&#123;</span><br><span class="line">                            <span class="comment">// var multiple = Backend.api.query(&#x27;multiple&#x27;);</span></span><br><span class="line">                            <span class="comment">// multiple = multiple == &#x27;true&#x27; ? true : false;</span></span><br><span class="line">                            Fast.api.close(&#123;</span><br><span class="line">                                <span class="attr">id</span>: row.id,</span><br><span class="line">                                <span class="attr">name</span>: row.name,</span><br><span class="line">                                <span class="attr">type</span>: row.type_text,</span><br><span class="line">                                <span class="attr">drawlimit</span>: row.drawlimit,</span><br><span class="line">                                <span class="attr">grant</span>: row.grant</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;,</span><br><span class="line">                    &#125;, <span class="attr">formatter</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="string">&#x27;&lt;a href=&quot;javascript:;&quot; class=&quot;btn btn-danger btn-chooseone btn-xs&quot;&gt;&lt;i class=&quot;fa fa-check&quot;&gt;&lt;/i&gt; &#x27;</span> + __(<span class="string">&#x27;Choose&#x27;</span>) + <span class="string">&#x27;&lt;/a&gt;&#x27;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">queryParams</span>: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> filter = <span class="built_in">JSON</span>.parse(params.filter);</span><br><span class="line">            <span class="keyword">var</span> op = <span class="built_in">JSON</span>.parse(params.op);</span><br><span class="line">            <span class="keyword">var</span> select_use_type = Fast.api.query(<span class="string">&#x27;select_use_type&#x27;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (select_use_type != <span class="literal">null</span>)&#123;</span><br><span class="line">                filter.use_type= select_use_type;</span><br><span class="line">                op.use_type = <span class="string">&quot;=&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            params.filter = <span class="built_in">JSON</span>.stringify(filter);</span><br><span class="line">            params.op = <span class="built_in">JSON</span>.stringify(op);</span><br><span class="line">            <span class="keyword">return</span> params;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 为表格绑定事件</span></span><br><span class="line">    Table.api.bindevent(table);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>后端代码 parent::index() 代码服务一份相应控制器就好了</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;一、实现效果&quot;&gt;&lt;a href=&quot;#一、实现效果&quot; class=&quot;headerlink&quot; title=&quot;一、实现效果&quot;&gt;&lt;/a&gt;一、实现效果&lt;/h1&gt;&lt;p&gt;点击按钮 弹出选项列表，选择列表通过table 实现的&lt;br&gt;难点：&lt;br&gt;     1.点击弹框url中传</summary>
      
    
    
    
    <category term="PHP开发" scheme="http://example.com/categories/PHP%E5%BC%80%E5%8F%91/"/>
    
    
  </entry>
  
  <entry>
    <title>windows2012-R2发布asp网站</title>
    <link href="http://example.com/posts/dd0146de.html"/>
    <id>http://example.com/posts/dd0146de.html</id>
    <published>2024-06-25T12:22:20.000Z</published>
    <updated>2024-06-29T06:03:45.280Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一-、安装asp-net-3-5-总是失败"><a href="#一-、安装asp-net-3-5-总是失败" class="headerlink" title="一 、安装asp.net 3.5 总是失败"></a>一 、安装asp.net 3.5 总是失败</h1><p>卸载相关补丁KB5027141  KB5028872  KB5028970  KB5029915<br><img src="../pic/win2012-net.png" alt="lena"></p><h1 id="二、-应用程序池"><a href="#二、-应用程序池" class="headerlink" title="二、 应用程序池"></a>二、 应用程序池</h1><pre><code>设置为 集成  2.0 的版本【安装.net 3.5 后 这边就是只有2.0的选项哦】</code></pre><h1 id="三、总是显示500，开启报错-方便调试"><a href="#三、总是显示500，开启报错-方便调试" class="headerlink" title="三、总是显示500，开启报错 方便调试"></a>三、总是显示500，开启报错 方便调试</h1><p>双击ASP 设置</p><pre><code>将错误发送到浏览器  true</code></pre><p><img src="../pic/iis-2.png" alt="lena">  </p><h1 id="四、设置文件夹权限"><a href="#四、设置文件夹权限" class="headerlink" title="四、设置文件夹权限"></a>四、设置文件夹权限</h1><p> everyone  读写就可以了</p><p> <img src="../pic/win2012-1.png" alt="lena">     </p><h1 id="五、Win2012-Microsoft-JET-Database-Engine-错误-‘80004005’"><a href="#五、Win2012-Microsoft-JET-Database-Engine-错误-‘80004005’" class="headerlink" title="五、Win2012  Microsoft JET Database Engine 错误 ‘80004005’"></a>五、Win2012  Microsoft JET Database Engine 错误 ‘80004005’</h1><pre><code>access 数据库没有权限访问设置c:/windows/temp或者%windir%/temp/erveryone  读写权限就可以了</code></pre><h1 id="六、IIS给网站配置https证书"><a href="#六、IIS给网站配置https证书" class="headerlink" title="六、IIS给网站配置https证书"></a>六、IIS给网站配置https证书</h1><h2 id="6-1导入入证书"><a href="#6-1导入入证书" class="headerlink" title="6.1导入入证书"></a>6.1导入入证书</h2><p><img src="../pic/iis-3.png" alt="lena"></p><h2 id="6-2配置证书"><a href="#6-2配置证书" class="headerlink" title="6.2配置证书"></a>6.2配置证书</h2><p><img src="../pic/iis-1.png" alt="lena"></p><h1 id="七、IIS限制上传配置"><a href="#七、IIS限制上传配置" class="headerlink" title="七、IIS限制上传配置"></a>七、IIS限制上传配置</h1><p>修改ASP 配置中 限制属性<br><img src="../pic/iis8-file-3.png" alt="lena"></p><p>网站中的配置修改(没配置项，可不配置)<br>在“节”选项下找到system.webServer/security/requestFiltering节。<br><img src="../pic/iis8-file-1.png" alt="lena"></p><p><img src="../pic/iis8-file-2.png" alt="lena"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;一-、安装asp-net-3-5-总是失败&quot;&gt;&lt;a href=&quot;#一-、安装asp-net-3-5-总是失败&quot; class=&quot;headerlink&quot; title=&quot;一 、安装asp.net 3.5 总是失败&quot;&gt;&lt;/a&gt;一 、安装asp.net 3.5 总是失败&lt;/</summary>
      
    
    
    
    <category term="服务器相关" scheme="http://example.com/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3/"/>
    
    
  </entry>
  
</feed>
