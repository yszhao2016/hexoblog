<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>yszhao的博客</title>
  
  <subtitle>记录我的生活 学习</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-11-25T11:16:59.825Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>yszhao</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>linux-screen软件应用</title>
    <link href="http://example.com/posts/87fcad5d.html"/>
    <id>http://example.com/posts/87fcad5d.html</id>
    <published>2024-11-25T11:00:26.000Z</published>
    <updated>2024-11-25T11:16:59.825Z</updated>
    
    
    
    
    <category term="服务器相关" scheme="http://example.com/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3/"/>
    
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>php开发-使用OpenSSL进程DES加密</title>
    <link href="http://example.com/posts/28dcf7b8.html"/>
    <id>http://example.com/posts/28dcf7b8.html</id>
    <published>2024-11-17T09:10:10.000Z</published>
    <updated>2024-11-18T11:12:11.497Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、遇到问题DES-加密返回空"><a href="#一、遇到问题DES-加密返回空" class="headerlink" title="一、遇到问题DES 加密返回空"></a>一、遇到问题DES 加密返回空</h1><h2 id="1-1加密代码"><a href="#1-1加密代码" class="headerlink" title="1.1加密代码"></a>1.1加密代码</h2><pre><code>bin2hex(openssl_encrypt($str, &#39;DES-ECB&#39;, $this-&gt;appSecret, OPENSSL_RAW_DATA));</code></pre><h2 id="1-2-解决方案"><a href="#1-2-解决方案" class="headerlink" title="1.2 解决方案"></a>1.2 解决方案</h2><p>1.检查 openssl 库是否安装</p><p> php -m|grep openssl</p><p>2.过 <font color="red">openssl_error_string() </font>调试代码 处理</p><h2 id="1-3报错-【error-0308010C-digital-envelope-routines-unsupported】"><a href="#1-3报错-【error-0308010C-digital-envelope-routines-unsupported】" class="headerlink" title="1.3报错 【error:0308010C:digital envelope routines::unsupported】"></a>1.3报错 【error:0308010C:digital envelope routines::unsupported】</h2><p><font color="red">原因是: 服务器上的openssl是1.1版本, 本地是3.0版本</font></p><p>找到 openssl.cnf文件</p><p>可以通过phpinfo找到openssl.cnf 或者 php -i|grep  openssl.cnf</p><p>找到[provider_sect]并将其更改为以下内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[provider_sect]</span><br><span class="line">default = default_sect</span><br><span class="line">legacy = legacy_sect</span><br></pre></td></tr></table></figure><p>找到[default_sect]并将其更改为以下内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[default_sect]</span><br><span class="line">activate = 1</span><br><span class="line">[legacy_sect]</span><br><span class="line">activate = 1</span><br></pre></td></tr></table></figure><h1 id="二、DES加密、解密php中使用"><a href="#二、DES加密、解密php中使用" class="headerlink" title="二、DES加密、解密php中使用"></a>二、DES加密、解密php中使用</h1><h2 id="2-1"><a href="#2-1" class="headerlink" title="2.1"></a>2.1</h2><p>加密模式：DES-ECB<br>填充模式：PKCS#7 </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pkcs#7</span></span><br><span class="line">bin2hex(openssl_encrypt(<span class="string">&quot;加密字符串&quot;</span>, <span class="string">&#x27;DES-ECB&#x27;</span>, <span class="string">&quot;key字符串&quot;</span>, OPENSSL_RAW_DATA));</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$key</span> = str_pad(<span class="variable">$key</span>,<span class="number">24</span>,<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">bin2hex(openssl_encrypt(<span class="string">&quot;加密字符串&quot;</span>, <span class="string">&#x27;DES-ECB&#x27;</span>, <span class="string">&quot;key字符串&quot;</span>, OPENSSL_RAW_DATA));</span><br><span class="line"></span><br><span class="line"><span class="variable">$encrypted</span> = pack(<span class="string">&#x27;H*&#x27;</span>, <span class="variable">$info</span>);</span><br><span class="line"><span class="variable">$key</span> = str_pad(<span class="variable">$key</span>,<span class="number">24</span>,<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="2-2"><a href="#2-2" class="headerlink" title="2.2"></a>2.2</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;一、遇到问题DES-加密返回空&quot;&gt;&lt;a href=&quot;#一、遇到问题DES-加密返回空&quot; class=&quot;headerlink&quot; title=&quot;一、遇到问题DES 加密返回空&quot;&gt;&lt;/a&gt;一、遇到问题DES 加密返回空&lt;/h1&gt;&lt;h2 id=&quot;1-1加密代码&quot;&gt;&lt;a h</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-laravel中间件开发应用</title>
    <link href="http://example.com/posts/99fb5d5d.html"/>
    <id>http://example.com/posts/99fb5d5d.html</id>
    <published>2024-10-18T05:52:43.000Z</published>
    <updated>2024-10-18T05:57:10.602Z</updated>
    
    
    
    
    <category term="PHP开发" scheme="http://example.com/categories/PHP%E5%BC%80%E5%8F%91/"/>
    
    
  </entry>
  
  <entry>
    <title>微信开发-授权登录（小程序登录/网页授权登录）</title>
    <link href="http://example.com/posts/71fe1155.html"/>
    <id>http://example.com/posts/71fe1155.html</id>
    <published>2024-10-18T05:51:41.000Z</published>
    <updated>2024-10-21T08:39:11.625Z</updated>
    
    <content type="html"><![CDATA[<h1 id="微信网页授权登录"><a href="#微信网页授权登录" class="headerlink" title="微信网页授权登录"></a>微信网页授权登录</h1><h2 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h2><p>H5、App 等微信授权登录</p><h2 id="接口文档地址"><a href="#接口文档地址" class="headerlink" title="接口文档地址"></a>接口文档地址</h2><p> <a href="https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html#0">https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html#0</a></p><h2 id="网页授权流程"><a href="#网页授权流程" class="headerlink" title="网页授权流程"></a>网页授权流程</h2><p>一、引导用户进入授权页面同意授权，获取code</p><p>二、通过code换取网页授权access_token（与基础支持中的access_token不同）</p><p>三、 如果需要，开发者可以刷新网页授权access_token，避免过期</p><p> 四、通过网页授权access_token和openid获取用户基本信息（支持UnionID机制）  </p><h2 id="接口设计"><a href="#接口设计" class="headerlink" title="接口设计"></a>接口设计</h2><p>第一步 用户授权页面 多是前端调起</p><p>在确保微信公众账号拥有授权作用域（scope参数）的权限的前提下<br>（已认证服务号，默认拥有scope参数中的snsapi_base和snsapi_userinfo 权限），引导关注者打开如下页面：</p><p><a href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE#wechat_redirect">https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE#wechat_redirect</a></p><p>第二步就是跳到后端设计的接口<br>接口传参数就是code  grant_type<br>后端接口中实现授权 流程中 2~4 步骤 实现授权登录</p><h1 id=""><a href="#" class="headerlink" title=""></a></h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;微信网页授权登录&quot;&gt;&lt;a href=&quot;#微信网页授权登录&quot; class=&quot;headerlink&quot; title=&quot;微信网页授权登录&quot;&gt;&lt;/a&gt;微信网页授权登录&lt;/h1&gt;&lt;h2 id=&quot;用途&quot;&gt;&lt;a href=&quot;#用途&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    <category term="微信开发" scheme="http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/"/>
    
    
  </entry>
  
  <entry>
    <title>openEuler系统安装问题总结</title>
    <link href="http://example.com/posts/6c1c44d1.html"/>
    <id>http://example.com/posts/6c1c44d1.html</id>
    <published>2024-09-05T09:54:37.000Z</published>
    <updated>2024-09-05T10:02:16.910Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安装-zip-扩展失败报错"><a href="#安装-zip-扩展失败报错" class="headerlink" title="安装 zip 扩展失败报错"></a>安装 zip 扩展失败报错</h1><p>报错如下</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">yum install php73-php-zip</span><br><span class="line"> </span><br><span class="line">Last metadata expiration check: <span class="number">2</span>:<span class="number">08</span>:<span class="number">24</span> ago on Thu <span class="number">05</span> Sep <span class="number">2024</span> <span class="number">03</span>:<span class="number">23</span>:<span class="number">50</span> PM CST.</span><br><span class="line"><span class="attr">Error</span>: </span><br><span class="line"> Problem: package php73-php-pecl-zip-<span class="number">1.22</span><span class="number">.3</span>-<span class="number">1.</span>el7.remi.x86_64 requires libzip5(x86-<span class="number">64</span>) &gt;= <span class="number">1.10</span><span class="number">.1</span>, but none <span class="keyword">of</span> the providers can be installed</span><br><span class="line">  - cannot install the best candidate <span class="keyword">for</span> the job</span><br><span class="line">  - package libzip5-<span class="number">1.10</span><span class="number">.1</span>-<span class="number">1.</span>el7.remi.x86_64 is filtered out by modular filtering</span><br><span class="line">(<span class="keyword">try</span> to add <span class="string">&#x27;--skip-broken&#x27;</span> to skip uninstallable packages or <span class="string">&#x27;--nobest&#x27;</span> to use not only best candidate packages)   </span><br></pre></td></tr></table></figure><p>解决方法：</p><p>在/etc/yum.conf文件中追加设置默认platform id，‌如：‌module_platform_id=platform:f30。‌<br>再次执行dnf makecache，‌错误不再出现。‌‌12<br>‌Modular dependency problems 解决方案‌</p><p>‌问题描述‌：‌存在模块依赖问题，‌如module(platform:el8)无法被提供。‌<br>‌解决途径‌：‌<br>检查并确保所有需要的模块和它们的依赖已正确安装。‌<br>尝试在/etc/yum.repos.d/xx.repo中添加module_hotfixes=1，‌以解决模块依赖问题。‌‌2</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;安装-zip-扩展失败报错&quot;&gt;&lt;a href=&quot;#安装-zip-扩展失败报错&quot; class=&quot;headerlink&quot; title=&quot;安装 zip 扩展失败报错&quot;&gt;&lt;/a&gt;安装 zip 扩展失败报错&lt;/h1&gt;&lt;p&gt;报错如下&lt;/p&gt;
&lt;figure class=&quot;hi</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-ASN编码</title>
    <link href="http://example.com/posts/b6482428.html"/>
    <id>http://example.com/posts/b6482428.html</id>
    <published>2024-09-03T09:03:54.000Z</published>
    <updated>2024-10-18T06:03:46.445Z</updated>
    
    
    
    
    <category term="PHP开发" scheme="http://example.com/categories/PHP%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="加密技术" scheme="http://example.com/tags/%E5%8A%A0%E5%AF%86%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title>php开发-国秘加密(sm2/sm3/sm4)</title>
    <link href="http://example.com/posts/6aa2955a.html"/>
    <id>http://example.com/posts/6aa2955a.html</id>
    <published>2024-09-03T09:00:31.000Z</published>
    <updated>2024-11-25T11:34:45.198Z</updated>
    
    
    
    
    <category term="PHP开发" scheme="http://example.com/categories/PHP%E5%BC%80%E5%8F%91/"/>
    
    
  </entry>
  
  <entry>
    <title>php开发-laravel中的服务容器</title>
    <link href="http://example.com/posts/b61a700f.html"/>
    <id>http://example.com/posts/b61a700f.html</id>
    <published>2024-08-16T07:18:09.000Z</published>
    <updated>2024-10-18T06:04:10.398Z</updated>
    
    
    
    
    <category term="PHP开发" scheme="http://example.com/categories/PHP%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="laravel" scheme="http://example.com/tags/laravel/"/>
    
  </entry>
  
  <entry>
    <title>php开发-多进程应用</title>
    <link href="http://example.com/posts/fef50030.html"/>
    <id>http://example.com/posts/fef50030.html</id>
    <published>2024-08-16T06:46:15.000Z</published>
    <updated>2024-11-25T11:34:42.175Z</updated>
    
    
    
    
    <category term="PHP开发" scheme="http://example.com/categories/PHP%E5%BC%80%E5%8F%91/"/>
    
    
  </entry>
  
  <entry>
    <title>php开发-设计模式之容器(container)</title>
    <link href="http://example.com/posts/aa1b125a.html"/>
    <id>http://example.com/posts/aa1b125a.html</id>
    <published>2024-08-15T11:58:22.000Z</published>
    <updated>2024-11-25T11:34:20.218Z</updated>
    
    <content type="html"><![CDATA[<h1 id="控制反转-IOC"><a href="#控制反转-IOC" class="headerlink" title="控制反转(IOC)"></a>控制反转(IOC)</h1><p> 含义：原来由人为（程序员）修改代码 控制流程，反转为由程序【框架】去控制<br> 控制反转(Inversion of Control) 是一种设计思想</p><p>没反转的情况(正转)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">commit</span>(<span class="params"><span class="variable">$supplierName</span></span>)</span></span><br><span class="line"><span class="function">     </span>&#123;</span><br><span class="line">        <span class="comment">// 去判断需要用哪个上游供应商，然后实例化</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$supplierName</span> == <span class="string">&quot;pushang&quot;</span>)&#123;</span><br><span class="line">           <span class="variable">$supplier</span> = <span class="keyword">new</span> PuShangSupplier(); </span><br><span class="line">           <span class="variable">$supplier</span>-&gt;commit();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">     &#125;</span><br><span class="line">    </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>反转后的情况（反转）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Supplier</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">   <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">commit</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PuShangSupplier</span> <span class="title">extend</span> <span class="title">Supplier</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">commit</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 逻辑</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">commit</span>(<span class="params">Supplier <span class="variable">$supplier</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable">$supplier</span>-&gt;commit();</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$app</span> = <span class="keyword">new</span> Application();</span><br><span class="line"><span class="variable">$app</span>-&gt;commit(<span class="keyword">new</span> PuShangSupplier());</span><br></pre></td></tr></table></figure><h1 id="依赖注入-DI"><a href="#依赖注入-DI" class="headerlink" title="依赖注入(DI)"></a>依赖注入(DI)</h1><p>依赖注入 是一种设计模式<br>依赖注入是控制反转的一种实现方式/方法<br>也就是依赖注入 实现了  控制反转</p><p>依赖注入方式 1、构造方法注入；2、set属性注入__set；3、静态工厂方法注入；</p><p>一旦换了平台，就要修改构造函数 即使你传参数 构造判断使用哪个类，新增了平台，你还有去修改A类构造方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ob</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">C <span class="variable">$c</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ob = <span class="keyword">new</span> Aly();</span><br><span class="line">      <span class="comment">//  $this-&gt;ob = new Txy();</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">send</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ob-&gt;send();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 实现阿里云</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Aly</span></span>&#123;&#125;</span><br><span class="line"><span class="comment">// 实现腾讯云</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Txy</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> A();</span><br><span class="line"><span class="variable">$a</span>-&gt;send();</span><br></pre></td></tr></table></figure><p>通过构造函数注入 依赖</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ob</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">C <span class="variable">$c</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ob = <span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">send</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ob-&gt;send();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Aly</span></span>&#123;</span><br><span class="line"><span class="comment">// 实现阿里云发送短信类</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$notice</span> = <span class="keyword">new</span> A(<span class="keyword">new</span> Aly());</span><br><span class="line"><span class="variable">$notice</span>-&gt;send();</span><br></pre></td></tr></table></figure><h1 id="IoC容器"><a href="#IoC容器" class="headerlink" title="IoC容器"></a>IoC容器</h1><p>将依赖的对象注入到容器中<br>当需要某个对象的时候，就直接获取，不必关注其实例化需要些什么，容器自动实例化了<br>运行时容器会自动解析依赖（存在子依赖也可以自动解析）</p> <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Container</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$i</span>=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$s</span> = <span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$k</span>, <span class="variable">$c</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;s[<span class="variable">$k</span>] = <span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$k</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;build(<span class="keyword">$this</span>-&gt;s[<span class="variable">$k</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 自动绑定（Autowiring）自动解析（Automatic Resolution）</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $className</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> object</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">build</span>(<span class="params"><span class="variable">$className</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 如果是匿名函数（Anonymous functions），也叫闭包函数（closures）</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$className</span> <span class="keyword">instanceof</span> <span class="built_in">Closure</span>) &#123;</span><br><span class="line"><span class="comment">//            var_dump($className);exit;</span></span><br><span class="line">            <span class="comment">// 执行闭包函数，并将结果</span></span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$className</span>(<span class="keyword">$this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*通过反射获取类的内部结构，实例化类*/</span></span><br><span class="line">        <span class="variable">$reflector</span> = <span class="keyword">new</span> ReflectionClass(<span class="variable">$className</span>);</span><br><span class="line">        <span class="comment">// 检查类是否可实例化, 排除抽象类abstract和对象接口interface</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$reflector</span>-&gt;isInstantiable()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Can&#x27;t instantiate this.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/** <span class="doctag">@var</span> ReflectionMethod $constructor 获取类的构造函数 */</span></span><br><span class="line">        <span class="variable">$constructor</span> = <span class="variable">$reflector</span>-&gt;getConstructor();</span><br><span class="line">        <span class="comment">// 若无构造函数，直接实例化并返回</span></span><br><span class="line">        <span class="keyword">if</span> (is_null(<span class="variable">$constructor</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="variable">$className</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 取构造函数参数,通过 ReflectionParameter 数组返回参数列表</span></span><br><span class="line">        <span class="variable">$parameters</span> = <span class="variable">$constructor</span>-&gt;getParameters();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 递归解析构造函数的参数</span></span><br><span class="line">        <span class="variable">$dependencies</span> = <span class="keyword">$this</span>-&gt;getDependencies(<span class="variable">$parameters</span>);</span><br><span class="line">        <span class="comment">// 创建一个类的新实例，给出的参数将传递到类的构造函数。</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$reflector</span>-&gt;newInstanceArgs(<span class="variable">$dependencies</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $parameters</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDependencies</span>(<span class="params"><span class="variable">$parameters</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$dependencies</span> = [];</span><br><span class="line">        <span class="comment">/** <span class="doctag">@var</span> ReflectionParameter $parameter */</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$parameters</span> <span class="keyword">as</span> <span class="variable">$parameter</span>) &#123;</span><br><span class="line">            <span class="comment">/** <span class="doctag">@var</span> ReflectionClass $dependency */</span></span><br><span class="line">            <span class="variable">$dependency</span> = <span class="variable">$parameter</span>-&gt;getClass();</span><br><span class="line">            <span class="keyword">if</span> (is_null(<span class="variable">$dependency</span>)) &#123;</span><br><span class="line">                <span class="comment">// 是变量,有默认值则设置默认值</span></span><br><span class="line">                <span class="variable">$dependencies</span>[] = <span class="keyword">$this</span>-&gt;resolveNonClass(<span class="variable">$parameter</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 是一个类，递归解析</span></span><br><span class="line">                <span class="variable">$dependencies</span>[] = <span class="keyword">$this</span>-&gt;build(<span class="variable">$dependency</span>-&gt;name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$dependencies</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ReflectionParameter $parameter</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> mixed</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">resolveNonClass</span>(<span class="params"><span class="variable">$parameter</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 有默认值则返回默认值</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$parameter</span>-&gt;isDefaultValueAvailable()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$parameter</span>-&gt;getDefaultValue();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;I have no idea what to do here.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&quot;./testclass.php&quot;</span>; <span class="comment">//开始测试，先测试已知依赖关系的情况</span></span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> Container();</span><br><span class="line"><span class="variable">$c</span>-&gt;department = <span class="string">&#x27;Department&#x27;</span>;<span class="comment">// 赋值类名 或 匿名函数</span></span><br><span class="line"><span class="variable">$c</span>-&gt;company = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$c</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Company(<span class="variable">$c</span>-&gt;department);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 从容器中取得company</span></span><br><span class="line"><span class="variable">$company</span> = <span class="variable">$c</span>-&gt;company;</span><br><span class="line"><span class="variable">$company</span>-&gt;doSomething(); <span class="comment">//输出: Group:hello|Department:hello|Company:hello|</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试未知依赖关系，直接使用的方法</span></span><br><span class="line"><span class="variable">$di</span> = <span class="keyword">new</span> Container();</span><br><span class="line"><span class="variable">$di</span>-&gt;company = <span class="string">&#x27;Company&#x27;</span>;<span class="comment">// 赋值类名 或 匿名函数</span></span><br><span class="line"><span class="variable">$company</span> = <span class="variable">$di</span>-&gt;company;</span><br><span class="line"><span class="variable">$company</span>-&gt;doSomething();<span class="comment">//输出: Group:hello|Department:hello|Company:hello|</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="comment">//依赖关系：Company-&gt;Department-&gt;Group</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Group</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">__CLASS__</span>.<span class="string">&quot;:&quot;</span>.<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;|&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Department</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$group</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Group <span class="variable">$group</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;group = <span class="variable">$group</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;group-&gt;doSomething();</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">__CLASS__</span>.<span class="string">&quot;:&quot;</span>.<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;|&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Company</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$department</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Department <span class="variable">$department</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;department = <span class="variable">$department</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;department-&gt;doSomething();</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">__CLASS__</span>.<span class="string">&quot;:&quot;</span>.<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;|&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;控制反转-IOC&quot;&gt;&lt;a href=&quot;#控制反转-IOC&quot; class=&quot;headerlink&quot; title=&quot;控制反转(IOC)&quot;&gt;&lt;/a&gt;控制反转(IOC)&lt;/h1&gt;&lt;p&gt; 含义：原来由人为（程序员）修改代码 控制流程，反转为由程序【框架】去控制&lt;br&gt; 控制</summary>
      
    
    
    
    <category term="PHP开发" scheme="http://example.com/categories/PHP%E5%BC%80%E5%8F%91/"/>
    
    
  </entry>
  
  <entry>
    <title>php开发-工行支付接口对接</title>
    <link href="http://example.com/posts/11955b14.html"/>
    <id>http://example.com/posts/11955b14.html</id>
    <published>2024-08-15T11:10:02.000Z</published>
    <updated>2024-11-25T11:34:48.619Z</updated>
    
    
    
    
    <category term="PHP开发" scheme="http://example.com/categories/PHP%E5%BC%80%E5%8F%91/"/>
    
    
  </entry>
  
  <entry>
    <title>php开发-海康视频接口对接</title>
    <link href="http://example.com/posts/cc90e6c9.html"/>
    <id>http://example.com/posts/cc90e6c9.html</id>
    <published>2024-08-15T11:09:37.000Z</published>
    <updated>2024-11-25T11:34:23.084Z</updated>
    
    
    
    
    <category term="PHP开发" scheme="http://example.com/categories/PHP%E5%BC%80%E5%8F%91/"/>
    
    
  </entry>
  
  <entry>
    <title>php开发-根据设置的概率抽奖</title>
    <link href="http://example.com/posts/84d7639f.html"/>
    <id>http://example.com/posts/84d7639f.html</id>
    <published>2024-08-15T10:48:19.000Z</published>
    <updated>2024-11-25T11:34:35.911Z</updated>
    
    
    
    
    <category term="PHP开发" scheme="http://example.com/categories/PHP%E5%BC%80%E5%8F%91/"/>
    
    
  </entry>
  
  <entry>
    <title>php开发-fastadmin中搜索日期时间的处理</title>
    <link href="http://example.com/posts/cb6a68f0.html"/>
    <id>http://example.com/posts/cb6a68f0.html</id>
    <published>2024-08-13T11:22:27.000Z</published>
    <updated>2024-10-18T06:05:08.772Z</updated>
    
    <content type="html"><![CDATA[<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>在使用FastAdmin时，遇到日期时间搜索的问题，JS中的RANGE或BETWEEN操作生成的SQL总是针对时间戳的区间查询。<br>通过分析代码发现，RANGE操作符会自动转为BETWEEN TIME，而BETWEEN操作符在含有datetimepicker样式的输入框中会被强制转换为RANGE。<br>为了解决这个问题，屏蔽了bootstrap-table-commonsearch.js中将operate置为RANGE的代码段，<br>实现了对日期时间的正确搜索</p><p>正常一般这么写</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">field</span>: <span class="string">&#x27;notice_time&#x27;</span>,<span class="attr">title</span>: <span class="string">&quot;通知时间&quot;</span>,<span class="attr">operate</span>: <span class="string">&#x27;Range&#x27;</span>,<span class="attr">addclass</span>: <span class="string">&#x27;datetimerange&#x27;</span>,<span class="attr">formatter</span>: Table.api.formatter.datetime,<span class="attr">data</span>:<span class="string">&#x27;data-date-format=&quot;YYYY-MM-DD&quot;&#x27;</span>&#125;,</span><br></pre></td></tr></table></figure><p>fastadmin 后端处理 BETWEEN TIME</p><p>也就是把搜索条件值转换为时间戳  进行between 搜索</p><p>当notice_time 存的是“xxxx-xx-xx”格式 就搜索不到</p><p>那就只能用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">field</span>: <span class="string">&#x27;notice_time&#x27;</span>,<span class="attr">title</span>: <span class="string">&quot;通知时间&quot;</span>,<span class="attr">operate</span>: <span class="string">&#x27;BETWEEN&#x27;</span>,<span class="attr">addclass</span>: <span class="string">&#x27;datetimepicker&#x27;</span>,<span class="attr">formatter</span>: Table.api.formatter.datetime,<span class="attr">data</span>:<span class="string">&#x27;data-date-format=&quot;YYYY-MM-DD&quot;&#x27;</span>&#125;,</span><br></pre></td></tr></table></figure><p>但是bootstrap-table-commonsearch.js 中有将datetimepicker样式的operate字段  强制转为Range了</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ($(<span class="string">&quot;[name=&#x27;&quot;</span> + name + <span class="string">&quot;&#x27;]:first&quot;</span>, that.$commonsearch).hasClass(<span class="string">&quot;datetimepicker&quot;</span>)) &#123;</span><br><span class="line">                     sym = <span class="string">&#x27;RANGE&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><h2 id="方案一"><a href="#方案一" class="headerlink" title="方案一"></a>方案一</h2><p>bootstrap-table-commonsearch.js 中这段代码注释</p><p>重新生成bootstrap-table-commonsearch.min.js</p><p> php think min -m backend -r all</p><p> 或者直接修改bootstrap-table-commonsearch.min.js</p><h2 id="方案二"><a href="#方案二" class="headerlink" title="方案二"></a>方案二</h2><p>修改数据库字段类型 存储时间戳</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;问题&quot;&gt;&lt;a href=&quot;#问题&quot; class=&quot;headerlink&quot; title=&quot;问题&quot;&gt;&lt;/a&gt;问题&lt;/h1&gt;&lt;p&gt;在使用FastAdmin时，遇到日期时间搜索的问题，JS中的RANGE或BETWEEN操作生成的SQL总是针对时间戳的区间查询。&lt;br&gt;通过</summary>
      
    
    
    
    <category term="PHP开发" scheme="http://example.com/categories/PHP%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="fastadmin" scheme="http://example.com/tags/fastadmin/"/>
    
  </entry>
  
  <entry>
    <title>商城开发-拼团功能开发设计</title>
    <link href="http://example.com/posts/701fec33.html"/>
    <id>http://example.com/posts/701fec33.html</id>
    <published>2024-08-12T07:24:12.000Z</published>
    <updated>2024-08-12T07:42:56.263Z</updated>
    
    <content type="html"><![CDATA[<h1 id="功能需求描述"><a href="#功能需求描述" class="headerlink" title="功能需求描述"></a>功能需求描述</h1><h1 id="数据库表设计"><a href="#数据库表设计" class="headerlink" title="数据库表设计"></a>数据库表设计</h1><p>fa_wanlshop_groups  拼团表</p><p>id    int    10    0    0    0    -1    0                ID                    0    0    0    0    -1    -1    0<br>group_no    varchar    32    0    0    0    0    0                拼团号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>user_id    int    10    0    0    0    0    0            0    团长ID                    0    0    0    0    0    0    0<br>shop_id    int    10    0    0    0    0    0            0    所属商家                    0    0    0    0    0    0    0<br>goods_id    int    10    0    0    0    0    0            0    所属商品                    0    0    0    0    0    0    0<br>group_type    enum    0    0    0    0    0    0        ‘alone’,’group’,’ladder’        拼团类型:alone=直购,group=拼团,ladder=阶梯拼团            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>is_ladder    tinyint    1    0    0    0    0    0            0    是否阶梯拼团                    0    0    0    0    0    0    0<br>ladder_id    int    10    0    0    0    0    0            0    阶梯ID                    0    0    0    0    0    0    0<br>people_num    int    10    0    0    0    0    0            0    成团人数                    0    0    0    0    0    0    0<br>join_num    int    10    0    0    0    0    0            0    参团人数                    0    0    0    0    0    0    0<br>state    enum    0    0    0    0    0    0        ‘ready’,’start’,’success’,’fail’,’auto’    ‘ready’    拼团状态:ready=准备中,start=拼团中,success=已成团,fail=拼团失败,auto=自动成团            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>createtime    int    10    0    -1    0    0    0                开团时间                    0    0    0    0    0    0    0<br>grouptime    int    10    0    -1    0    0    0                成团时间                    0    0    0    0    0    0    0<br>validitytime    int    10    0    -1    0    0    0                有效时间                    0    0    0    0    0    0    0<br>updatetime    int    10    0    -1    0    0    0                更新时间                    0    0    0    0    0    0    0<br>deletetime    int    10    0    -1    0    0    0                删除时间                    0    0    0    0    0    0    0<br>status    enum    0    0    -1    0    0    0        ‘normal’,’hidden’    ‘normal’    状态            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0</p><p>fa_wanlshop_groups_goods 拼团商品表</p><p>id    int    10    0    0    0    -1    0                ID                    0    0    0    0    -1    -1    0<br>shop_id    int    10    0    -1    0    0    0            0    店铺ID                    0    0    0    0    0    -1    0<br>shop_category_id    varchar    100    0    -1    0    0    0                店铺内类目            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>category_id    int    10    0    0    0    0    0            0    商品类目                    0    0    0    0    0    -1    0<br>brand_id    int    10    0    -1    0    0    0            0    品牌ID                    0    0    0    0    0    -1    0<br>category_attribute    longtext    0    0    -1    0    0    0                类目属性            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>title    varchar    100    0    0    0    0    0                商品标题            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>image    varchar    100    0    0    0    0    0                商品主图            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>images    varchar    1500    0    0    0    0    0                产品相册            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>description    varchar    255    0    0    0    0    0                商品描述            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>is_alone    tinyint    1    0    0    0    0    0            1    是否显示单购是:0=否,1=是                    0    0    0    0    0    0    0<br>people_num    int    3    0    -1    0    0    0            0    组团人数                    0    0    0    0    0    0    0<br>groups_num    int    3    0    -1    0    0    0            0    成团人数                    0    0    0    0    0    0    0<br>is_ladder    tinyint    1    0    0    0    0    0            0    开启阶梯团:0=否,1=是                    0    0    0    0    0    0    0<br>group_hour    int    10    0    0    0    0    0            24    组团限时(小时)                    0    0    0    0    0    0    0<br>purchase_limit    int    6    0    0    0    0    0            0    个人购买次数限制，默认是0，没有次数限制                    0    0    0    0    0    0    0<br>is_discount    tinyint    1    0    0    0    0    0            0    是否显示团长优惠是:0=否,1=是                    0    0    0    0    0    0    0<br>discount_type    tinyint    1    0    0    0    0    0            0    团长优惠类型:0=金额,1=百分百                    0    0    0    0    0    0    0<br>discount    float    10    2    -1    0    0    0            0.00    优惠金额/折扣                    0    0    0    0    0    0    0<br>flag    set    0    0    0    0    0    0        ‘hot’,’index’,’recommend’        标志(多选):hot=热门,index=首页,recommend=推荐            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>stock    enum    0    0    0    0    0    0        ‘porder’,’payment’    ‘porder’    库存计算方式:porder=下单减库存,payment=付款减库存            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>content    longtext    0    0    0    0    0    0                商品详情            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>freight_id    int    10    0    0    0    0    0            0    运费模板                    0    0    0    0    0    -1    0<br>grounding    tinyint    1    0    0    0    0    0            0    上架状态                    0    0    0    0    0    0    0<br>specs    enum    0    0    0    0    0    0        ‘single’,’multi’    ‘single’    商品规格:single=单规格,multi=多规格            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>distribution    enum    0    0    0    0    0    0        ‘true’,’false’    ‘false’    是否独立分销:true=开启,false=关闭            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>activity    enum    0    0    0    0    0    0        ‘true’,’false’    ‘false’    是否活动中:true=是,false=否            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>views    int    10    0    0    0    0    0            0    点击                    0    0    0    0    0    -1    0<br>price    decimal    10    2    -1    0    0    0            0.00    产品价格                    0    0    0    0    0    0    0<br>sales    int    10    0    0    0    0    0            0    销量                    0    0    0    0    0    -1    0<br>payment    int    10    0    0    0    0    0            0    付款人数                    0    0    0    0    0    -1    0<br>comment    int    10    0    0    0    0    0            0    评论                    0    0    0    0    0    -1    0<br>praise    int    10    0    0    0    0    0            0    好评                    0    0    0    0    0    -1    0<br>moderate    int    10    0    0    0    0    0            0    中评                    0    0    0    0    0    -1    0<br>negative    int    10    0    0    0    0    0            0    差评                    0    0    0    0    0    -1    0<br>like    int    10    0    0    0    0    0            0    收藏                    0    0    0    0    0    -1    0<br>weigh    int    10    0    0    0    0    0            0    权重                    0    0    0    0    0    0    0<br>createtime    int    10    0    -1    0    0    0                创建时间                    0    0    0    0    0    0    0<br>updatetime    int    10    0    -1    0    0    0                更新时间                    0    0    0    0    0    0    0<br>deletetime    int    10    0    -1    0    0    0                删除时间                    0    0    0    0    0    0    0<br>status    enum    0    0    -1    0    0    0        ‘normal’,’hidden’    ‘normal’    状态            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0</p><p>fa_wanlshop_groups_team  拼团记录表</p><p>id    int    10    0    0    0    -1    0                ID                    0    0    0    0    -1    -1    0<br>group_no    varchar    32    0    0    0    0    0                拼团号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>user_id    int    10    0    0    0    0    0            0    用户ID                    0    0    0    0    0    0    0<br>shop_id    int    10    0    0    0    0    0            0    所属商家ID                    0    0    0    0    0    0    0<br>order_id    int    10    0    0    0    0    0            0    订单ID                    0    0    0    0    0    0    0<br>order_goods_id    int    10    0    0    0    0    0            0    订单商品ID                    0    0    0    0    0    0    0<br>username    varchar    32    0    -1    0    0    0                快递号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>nickname    varchar    50    0    -1    0    0    0                快递号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>avatar    varchar    255    0    -1    0    0    0                快递号            utf8mb4    utf8mb4_unicode_ci    0    0    0    0    0    0    0<br>createtime    int    10    0    -1    0    0    0                参团时间                    0    0    0    0    0    0    0<br>updatetime    int    10    0    -1    0    0    0                更新时间                    0    0    0    0    0    0    0<br>deletetime    int    10    0    -1    0    0    0                删除时间                    0    0    0    0    0    0    0</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;功能需求描述&quot;&gt;&lt;a href=&quot;#功能需求描述&quot; class=&quot;headerlink&quot; title=&quot;功能需求描述&quot;&gt;&lt;/a&gt;功能需求描述&lt;/h1&gt;&lt;h1 id=&quot;数据库表设计&quot;&gt;&lt;a href=&quot;#数据库表设计&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>商城开发-SPU和SKU数据结构设计</title>
    <link href="http://example.com/posts/ce3caa74.html"/>
    <id>http://example.com/posts/ce3caa74.html</id>
    <published>2024-08-12T06:24:31.000Z</published>
    <updated>2024-08-12T07:25:41.240Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、SPU和SKU"><a href="#一、SPU和SKU" class="headerlink" title="一、SPU和SKU"></a>一、SPU和SKU</h1><p>SPU：Standard Product Unit （标准产品单位） ，一组具有共同属性的商品集</p><p>示例 如奶茶商品中的 容量  大 、中 、小 杯<br>     如奶茶商品中   甜度  少糖 标准  加糖</p><p>SKU：Stock Keeping Unit（库存量单位），SPU商品集因具体特性不同而细分的每个商品</p><p>示例 如奶茶商品中 【就是 容量 与 甜度 的排列组合】</p><pre><code>    大杯  少糖    中杯  少糖    小杯  少糖    大杯  标准    中杯  标准    小杯  标准    。。。</code></pre><h1 id="二、数据库设计"><a href="#二、数据库设计" class="headerlink" title="二、数据库设计"></a>二、数据库设计</h1><h2 id="2-1-spu表"><a href="#2-1-spu表" class="headerlink" title="2.1 spu表"></a>2.1 spu表</h2><table><thead><tr><th align="left">字段</th><th align="center">类型</th><th align="right">描述</th></tr></thead><tbody><tr><td align="left">id</td><td align="center">int</td><td align="right">ID</td></tr><tr><td align="left">goods_id</td><td align="center">int</td><td align="right">商品ID</td></tr><tr><td align="left">name</td><td align="center">varchar</td><td align="right">规格名称</td></tr><tr><td align="left">item</td><td align="center">text</td><td align="right">规格</td></tr><tr><td align="left">status</td><td align="center">tinty</td><td align="right">状态</td></tr><tr><td align="left">createtime</td><td align="center">int</td><td align="right">创建时间</td></tr><tr><td align="left">updatetime</td><td align="center">int</td><td align="right">更新时间</td></tr></tbody></table><p>6    2    口味    微辣,中辣,特辣    1723441719    1723441719        0</p><h2 id="2-2sku-表"><a href="#2-2sku-表" class="headerlink" title="2.2sku 表"></a>2.2sku 表</h2><table><thead><tr><th align="left">字段</th><th align="center">类型</th><th align="right">描述</th></tr></thead><tbody><tr><td align="left">id</td><td align="center">int</td><td align="right">ID</td></tr><tr><td align="left">goods_id</td><td align="center">int</td><td align="right">商品ID</td></tr><tr><td align="left">thumbnail</td><td align="center">text</td><td align="right">缩略图</td></tr><tr><td align="left">difference</td><td align="center">text</td><td align="right">规格</td></tr><tr><td align="left">price</td><td align="center">decimal(10,2)</td><td align="right">价格</td></tr><tr><td align="left">stock</td><td align="center">int</td><td align="right">库存</td></tr><tr><td align="left">sn</td><td align="center">varchar(200)</td><td align="right">商品标号</td></tr><tr><td align="left">createtime</td><td align="center">int</td><td align="right">创建时间</td></tr><tr><td align="left">updatetime</td><td align="center">int</td><td align="right">更新时间</td></tr></tbody></table><p>2    2        微辣,小份    1    11    11    1    11    0    1    1723441530    1723441600        normal</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;一、SPU和SKU&quot;&gt;&lt;a href=&quot;#一、SPU和SKU&quot; class=&quot;headerlink&quot; title=&quot;一、SPU和SKU&quot;&gt;&lt;/a&gt;一、SPU和SKU&lt;/h1&gt;&lt;p&gt;SPU：Standard Product Unit （标准产品单位） ，一组具有共同</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>php开发-fastadmin表格操作列自定义按钮</title>
    <link href="http://example.com/posts/5f9fc809.html"/>
    <id>http://example.com/posts/5f9fc809.html</id>
    <published>2024-08-08T12:30:54.000Z</published>
    <updated>2024-10-18T06:03:59.671Z</updated>
    
    <content type="html"><![CDATA[<h1 id="自定义弹框效果按钮"><a href="#自定义弹框效果按钮" class="headerlink" title="自定义弹框效果按钮"></a>自定义弹框效果按钮</h1><p>classname字段控制 btn-dialog</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;changerecord&#x27;</span>,</span><br><span class="line">   <span class="attr">text</span>: <span class="string">&#x27;动账记录查询&#x27;</span>,</span><br><span class="line">   <span class="attr">icon</span>: <span class="string">&#x27;fa fa-search&#x27;</span>,</span><br><span class="line">   <span class="attr">classname</span>: <span class="string">&#x27;btn btn-info btn-xs btn-dialog&#x27;</span>,</span><br><span class="line">   <span class="attr">url</span>: <span class="string">&#x27;cms/bank/changeRecord&#x27;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h1 id="需要确认后再处理"><a href="#需要确认后再处理" class="headerlink" title="需要确认后再处理"></a>需要确认后再处理</h1><p>visible 字段可根据数据判断 是否显示按钮</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">         &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;jy&#x27;</span>,</span><br><span class="line">            <span class="attr">text</span>: <span class="string">&#x27;解约&#x27;</span>,</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&#x27;fa fa-search&#x27;</span>,</span><br><span class="line">            <span class="attr">classname</span>: <span class="string">&#x27;btn btn-info btn-xs btn-danger btn-ajax&#x27;</span>,</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;cms/bank/unwind&#x27;</span>,</span><br><span class="line">            <span class="attr">visible</span>: <span class="function"><span class="keyword">function</span> (<span class="params">row</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (row.status == <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">confirm</span>: <span class="string">&#x27;确定要解约吗?&#x27;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">data, ret</span>) </span>&#123;</span><br><span class="line">                $(<span class="string">&quot;a.btn-refresh&quot;</span>).trigger(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">                layer.alert(ret.msg);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//如果需要阻止成功提示，则必须使用return false;</span></span><br><span class="line">                <span class="comment">//return false;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">error</span>: <span class="function"><span class="keyword">function</span> (<span class="params">data, ret</span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(data, ret);</span><br><span class="line">                layer.alert(ret.msg);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line"><span class="string">``</span><span class="string">`    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 控制字段的显示</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">formatter字段中处理</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>js </span><br><span class="line"> &#123;</span><br><span class="line">    <span class="attr">field</span>: <span class="string">&#x27;status&#x27;</span>, <span class="attr">title</span>: <span class="string">&#x27;状态&#x27;</span>,<span class="attr">operate</span>: <span class="literal">false</span>, <span class="attr">formatter</span>: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (value == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;已签约&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;未签约&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">field</span>: <span class="string">&#x27;grant&#x27;</span>, <span class="attr">title</span>: __(<span class="string">&#x27;Grant&#x27;</span>), <span class="attr">operate</span>: <span class="string">&#x27;LIKE&#x27;</span>,<span class="attr">formatter</span>: Controller.api.formatter.grant&#125;</span><br></pre></td></tr></table></figure><h1 id="自定义编辑删除按钮"><a href="#自定义编辑删除按钮" class="headerlink" title="自定义编辑删除按钮"></a>自定义编辑删除按钮</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;edit&#x27;</span>,</span><br><span class="line">     <span class="attr">icon</span>: <span class="string">&#x27;fa fa-pencil&#x27;</span>,</span><br><span class="line">     <span class="attr">title</span>: __(<span class="string">&#x27;Edit&#x27;</span>),</span><br><span class="line">     <span class="attr">extend</span>: <span class="string">&#x27;data-toggle=&quot;tooltip&quot;&#x27;</span>,</span><br><span class="line">     <span class="attr">classname</span>: <span class="string">&#x27;btn btn-xs btn-success btn-editone&#x27;</span>,</span><br><span class="line">     <span class="attr">visible</span>: <span class="function"><span class="keyword">function</span> (<span class="params">row</span>) </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> row.status === <span class="number">0</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;,</span><br><span class="line">&#123;</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;del&#x27;</span>,</span><br><span class="line">     <span class="attr">icon</span>: <span class="string">&#x27;fa fa-trash&#x27;</span>,</span><br><span class="line">     <span class="attr">title</span>: __(<span class="string">&#x27;Del&#x27;</span>),</span><br><span class="line">     <span class="attr">extend</span>: <span class="string">&#x27;data-toggle=&quot;tooltip&quot;&#x27;</span>,</span><br><span class="line">     <span class="attr">classname</span>: <span class="string">&#x27;btn btn-xs btn-danger btn-delone&#x27;</span>,</span><br><span class="line">     <span class="attr">visible</span>: <span class="function"><span class="keyword">function</span> (<span class="params">row</span>) </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> row.status === <span class="number">0</span>;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="自定义提交处理"><a href="#自定义提交处理" class="headerlink" title="自定义提交处理"></a>自定义提交处理</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">add: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          Controller.api.selectcoupon();</span><br><span class="line">          Controller.api.selectusers();</span><br><span class="line">          </span><br><span class="line">          Form.api.bindevent($(<span class="string">&quot;form[role=form]&quot;</span>), <span class="function"><span class="keyword">function</span>(<span class="params">data, ret</span>)</span>&#123;</span><br><span class="line">              <span class="comment">//如果我们需要在提交表单成功后做跳转，可以在此使用location.href=&quot;链接&quot;;进行跳转</span></span><br><span class="line">          &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">data, ret</span>)</span>&#123;</span><br><span class="line">              <span class="comment">// 错误处理</span></span><br><span class="line">              Fast.api.close();</span><br><span class="line">          &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">success, error</span>)</span>&#123;</span><br><span class="line">              <span class="comment">//bindevent的第三个参数为提交前的回调</span></span><br><span class="line">              <span class="comment">//如果我们需要在表单提交前做一些数据处理，则可以在此方法处理</span></span><br><span class="line">              <span class="comment">//注意如果我们需要阻止表单，可以在此使用return false;即可</span></span><br><span class="line">              <span class="comment">//如果我们处理完成需要再次提交表单则可以使用submit提交,如下</span></span><br><span class="line">              <span class="keyword">if</span>(!$(<span class="string">&quot;#user_ids&quot;</span>).val())&#123;</span><br><span class="line">                  Toastr.error(<span class="string">&quot;请选择发放用户&quot;</span>);</span><br><span class="line">                  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span>(!$(<span class="string">&quot;#couponid&quot;</span>).val())&#123;</span><br><span class="line">                  Toastr.error(<span class="string">&quot;请选择发放卡券&quot;</span>);</span><br><span class="line">                  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h1 id="完整-示例代码"><a href="#完整-示例代码" class="headerlink" title="完整 示例代码"></a>完整 示例代码</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">columns: [</span><br><span class="line">                [</span><br><span class="line">                    &#123;checkbox: true&#125;,</span><br><span class="line">                    &#123;field: &#x27;id&#x27;, title: &quot;ID&quot;,operate: false&#125;,</span><br><span class="line">                    &#123;field: &#x27;account&#x27;, title: &quot;账号&quot;, operate: &#x27;like&#x27;&#125;,</span><br><span class="line">                    &#123;field: &#x27;school.school_name&#x27;, title: &quot;学校&quot;, operate: &#x27;like&#x27;&#125;,</span><br><span class="line">                    &#123;field: &#x27;balance&#x27;, title: &quot;余额/元&quot;, operate: false&#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        field: &#x27;status&#x27;, title: &#x27;状态&#x27;,operate: false, formatter: function (value) &#123;</span><br><span class="line">                            if (value == 0) &#123;</span><br><span class="line">                                return &quot;已签约&quot;;</span><br><span class="line">                            &#125; else if (value == 1) &#123;</span><br><span class="line">                                return &quot;未签约&quot;;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        field: &#x27;operate&#x27;, title: __(&#x27;Operate&#x27;), table: table,</span><br><span class="line">                        events: Table.api.events.operate,</span><br><span class="line">                        buttons: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;changerecord&#x27;,</span><br><span class="line">                                text: &#x27;动账记录查询&#x27;,</span><br><span class="line">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class="line">                                classname: &#x27;btn btn-info btn-xs btn-dialog&#x27;,</span><br><span class="line">                                url: &#x27;cms/bank/changeRecord&#x27;</span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;freezerecord&#x27;,</span><br><span class="line">                                text: &#x27;冻结/解冻记录&#x27;,</span><br><span class="line">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class="line">                                classname: &#x27;btn btn-info btn-xs btn-detail btn-dialog&#x27;,</span><br><span class="line">                                url: &#x27;cms/bank/freezeRecord&#x27;,</span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;balance&#x27;,</span><br><span class="line">                                text: &#x27;查询余额&#x27;,</span><br><span class="line">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class="line">                                classname: &#x27;btn btn-info btn-xs btn-balance&#x27;,</span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;qy&#x27;,</span><br><span class="line">                                text: &#x27;签约&#x27;,</span><br><span class="line">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class="line">                                classname: &#x27;btn btn-info btn-xs btn-success btn-ajax&#x27;,</span><br><span class="line">                                url: &#x27;cms/bank/sign&#x27;,</span><br><span class="line">                                visible: function (row) &#123;</span><br><span class="line">                                    if (row.status == 1) &#123;</span><br><span class="line">                                        return true;</span><br><span class="line">                                    &#125; else &#123;</span><br><span class="line">                                        return false;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;,</span><br><span class="line">                                success: function (data, ret) &#123;</span><br><span class="line">                                    $(&quot;a.btn-refresh&quot;).trigger(&quot;click&quot;);</span><br><span class="line">                                    layer.alert(ret.msg);</span><br><span class="line">                                    //如果需要阻止成功提示，则必须使用return false;</span><br><span class="line">                                    //return false;</span><br><span class="line">                                &#125;,</span><br><span class="line">                                error: function (data, ret) &#123;</span><br><span class="line">                                    console.log(data, ret);</span><br><span class="line">                                    layer.alert(ret.msg);</span><br><span class="line">                                    return false;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;jy&#x27;,</span><br><span class="line">                                text: &#x27;解约&#x27;,</span><br><span class="line">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class="line">                                classname: &#x27;btn btn-info btn-xs btn-danger btn-ajax&#x27;,</span><br><span class="line">                                url: &#x27;cms/bank/unwind&#x27;,</span><br><span class="line">                                visible: function (row) &#123;</span><br><span class="line">                                    if (row.status == 0) &#123;</span><br><span class="line">                                        return true;</span><br><span class="line">                                    &#125; else &#123;</span><br><span class="line">                                        return false;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;,</span><br><span class="line">                                confirm: &#x27;确定要解约吗?&#x27;,</span><br><span class="line">                                success: function (data, ret) &#123;</span><br><span class="line">                                    $(&quot;a.btn-refresh&quot;).trigger(&quot;click&quot;);</span><br><span class="line">                                    layer.alert(ret.msg);</span><br><span class="line"></span><br><span class="line">                                    //如果需要阻止成功提示，则必须使用return false;</span><br><span class="line">                                    //return false;</span><br><span class="line">                                &#125;,</span><br><span class="line">                                error: function (data, ret) &#123;</span><br><span class="line">                                    console.log(data, ret);</span><br><span class="line">                                    layer.alert(ret.msg);</span><br><span class="line">                                    return false;</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;dj&#x27;,</span><br><span class="line">                                text: &#x27;冻结&#x27;,</span><br><span class="line">                                icon: &#x27;fa fa-search&#x27;,</span><br><span class="line">                                classname: &#x27;btn btn-info btn-xs btn-danger btn-ajax&#x27;,</span><br><span class="line">                                url: &#x27;cms/bank/frozen&#x27;,</span><br><span class="line">                                confirm: &#x27;确定要冻结吗?&#x27;,</span><br><span class="line">                                success: function (data, ret) &#123;</span><br><span class="line">                                    $(&quot;a.btn-refresh&quot;).trigger(&quot;click&quot;);</span><br><span class="line">                                    layer.alert(ret.msg);</span><br><span class="line"></span><br><span class="line">                                    //如果需要阻止成功提示，则必须使用return false;</span><br><span class="line">                                    //return false;</span><br><span class="line">                                &#125;,</span><br><span class="line">                                error: function (data, ret) &#123;</span><br><span class="line">                                    console.log(data, ret);</span><br><span class="line">                                    layer.alert(ret.msg);</span><br><span class="line">                                    return false;</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                            &#125;,</span><br><span class="line">                         &#123;</span><br><span class="line">                            name: &#x27;edit&#x27;,</span><br><span class="line">                            icon: &#x27;fa fa-pencil&#x27;,</span><br><span class="line">                            title: __(&#x27;Edit&#x27;),</span><br><span class="line">                            extend: &#x27;data-toggle=&quot;tooltip&quot;&#x27;,</span><br><span class="line">                            classname: &#x27;btn btn-xs btn-success btn-editone&#x27;,</span><br><span class="line">                            visible: function (row) &#123;</span><br><span class="line">                                return row.status === 0;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            name: &#x27;del&#x27;,</span><br><span class="line">                            icon: &#x27;fa fa-trash&#x27;,</span><br><span class="line">                            title: __(&#x27;Del&#x27;),</span><br><span class="line">                            extend: &#x27;data-toggle=&quot;tooltip&quot;&#x27;,</span><br><span class="line">                            classname: &#x27;btn btn-xs btn-danger btn-delone&#x27;,</span><br><span class="line">                            visible: function (row) &#123;</span><br><span class="line">                                return row.status === 0;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    ], formatter: Table.api.formatter.operate&#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                ]</span><br><span class="line">            ]</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;自定义弹框效果按钮&quot;&gt;&lt;a href=&quot;#自定义弹框效果按钮&quot; class=&quot;headerlink&quot; title=&quot;自定义弹框效果按钮&quot;&gt;&lt;/a&gt;自定义弹框效果按钮&lt;/h1&gt;&lt;p&gt;classname字段控制 btn-dialog&lt;/p&gt;
&lt;figure class</summary>
      
    
    
    
    
    <category term="fastadmin" scheme="http://example.com/tags/fastadmin/"/>
    
  </entry>
  
  <entry>
    <title>php开发-fastadmin键值组件(Fieldlist)</title>
    <link href="http://example.com/posts/c70fd524.html"/>
    <id>http://example.com/posts/c70fd524.html</id>
    <published>2024-08-08T11:56:55.000Z</published>
    <updated>2024-10-18T06:04:02.835Z</updated>
    
    <content type="html"><![CDATA[<h1 id="fieldlist中有select"><a href="#fieldlist中有select" class="headerlink" title="fieldlist中有select"></a>fieldlist中有select</h1><p>selectpicker貌似不兼容的<br>模版语法 art-template<br>edit 页面select默认选中值 [先执行php代码 最后js取渲染模版的]</p><p>art-template中使用if</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="keyword">if</span>(…)&#123;%&gt;  html  &lt;%&#125;<span class="keyword">else</span>&#123;%&gt; html  &lt;%&#125;%&gt;</span><br></pre></td></tr></table></figure><p>edit页面 代码示例</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/html&quot;</span> <span class="attr">id</span>=<span class="string">&quot;testtpl&quot;</span>&gt;</span><span class="handlebars"><span class="xml"></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">     <span class="tag">&lt;<span class="name">dd</span> <span class="attr">class</span>=<span class="string">&quot;form-inline&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][id]&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&lt;%=row[&#x27;id&#x27;]%&gt;&quot;</span> <span class="attr">size</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars"></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;<span class="name">select</span>   <span class="attr">data-id</span>=<span class="string">&quot;&lt;%=index%&gt;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;couponname form-control&quot;</span>  <span class="attr">name</span>=<span class="string">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][coupon_id]&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 111px&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">             <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>请选择<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars"></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">             &lt;?php</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">                                         foreach($coupon as $vo)&#123;</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">                                            echo &#x27;<span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">&quot;&#x27;.$vo[&#x27;name&#x27;].&#x27;&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#x27;.$vo[&#x27;id&#x27;].&#x27;&quot;</span>     &lt;% <span class="attr">if</span> (<span class="attr">row</span>[&quot;<span class="attr">coupon_id</span>&quot;]&amp;&amp;<span class="attr">row</span>[&quot;<span class="attr">coupon_id</span>&quot;]<span class="attr">.indexOf</span>(&quot;&#x27;<span class="attr">.</span>$<span class="attr">vo</span>[&quot;<span class="attr">id</span>&quot;]<span class="attr">.</span>&#x27;&quot;)&gt;</span>-1) &#123; %&gt; selected &lt;% &#125; %&gt;     &gt;&#x27;.$vo[&#x27;name&#x27;].&#x27;<span class="tag">&lt;/<span class="name">option</span>&gt;</span>&#x27;;</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">             &#125;</span></span></span><br><span class="line"><span class="xml"><span class="handlebars"></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">             ?&gt;</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">             <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;-1&quot;</span>&gt;</span>谢谢参与<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>   <span class="attr">id</span>=<span class="string">&quot;num&lt;%=index%&gt;&quot;</span>  <span class="attr">name</span>=<span class="string">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][num]&quot;</span> <span class="attr">readonly</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&lt;%=row[&#x27;num&#x27;]%&gt;&quot;</span> <span class="attr">size</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row[&lt;%=name%&gt;][&lt;%=index%&gt;][scale]&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&lt;%=row[&#x27;scale&#x27;]%&gt;&quot;</span> <span class="attr">size</span>=<span class="string">&quot;1&quot;</span>&gt;</span>%</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&lt;%=name%&gt;[&lt;%=index%&gt;][icon]&quot;</span> <span class="attr">id</span>=<span class="string">&quot;c-downloadurl-&lt;%=index%&gt;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&lt;%=row.icon%&gt;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:140px;&quot;</span>/&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn-group&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">             <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&quot;plupload-downloadurl-&lt;%=index%&gt;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-danger plupload&quot;</span> <span class="attr">data-input-id</span>=<span class="string">&quot;c-downloadurl-&lt;%=index%&gt;&quot;</span> <span class="attr">data-mimetype</span>=<span class="string">&quot;*&quot;</span> <span class="attr">data-multiple</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-upload&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">     <span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars"> </span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;fieldlist中有select&quot;&gt;&lt;a href=&quot;#fieldlist中有select&quot; class=&quot;headerlink&quot; title=&quot;fieldlist中有select&quot;&gt;&lt;/a&gt;fieldlist中有select&lt;/h1&gt;&lt;p&gt;selectpick</summary>
      
    
    
    
    
    <category term="fastadmin" scheme="http://example.com/tags/fastadmin/"/>
    
  </entry>
  
  <entry>
    <title>linux-sftp服务配置</title>
    <link href="http://example.com/posts/8e2962f3.html"/>
    <id>http://example.com/posts/8e2962f3.html</id>
    <published>2024-08-02T02:34:24.000Z</published>
    <updated>2024-11-25T11:19:05.124Z</updated>
    
    <content type="html"><![CDATA[<p>vim /etc/ssh/ssh_config</p><p>Subsystem sftp internal-sftp<br>Match Group sftp<br>        ChrootDirectory /www/wwwroot/ftp_ip_user<br>        X11Forwarding no<br>        AllowTcpForwarding no<br>        ForceCommand internal-sftp</p><p>fatal: bad ownership or modes for chroot directory “/www/wwwroot/ftp_ip_user” </p><p>这个错误通常发生在使用SSH服务进行远程登录时，特别是当你尝试为特定用户设置chroot环境时。<br>chroot是一种安全机制，它将用户的根目录更改为另一个目录，从而限制用户只能在该目录及其子目录下操作。<br>报错信息fatal: bad ownership or modes意味着chroot目录的所有权或权限设置不正确，SSH服务无法以安全的方式访问该目录。</p><p>问题解决：</p><p>检查/www/wwwroot/ftp_ip_user目录的所有权和权限。它应该只有root用户有写权限。可以使用以下命令来修复：</p><p>sudo chown root:root /www/wwwroot/ftp_ip_user<br>sudo chmod 0755 /www/wwwroot/ftp_ip_user</p><p>确保目录中没有任何不必要的文件或目录，特别是不应该有写权限给其他用户。</p><p>如果你使用的是sshd_config文件中的ChrootDirectory指令，确保指定的目录是你想要chroot jail的目录。</p><p>如果你在使用sftp服务，确保sshd_config文件中的Subsystem sftp指令指向正确的internal-sftp路径。</p><p>重启SSH服务以使更改生效。</p><p>如果问题依然存在，检查系统日志以获取更多信息，可能会有额外的线索</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;vim /etc/ssh/ssh_config&lt;/p&gt;
&lt;p&gt;Subsystem sftp internal-sftp&lt;br&gt;Match Group sftp&lt;br&gt;        ChrootDirectory /www/wwwroot/ftp_ip_user&lt;br&gt;  </summary>
      
    
    
    
    <category term="服务器相关" scheme="http://example.com/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3/"/>
    
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
    <category term="sftp" scheme="http://example.com/tags/sftp/"/>
    
  </entry>
  
  <entry>
    <title>mysql-主从数据库</title>
    <link href="http://example.com/posts/585d050b.html"/>
    <id>http://example.com/posts/585d050b.html</id>
    <published>2024-07-23T02:33:22.000Z</published>
    <updated>2024-11-25T11:21:02.790Z</updated>
    
    <content type="html"><![CDATA[<h1 id="mysql主从的应用"><a href="#mysql主从的应用" class="headerlink" title="mysql主从的应用"></a>mysql主从的应用</h1><h2 id="用来数据迁移"><a href="#用来数据迁移" class="headerlink" title="用来数据迁移"></a>用来数据迁移</h2><pre><code>开启主从同步，将数据导入主节点，让从节点同步；将数据分别导入主从节点，让主从节点数据一致后，建立连接，开启同步</code></pre><h2 id="数据备份"><a href="#数据备份" class="headerlink" title="数据备份"></a>数据备份</h2><h2 id="读写分离"><a href="#读写分离" class="headerlink" title="读写分离"></a>读写分离</h2><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h2 id="主节点配置"><a href="#主节点配置" class="headerlink" title="主节点配置"></a>主节点配置</h2><h3 id="主节点-my-cnf配置"><a href="#主节点-my-cnf配置" class="headerlink" title="主节点 my.cnf配置"></a>主节点 my.cnf配置</h3><pre><code>my.cnf  mysqld    # 开启日志general_log = 1general_log_file = mysql.log# 主从复制配置server-id = 1# binlog日志格式，mysql默认采用statement，建议使用mixed# STATEMENT模式（SBR）# 每一条会修改数据的sql语句会记录到binlog中。优点是并不需要记录每一条sql语句和每一行的数据变化，减少了binlog日志量，节约IO，提高性能。缺点是在某些情况下会导致master-slave中的数据不一致(如sleep()函数， last_insert_id()，以及user-defined functions(udf)等会出现问题)# ROW模式（RBR）# 不记录每条sql语句的上下文信息，仅需记录哪条数据被修改了，修改成什么样了。而且不会出现某些特定情况下的存储过程、或function、或trigger的调用和触发无法被正确复制的问题。缺点是会产生大量的日志，尤其是alter table的时候会让日志暴涨。# MIXED模式（MBR）# 以上两种模式的混合使用，一般的复制使用STATEMENT模式保存binlog，对于STATEMENT模式无法复制的操作使用ROW模式保存binlog，MySQL会根据执行的SQL语句选择日志保存方式。binlog_format= MIXED# binlog日志文件log-bin=mysql-bin# 是否只读，1 代表只读，0代表读写，主数据库需要读写，设置0read-only=0# binlog过期清理时间expire_logs_days=7# binlog每个日志文件大小max_binlog_size= 100m# binlog缓存大小binlog_cache_size= 4m# 最大binlog缓存大小max_binlog_cache_size= 512m</code></pre><h3 id="相关sql操作"><a href="#相关sql操作" class="headerlink" title="相关sql操作"></a>相关sql操作</h3><pre><code>## 创建dd用户 授权只能ip 192.168.227.134 访问 密码设置为123456CREATE USER &#39;dd&#39;@&#39;192.168.227.134&#39; IDENTIFIED BY &#39;123456&#39;;## 设置一个从服务器（slave）来复制主服务器（master）的数据权限GRANT REPLICATION SLAVE ON *.* TO &#39;dd&#39;@&#39;192.168.227.134&#39;;show master status </code></pre><h3 id="从节点-my-cnf配置"><a href="#从节点-my-cnf配置" class="headerlink" title="从节点 my.cnf配置"></a>从节点 my.cnf配置</h3><pre><code>server-id=2#它指定了从服务器（slave）用于存储从中继日志（relay logs）#中读取并准备应用于本地数据库的事件的文件的路径和名称模式。relay-log=mysql-relay-binsql//配置并启动主从复制change master to    -&gt; master_host=&#39;192.168.227.133&#39;,        #主的ip地址    -&gt; master_user=&#39;dd&#39;,                    #创建的用户名    -&gt; master_password=&#39;123456&#39;,            #创建的密码    -&gt; master_log_file=&#39;mysql-bin.000001&#39;,    #日志文件    -&gt; master_log_pos=328;                    #数据的最新位置//开启奴隶模式start slave;    show slave status </code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;mysql主从的应用&quot;&gt;&lt;a href=&quot;#mysql主从的应用&quot; class=&quot;headerlink&quot; title=&quot;mysql主从的应用&quot;&gt;&lt;/a&gt;mysql主从的应用&lt;/h1&gt;&lt;h2 id=&quot;用来数据迁移&quot;&gt;&lt;a href=&quot;#用来数据迁移&quot; class=&quot;</summary>
      
    
    
    
    <category term="mysql" scheme="http://example.com/categories/mysql/"/>
    
    
    <category term="mysql" scheme="http://example.com/tags/mysql/"/>
    
  </entry>
  
</feed>
